python run.py --language UD_Catalan --experiment-name inter-layer-13 --attribute POS --trainer poisson --gpu --embedding bloom-1b1 greedy --selection-size 50 --selection-criterion mi
Setting up datasets (['UD_Catalan'], POS) and probes...
  0%|          | 0/441656 [00:00<?, ?it/s]  0%|          | 2116/441656 [00:00<00:20, 21153.51it/s]  1%|          | 4892/441656 [00:00<00:17, 25037.77it/s]  2%|▏         | 7704/441656 [00:00<00:16, 26440.82it/s]  2%|▏         | 10422/441656 [00:00<00:16, 26730.59it/s]  3%|▎         | 13152/441656 [00:00<00:15, 26934.35it/s]  4%|▎         | 15948/441656 [00:00<00:15, 27281.44it/s]  4%|▍         | 18711/441656 [00:00<00:15, 27393.02it/s]  5%|▍         | 21451/441656 [00:00<00:15, 27322.59it/s]  5%|▌         | 24184/441656 [00:00<00:15, 27318.71it/s]  6%|▌         | 26916/441656 [00:01<00:15, 27307.70it/s]  7%|▋         | 29647/441656 [00:01<00:15, 27202.89it/s]  7%|▋         | 32368/441656 [00:01<00:15, 27162.28it/s]  8%|▊         | 35085/441656 [00:01<00:14, 27145.32it/s]  9%|▊         | 37800/441656 [00:01<00:36, 10997.30it/s]  9%|▉         | 40272/441656 [00:01<00:30, 13033.29it/s] 10%|▉         | 42909/441656 [00:02<00:25, 15364.77it/s] 10%|█         | 45553/441656 [00:02<00:22, 17577.79it/s] 11%|█         | 48228/441656 [00:02<00:20, 19613.96it/s] 12%|█▏        | 50887/441656 [00:02<00:18, 21291.49it/s] 12%|█▏        | 53603/441656 [00:02<00:17, 22791.12it/s] 13%|█▎        | 56283/441656 [00:02<00:16, 23862.46it/s] 13%|█▎        | 58954/441656 [00:02<00:15, 24646.93it/s] 14%|█▍        | 61658/441656 [00:02<00:15, 25322.05it/s] 15%|█▍        | 64346/441656 [00:02<00:14, 25769.51it/s] 15%|█▌        | 67055/441656 [00:02<00:14, 26152.43it/s] 16%|█▌        | 69735/441656 [00:03<00:14, 26340.63it/s] 16%|█▋        | 72414/441656 [00:03<00:14, 25992.37it/s] 17%|█▋        | 75110/441656 [00:03<00:13, 26271.55it/s] 18%|█▊        | 77808/441656 [00:03<00:13, 26473.76it/s] 18%|█▊        | 80628/441656 [00:03<00:13, 26982.29it/s] 19%|█▉        | 83339/441656 [00:03<00:13, 27001.08it/s] 19%|█▉        | 86048/441656 [00:03<00:13, 26970.91it/s] 20%|██        | 88751/441656 [00:04<00:35, 9858.85it/s]  21%|██        | 91216/441656 [00:04<00:29, 11849.96it/s] 21%|██        | 93703/441656 [00:04<00:24, 13950.39it/s] 22%|██▏       | 96180/441656 [00:04<00:21, 15975.97it/s] 22%|██▏       | 98592/441656 [00:04<00:19, 17694.32it/s] 23%|██▎       | 101082/441656 [00:04<00:17, 19299.85it/s] 23%|██▎       | 103591/441656 [00:04<00:16, 20735.72it/s] 24%|██▍       | 106009/441656 [00:05<00:15, 21627.20it/s] 25%|██▍       | 108426/441656 [00:05<00:15, 22192.38it/s] 25%|██▌       | 110882/441656 [00:05<00:14, 22849.01it/s] 26%|██▌       | 113388/441656 [00:05<00:13, 23476.76it/s] 26%|██▌       | 115859/441656 [00:05<00:13, 23832.08it/s] 27%|██▋       | 118390/441656 [00:05<00:13, 24263.50it/s] 27%|██▋       | 120922/441656 [00:05<00:13, 24572.79it/s] 28%|██▊       | 123451/441656 [00:05<00:12, 24784.36it/s] 29%|██▊       | 125984/441656 [00:05<00:12, 24944.66it/s] 29%|██▉       | 128501/441656 [00:05<00:12, 25011.16it/s] 30%|██▉       | 131076/441656 [00:06<00:12, 25231.25it/s] 30%|███       | 133608/441656 [00:06<00:12, 25156.87it/s] 31%|███       | 136166/441656 [00:06<00:12, 25280.17it/s] 31%|███▏      | 138699/441656 [00:06<00:11, 25282.75it/s] 32%|███▏      | 141231/441656 [00:06<00:12, 25006.91it/s] 33%|███▎      | 143735/441656 [00:06<00:11, 24941.23it/s] 33%|███▎      | 146247/441656 [00:06<00:11, 24990.75it/s] 34%|███▎      | 148763/441656 [00:06<00:11, 25040.76it/s] 34%|███▍      | 151269/441656 [00:07<00:34, 8422.18it/s]  35%|███▍      | 153720/441656 [00:07<00:27, 10439.78it/s] 35%|███▌      | 156141/441656 [00:07<00:22, 12531.85it/s] 36%|███▌      | 158585/441656 [00:07<00:19, 14655.11it/s] 36%|███▋      | 161019/441656 [00:07<00:16, 16621.42it/s] 37%|███▋      | 163445/441656 [00:08<00:15, 18337.31it/s] 38%|███▊      | 165864/441656 [00:08<00:13, 19759.65it/s] 38%|███▊      | 168224/441656 [00:08<00:13, 20735.09it/s] 39%|███▊      | 170640/441656 [00:08<00:12, 21654.46it/s] 39%|███▉      | 173039/441656 [00:08<00:12, 22302.42it/s] 40%|███▉      | 175440/441656 [00:08<00:11, 22785.06it/s] 40%|████      | 177832/441656 [00:08<00:11, 23109.06it/s] 41%|████      | 180268/441656 [00:08<00:11, 23472.30it/s] 41%|████▏     | 182794/441656 [00:08<00:10, 23995.85it/s] 42%|████▏     | 185256/441656 [00:08<00:10, 24135.71it/s] 42%|████▏     | 187698/441656 [00:09<00:10, 24124.53it/s] 43%|████▎     | 190131/441656 [00:09<00:10, 24004.11it/s] 44%|████▎     | 192568/441656 [00:09<00:10, 24108.10it/s] 44%|████▍     | 195045/441656 [00:09<00:10, 24303.49it/s] 45%|████▍     | 197483/441656 [00:09<00:10, 24125.94it/s] 45%|████▌     | 199901/441656 [00:09<00:10, 24133.39it/s] 46%|████▌     | 202329/441656 [00:09<00:09, 24176.25it/s] 46%|████▋     | 204750/441656 [00:09<00:09, 23941.45it/s] 47%|████▋     | 207147/441656 [00:09<00:09, 23794.71it/s] 47%|████▋     | 209529/441656 [00:09<00:09, 23766.68it/s] 48%|████▊     | 211926/441656 [00:10<00:09, 23824.62it/s] 49%|████▊     | 214471/441656 [00:10<00:09, 24308.32it/s] 49%|████▉     | 217063/441656 [00:10<00:09, 24787.56it/s] 50%|████▉     | 219799/441656 [00:10<00:08, 25554.64it/s] 50%|█████     | 222535/441656 [00:10<00:08, 26093.51it/s] 51%|█████     | 225223/441656 [00:10<00:08, 26326.66it/s] 52%|█████▏    | 227951/441656 [00:10<00:08, 26610.18it/s] 52%|█████▏    | 230613/441656 [00:11<00:25, 8424.80it/s]  53%|█████▎    | 233385/441656 [00:11<00:19, 10727.41it/s] 53%|█████▎    | 236123/441656 [00:11<00:15, 13152.76it/s] 54%|█████▍    | 238900/441656 [00:11<00:12, 15669.92it/s] 55%|█████▍    | 241685/441656 [00:11<00:11, 18074.78it/s] 55%|█████▌    | 244434/441656 [00:11<00:09, 20145.84it/s] 56%|█████▌    | 247214/441656 [00:12<00:08, 21974.51it/s] 57%|█████▋    | 250007/441656 [00:12<00:08, 23489.38it/s] 57%|█████▋    | 252717/441656 [00:12<00:07, 24310.58it/s] 58%|█████▊    | 255477/441656 [00:12<00:07, 25212.85it/s] 58%|█████▊    | 258256/441656 [00:12<00:07, 25936.78it/s] 59%|█████▉    | 261028/441656 [00:12<00:06, 26326.15it/s] 60%|█████▉    | 263800/441656 [00:12<00:06, 26728.37it/s] 60%|██████    | 266550/441656 [00:12<00:06, 26951.65it/s] 61%|██████    | 269332/441656 [00:12<00:06, 27204.99it/s] 62%|██████▏   | 272088/441656 [00:12<00:06, 27237.67it/s] 62%|██████▏   | 274870/441656 [00:13<00:06, 27410.14it/s] 63%|██████▎   | 277629/441656 [00:13<00:05, 27393.76it/s] 63%|██████▎   | 280381/441656 [00:13<00:05, 27044.36it/s] 64%|██████▍   | 283095/441656 [00:13<00:05, 26562.85it/s] 65%|██████▍   | 285760/441656 [00:13<00:05, 26534.74it/s] 65%|██████▌   | 288420/441656 [00:13<00:05, 26484.23it/s] 66%|██████▌   | 291073/441656 [00:13<00:05, 26466.07it/s] 67%|██████▋   | 293723/441656 [00:13<00:05, 26343.30it/s] 67%|██████▋   | 296360/441656 [00:13<00:05, 26283.70it/s] 68%|██████▊   | 298990/441656 [00:14<00:05, 26137.62it/s] 68%|██████▊   | 301610/441656 [00:14<00:05, 26153.36it/s] 69%|██████▉   | 304237/441656 [00:14<00:05, 26186.18it/s] 69%|██████▉   | 306857/441656 [00:14<00:05, 25996.45it/s] 70%|███████   | 309458/441656 [00:14<00:05, 25949.90it/s] 71%|███████   | 312074/441656 [00:14<00:04, 26009.76it/s] 71%|███████▏  | 314701/441656 [00:14<00:04, 26084.67it/s] 72%|███████▏  | 317339/441656 [00:14<00:04, 26171.70it/s] 72%|███████▏  | 319957/441656 [00:14<00:04, 26148.94it/s] 73%|███████▎  | 322573/441656 [00:14<00:04, 26120.78it/s] 74%|███████▎  | 325198/441656 [00:15<00:04, 26156.93it/s] 74%|███████▍  | 327821/441656 [00:15<00:04, 26176.67it/s] 75%|███████▍  | 330439/441656 [00:16<00:18, 5965.81it/s]  75%|███████▌  | 333104/441656 [00:16<00:13, 7803.80it/s] 76%|███████▌  | 335796/441656 [00:16<00:10, 9957.12it/s] 77%|███████▋  | 338500/441656 [00:16<00:08, 12324.91it/s] 77%|███████▋  | 341171/441656 [00:16<00:06, 14701.77it/s] 78%|███████▊  | 343894/441656 [00:16<00:05, 17094.58it/s] 78%|███████▊  | 346580/441656 [00:16<00:04, 19187.27it/s] 79%|███████▉  | 349311/441656 [00:17<00:04, 21090.07it/s] 80%|███████▉  | 351999/441656 [00:17<00:03, 22540.92it/s] 80%|████████  | 354715/441656 [00:17<00:03, 23758.84it/s] 81%|████████  | 357387/441656 [00:17<00:03, 24456.16it/s] 82%|████████▏ | 360091/441656 [00:17<00:03, 25177.45it/s] 82%|████████▏ | 362829/441656 [00:17<00:03, 25806.34it/s] 83%|████████▎ | 365536/441656 [00:17<00:02, 26169.84it/s] 83%|████████▎ | 368276/441656 [00:17<00:02, 26528.84it/s] 84%|████████▍ | 370986/441656 [00:17<00:02, 26688.34it/s] 85%|████████▍ | 373733/441656 [00:17<00:02, 26919.54it/s] 85%|████████▌ | 376456/441656 [00:18<00:02, 27008.98it/s] 86%|████████▌ | 379177/441656 [00:18<00:02, 27055.33it/s] 86%|████████▋ | 381902/441656 [00:18<00:02, 27111.23it/s] 87%|████████▋ | 384623/441656 [00:18<00:02, 26945.33it/s] 88%|████████▊ | 387338/441656 [00:18<00:02, 27005.98it/s] 88%|████████▊ | 390092/441656 [00:18<00:01, 27163.67it/s] 89%|████████▉ | 392832/441656 [00:18<00:01, 27232.71it/s] 90%|████████▉ | 395576/441656 [00:18<00:01, 27292.95it/s] 90%|█████████ | 398308/441656 [00:18<00:01, 27274.40it/s] 91%|█████████ | 401066/441656 [00:18<00:01, 27363.01it/s] 91%|█████████▏| 403828/441656 [00:19<00:01, 27437.03it/s] 92%|█████████▏| 406573/441656 [00:19<00:01, 27360.68it/s] 93%|█████████▎| 409327/441656 [00:19<00:01, 27413.02it/s] 93%|█████████▎| 412069/441656 [00:19<00:01, 27185.30it/s] 94%|█████████▍| 414789/441656 [00:19<00:01, 26826.06it/s] 95%|█████████▍| 417473/441656 [00:19<00:00, 26694.24it/s] 95%|█████████▌| 420144/441656 [00:19<00:00, 26202.55it/s] 96%|█████████▌| 422767/441656 [00:19<00:00, 26191.67it/s] 96%|█████████▋| 425388/441656 [00:19<00:00, 25985.64it/s] 97%|█████████▋| 428002/441656 [00:19<00:00, 26029.27it/s] 98%|█████████▊| 430641/441656 [00:20<00:00, 26134.21it/s] 98%|█████████▊| 433402/441656 [00:20<00:00, 26475.22it/s] 99%|█████████▉| 436153/441656 [00:20<00:00, 26780.49it/s] 99%|█████████▉| 438832/441656 [00:20<00:00, 26745.65it/s]100%|█████████▉| 441591/441656 [00:20<00:00, 26995.63it/s]100%|██████████| 441656/441656 [00:20<00:00, 21569.50it/s]
  0%|          | 0/53198 [00:00<?, ?it/s]  7%|▋         | 3916/53198 [00:00<00:01, 39150.14it/s] 15%|█▍        | 7832/53198 [00:00<00:01, 38710.24it/s] 22%|██▏       | 11759/53198 [00:00<00:01, 38961.26it/s] 30%|██▉       | 15745/53198 [00:00<00:00, 39313.91it/s] 37%|███▋      | 19713/53198 [00:00<00:00, 39444.90it/s] 44%|████▍     | 23658/53198 [00:00<00:00, 38383.44it/s] 52%|█████▏    | 27502/53198 [00:00<00:00, 37371.10it/s] 59%|█████▊    | 31247/53198 [00:00<00:00, 37207.14it/s] 66%|██████▌   | 35184/53198 [00:00<00:00, 37864.93it/s] 73%|███████▎  | 39084/53198 [00:01<00:00, 38206.39it/s] 81%|████████  | 42996/53198 [00:01<00:00, 38479.97it/s] 88%|████████▊ | 46893/53198 [00:01<00:00, 38623.45it/s] 96%|█████████▌| 50848/53198 [00:01<00:00, 38900.13it/s]100%|██████████| 53198/53198 [00:01<00:00, 38308.35it/s]
  0%|          | 0/35912 [00:00<?, ?it/s] 11%|█         | 3961/35912 [00:00<00:00, 39605.03it/s] 22%|██▏       | 7922/35912 [00:00<00:00, 39476.22it/s] 33%|███▎      | 11894/35912 [00:00<00:00, 39582.23it/s] 44%|████▍     | 15853/35912 [00:00<00:00, 39304.81it/s] 55%|█████▌    | 19784/35912 [00:00<00:00, 37870.28it/s] 66%|██████▌   | 23580/35912 [00:00<00:00, 37309.84it/s] 76%|███████▌  | 27317/35912 [00:00<00:00, 36676.45it/s] 86%|████████▋ | 30989/35912 [00:00<00:00, 35070.88it/s] 96%|█████████▌| 34509/35912 [00:00<00:00, 34472.25it/s]100%|██████████| 35912/35912 [00:00<00:00, 36473.47it/s]
dataset loaded from path: 
data/ud/ud-treebanks-v2.1/UD_Catalan/inter-layer-13/UD_Catalan-train-bloom-1b1.pkl
data/ud/ud-treebanks-v2.1/UD_Catalan/inter-layer-13/UD_Catalan-dev-bloom-1b1.pkl
data/ud/ud-treebanks-v2.1/UD_Catalan/inter-layer-13/UD_Catalan-test-bloom-1b1.pkl
Embedding dimensionality: 1536
Pre-training probe (if possible)...
Traceback (most recent call last):
  File "run.py", line 102, in <module>
    args.func(args)
  File "/home/s2308470/multilingual-typology-probing/commands.py", line 166, in greedy
    trainer.train()
  File "/home/s2308470/multilingual-typology-probing/probekit/trainers/trainer.py", line 21, in train
    self._train()
  File "/home/s2308470/multilingual-typology-probing/probekit/trainers/neural_probe_trainer.py", line 30, in _train
    self._train_for_dimensions()
  File "/home/s2308470/multilingual-typology-probing/trainers/flexible_neural_probe_trainer.py", line 72, in _train_for_dimensions
    inputs_tensor_shuffled = inputs_tensor[shuffled_indices]
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 2.21 GiB (GPU 0; 5.94 GiB total capacity; 5.41 GiB already allocated; 285.31 MiB free; 5.44 GiB reserved in total by PyTorch) If reserved memory is >> allocated memory try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF
