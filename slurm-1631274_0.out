now processing task id: 0
CORPUS: UD_Arabic
python preprocess_treebank.py UD_Arabic --experiment-name inter-layer-17 --treebanks-root /home/s2308470/multilingual-typology-probing/data/ud/ud-treebanks-v2.1 --bloom bloom-1b7 --checkpoint 10000 --inter-layer 17 --use-gpu
Embeddings root: embeddings
Using GPU
0it [00:00, ?it/s]28it [00:00, 274.98it/s]56it [00:00, 250.21it/s]82it [00:00, 250.84it/s]108it [00:00, 220.39it/s]131it [00:00, 212.06it/s]153it [00:00, 201.54it/s]176it [00:00, 209.08it/s]198it [00:00, 194.23it/s]218it [00:01, 194.04it/s]240it [00:01, 199.28it/s]265it [00:01, 213.66it/s]287it [00:01, 205.91it/s]312it [00:01, 215.70it/s]334it [00:01, 213.57it/s]356it [00:01, 213.39it/s]378it [00:01, 210.56it/s]400it [00:01, 204.38it/s]424it [00:01, 211.91it/s]448it [00:02, 218.92it/s]472it [00:02, 223.77it/s]495it [00:02, 212.61it/s]518it [00:02, 217.02it/s]542it [00:02, 222.57it/s]565it [00:02, 222.80it/s]588it [00:02, 221.98it/s]612it [00:02, 226.95it/s]635it [00:02, 221.33it/s]659it [00:03, 224.54it/s]682it [00:03, 223.10it/s]709it [00:03, 233.60it/s]733it [00:03, 154.30it/s]757it [00:03, 171.80it/s]783it [00:03, 190.51it/s]806it [00:03, 199.86it/s]829it [00:03, 197.66it/s]853it [00:04, 208.36it/s]880it [00:04, 224.73it/s]904it [00:04, 219.39it/s]927it [00:04, 210.52it/s]949it [00:04, 208.45it/s]972it [00:04, 210.86it/s]994it [00:04, 207.65it/s]1019it [00:04, 217.86it/s]1046it [00:04, 229.26it/s]1070it [00:05, 221.20it/s]1094it [00:05, 226.02it/s]1119it [00:05, 229.89it/s]1143it [00:05, 224.69it/s]1208it [00:05, 344.20it/s]1244it [00:05, 320.23it/s]1277it [00:05, 288.60it/s]1307it [00:05, 273.09it/s]1336it [00:06, 258.37it/s]1363it [00:06, 244.17it/s]1392it [00:06, 253.03it/s]1418it [00:06, 228.17it/s]1447it [00:06, 239.32it/s]1492it [00:06, 291.84it/s]1542it [00:06, 342.01it/s]1578it [00:06, 303.93it/s]1610it [00:07, 268.55it/s]1639it [00:07, 210.85it/s]1663it [00:07, 179.13it/s]1684it [00:07, 168.89it/s]1703it [00:07, 167.31it/s]1721it [00:07, 166.20it/s]1739it [00:07, 149.28it/s]1755it [00:08, 146.64it/s]1776it [00:08, 161.62it/s]1796it [00:08, 170.16it/s]1815it [00:08, 173.49it/s]1833it [00:08, 175.16it/s]1851it [00:08, 156.59it/s]1871it [00:08, 166.78it/s]1889it [00:08, 169.10it/s]1907it [00:08, 168.06it/s]1931it [00:09, 186.10it/s]1950it [00:09, 173.73it/s]1968it [00:09, 164.50it/s]1985it [00:09, 150.45it/s]2004it [00:09, 159.70it/s]2021it [00:09, 160.99it/s]2038it [00:09, 155.80it/s]2054it [00:09, 147.24it/s]2069it [00:10, 136.35it/s]2085it [00:10, 140.83it/s]2100it [00:10, 140.36it/s]2120it [00:10, 154.75it/s]2136it [00:10, 148.57it/s]2152it [00:10, 142.94it/s]2168it [00:10, 146.65it/s]2184it [00:10, 149.43it/s]2201it [00:10, 154.78it/s]2217it [00:11, 147.07it/s]2232it [00:11, 133.03it/s]2246it [00:11, 124.17it/s]2259it [00:11, 120.71it/s]2272it [00:11, 118.22it/s]2286it [00:11, 122.81it/s]2299it [00:11, 117.93it/s]2311it [00:11, 117.77it/s]2329it [00:11, 130.82it/s]2343it [00:12, 127.28it/s]2364it [00:12, 148.95it/s]2380it [00:12, 81.08it/s] 2398it [00:12, 97.77it/s]2416it [00:12, 111.90it/s]2431it [00:12, 114.38it/s]2452it [00:13, 134.77it/s]2469it [00:13, 141.56it/s]2485it [00:13, 131.31it/s]2505it [00:13, 147.93it/s]2521it [00:13, 144.54it/s]2537it [00:13, 146.49it/s]2556it [00:13, 157.59it/s]2573it [00:13, 150.65it/s]2591it [00:13, 157.89it/s]2608it [00:14, 160.37it/s]2628it [00:14, 170.27it/s]2646it [00:14, 168.13it/s]2663it [00:14, 166.60it/s]2683it [00:14, 175.51it/s]2701it [00:14, 171.06it/s]2719it [00:14, 173.28it/s]2741it [00:14, 186.22it/s]2760it [00:14, 184.23it/s]2787it [00:14, 207.55it/s]2817it [00:15, 233.15it/s]2843it [00:15, 239.32it/s]2867it [00:15, 212.24it/s]2893it [00:15, 223.75it/s]2919it [00:15, 232.84it/s]2943it [00:15, 232.12it/s]2967it [00:15, 199.63it/s]2990it [00:15, 206.52it/s]3012it [00:16, 178.84it/s]3038it [00:16, 194.77it/s]3059it [00:16, 190.76it/s]3079it [00:16, 189.29it/s]3101it [00:16, 193.76it/s]3121it [00:16, 175.43it/s]3140it [00:16, 175.73it/s]3161it [00:16, 182.58it/s]3184it [00:16, 195.13it/s]3204it [00:17, 190.98it/s]3224it [00:17, 184.68it/s]3246it [00:17, 193.36it/s]3266it [00:17, 187.98it/s]3308it [00:17, 251.25it/s]3334it [00:17, 250.12it/s]3360it [00:17, 241.93it/s]3385it [00:17, 223.04it/s]3408it [00:17, 198.15it/s]3429it [00:18, 196.73it/s]3452it [00:18, 205.26it/s]3473it [00:18, 197.00it/s]3500it [00:18, 215.75it/s]3534it [00:18, 247.32it/s]3560it [00:18, 237.72it/s]3585it [00:18, 228.60it/s]3617it [00:18, 252.74it/s]3643it [00:19, 227.54it/s]3667it [00:19, 214.70it/s]3690it [00:19, 215.56it/s]3712it [00:19, 205.70it/s]3734it [00:19, 205.87it/s]3755it [00:19, 188.67it/s]3775it [00:19, 184.91it/s]3794it [00:19, 173.30it/s]3812it [00:19, 170.01it/s]3830it [00:20, 169.54it/s]3848it [00:20, 161.45it/s]3868it [00:20, 168.10it/s]3887it [00:20, 173.57it/s]3905it [00:20, 175.16it/s]3923it [00:20, 162.00it/s]3944it [00:20, 174.08it/s]3962it [00:20, 170.02it/s]3983it [00:20, 179.29it/s]4007it [00:21, 194.62it/s]4033it [00:21, 213.21it/s]4055it [00:21, 213.77it/s]4077it [00:21, 179.98it/s]4101it [00:21, 195.39it/s]4122it [00:21, 184.03it/s]4142it [00:21, 178.55it/s]4167it [00:21, 195.63it/s]4190it [00:21, 203.03it/s]4211it [00:22, 200.37it/s]4232it [00:22, 173.74it/s]4251it [00:22, 167.79it/s]4272it [00:22, 177.70it/s]4295it [00:22, 191.38it/s]4317it [00:22, 196.94it/s]4338it [00:22, 194.91it/s]4361it [00:22, 202.94it/s]4382it [00:23, 192.29it/s]4407it [00:23, 205.67it/s]4429it [00:23, 206.95it/s]4453it [00:23, 215.06it/s]4475it [00:23, 210.11it/s]4497it [00:23, 96.60it/s] 4517it [00:24, 112.56it/s]4535it [00:24, 122.26it/s]4558it [00:24, 142.93it/s]4577it [00:24, 144.83it/s]4597it [00:24, 155.18it/s]4615it [00:24, 148.69it/s]4632it [00:24, 152.71it/s]4651it [00:24, 159.25it/s]4668it [00:24, 152.36it/s]4684it [00:25, 150.90it/s]4702it [00:25, 155.97it/s]4718it [00:25, 146.24it/s]4733it [00:25, 146.98it/s]4750it [00:25, 152.39it/s]4772it [00:25, 170.76it/s]4790it [00:25, 155.36it/s]4810it [00:25, 166.88it/s]4836it [00:25, 189.99it/s]4857it [00:26, 193.04it/s]4883it [00:26, 209.18it/s]4905it [00:26, 208.36it/s]4930it [00:26, 218.97it/s]4953it [00:26, 214.07it/s]4979it [00:26, 225.06it/s]5009it [00:26, 245.49it/s]5034it [00:26, 233.16it/s]5059it [00:26, 237.07it/s]5087it [00:27, 247.23it/s]5117it [00:27, 259.07it/s]5144it [00:27, 238.61it/s]5170it [00:27, 242.52it/s]5201it [00:27, 258.83it/s]5229it [00:27, 262.12it/s]5256it [00:27, 258.13it/s]5285it [00:27, 263.90it/s]5312it [00:27, 262.96it/s]5340it [00:28, 265.71it/s]5368it [00:28, 269.23it/s]5395it [00:28, 264.29it/s]5422it [00:28, 252.91it/s]5452it [00:28, 263.39it/s]5479it [00:28, 253.56it/s]5508it [00:28, 262.97it/s]5537it [00:28, 267.88it/s]5567it [00:28, 274.82it/s]5597it [00:28, 279.98it/s]5626it [00:29, 266.67it/s]5653it [00:29, 258.15it/s]5679it [00:29, 254.41it/s]5705it [00:29, 223.22it/s]5729it [00:29, 220.21it/s]5759it [00:29, 238.96it/s]5784it [00:29, 224.08it/s]5807it [00:29, 223.68it/s]5834it [00:30, 233.99it/s]5859it [00:30, 235.81it/s]5889it [00:30, 248.10it/s]5914it [00:30, 239.96it/s]5942it [00:30, 250.42it/s]5968it [00:30, 252.54it/s]5994it [00:30, 253.10it/s]6021it [00:30, 256.71it/s]6047it [00:30, 256.40it/s]6073it [00:30, 250.19it/s]6075it [00:30, 196.23it/s]
0it [00:00, ?it/s]24it [00:00, 237.24it/s]48it [00:00, 202.67it/s]69it [00:00, 159.89it/s]86it [00:00, 156.28it/s]103it [00:00, 157.45it/s]120it [00:00, 135.55it/s]135it [00:00, 122.43it/s]148it [00:01, 115.51it/s]160it [00:01, 114.84it/s]180it [00:01, 134.96it/s]197it [00:01, 142.03it/s]212it [00:01, 140.95it/s]227it [00:01, 134.61it/s]244it [00:01, 143.92it/s]259it [00:01, 140.23it/s]274it [00:01, 135.52it/s]290it [00:02, 140.69it/s]313it [00:02, 165.16it/s]331it [00:02, 168.17it/s]357it [00:02, 192.61it/s]391it [00:02, 234.96it/s]415it [00:02, 215.67it/s]438it [00:02, 179.50it/s]458it [00:02, 172.14it/s]483it [00:03, 189.94it/s]508it [00:03, 203.51it/s]530it [00:03, 178.03it/s]560it [00:03, 207.02it/s]593it [00:03, 237.63it/s]619it [00:03, 232.15it/s]647it [00:03, 243.04it/s]678it [00:03, 259.53it/s]680it [00:03, 178.29it/s]
0it [00:00, ?it/s]22it [00:00, 210.70it/s]46it [00:00, 226.45it/s]69it [00:00, 217.75it/s]92it [00:00, 215.91it/s]114it [00:00, 207.10it/s]135it [00:00, 207.71it/s]156it [00:00, 190.76it/s]176it [00:00, 190.54it/s]200it [00:00, 204.40it/s]223it [00:01, 210.61it/s]249it [00:01, 224.72it/s]272it [00:01, 214.06it/s]294it [00:01, 213.62it/s]316it [00:01, 209.98it/s]339it [00:01, 213.48it/s]361it [00:01, 207.81it/s]383it [00:01, 209.17it/s]406it [00:01, 213.25it/s]432it [00:02, 223.74it/s]455it [00:02, 215.30it/s]479it [00:02, 221.91it/s]505it [00:02, 230.44it/s]529it [00:02, 232.00it/s]553it [00:02, 233.36it/s]577it [00:02, 223.86it/s]600it [00:02, 191.30it/s]620it [00:02, 187.64it/s]644it [00:03, 200.97it/s]665it [00:03, 88.42it/s] 689it [00:03, 110.28it/s]708it [00:03, 119.40it/s]732it [00:03, 142.22it/s]753it [00:04, 155.95it/s]773it [00:04, 159.37it/s]795it [00:04, 173.76it/s]825it [00:04, 204.92it/s]848it [00:04, 140.84it/s]867it [00:04, 149.19it/s]903it [00:04, 193.64it/s]909it [00:04, 185.80it/s]
Skipped:
{'total_sents': 7664}

Total: 0
Using model bloom-1b7-intermediate-global_step10000...
Processing UD_Arabic...
Traceback (most recent call last):
  File "preprocess_treebank.py", line 374, in <module>
    model = BloomModel.from_pretrained(bloom_model, 
  File "/home/s2308470/miniconda3/envs/multilingual-typology-probing/lib/python3.8/site-packages/transformers/modeling_utils.py", line 1878, in to
    return super().to(*args, **kwargs)
  File "/home/s2308470/miniconda3/envs/multilingual-typology-probing/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1145, in to
    return self._apply(convert)
  File "/home/s2308470/miniconda3/envs/multilingual-typology-probing/lib/python3.8/site-packages/torch/nn/modules/module.py", line 797, in _apply
    module._apply(fn)
  File "/home/s2308470/miniconda3/envs/multilingual-typology-probing/lib/python3.8/site-packages/torch/nn/modules/module.py", line 797, in _apply
    module._apply(fn)
  File "/home/s2308470/miniconda3/envs/multilingual-typology-probing/lib/python3.8/site-packages/torch/nn/modules/module.py", line 797, in _apply
    module._apply(fn)
  [Previous line repeated 1 more time]
  File "/home/s2308470/miniconda3/envs/multilingual-typology-probing/lib/python3.8/site-packages/torch/nn/modules/module.py", line 820, in _apply
    param_applied = fn(param)
  File "/home/s2308470/miniconda3/envs/multilingual-typology-probing/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1143, in convert
    return t.to(device, dtype if t.is_floating_point() or t.is_complex() else None, non_blocking)
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 64.00 MiB (GPU 0; 5.94 GiB total capacity; 5.79 GiB already allocated; 35.31 MiB free; 5.79 GiB reserved in total by PyTorch) If reserved memory is >> allocated memory try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF
