now processing task id: 10
CORPUS: UD_Spanish
python preprocess_treebank.py UD_Spanish --experiment-name inter-layer-17 --treebanks-root /home/s2308470/multilingual-typology-probing/data/ud/ud-treebanks-v2.1 --bloom bloom-1b7 --checkpoint 10000 --inter-layer 17 --use-gpu
Embeddings root: embeddings
Using GPU
0it [00:00, ?it/s]24it [00:00, 237.18it/s]51it [00:00, 255.37it/s]83it [00:00, 284.23it/s]115it [00:00, 296.73it/s]146it [00:00, 300.13it/s]177it [00:00, 297.52it/s]210it [00:00, 305.45it/s]241it [00:00, 293.86it/s]272it [00:00, 298.46it/s]304it [00:01, 303.78it/s]340it [00:01, 317.21it/s]372it [00:01, 289.55it/s]402it [00:01, 284.62it/s]432it [00:01, 286.23it/s]464it [00:01, 294.27it/s]495it [00:01, 298.09it/s]527it [00:01, 304.29it/s]567it [00:01, 330.49it/s]602it [00:01, 336.03it/s]636it [00:02, 326.63it/s]671it [00:02, 333.25it/s]707it [00:02, 339.11it/s]741it [00:02, 317.08it/s]774it [00:02, 310.91it/s]806it [00:02, 309.80it/s]838it [00:02, 208.13it/s]875it [00:03, 242.17it/s]907it [00:03, 256.59it/s]937it [00:03, 264.85it/s]970it [00:03, 279.99it/s]1001it [00:03, 287.18it/s]1039it [00:03, 311.18it/s]1075it [00:03, 323.31it/s]1109it [00:03, 326.36it/s]1143it [00:03, 321.35it/s]1182it [00:03, 340.42it/s]1218it [00:04, 345.89it/s]1254it [00:04, 349.92it/s]1290it [00:04, 345.45it/s]1325it [00:04, 328.38it/s]1361it [00:04, 337.26it/s]1397it [00:04, 342.43it/s]1435it [00:04, 352.69it/s]1473it [00:04, 356.93it/s]1509it [00:04, 345.23it/s]1544it [00:04, 339.44it/s]1579it [00:05, 341.82it/s]1614it [00:05, 338.31it/s]1648it [00:05, 337.78it/s]1684it [00:05, 340.22it/s]1719it [00:05, 331.58it/s]1755it [00:05, 338.49it/s]1789it [00:05, 332.37it/s]1824it [00:05, 336.24it/s]1858it [00:05, 336.39it/s]1892it [00:06, 325.65it/s]1926it [00:06, 326.13it/s]1960it [00:06, 326.38it/s]1993it [00:06, 315.97it/s]2025it [00:06, 309.64it/s]2058it [00:06, 314.58it/s]2092it [00:06, 320.64it/s]2125it [00:06, 310.10it/s]2157it [00:06, 297.41it/s]2187it [00:07, 288.66it/s]2220it [00:07, 298.51it/s]2255it [00:07, 311.84it/s]2287it [00:07, 311.24it/s]2320it [00:07, 314.13it/s]2352it [00:07, 307.61it/s]2384it [00:07, 310.41it/s]2416it [00:07, 307.22it/s]2456it [00:07, 333.32it/s]2491it [00:07, 335.79it/s]2525it [00:08, 328.86it/s]2566it [00:08, 351.19it/s]2602it [00:08, 331.48it/s]2638it [00:08, 338.57it/s]2673it [00:08, 340.46it/s]2708it [00:08, 324.43it/s]2741it [00:08, 325.67it/s]2774it [00:08, 325.48it/s]2813it [00:08, 340.25it/s]2848it [00:09, 336.46it/s]2882it [00:09, 319.96it/s]2915it [00:09, 320.18it/s]2954it [00:09, 338.57it/s]2989it [00:09, 328.64it/s]3023it [00:09, 328.87it/s]3057it [00:09, 199.67it/s]3090it [00:09, 224.73it/s]3119it [00:10, 239.04it/s]3154it [00:10, 263.64it/s]3189it [00:10, 284.94it/s]3221it [00:10, 289.07it/s]3256it [00:10, 303.64it/s]3294it [00:10, 324.49it/s]3332it [00:10, 333.27it/s]3367it [00:10, 323.33it/s]3403it [00:10, 329.40it/s]3438it [00:11, 335.20it/s]3472it [00:11, 336.52it/s]3507it [00:11, 339.18it/s]3542it [00:11, 333.65it/s]3580it [00:11, 346.22it/s]3615it [00:11, 346.68it/s]3650it [00:11, 345.82it/s]3688it [00:11, 355.47it/s]3724it [00:11, 355.00it/s]3761it [00:11, 357.55it/s]3797it [00:12, 350.53it/s]3837it [00:12, 364.38it/s]3874it [00:12, 343.70it/s]3912it [00:12, 353.31it/s]3948it [00:12, 350.87it/s]3984it [00:12, 344.21it/s]4019it [00:12, 335.25it/s]4058it [00:12, 347.48it/s]4093it [00:12, 340.13it/s]4128it [00:13, 320.79it/s]4161it [00:13, 312.60it/s]4196it [00:13, 322.85it/s]4233it [00:13, 334.81it/s]4267it [00:13, 322.63it/s]4306it [00:13, 340.72it/s]4341it [00:13, 336.85it/s]4384it [00:13, 362.50it/s]4421it [00:13, 359.98it/s]4458it [00:13, 349.59it/s]4494it [00:14, 333.00it/s]4528it [00:14, 327.27it/s]4561it [00:14, 323.06it/s]4596it [00:14, 329.33it/s]4630it [00:14, 328.83it/s]4665it [00:14, 332.50it/s]4699it [00:14, 331.41it/s]4733it [00:14, 315.61it/s]4765it [00:14, 297.69it/s]4796it [00:15, 294.84it/s]4831it [00:15, 309.32it/s]4865it [00:15, 317.77it/s]4902it [00:15, 332.71it/s]4938it [00:15, 337.67it/s]4972it [00:15, 331.10it/s]5006it [00:15, 333.16it/s]5040it [00:15, 324.52it/s]5073it [00:15, 324.20it/s]5106it [00:16, 319.66it/s]5139it [00:16, 316.48it/s]5174it [00:16, 323.94it/s]5208it [00:16, 326.82it/s]5241it [00:16, 311.75it/s]5274it [00:16, 315.43it/s]5306it [00:16, 316.14it/s]5338it [00:16, 303.13it/s]5369it [00:16, 297.58it/s]5403it [00:16, 304.80it/s]5434it [00:17, 295.41it/s]5464it [00:17, 293.92it/s]5495it [00:17, 298.26it/s]5527it [00:17, 300.57it/s]5559it [00:17, 304.41it/s]5590it [00:17, 300.26it/s]5621it [00:17, 295.83it/s]5652it [00:17, 298.73it/s]5685it [00:17, 306.89it/s]5716it [00:18, 297.53it/s]5752it [00:18, 314.86it/s]5784it [00:18, 309.72it/s]5817it [00:18, 314.27it/s]5849it [00:18, 309.10it/s]5880it [00:18, 162.11it/s]5910it [00:18, 186.37it/s]5941it [00:19, 209.76it/s]5973it [00:19, 234.05it/s]6006it [00:19, 257.15it/s]6038it [00:19, 272.49it/s]6075it [00:19, 296.00it/s]6109it [00:19, 306.16it/s]6142it [00:19, 301.89it/s]6177it [00:19, 314.51it/s]6210it [00:19, 313.79it/s]6243it [00:20, 308.81it/s]6277it [00:20, 315.18it/s]6310it [00:20, 318.56it/s]6343it [00:20, 307.07it/s]6374it [00:20, 302.92it/s]6405it [00:20, 303.14it/s]6440it [00:20, 313.83it/s]6472it [00:20, 300.97it/s]6503it [00:20, 302.79it/s]6537it [00:20, 312.27it/s]6569it [00:21, 304.95it/s]6606it [00:21, 321.45it/s]6639it [00:21, 320.56it/s]6672it [00:21, 304.14it/s]6704it [00:21, 308.06it/s]6737it [00:21, 312.29it/s]6773it [00:21, 326.05it/s]6806it [00:21, 323.53it/s]6839it [00:21, 317.61it/s]6871it [00:22, 317.24it/s]6903it [00:22, 317.94it/s]6935it [00:22, 311.67it/s]6969it [00:22, 319.63it/s]7002it [00:22, 313.07it/s]7039it [00:22, 327.02it/s]7073it [00:22, 329.09it/s]7106it [00:22, 318.11it/s]7139it [00:22, 317.76it/s]7177it [00:22, 331.93it/s]7212it [00:23, 335.47it/s]7246it [00:23, 311.96it/s]7278it [00:23, 310.84it/s]7311it [00:23, 315.30it/s]7343it [00:23, 311.36it/s]7378it [00:23, 322.43it/s]7411it [00:23, 324.34it/s]7449it [00:23, 339.52it/s]7484it [00:23, 329.14it/s]7518it [00:24, 324.84it/s]7553it [00:24, 331.50it/s]7590it [00:24, 341.96it/s]7625it [00:24, 337.95it/s]7659it [00:24, 320.66it/s]7692it [00:24, 318.38it/s]7724it [00:24, 304.67it/s]7755it [00:24, 304.52it/s]7786it [00:24, 302.94it/s]7821it [00:24, 315.13it/s]7854it [00:25, 318.91it/s]7887it [00:25, 316.58it/s]7921it [00:25, 321.70it/s]7955it [00:25, 326.81it/s]7988it [00:25, 316.02it/s]8022it [00:25, 321.34it/s]8062it [00:25, 342.48it/s]8097it [00:25, 323.66it/s]8130it [00:25, 311.35it/s]8162it [00:26, 312.98it/s]8198it [00:26, 326.13it/s]8231it [00:26, 318.64it/s]8264it [00:26, 316.03it/s]8299it [00:26, 324.53it/s]8332it [00:26, 314.48it/s]8365it [00:26, 316.51it/s]8399it [00:26, 321.15it/s]8432it [00:26, 318.47it/s]8466it [00:26, 321.84it/s]8499it [00:27, 300.01it/s]8534it [00:27, 312.27it/s]8566it [00:27, 313.17it/s]8598it [00:27, 314.88it/s]8630it [00:27, 304.16it/s]8661it [00:27, 303.83it/s]8695it [00:27, 313.44it/s]8728it [00:27, 315.01it/s]8760it [00:27, 309.50it/s]8793it [00:28, 315.01it/s]8825it [00:28, 315.65it/s]8858it [00:28, 316.72it/s]8890it [00:28, 308.34it/s]8921it [00:28, 306.15it/s]8952it [00:28, 289.83it/s]8982it [00:28, 290.65it/s]9012it [00:28, 276.24it/s]9042it [00:28, 282.42it/s]9071it [00:29, 282.02it/s]9100it [00:29, 279.56it/s]9129it [00:29, 277.90it/s]9163it [00:29, 292.50it/s]9196it [00:29, 303.11it/s]9230it [00:29, 310.13it/s]9265it [00:29, 319.32it/s]9297it [00:30, 136.45it/s]9324it [00:30, 155.72it/s]9359it [00:30, 189.74it/s]9389it [00:30, 211.61it/s]9418it [00:30, 222.76it/s]9447it [00:30, 237.83it/s]9475it [00:30, 248.40it/s]9507it [00:30, 266.87it/s]9539it [00:31, 277.23it/s]9571it [00:31, 288.80it/s]9605it [00:31, 301.50it/s]9637it [00:31, 288.01it/s]9667it [00:31, 288.28it/s]9701it [00:31, 299.56it/s]9732it [00:31, 302.44it/s]9763it [00:31, 300.70it/s]9797it [00:31, 311.14it/s]9829it [00:31, 309.82it/s]9862it [00:32, 314.92it/s]9895it [00:32, 316.62it/s]9933it [00:32, 333.48it/s]9967it [00:32, 327.81it/s]10000it [00:32, 323.42it/s]10033it [00:32, 318.03it/s]10065it [00:32, 300.95it/s]10097it [00:32, 306.11it/s]10128it [00:32, 295.80it/s]10158it [00:33, 294.23it/s]10190it [00:33, 298.99it/s]10220it [00:33, 286.05it/s]10254it [00:33, 300.75it/s]10288it [00:33, 311.45it/s]10320it [00:33, 312.50it/s]10352it [00:33, 303.04it/s]10385it [00:33, 309.87it/s]10421it [00:33, 320.85it/s]10454it [00:33, 307.88it/s]10485it [00:34, 303.48it/s]10516it [00:34, 305.23it/s]10549it [00:34, 311.03it/s]10581it [00:34, 309.43it/s]10614it [00:34, 311.48it/s]10646it [00:34, 308.53it/s]10677it [00:34, 301.35it/s]10711it [00:34, 311.78it/s]10743it [00:34, 313.81it/s]10776it [00:35, 315.04it/s]10808it [00:35, 311.13it/s]10843it [00:35, 320.26it/s]10876it [00:35, 309.32it/s]10908it [00:35, 296.75it/s]10946it [00:35, 316.29it/s]10978it [00:35, 305.73it/s]11009it [00:35, 206.09it/s]11040it [00:36, 226.80it/s]11073it [00:36, 218.25it/s]11104it [00:36, 238.00it/s]11136it [00:36, 256.07it/s]11171it [00:36, 279.92it/s]11201it [00:36, 278.78it/s]11231it [00:36, 273.19it/s]11261it [00:36, 278.83it/s]11291it [00:36, 275.69it/s]11324it [00:37, 289.52it/s]11355it [00:37, 294.99it/s]11385it [00:37, 294.96it/s]11415it [00:37, 289.44it/s]11448it [00:37, 301.11it/s]11485it [00:37, 320.65it/s]11518it [00:37, 316.00it/s]11550it [00:37, 302.50it/s]11581it [00:37, 300.97it/s]11612it [00:38, 300.28it/s]11643it [00:38, 275.83it/s]11675it [00:38, 287.82it/s]11705it [00:38, 282.81it/s]11739it [00:38, 286.04it/s]11774it [00:38, 302.00it/s]11805it [00:38, 266.42it/s]11833it [00:38, 267.10it/s]11866it [00:38, 283.09it/s]11900it [00:39, 295.74it/s]11931it [00:39, 299.09it/s]11969it [00:39, 317.00it/s]12001it [00:39, 313.26it/s]12035it [00:39, 319.26it/s]12068it [00:39, 310.90it/s]12102it [00:39, 318.01it/s]12134it [00:39, 317.59it/s]12171it [00:39, 331.42it/s]12205it [00:39, 324.43it/s]12238it [00:40, 310.64it/s]12270it [00:40, 302.96it/s]12301it [00:40, 297.17it/s]12336it [00:40, 311.51it/s]12371it [00:40, 321.11it/s]12406it [00:40, 328.62it/s]12439it [00:40, 321.11it/s]12474it [00:40, 329.05it/s]12508it [00:40, 326.55it/s]12543it [00:41, 333.28it/s]12577it [00:41, 329.54it/s]12611it [00:41, 312.73it/s]12646it [00:41, 322.25it/s]12681it [00:41, 329.23it/s]12715it [00:41, 329.03it/s]12749it [00:41, 317.33it/s]12781it [00:41, 315.04it/s]12813it [00:41, 316.19it/s]12846it [00:41, 315.74it/s]12881it [00:42, 324.73it/s]12915it [00:42, 325.25it/s]12948it [00:42, 316.81it/s]12984it [00:42, 327.57it/s]13017it [00:42, 319.22it/s]13050it [00:42, 317.46it/s]13082it [00:42, 302.84it/s]13114it [00:42, 306.52it/s]13145it [00:42, 297.96it/s]13177it [00:43, 303.77it/s]13208it [00:43, 301.41it/s]13241it [00:43, 305.05it/s]13272it [00:43, 305.39it/s]13305it [00:43, 311.65it/s]13340it [00:43, 320.02it/s]13378it [00:43, 333.27it/s]13414it [00:43, 338.45it/s]13449it [00:43, 339.40it/s]13484it [00:43, 340.88it/s]13519it [00:44, 131.92it/s]13545it [00:44, 149.31it/s]13575it [00:44, 173.84it/s]13608it [00:44, 202.84it/s]13638it [00:45, 223.53it/s]13670it [00:45, 244.83it/s]13705it [00:45, 269.99it/s]13737it [00:45, 279.18it/s]13768it [00:45, 280.13it/s]13799it [00:45, 285.84it/s]13830it [00:45, 290.93it/s]13861it [00:45, 287.84it/s]13891it [00:45, 281.49it/s]13920it [00:45, 279.33it/s]13951it [00:46, 287.24it/s]13981it [00:46, 285.08it/s]14012it [00:46, 292.06it/s]14044it [00:46, 298.91it/s]14079it [00:46, 311.37it/s]14111it [00:46, 301.40it/s]14150it [00:46, 325.77it/s]14183it [00:46, 300.30it/s]14187it [00:46, 302.78it/s]
0it [00:00, ?it/s]36it [00:00, 348.27it/s]71it [00:00, 321.94it/s]104it [00:00, 321.54it/s]137it [00:00, 319.14it/s]169it [00:00, 306.43it/s]201it [00:00, 308.16it/s]234it [00:00, 314.02it/s]267it [00:00, 315.95it/s]303it [00:00, 325.91it/s]336it [00:01, 320.16it/s]369it [00:01, 321.15it/s]402it [00:01, 313.30it/s]434it [00:01, 309.47it/s]465it [00:01, 307.76it/s]496it [00:01, 302.73it/s]528it [00:01, 302.51it/s]559it [00:01, 300.59it/s]590it [00:01, 301.84it/s]626it [00:01, 317.23it/s]658it [00:02, 312.47it/s]690it [00:02, 309.93it/s]724it [00:02, 317.78it/s]756it [00:02, 310.29it/s]788it [00:02, 288.18it/s]824it [00:02, 304.22it/s]857it [00:02, 311.07it/s]889it [00:02, 300.05it/s]920it [00:02, 295.40it/s]953it [00:03, 302.93it/s]986it [00:03, 309.24it/s]1021it [00:03, 320.11it/s]1055it [00:03, 322.17it/s]1088it [00:03, 322.78it/s]1122it [00:03, 326.83it/s]1158it [00:03, 336.31it/s]1192it [00:03, 325.17it/s]1225it [00:03, 320.99it/s]1258it [00:04, 311.27it/s]1290it [00:04, 313.11it/s]1323it [00:04, 315.98it/s]1355it [00:04, 303.52it/s]1389it [00:04, 312.59it/s]1400it [00:04, 312.57it/s]
0it [00:00, ?it/s]34it [00:00, 339.92it/s]68it [00:00, 318.86it/s]100it [00:00, 318.55it/s]132it [00:00, 310.36it/s]164it [00:00, 310.17it/s]196it [00:00, 303.83it/s]229it [00:00, 310.32it/s]261it [00:00, 275.58it/s]290it [00:00, 264.91it/s]317it [00:01, 256.05it/s]343it [00:01, 250.71it/s]384it [00:01, 293.07it/s]426it [00:01, 302.58it/s]
Skipped:
{'total_sents': 16013}

Total: 0
Using model bloom-1b7-intermediate-global_step10000...
Processing UD_Spanish...
Traceback (most recent call last):
  File "preprocess_treebank.py", line 374, in <module>
    model = BloomModel.from_pretrained(bloom_model, 
  File "/home/s2308470/miniconda3/envs/multilingual-typology-probing/lib/python3.8/site-packages/transformers/modeling_utils.py", line 1878, in to
    return super().to(*args, **kwargs)
  File "/home/s2308470/miniconda3/envs/multilingual-typology-probing/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1145, in to
    return self._apply(convert)
  File "/home/s2308470/miniconda3/envs/multilingual-typology-probing/lib/python3.8/site-packages/torch/nn/modules/module.py", line 797, in _apply
    module._apply(fn)
  File "/home/s2308470/miniconda3/envs/multilingual-typology-probing/lib/python3.8/site-packages/torch/nn/modules/module.py", line 797, in _apply
    module._apply(fn)
  File "/home/s2308470/miniconda3/envs/multilingual-typology-probing/lib/python3.8/site-packages/torch/nn/modules/module.py", line 797, in _apply
    module._apply(fn)
  [Previous line repeated 1 more time]
  File "/home/s2308470/miniconda3/envs/multilingual-typology-probing/lib/python3.8/site-packages/torch/nn/modules/module.py", line 820, in _apply
    param_applied = fn(param)
  File "/home/s2308470/miniconda3/envs/multilingual-typology-probing/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1143, in convert
    return t.to(device, dtype if t.is_floating_point() or t.is_complex() else None, non_blocking)
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 64.00 MiB (GPU 0; 5.94 GiB total capacity; 5.79 GiB already allocated; 35.31 MiB free; 5.79 GiB reserved in total by PyTorch) If reserved memory is >> allocated memory try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF
