now processing task id: 1
CORPUS: UD_Basque
python preprocess_treebank.py UD_Basque --experiment-name inter-layer-17 --treebanks-root /home/s2308470/multilingual-typology-probing/data/ud/ud-treebanks-v2.1 --bloom bloom-1b7 --checkpoint 10000 --inter-layer 17 --use-gpu
Embeddings root: embeddings
Using GPU
0it [00:00, ?it/s]52it [00:00, 518.95it/s]123it [00:00, 628.61it/s]187it [00:00, 633.31it/s]255it [00:00, 648.84it/s]322it [00:00, 652.65it/s]396it [00:00, 679.76it/s]464it [00:00, 678.93it/s]532it [00:00, 658.65it/s]605it [00:00, 679.68it/s]680it [00:01, 700.07it/s]754it [00:01, 708.35it/s]831it [00:01, 725.94it/s]906it [00:01, 729.97it/s]980it [00:01, 726.65it/s]1053it [00:01, 725.83it/s]1126it [00:01, 721.53it/s]1202it [00:01, 731.03it/s]1276it [00:01, 729.47it/s]1349it [00:01, 697.61it/s]1420it [00:02, 676.22it/s]1491it [00:02, 683.72it/s]1560it [00:02, 472.88it/s]1636it [00:02, 534.77it/s]1709it [00:02, 579.98it/s]1777it [00:02, 603.53it/s]1843it [00:02, 616.51it/s]1909it [00:02, 625.60it/s]1975it [00:03, 633.29it/s]2054it [00:03, 676.26it/s]2125it [00:03, 682.96it/s]2195it [00:03, 673.57it/s]2265it [00:03, 674.44it/s]2337it [00:03, 687.03it/s]2407it [00:03, 684.56it/s]2476it [00:03, 675.42it/s]2547it [00:03, 684.95it/s]2622it [00:03, 700.13it/s]2693it [00:04, 701.94it/s]2764it [00:04, 683.33it/s]2833it [00:04, 661.02it/s]2901it [00:04, 662.43it/s]2972it [00:04, 674.60it/s]3041it [00:04, 676.62it/s]3113it [00:04, 689.02it/s]3183it [00:04, 678.10it/s]3251it [00:04, 612.27it/s]3314it [00:05, 573.36it/s]3373it [00:05, 559.57it/s]3430it [00:05, 534.37it/s]3485it [00:05, 525.78it/s]3538it [00:05, 509.55it/s]3590it [00:05, 498.99it/s]3641it [00:05, 485.38it/s]3691it [00:05, 487.35it/s]3742it [00:05, 490.96it/s]3794it [00:06, 498.35it/s]3855it [00:06, 528.07it/s]3908it [00:06, 519.04it/s]3961it [00:06, 507.63it/s]4012it [00:06, 503.39it/s]4065it [00:06, 509.42it/s]4118it [00:06, 514.09it/s]4170it [00:06, 512.96it/s]4225it [00:06, 523.43it/s]4278it [00:06, 518.94it/s]4330it [00:07, 517.64it/s]4382it [00:07, 508.20it/s]4433it [00:07, 496.79it/s]4485it [00:07, 502.87it/s]4536it [00:07, 500.79it/s]4587it [00:07, 497.84it/s]4640it [00:07, 502.61it/s]4691it [00:07, 503.92it/s]4742it [00:07, 505.16it/s]4797it [00:07, 517.50it/s]4851it [00:08, 522.80it/s]4904it [00:08, 518.37it/s]4957it [00:08, 520.28it/s]5010it [00:08, 520.75it/s]5063it [00:08, 504.20it/s]5118it [00:08, 516.33it/s]5170it [00:08, 508.27it/s]5221it [00:09, 290.37it/s]5274it [00:09, 335.87it/s]5321it [00:09, 363.89it/s]5371it [00:09, 394.51it/s]5396it [00:09, 572.40it/s]
0it [00:00, ?it/s]67it [00:00, 666.30it/s]139it [00:00, 689.77it/s]211it [00:00, 703.16it/s]282it [00:00, 678.44it/s]350it [00:00, 676.28it/s]418it [00:00, 674.69it/s]486it [00:00, 668.41it/s]559it [00:00, 685.60it/s]628it [00:00, 685.11it/s]699it [00:01, 691.85it/s]776it [00:01, 713.44it/s]848it [00:01, 689.81it/s]922it [00:01, 703.06it/s]995it [00:01, 707.45it/s]1066it [00:01, 697.96it/s]1136it [00:01, 601.96it/s]1199it [00:01, 584.96it/s]1260it [00:01, 560.99it/s]1318it [00:02, 552.43it/s]1374it [00:02, 540.82it/s]1429it [00:02, 524.05it/s]1482it [00:02, 524.96it/s]1535it [00:02, 510.67it/s]1587it [00:02, 494.97it/s]1641it [00:02, 505.64it/s]1693it [00:02, 508.28it/s]1749it [00:02, 521.37it/s]1798it [00:03, 598.87it/s]
0it [00:00, ?it/s]55it [00:00, 546.17it/s]136it [00:00, 699.30it/s]211it [00:00, 720.84it/s]284it [00:00, 697.38it/s]357it [00:00, 707.50it/s]428it [00:00, 698.75it/s]498it [00:00, 686.24it/s]567it [00:00, 684.72it/s]636it [00:00, 676.45it/s]706it [00:01, 681.96it/s]775it [00:01, 681.33it/s]844it [00:01, 677.30it/s]912it [00:01, 670.83it/s]980it [00:01, 665.59it/s]1053it [00:01, 683.80it/s]1122it [00:01, 628.15it/s]1186it [00:01, 590.96it/s]1246it [00:01, 579.19it/s]1305it [00:02, 549.11it/s]1362it [00:02, 551.71it/s]1418it [00:02, 530.56it/s]1472it [00:02, 504.71it/s]1527it [00:02, 514.49it/s]1579it [00:02, 515.84it/s]1631it [00:02, 505.74it/s]1682it [00:02, 498.27it/s]1734it [00:02, 503.47it/s]1785it [00:02, 503.61it/s]1799it [00:03, 597.03it/s]
Skipped:
{'total_sents': 8993}

Total: 0
Using model bloom-1b7-intermediate-global_step10000...
Processing UD_Basque...
Traceback (most recent call last):
  File "preprocess_treebank.py", line 374, in <module>
    model = BloomModel.from_pretrained(bloom_model, 
  File "/home/s2308470/miniconda3/envs/multilingual-typology-probing/lib/python3.8/site-packages/transformers/modeling_utils.py", line 1878, in to
    return super().to(*args, **kwargs)
  File "/home/s2308470/miniconda3/envs/multilingual-typology-probing/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1145, in to
    return self._apply(convert)
  File "/home/s2308470/miniconda3/envs/multilingual-typology-probing/lib/python3.8/site-packages/torch/nn/modules/module.py", line 797, in _apply
    module._apply(fn)
  File "/home/s2308470/miniconda3/envs/multilingual-typology-probing/lib/python3.8/site-packages/torch/nn/modules/module.py", line 797, in _apply
    module._apply(fn)
  File "/home/s2308470/miniconda3/envs/multilingual-typology-probing/lib/python3.8/site-packages/torch/nn/modules/module.py", line 797, in _apply
    module._apply(fn)
  [Previous line repeated 1 more time]
  File "/home/s2308470/miniconda3/envs/multilingual-typology-probing/lib/python3.8/site-packages/torch/nn/modules/module.py", line 820, in _apply
    param_applied = fn(param)
  File "/home/s2308470/miniconda3/envs/multilingual-typology-probing/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1143, in convert
    return t.to(device, dtype if t.is_floating_point() or t.is_complex() else None, non_blocking)
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 64.00 MiB (GPU 0; 5.94 GiB total capacity; 5.79 GiB already allocated; 35.31 MiB free; 5.79 GiB reserved in total by PyTorch) If reserved memory is >> allocated memory try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF
