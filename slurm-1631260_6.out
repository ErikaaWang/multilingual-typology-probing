now processing task id: 6
CORPUS: UD_French
python preprocess_treebank.py UD_French --experiment-name inter-layer-17 --treebanks-root /home/s2308470/multilingual-typology-probing/data/ud/ud-treebanks-v2.1 --bloom bloom-1b7 --checkpoint 1000 --inter-layer 17 --use-gpu
Embeddings root: embeddings
Using GPU
0it [00:00, ?it/s]27it [00:00, 262.65it/s]66it [00:00, 330.26it/s]100it [00:00, 327.93it/s]133it [00:00, 320.11it/s]167it [00:00, 325.61it/s]200it [00:00, 318.57it/s]236it [00:00, 327.90it/s]269it [00:00, 324.65it/s]305it [00:00, 332.03it/s]339it [00:01, 332.91it/s]377it [00:01, 346.18it/s]413it [00:01, 349.05it/s]448it [00:01, 348.97it/s]483it [00:01, 348.83it/s]522it [00:01, 358.03it/s]558it [00:01, 346.33it/s]593it [00:01, 341.93it/s]629it [00:01, 343.80it/s]666it [00:01, 348.97it/s]705it [00:02, 360.04it/s]742it [00:02, 358.03it/s]779it [00:02, 358.21it/s]818it [00:02, 364.77it/s]856it [00:02, 362.49it/s]893it [00:02, 358.33it/s]929it [00:02, 236.04it/s]963it [00:02, 257.09it/s]996it [00:03, 273.82it/s]1033it [00:03, 297.54it/s]1071it [00:03, 318.21it/s]1106it [00:03, 310.71it/s]1146it [00:03, 331.64it/s]1184it [00:03, 342.12it/s]1221it [00:03, 349.14it/s]1259it [00:03, 357.89it/s]1297it [00:03, 361.94it/s]1337it [00:04, 369.87it/s]1375it [00:04, 352.71it/s]1411it [00:04, 351.57it/s]1450it [00:04, 361.14it/s]1487it [00:04, 356.25it/s]1523it [00:04, 356.25it/s]1560it [00:04, 358.01it/s]1596it [00:04, 345.44it/s]1633it [00:04, 348.41it/s]1672it [00:04, 358.89it/s]1708it [00:05, 354.58it/s]1747it [00:05, 364.65it/s]1784it [00:05, 358.53it/s]1823it [00:05, 366.54it/s]1860it [00:05, 361.33it/s]1899it [00:05, 368.63it/s]1937it [00:05, 371.07it/s]1979it [00:05, 382.07it/s]2018it [00:05, 368.14it/s]2055it [00:06, 354.88it/s]2098it [00:06, 372.90it/s]2137it [00:06, 373.29it/s]2175it [00:06, 366.41it/s]2213it [00:06, 367.61it/s]2250it [00:06, 365.77it/s]2287it [00:06, 361.55it/s]2324it [00:06, 362.45it/s]2361it [00:06, 364.58it/s]2398it [00:06, 356.78it/s]2434it [00:07, 352.47it/s]2470it [00:07, 346.77it/s]2507it [00:07, 352.41it/s]2543it [00:07, 342.08it/s]2579it [00:07, 343.67it/s]2618it [00:07, 356.41it/s]2656it [00:07, 362.10it/s]2694it [00:07, 361.22it/s]2731it [00:07, 359.54it/s]2775it [00:07, 382.35it/s]2814it [00:08, 363.02it/s]2851it [00:08, 356.07it/s]2887it [00:08, 351.82it/s]2923it [00:08, 333.11it/s]2959it [00:08, 339.26it/s]2994it [00:08, 340.01it/s]3037it [00:08, 364.82it/s]3074it [00:08, 362.35it/s]3111it [00:08, 361.64it/s]3150it [00:09, 369.03it/s]3191it [00:09, 379.21it/s]3230it [00:09, 381.29it/s]3269it [00:09, 370.20it/s]3310it [00:09, 379.47it/s]3349it [00:09, 220.19it/s]3391it [00:09, 258.04it/s]3427it [00:10, 279.98it/s]3470it [00:10, 314.81it/s]3508it [00:10, 330.98it/s]3549it [00:10, 348.23it/s]3587it [00:10, 348.92it/s]3624it [00:10, 340.52it/s]3660it [00:10, 344.83it/s]3701it [00:10, 361.24it/s]3738it [00:10, 351.28it/s]3778it [00:10, 364.11it/s]3815it [00:11, 359.34it/s]3860it [00:11, 384.02it/s]3899it [00:11, 370.19it/s]3937it [00:11, 369.03it/s]3977it [00:11, 376.01it/s]4021it [00:11, 393.93it/s]4062it [00:11, 396.39it/s]4102it [00:11, 388.94it/s]4143it [00:11, 392.59it/s]4183it [00:12, 390.43it/s]4223it [00:12, 366.92it/s]4261it [00:12, 369.26it/s]4299it [00:12, 366.83it/s]4337it [00:12, 369.75it/s]4375it [00:12, 372.13it/s]4414it [00:12, 374.71it/s]4452it [00:12, 374.24it/s]4490it [00:12, 375.68it/s]4528it [00:12, 367.83it/s]4565it [00:13, 362.21it/s]4602it [00:13, 362.62it/s]4639it [00:13, 346.65it/s]4677it [00:13, 353.95it/s]4715it [00:13, 357.28it/s]4751it [00:13, 348.28it/s]4786it [00:13, 340.17it/s]4821it [00:13, 339.84it/s]4859it [00:13, 350.76it/s]4895it [00:14, 351.69it/s]4933it [00:14, 358.65it/s]4971it [00:14, 361.04it/s]5008it [00:14, 353.08it/s]5045it [00:14, 356.00it/s]5081it [00:14, 347.16it/s]5116it [00:14, 346.38it/s]5156it [00:14, 361.86it/s]5193it [00:14, 356.11it/s]5229it [00:14, 341.62it/s]5266it [00:15, 349.47it/s]5303it [00:15, 355.00it/s]5339it [00:15, 350.76it/s]5375it [00:15, 344.70it/s]5416it [00:15, 361.56it/s]5455it [00:15, 366.70it/s]5492it [00:15, 330.99it/s]5529it [00:15, 339.74it/s]5565it [00:15, 343.64it/s]5602it [00:16, 351.08it/s]5639it [00:16, 353.29it/s]5675it [00:16, 354.59it/s]5715it [00:16, 367.67it/s]5752it [00:16, 364.80it/s]5791it [00:16, 370.53it/s]5831it [00:16, 375.12it/s]5869it [00:16, 354.19it/s]5905it [00:16, 345.13it/s]5947it [00:16, 361.60it/s]5987it [00:17, 369.89it/s]6026it [00:17, 372.68it/s]6065it [00:17, 377.38it/s]6103it [00:17, 376.84it/s]6141it [00:17, 359.35it/s]6178it [00:17, 359.25it/s]6215it [00:17, 354.26it/s]6251it [00:17, 354.95it/s]6290it [00:17, 364.44it/s]6330it [00:18, 373.22it/s]6368it [00:18, 179.54it/s]6402it [00:18, 206.12it/s]6434it [00:18, 228.00it/s]6465it [00:18, 234.13it/s]6498it [00:18, 254.41it/s]6532it [00:19, 274.36it/s]6571it [00:19, 302.08it/s]6611it [00:19, 327.27it/s]6651it [00:19, 346.37it/s]6688it [00:19, 343.32it/s]6728it [00:19, 356.35it/s]6765it [00:19, 352.60it/s]6803it [00:19, 359.04it/s]6840it [00:19, 351.10it/s]6876it [00:19, 337.26it/s]6913it [00:20, 345.87it/s]6953it [00:20, 361.22it/s]6990it [00:20, 352.41it/s]7026it [00:20, 340.97it/s]7064it [00:20, 351.97it/s]7105it [00:20, 365.19it/s]7142it [00:20, 359.46it/s]7182it [00:20, 371.11it/s]7220it [00:20, 349.84it/s]7258it [00:21, 357.62it/s]7299it [00:21, 368.38it/s]7338it [00:21, 369.83it/s]7376it [00:21, 367.36it/s]7413it [00:21, 361.74it/s]7450it [00:21, 362.22it/s]7487it [00:21, 356.42it/s]7523it [00:21, 355.06it/s]7562it [00:21, 358.99it/s]7601it [00:21, 366.42it/s]7638it [00:22, 359.07it/s]7674it [00:22, 352.16it/s]7710it [00:22, 349.05it/s]7748it [00:22, 355.91it/s]7787it [00:22, 365.22it/s]7825it [00:22, 368.49it/s]7862it [00:22, 350.18it/s]7901it [00:22, 359.67it/s]7938it [00:22, 352.61it/s]7977it [00:23, 363.03it/s]8014it [00:23, 359.74it/s]8054it [00:23, 369.43it/s]8092it [00:23, 360.91it/s]8129it [00:23, 352.99it/s]8165it [00:23, 351.46it/s]8201it [00:23, 353.20it/s]8237it [00:23, 344.31it/s]8274it [00:23, 348.86it/s]8316it [00:23, 365.22it/s]8354it [00:24, 365.79it/s]8395it [00:24, 375.95it/s]8433it [00:24, 368.29it/s]8470it [00:24, 352.85it/s]8508it [00:24, 358.80it/s]8550it [00:24, 374.59it/s]8588it [00:24, 366.49it/s]8625it [00:24, 357.75it/s]8661it [00:24, 353.08it/s]8697it [00:25, 351.65it/s]8733it [00:25, 350.56it/s]8769it [00:25, 335.76it/s]8806it [00:25, 344.56it/s]8846it [00:25, 356.74it/s]8882it [00:25, 347.52it/s]8921it [00:25, 358.83it/s]8961it [00:25, 370.51it/s]8999it [00:25, 365.20it/s]9036it [00:25, 365.59it/s]9076it [00:26, 372.23it/s]9114it [00:26, 367.86it/s]9151it [00:26, 357.83it/s]9188it [00:26, 358.80it/s]9227it [00:26, 367.67it/s]9264it [00:26, 367.32it/s]9301it [00:26, 348.01it/s]9338it [00:26, 351.52it/s]9380it [00:26, 370.09it/s]9418it [00:27, 372.13it/s]9456it [00:27, 366.22it/s]9495it [00:27, 373.02it/s]9534it [00:27, 376.59it/s]9572it [00:27, 370.84it/s]9610it [00:27, 373.16it/s]9648it [00:27, 361.68it/s]9690it [00:27, 374.64it/s]9728it [00:27, 357.56it/s]9764it [00:27, 344.44it/s]9799it [00:28, 343.77it/s]9838it [00:28, 355.56it/s]9874it [00:28, 353.30it/s]9916it [00:28, 363.52it/s]9955it [00:28, 369.53it/s]9993it [00:28, 357.07it/s]10033it [00:29, 171.99it/s]10070it [00:29, 202.58it/s]10109it [00:29, 236.11it/s]10149it [00:29, 269.90it/s]10193it [00:29, 307.61it/s]10231it [00:29, 320.42it/s]10275it [00:29, 350.15it/s]10317it [00:29, 367.35it/s]10357it [00:29, 361.96it/s]10401it [00:30, 380.47it/s]10441it [00:30, 367.95it/s]10479it [00:30, 363.37it/s]10517it [00:30, 365.64it/s]10555it [00:30, 367.63it/s]10595it [00:30, 374.69it/s]10636it [00:30, 383.65it/s]10675it [00:30, 379.21it/s]10714it [00:30, 368.12it/s]10751it [00:31, 350.46it/s]10787it [00:31, 352.01it/s]10830it [00:31, 373.76it/s]10868it [00:31, 364.06it/s]10905it [00:31, 359.84it/s]10948it [00:31, 377.96it/s]10986it [00:31, 373.52it/s]11024it [00:31, 363.06it/s]11064it [00:31, 373.58it/s]11106it [00:31, 385.18it/s]11145it [00:32, 372.81it/s]11183it [00:32, 365.31it/s]11220it [00:32, 353.66it/s]11261it [00:32, 368.06it/s]11298it [00:32, 363.41it/s]11335it [00:32, 354.46it/s]11371it [00:32, 334.99it/s]11409it [00:32, 346.67it/s]11444it [00:32, 341.44it/s]11482it [00:33, 350.14it/s]11520it [00:33, 357.05it/s]11556it [00:33, 346.71it/s]11591it [00:33, 347.62it/s]11629it [00:33, 354.88it/s]11665it [00:33, 354.47it/s]11704it [00:33, 361.03it/s]11741it [00:33, 348.49it/s]11783it [00:33, 368.40it/s]11821it [00:33, 367.66it/s]11858it [00:34, 341.28it/s]11896it [00:34, 351.15it/s]11939it [00:34, 372.77it/s]11977it [00:34, 372.35it/s]12019it [00:34, 380.34it/s]12059it [00:34, 385.04it/s]12098it [00:34, 379.31it/s]12137it [00:34, 357.94it/s]12177it [00:34, 368.38it/s]12215it [00:35, 361.21it/s]12252it [00:35, 352.55it/s]12288it [00:35, 345.83it/s]12328it [00:35, 358.76it/s]12365it [00:35, 348.19it/s]12403it [00:35, 354.67it/s]12441it [00:35, 359.51it/s]12478it [00:35, 352.95it/s]12514it [00:35, 352.09it/s]12550it [00:36, 344.70it/s]12585it [00:36, 340.41it/s]12620it [00:36, 327.51it/s]12653it [00:36, 328.08it/s]12694it [00:36, 350.69it/s]12730it [00:36, 348.80it/s]12769it [00:36, 359.26it/s]12806it [00:36, 360.99it/s]12843it [00:36, 350.35it/s]12879it [00:36, 339.40it/s]12919it [00:37, 355.71it/s]12957it [00:37, 360.34it/s]12994it [00:37, 351.41it/s]13030it [00:37, 317.62it/s]13065it [00:37, 325.25it/s]13101it [00:37, 334.77it/s]13140it [00:37, 349.28it/s]13176it [00:37, 345.56it/s]13212it [00:37, 347.99it/s]13248it [00:38, 342.79it/s]13286it [00:38, 351.57it/s]13322it [00:38, 345.70it/s]13361it [00:38, 357.84it/s]13397it [00:38, 344.20it/s]13432it [00:38, 344.66it/s]13467it [00:38, 334.98it/s]13506it [00:38, 349.16it/s]13542it [00:38, 345.56it/s]13579it [00:39, 349.84it/s]13615it [00:39, 349.83it/s]13651it [00:39, 343.21it/s]13688it [00:39, 347.03it/s]13725it [00:39, 352.13it/s]13762it [00:39, 351.04it/s]13801it [00:39, 359.80it/s]13838it [00:39, 356.76it/s]13878it [00:39, 368.49it/s]13916it [00:39, 371.05it/s]13955it [00:40, 375.33it/s]13993it [00:40, 372.29it/s]14031it [00:40, 354.12it/s]14074it [00:40, 374.90it/s]14112it [00:40, 358.84it/s]14153it [00:40, 371.06it/s]14191it [00:40, 368.77it/s]14229it [00:40, 371.99it/s]14267it [00:40, 365.88it/s]14307it [00:41, 374.76it/s]14345it [00:41, 371.10it/s]14383it [00:41, 364.53it/s]14423it [00:41, 371.40it/s]14461it [00:41, 354.78it/s]14497it [00:41, 350.21it/s]14541it [00:41, 375.06it/s]14554it [00:41, 348.99it/s]
0it [00:00, ?it/s]17it [00:00, 168.90it/s]38it [00:00, 45.58it/s] 73it [00:00, 95.37it/s]101it [00:00, 129.64it/s]132it [00:01, 167.37it/s]166it [00:01, 206.34it/s]195it [00:01, 225.00it/s]226it [00:01, 245.29it/s]255it [00:01, 256.36it/s]284it [00:01, 258.43it/s]319it [00:01, 283.11it/s]351it [00:01, 293.30it/s]382it [00:01, 297.44it/s]413it [00:01, 300.17it/s]445it [00:02, 301.10it/s]476it [00:02, 296.62it/s]506it [00:02, 296.97it/s]537it [00:02, 300.12it/s]568it [00:02, 290.07it/s]601it [00:02, 301.48it/s]634it [00:02, 307.36it/s]667it [00:02, 312.07it/s]699it [00:02, 305.84it/s]734it [00:03, 317.86it/s]767it [00:03, 320.20it/s]801it [00:03, 323.51it/s]834it [00:03, 311.95it/s]866it [00:03, 303.53it/s]897it [00:03, 304.22it/s]928it [00:03, 297.67it/s]964it [00:03, 314.01it/s]996it [00:03, 305.63it/s]1027it [00:03, 296.67it/s]1060it [00:04, 303.57it/s]1093it [00:04, 310.26it/s]1125it [00:04, 306.23it/s]1159it [00:04, 315.54it/s]1191it [00:04, 316.27it/s]1223it [00:04, 310.12it/s]1255it [00:04, 302.80it/s]1287it [00:04, 305.03it/s]1323it [00:04, 317.12it/s]1355it [00:05, 305.47it/s]1386it [00:05, 302.81it/s]1417it [00:05, 299.40it/s]1447it [00:05, 298.30it/s]1477it [00:05, 296.66it/s]1478it [00:05, 270.20it/s]
0it [00:00, ?it/s]19it [00:00, 183.20it/s]56it [00:00, 290.78it/s]86it [00:00, 261.19it/s]116it [00:00, 272.95it/s]144it [00:00, 272.63it/s]175it [00:00, 281.93it/s]206it [00:00, 288.28it/s]253it [00:00, 340.65it/s]293it [00:00, 358.35it/s]329it [00:01, 355.98it/s]365it [00:01, 341.78it/s]400it [00:01, 324.46it/s]416it [00:01, 309.91it/s]
Skipped:
{'total_sents': 16448}

Total: 0
Using model bloom-1b7-intermediate-global_step1000...
Processing UD_French...
Traceback (most recent call last):
  File "preprocess_treebank.py", line 374, in <module>
    model = BloomModel.from_pretrained(bloom_model, 
  File "/home/s2308470/miniconda3/envs/multilingual-typology-probing/lib/python3.8/site-packages/transformers/modeling_utils.py", line 1878, in to
    return super().to(*args, **kwargs)
  File "/home/s2308470/miniconda3/envs/multilingual-typology-probing/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1145, in to
    return self._apply(convert)
  File "/home/s2308470/miniconda3/envs/multilingual-typology-probing/lib/python3.8/site-packages/torch/nn/modules/module.py", line 797, in _apply
    module._apply(fn)
  File "/home/s2308470/miniconda3/envs/multilingual-typology-probing/lib/python3.8/site-packages/torch/nn/modules/module.py", line 797, in _apply
    module._apply(fn)
  File "/home/s2308470/miniconda3/envs/multilingual-typology-probing/lib/python3.8/site-packages/torch/nn/modules/module.py", line 797, in _apply
    module._apply(fn)
  [Previous line repeated 1 more time]
  File "/home/s2308470/miniconda3/envs/multilingual-typology-probing/lib/python3.8/site-packages/torch/nn/modules/module.py", line 820, in _apply
    param_applied = fn(param)
  File "/home/s2308470/miniconda3/envs/multilingual-typology-probing/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1143, in convert
    return t.to(device, dtype if t.is_floating_point() or t.is_complex() else None, non_blocking)
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 64.00 MiB (GPU 0; 5.94 GiB total capacity; 5.79 GiB already allocated; 35.31 MiB free; 5.79 GiB reserved in total by PyTorch) If reserved memory is >> allocated memory try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF
