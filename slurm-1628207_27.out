python run.py --language UD_Catalan --experiment-name inter-layer-13 --attribute POS --trainer poisson --gpu --embedding bloom-1b1-intermediate-global_step600000 greedy --selection-size 50 --selection-criterion mi
Setting up datasets (['UD_Catalan'], POS) and probes...
  0%|          | 0/441656 [00:00<?, ?it/s]  1%|          | 2271/441656 [00:00<00:19, 22701.52it/s]  1%|          | 5168/441656 [00:00<00:16, 26383.17it/s]  2%|▏         | 8089/441656 [00:00<00:15, 27670.14it/s]  2%|▏         | 10929/441656 [00:00<00:15, 27955.90it/s]  3%|▎         | 13857/441656 [00:00<00:15, 28430.96it/s]  4%|▍         | 16747/441656 [00:00<00:14, 28587.80it/s]  4%|▍         | 19662/441656 [00:00<00:14, 28770.25it/s]  5%|▌         | 22583/441656 [00:00<00:14, 28906.66it/s]  6%|▌         | 25474/441656 [00:00<00:14, 28860.78it/s]  6%|▋         | 28409/441656 [00:01<00:14, 29009.48it/s]  7%|▋         | 31324/441656 [00:01<00:14, 29049.00it/s]  8%|▊         | 34229/441656 [00:01<00:14, 28877.92it/s]  8%|▊         | 37118/441656 [00:01<00:34, 11811.62it/s]  9%|▉         | 40000/441656 [00:01<00:27, 14358.34it/s] 10%|▉         | 42876/441656 [00:01<00:23, 16896.24it/s] 10%|█         | 45740/441656 [00:02<00:20, 19257.94it/s] 11%|█         | 48598/441656 [00:02<00:18, 21337.64it/s] 12%|█▏        | 51510/441656 [00:02<00:16, 23217.62it/s] 12%|█▏        | 54466/441656 [00:02<00:15, 24843.76it/s] 13%|█▎        | 57356/441656 [00:02<00:14, 25929.84it/s] 14%|█▎        | 60197/441656 [00:02<00:14, 26548.15it/s] 14%|█▍        | 63108/441656 [00:02<00:13, 27252.11it/s] 15%|█▍        | 66061/441656 [00:02<00:13, 27904.71it/s] 16%|█▌        | 68976/441656 [00:02<00:13, 28266.44it/s] 16%|█▋        | 71869/441656 [00:02<00:13, 28403.45it/s] 17%|█▋        | 74817/441656 [00:03<00:12, 28720.66it/s] 18%|█▊        | 77765/441656 [00:03<00:12, 28943.90it/s] 18%|█▊        | 80683/441656 [00:03<00:12, 28815.55it/s] 19%|█▉        | 83592/441656 [00:03<00:12, 28894.22it/s] 20%|█▉        | 86494/441656 [00:04<00:33, 10550.16it/s] 20%|██        | 89366/441656 [00:04<00:27, 12990.22it/s] 21%|██        | 92319/441656 [00:04<00:22, 15652.06it/s] 22%|██▏       | 95237/441656 [00:04<00:19, 18180.26it/s] 22%|██▏       | 98174/441656 [00:04<00:16, 20538.07it/s] 23%|██▎       | 101082/441656 [00:04<00:15, 22506.02it/s] 24%|██▎       | 104045/441656 [00:04<00:13, 24273.70it/s] 24%|██▍       | 107003/441656 [00:04<00:13, 25662.52it/s] 25%|██▍       | 109880/441656 [00:04<00:12, 26176.50it/s] 26%|██▌       | 112839/441656 [00:04<00:12, 27121.80it/s] 26%|██▌       | 115782/441656 [00:05<00:11, 27682.94it/s] 27%|██▋       | 118709/441656 [00:05<00:11, 28138.61it/s] 28%|██▊       | 121629/441656 [00:05<00:11, 28445.14it/s] 28%|██▊       | 124533/441656 [00:05<00:11, 28557.18it/s] 29%|██▉       | 127437/441656 [00:05<00:10, 28698.30it/s] 30%|██▉       | 130349/441656 [00:05<00:10, 28821.34it/s] 30%|███       | 133252/441656 [00:05<00:10, 28770.98it/s] 31%|███       | 136171/441656 [00:05<00:10, 28894.55it/s] 31%|███▏      | 139071/441656 [00:05<00:10, 28822.14it/s] 32%|███▏      | 141961/441656 [00:05<00:10, 28646.02it/s] 33%|███▎      | 144858/441656 [00:06<00:10, 28741.08it/s] 33%|███▎      | 147769/441656 [00:06<00:10, 28848.24it/s] 34%|███▍      | 150657/441656 [00:07<00:33, 8634.43it/s]  35%|███▍      | 153574/441656 [00:07<00:26, 10958.27it/s] 35%|███▌      | 156462/441656 [00:07<00:21, 13452.20it/s] 36%|███▌      | 159412/441656 [00:07<00:17, 16112.76it/s] 37%|███▋      | 162310/441656 [00:07<00:15, 18576.39it/s] 37%|███▋      | 165264/441656 [00:07<00:13, 20930.16it/s] 38%|███▊      | 168159/441656 [00:07<00:11, 22811.35it/s] 39%|███▊      | 171056/441656 [00:07<00:11, 24357.19it/s] 39%|███▉      | 173937/441656 [00:07<00:10, 25531.30it/s] 40%|████      | 176832/441656 [00:07<00:10, 26467.08it/s] 41%|████      | 179700/441656 [00:08<00:09, 27041.25it/s] 41%|████▏     | 182562/441656 [00:08<00:09, 27262.11it/s] 42%|████▏     | 185423/441656 [00:08<00:09, 27649.59it/s] 43%|████▎     | 188292/441656 [00:08<00:09, 27949.68it/s] 43%|████▎     | 191182/441656 [00:08<00:08, 28228.08it/s] 44%|████▍     | 194062/441656 [00:08<00:08, 28394.03it/s] 45%|████▍     | 196952/441656 [00:08<00:08, 28542.79it/s] 45%|████▌     | 199829/441656 [00:08<00:08, 28607.83it/s] 46%|████▌     | 202704/441656 [00:08<00:08, 28548.84it/s] 47%|████▋     | 205633/441656 [00:08<00:08, 28769.10it/s] 47%|████▋     | 208517/441656 [00:09<00:08, 28709.86it/s] 48%|████▊     | 211393/441656 [00:09<00:08, 28488.14it/s] 49%|████▊     | 214280/441656 [00:09<00:07, 28565.40it/s] 49%|████▉     | 217140/441656 [00:09<00:07, 28569.14it/s] 50%|████▉     | 220053/441656 [00:09<00:07, 28735.63it/s] 50%|█████     | 222935/441656 [00:09<00:07, 28759.30it/s] 51%|█████     | 225812/441656 [00:09<00:07, 28685.12it/s] 52%|█████▏    | 228682/441656 [00:09<00:07, 28634.91it/s] 52%|█████▏    | 231546/441656 [00:10<00:30, 6879.51it/s]  53%|█████▎    | 234428/441656 [00:11<00:23, 8919.53it/s] 54%|█████▎    | 237344/441656 [00:11<00:18, 11293.00it/s] 54%|█████▍    | 240229/441656 [00:11<00:14, 13811.91it/s] 55%|█████▌    | 243182/441656 [00:11<00:12, 16485.39it/s] 56%|█████▌    | 245898/441656 [00:11<00:10, 18563.10it/s] 56%|█████▋    | 248774/441656 [00:11<00:09, 20786.64it/s] 57%|█████▋    | 251669/441656 [00:11<00:08, 22725.19it/s] 58%|█████▊    | 254516/441656 [00:11<00:07, 24180.43it/s] 58%|█████▊    | 257332/441656 [00:11<00:07, 25140.97it/s] 59%|█████▉    | 260196/441656 [00:11<00:06, 26100.38it/s] 60%|█████▉    | 263066/441656 [00:12<00:06, 26830.91it/s] 60%|██████    | 265945/441656 [00:12<00:06, 27389.78it/s] 61%|██████    | 268827/441656 [00:12<00:06, 27802.48it/s] 62%|██████▏   | 271690/441656 [00:12<00:06, 28042.61it/s] 62%|██████▏   | 274565/441656 [00:12<00:05, 28249.46it/s] 63%|██████▎   | 277429/441656 [00:12<00:05, 27959.22it/s] 63%|██████▎   | 280253/441656 [00:12<00:05, 27874.49it/s] 64%|██████▍   | 283097/441656 [00:12<00:05, 28039.20it/s] 65%|██████▍   | 285980/441656 [00:12<00:05, 28272.26it/s] 65%|██████▌   | 288818/441656 [00:12<00:05, 28107.48it/s] 66%|██████▌   | 291636/441656 [00:13<00:05, 28080.39it/s] 67%|██████▋   | 294454/441656 [00:13<00:05, 28098.21it/s] 67%|██████▋   | 297268/441656 [00:13<00:05, 27993.28it/s] 68%|██████▊   | 300144/441656 [00:13<00:05, 28220.01it/s] 69%|██████▊   | 303004/441656 [00:13<00:04, 28330.84it/s] 69%|██████▉   | 305839/441656 [00:13<00:04, 28151.26it/s] 70%|██████▉   | 308656/441656 [00:13<00:04, 28116.80it/s] 71%|███████   | 311469/441656 [00:13<00:04, 28110.27it/s] 71%|███████   | 314281/441656 [00:13<00:04, 28072.19it/s] 72%|███████▏  | 317110/441656 [00:13<00:04, 28136.51it/s] 72%|███████▏  | 319924/441656 [00:14<00:04, 27822.79it/s] 73%|███████▎  | 322811/441656 [00:14<00:04, 28132.25it/s] 74%|███████▎  | 325626/441656 [00:14<00:04, 28101.94it/s] 74%|███████▍  | 328437/441656 [00:15<00:17, 6582.94it/s]  75%|███████▍  | 331193/441656 [00:15<00:13, 8486.34it/s] 76%|███████▌  | 333830/441656 [00:15<00:10, 10538.36it/s] 76%|███████▌  | 336505/441656 [00:15<00:08, 12821.59it/s] 77%|███████▋  | 339140/441656 [00:15<00:06, 15087.34it/s] 77%|███████▋  | 341804/441656 [00:15<00:05, 17317.55it/s] 78%|███████▊  | 344503/441656 [00:16<00:05, 19404.38it/s] 79%|███████▊  | 347183/441656 [00:16<00:04, 21148.12it/s] 79%|███████▉  | 349821/441656 [00:16<00:04, 22466.54it/s] 80%|███████▉  | 352514/441656 [00:16<00:03, 23647.58it/s] 80%|████████  | 355162/441656 [00:16<00:03, 24147.64it/s] 81%|████████  | 357803/441656 [00:16<00:03, 24764.91it/s] 82%|████████▏ | 360478/441656 [00:16<00:03, 25328.29it/s] 82%|████████▏ | 363183/441656 [00:16<00:03, 25824.44it/s] 83%|████████▎ | 365866/441656 [00:16<00:02, 26117.09it/s] 83%|████████▎ | 368531/441656 [00:16<00:02, 26212.89it/s] 84%|████████▍ | 371218/441656 [00:17<00:02, 26404.83it/s] 85%|████████▍ | 373885/441656 [00:17<00:02, 26444.33it/s] 85%|████████▌ | 376548/441656 [00:17<00:02, 26400.37it/s] 86%|████████▌ | 379202/441656 [00:17<00:02, 26422.56it/s] 86%|████████▋ | 381889/441656 [00:17<00:02, 26553.46it/s] 87%|████████▋ | 384578/441656 [00:17<00:02, 26644.76it/s] 88%|████████▊ | 387248/441656 [00:17<00:02, 26512.32it/s] 88%|████████▊ | 389922/441656 [00:17<00:01, 26578.43it/s] 89%|████████▉ | 392583/441656 [00:17<00:01, 26283.32it/s] 89%|████████▉ | 395272/441656 [00:17<00:01, 26460.14it/s] 90%|█████████ | 397920/441656 [00:18<00:01, 26421.10it/s] 91%|█████████ | 400600/441656 [00:18<00:01, 26531.34it/s] 91%|█████████▏| 403278/441656 [00:18<00:01, 26603.62it/s] 92%|█████████▏| 405940/441656 [00:18<00:01, 26607.72it/s] 93%|█████████▎| 408602/441656 [00:18<00:01, 26584.77it/s] 93%|█████████▎| 411320/441656 [00:18<00:01, 26760.88it/s] 94%|█████████▎| 413997/441656 [00:18<00:01, 26761.06it/s] 94%|█████████▍| 416674/441656 [00:18<00:00, 26554.50it/s] 95%|█████████▍| 419330/441656 [00:18<00:00, 26458.52it/s] 96%|█████████▌| 422026/441656 [00:18<00:00, 26607.32it/s] 96%|█████████▌| 424688/441656 [00:19<00:00, 26582.62it/s] 97%|█████████▋| 427347/441656 [00:19<00:00, 26529.23it/s] 97%|█████████▋| 430045/441656 [00:19<00:00, 26661.82it/s] 98%|█████████▊| 432712/441656 [00:19<00:00, 26311.38it/s] 99%|█████████▊| 435412/441656 [00:19<00:00, 26513.61it/s] 99%|█████████▉| 438067/441656 [00:19<00:00, 26521.72it/s]100%|█████████▉| 440764/441656 [00:19<00:00, 26653.92it/s]100%|██████████| 441656/441656 [00:19<00:00, 22405.47it/s]
  0%|          | 0/53198 [00:00<?, ?it/s]  6%|▋         | 3335/53198 [00:00<00:01, 33339.70it/s] 13%|█▎        | 6669/53198 [00:00<00:01, 33094.40it/s] 19%|█▉        | 9979/53198 [00:00<00:01, 32336.75it/s] 25%|██▌       | 13368/53198 [00:00<00:01, 32935.83it/s] 32%|███▏      | 16835/53198 [00:00<00:01, 33551.94it/s] 38%|███▊      | 20229/53198 [00:00<00:00, 33680.76it/s] 44%|████▍     | 23617/53198 [00:00<00:00, 33565.73it/s] 51%|█████     | 27049/53198 [00:00<00:00, 33800.48it/s] 57%|█████▋    | 30430/53198 [00:00<00:00, 33694.16it/s] 64%|██████▎   | 33815/53198 [00:01<00:00, 33738.21it/s] 70%|██████▉   | 37190/53198 [00:01<00:00, 33409.18it/s] 76%|███████▌  | 40532/53198 [00:01<00:00, 33278.42it/s] 82%|████████▏ | 43861/53198 [00:01<00:00, 33261.01it/s] 89%|████████▊ | 47190/53198 [00:01<00:00, 33268.38it/s] 95%|█████████▌| 50547/53198 [00:01<00:00, 33357.85it/s]100%|██████████| 53198/53198 [00:01<00:00, 33356.77it/s]
  0%|          | 0/35912 [00:00<?, ?it/s]  9%|▉         | 3374/35912 [00:00<00:00, 33735.69it/s] 19%|█▉        | 6912/35912 [00:00<00:00, 34698.67it/s] 29%|██▉       | 10382/35912 [00:00<00:00, 34485.72it/s] 39%|███▊      | 13878/35912 [00:00<00:00, 34669.60it/s] 48%|████▊     | 17346/35912 [00:00<00:00, 34601.10it/s] 58%|█████▊    | 20807/35912 [00:00<00:00, 33713.35it/s] 67%|██████▋   | 24183/35912 [00:00<00:00, 33136.72it/s] 77%|███████▋  | 27538/35912 [00:00<00:00, 33262.83it/s] 86%|████████▌ | 30868/35912 [00:00<00:00, 32925.85it/s] 95%|█████████▌| 34167/35912 [00:01<00:00, 32680.12it/s]100%|██████████| 35912/35912 [00:01<00:00, 33375.27it/s]
dataset loaded from path: 
data/ud/ud-treebanks-v2.1/UD_Catalan/inter-layer-13/UD_Catalan-train-bloom-1b1-intermediate-global_step600000.pkl
data/ud/ud-treebanks-v2.1/UD_Catalan/inter-layer-13/UD_Catalan-dev-bloom-1b1-intermediate-global_step600000.pkl
data/ud/ud-treebanks-v2.1/UD_Catalan/inter-layer-13/UD_Catalan-test-bloom-1b1-intermediate-global_step600000.pkl
Embedding dimensionality: 1536
Pre-training probe (if possible)...
Traceback (most recent call last):
  File "run.py", line 102, in <module>
    args.func(args)
  File "/home/s2308470/multilingual-typology-probing/commands.py", line 166, in greedy
    trainer.train()
  File "/home/s2308470/multilingual-typology-probing/probekit/trainers/trainer.py", line 21, in train
    self._train()
  File "/home/s2308470/multilingual-typology-probing/probekit/trainers/neural_probe_trainer.py", line 30, in _train
    self._train_for_dimensions()
  File "/home/s2308470/multilingual-typology-probing/trainers/flexible_neural_probe_trainer.py", line 72, in _train_for_dimensions
    inputs_tensor_shuffled = inputs_tensor[shuffled_indices]
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 2.21 GiB (GPU 0; 5.94 GiB total capacity; 5.41 GiB already allocated; 285.31 MiB free; 5.44 GiB reserved in total by PyTorch) If reserved memory is >> allocated memory try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF
