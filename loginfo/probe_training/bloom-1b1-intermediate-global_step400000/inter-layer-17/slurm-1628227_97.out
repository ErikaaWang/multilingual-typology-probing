python run.py --language UD_Spanish --experiment-name inter-layer-17 --attribute POS --trainer poisson --gpu --embedding bloom-1b1-intermediate-global_step400000 greedy --selection-size 50 --selection-criterion mi
Setting up datasets (['UD_Spanish'], POS) and probes...
  0%|          | 0/343741 [00:00<?, ?it/s]  1%|          | 2298/343741 [00:00<00:14, 22969.40it/s]  2%|▏         | 5316/343741 [00:00<00:12, 27207.77it/s]  2%|▏         | 8286/343741 [00:00<00:11, 28343.74it/s]  3%|▎         | 11346/343741 [00:00<00:11, 29230.55it/s]  4%|▍         | 14327/343741 [00:00<00:11, 29436.14it/s]  5%|▌         | 17365/343741 [00:00<00:10, 29754.28it/s]  6%|▌         | 20405/343741 [00:00<00:10, 29964.04it/s]  7%|▋         | 23402/343741 [00:01<00:23, 13713.22it/s]  8%|▊         | 26377/343741 [00:01<00:19, 16474.70it/s]  9%|▊         | 29358/343741 [00:01<00:16, 19107.21it/s]  9%|▉         | 32409/343741 [00:01<00:14, 21614.50it/s] 10%|█         | 35365/343741 [00:01<00:13, 23513.17it/s] 11%|█         | 38418/343741 [00:01<00:12, 25298.12it/s] 12%|█▏        | 41437/343741 [00:01<00:11, 26600.54it/s] 13%|█▎        | 44414/343741 [00:01<00:10, 27474.03it/s] 14%|█▍        | 47430/343741 [00:01<00:10, 28232.86it/s] 15%|█▍        | 50395/343741 [00:02<00:10, 28604.61it/s] 16%|█▌        | 53438/343741 [00:02<00:09, 29133.40it/s] 16%|█▋        | 56424/343741 [00:02<00:09, 29324.90it/s] 17%|█▋        | 59469/343741 [00:02<00:09, 29656.10it/s] 18%|█▊        | 62471/343741 [00:02<00:22, 12493.66it/s] 19%|█▉        | 65442/343741 [00:03<00:18, 15093.88it/s] 20%|█▉        | 68520/343741 [00:03<00:15, 17877.49it/s] 21%|██        | 71516/343741 [00:03<00:13, 20320.81it/s] 22%|██▏       | 74583/343741 [00:03<00:11, 22639.46it/s] 23%|██▎       | 77433/343741 [00:03<00:11, 24008.07it/s] 23%|██▎       | 80367/343741 [00:03<00:10, 25376.22it/s] 24%|██▍       | 83385/343741 [00:03<00:09, 26664.36it/s] 25%|██▌       | 86357/343741 [00:03<00:09, 27508.99it/s] 26%|██▌       | 89380/343741 [00:03<00:08, 28278.40it/s] 27%|██▋       | 92416/343741 [00:03<00:08, 28877.22it/s] 28%|██▊       | 95428/343741 [00:04<00:08, 29237.78it/s] 29%|██▊       | 98456/343741 [00:04<00:08, 29528.12it/s] 30%|██▉       | 101471/343741 [00:04<00:08, 29711.56it/s] 30%|███       | 104534/343741 [00:04<00:07, 29981.52it/s] 31%|███▏      | 107556/343741 [00:04<00:07, 30013.13it/s] 32%|███▏      | 110588/343741 [00:04<00:07, 30102.52it/s] 33%|███▎      | 113610/343741 [00:05<00:19, 11802.55it/s] 34%|███▍      | 116616/343741 [00:05<00:15, 14416.65it/s] 35%|███▍      | 119630/343741 [00:05<00:13, 17073.25it/s] 36%|███▌      | 122617/343741 [00:05<00:11, 19569.93it/s] 37%|███▋      | 125673/343741 [00:05<00:09, 21964.40it/s] 37%|███▋      | 128700/343741 [00:05<00:08, 23934.95it/s] 38%|███▊      | 131762/343741 [00:05<00:08, 25627.45it/s] 39%|███▉      | 134738/343741 [00:05<00:07, 26724.25it/s] 40%|████      | 137797/343741 [00:05<00:07, 27785.41it/s] 41%|████      | 140782/343741 [00:06<00:07, 28327.70it/s] 42%|████▏     | 143799/343741 [00:06<00:06, 28855.56it/s] 43%|████▎     | 146834/343741 [00:06<00:06, 29288.67it/s] 44%|████▎     | 149839/343741 [00:06<00:06, 29200.44it/s] 44%|████▍     | 152870/343741 [00:06<00:06, 29522.80it/s] 45%|████▌     | 155904/343741 [00:06<00:06, 29760.88it/s] 46%|████▌     | 158947/343741 [00:06<00:06, 29958.09it/s] 47%|████▋     | 161962/343741 [00:06<00:06, 29967.65it/s] 48%|████▊     | 165008/343741 [00:06<00:05, 30111.50it/s] 49%|████▉     | 168031/343741 [00:06<00:05, 30143.73it/s] 50%|████▉     | 171054/343741 [00:07<00:05, 30168.03it/s] 51%|█████     | 174114/343741 [00:07<00:05, 30296.53it/s] 52%|█████▏    | 177147/343741 [00:07<00:15, 10834.01it/s] 52%|█████▏    | 180189/343741 [00:07<00:12, 13432.06it/s] 53%|█████▎    | 183158/343741 [00:08<00:10, 16021.81it/s] 54%|█████▍    | 186219/343741 [00:08<00:08, 18725.12it/s] 55%|█████▌    | 189198/343741 [00:08<00:07, 21041.02it/s] 56%|█████▌    | 192225/343741 [00:08<00:06, 23164.24it/s] 57%|█████▋    | 195254/343741 [00:08<00:05, 24926.99it/s] 58%|█████▊    | 198233/343741 [00:08<00:05, 26196.55it/s] 59%|█████▊    | 201308/343741 [00:08<00:05, 27430.92it/s] 59%|█████▉    | 204309/343741 [00:08<00:04, 28149.59it/s] 60%|██████    | 207333/343741 [00:08<00:04, 28744.19it/s] 61%|██████    | 210333/343741 [00:08<00:04, 29106.21it/s] 62%|██████▏   | 213361/343741 [00:09<00:04, 29446.95it/s] 63%|██████▎   | 216369/343741 [00:09<00:04, 29602.31it/s] 64%|██████▍   | 219374/343741 [00:09<00:04, 29229.00it/s] 65%|██████▍   | 222418/343741 [00:09<00:04, 29582.94it/s] 66%|██████▌   | 225402/343741 [00:09<00:03, 29656.98it/s] 66%|██████▋   | 228453/343741 [00:09<00:03, 29907.23it/s] 67%|██████▋   | 231456/343741 [00:09<00:03, 29881.28it/s] 68%|██████▊   | 234488/343741 [00:09<00:03, 30010.96it/s] 69%|██████▉   | 237495/343741 [00:09<00:03, 29968.07it/s] 70%|██████▉   | 240502/343741 [00:09<00:03, 29997.51it/s] 71%|███████   | 243561/343741 [00:10<00:03, 30173.28it/s] 72%|███████▏  | 246581/343741 [00:10<00:03, 30028.64it/s] 73%|███████▎  | 249653/343741 [00:10<00:03, 30229.86it/s] 74%|███████▎  | 252678/343741 [00:10<00:03, 30129.29it/s] 74%|███████▍  | 255692/343741 [00:11<00:09, 9709.60it/s]  75%|███████▌  | 258657/343741 [00:11<00:07, 12117.93it/s] 76%|███████▌  | 261685/343741 [00:11<00:05, 14790.22it/s] 77%|███████▋  | 264720/343741 [00:11<00:04, 17492.17it/s] 78%|███████▊  | 267677/343741 [00:11<00:03, 19891.93it/s] 79%|███████▉  | 270734/343741 [00:11<00:03, 22252.30it/s] 80%|███████▉  | 273704/343741 [00:11<00:02, 24039.53it/s] 81%|████████  | 276776/343741 [00:11<00:02, 25743.70it/s] 81%|████████▏ | 279736/343741 [00:11<00:02, 26772.78it/s] 82%|████████▏ | 282792/343741 [00:12<00:02, 27818.84it/s] 83%|████████▎ | 285815/343741 [00:12<00:02, 28500.73it/s] 84%|████████▍ | 288813/343741 [00:12<00:01, 28909.80it/s] 85%|████████▍ | 291828/343741 [00:12<00:01, 29265.79it/s] 86%|████████▌ | 294830/343741 [00:12<00:01, 29366.62it/s] 87%|████████▋ | 297873/343741 [00:12<00:01, 29679.15it/s] 88%|████████▊ | 300883/343741 [00:12<00:01, 29801.07it/s] 88%|████████▊ | 303890/343741 [00:12<00:01, 29878.62it/s] 89%|████████▉ | 306897/343741 [00:12<00:01, 29887.65it/s] 90%|█████████ | 309930/343741 [00:12<00:01, 30016.49it/s] 91%|█████████ | 312972/343741 [00:13<00:01, 30136.57it/s] 92%|█████████▏| 315993/343741 [00:13<00:00, 30001.38it/s] 93%|█████████▎| 318998/343741 [00:13<00:00, 29647.41it/s] 94%|█████████▎| 321973/343741 [00:13<00:00, 29676.30it/s] 95%|█████████▍| 325021/343741 [00:13<00:00, 29914.72it/s] 95%|█████████▌| 328015/343741 [00:13<00:00, 29916.52it/s] 96%|█████████▋| 331022/343741 [00:13<00:00, 29960.11it/s] 97%|█████████▋| 334049/343741 [00:13<00:00, 30051.05it/s] 98%|█████████▊| 337055/343741 [00:13<00:00, 29935.41it/s] 99%|█████████▉| 340079/343741 [00:13<00:00, 30023.19it/s]100%|█████████▉| 343082/343741 [00:14<00:00, 29999.08it/s]100%|██████████| 343741/343741 [00:14<00:00, 24352.43it/s]
  0%|          | 0/56357 [00:00<?, ?it/s]  6%|▌         | 3405/56357 [00:00<00:01, 34045.49it/s] 12%|█▏        | 6847/56357 [00:00<00:01, 34261.86it/s] 18%|█▊        | 10274/56357 [00:00<00:01, 34037.57it/s] 24%|██▍       | 13685/56357 [00:00<00:01, 34062.36it/s] 31%|███       | 17201/56357 [00:00<00:01, 34456.15it/s] 37%|███▋      | 20665/56357 [00:00<00:01, 34516.35it/s] 43%|████▎     | 24137/56357 [00:00<00:00, 34581.59it/s] 49%|████▉     | 27623/56357 [00:00<00:00, 34667.37it/s] 55%|█████▌    | 31105/56357 [00:00<00:00, 34714.49it/s] 61%|██████▏   | 34577/56357 [00:01<00:00, 34679.23it/s] 68%|██████▊   | 38110/56357 [00:01<00:00, 34875.66it/s] 74%|███████▍  | 41598/56357 [00:01<00:00, 34665.43it/s] 80%|███████▉  | 45065/56357 [00:01<00:00, 34090.09it/s] 86%|████████▌ | 48557/56357 [00:01<00:00, 34335.34it/s] 92%|█████████▏| 52034/56357 [00:01<00:00, 34462.24it/s] 98%|█████████▊| 55482/56357 [00:01<00:00, 34338.07it/s]100%|██████████| 56357/56357 [00:01<00:00, 34452.89it/s]
  0%|          | 0/23248 [00:00<?, ?it/s] 16%|█▌        | 3689/23248 [00:00<00:00, 36880.28it/s] 32%|███▏      | 7378/23248 [00:00<00:00, 36795.51it/s] 48%|████▊     | 11115/23248 [00:00<00:00, 37056.60it/s] 64%|██████▍   | 14821/23248 [00:00<00:00, 37021.36it/s] 80%|████████  | 18636/23248 [00:00<00:00, 37425.93it/s] 96%|█████████▋| 22379/23248 [00:00<00:00, 37120.86it/s]100%|██████████| 23248/23248 [00:00<00:00, 36995.79it/s]
dataset loaded from path: 
data/ud/ud-treebanks-v2.1/UD_Spanish/inter-layer-17/UD_Spanish-train-bloom-1b1-intermediate-global_step400000.pkl
data/ud/ud-treebanks-v2.1/UD_Spanish/inter-layer-17/UD_Spanish-dev-bloom-1b1-intermediate-global_step400000.pkl
data/ud/ud-treebanks-v2.1/UD_Spanish/inter-layer-17/UD_Spanish-test-bloom-1b1-intermediate-global_step400000.pkl
Embedding dimensionality: 1536
Pre-training probe (if possible)...
Traceback (most recent call last):
  File "run.py", line 102, in <module>
    args.func(args)
  File "/home/s2308470/multilingual-typology-probing/commands.py", line 166, in greedy
    trainer.train()
  File "/home/s2308470/multilingual-typology-probing/probekit/trainers/trainer.py", line 21, in train
    self._train()
  File "/home/s2308470/multilingual-typology-probing/probekit/trainers/neural_probe_trainer.py", line 30, in _train
    self._train_for_dimensions()
  File "/home/s2308470/multilingual-typology-probing/trainers/flexible_neural_probe_trainer.py", line 72, in _train_for_dimensions
    inputs_tensor_shuffled = inputs_tensor[shuffled_indices]
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 1.63 GiB (GPU 0; 5.94 GiB total capacity; 4.18 GiB already allocated; 1.51 GiB free; 4.21 GiB reserved in total by PyTorch) If reserved memory is >> allocated memory try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF
