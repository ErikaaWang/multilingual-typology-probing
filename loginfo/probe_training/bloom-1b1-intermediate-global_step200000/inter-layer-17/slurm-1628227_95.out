python run.py --language UD_Spanish --experiment-name inter-layer-17 --attribute POS --trainer poisson --gpu --embedding bloom-1b1-intermediate-global_step200000 greedy --selection-size 50 --selection-criterion mi
Setting up datasets (['UD_Spanish'], POS) and probes...
  0%|          | 0/343741 [00:00<?, ?it/s]  1%|          | 2334/343741 [00:00<00:14, 23332.01it/s]  2%|▏         | 5379/343741 [00:00<00:12, 27515.48it/s]  2%|▏         | 8369/343741 [00:00<00:11, 28599.53it/s]  3%|▎         | 11468/343741 [00:00<00:11, 29541.38it/s]  4%|▍         | 14503/343741 [00:00<00:11, 29831.66it/s]  5%|▌         | 17548/343741 [00:00<00:10, 30040.32it/s]  6%|▌         | 20583/343741 [00:01<00:23, 13665.11it/s]  7%|▋         | 23622/343741 [00:01<00:19, 16586.82it/s]  8%|▊         | 26689/343741 [00:01<00:16, 19399.01it/s]  9%|▊         | 29690/343741 [00:01<00:14, 21753.13it/s]  9%|▉         | 32593/343741 [00:01<00:13, 23504.33it/s] 10%|█         | 35526/343741 [00:01<00:12, 24993.63it/s] 11%|█         | 38496/343741 [00:01<00:11, 26251.64it/s] 12%|█▏        | 41502/343741 [00:01<00:11, 27302.83it/s] 13%|█▎        | 44424/343741 [00:01<00:10, 27825.41it/s] 14%|█▍        | 47415/343741 [00:01<00:10, 28423.43it/s] 15%|█▍        | 50356/343741 [00:02<00:10, 28658.55it/s] 16%|█▌        | 53336/343741 [00:02<00:10, 28992.83it/s] 16%|█▋        | 56308/343741 [00:02<00:09, 29206.35it/s] 17%|█▋        | 59350/343741 [00:02<00:09, 29563.68it/s] 18%|█▊        | 62332/343741 [00:02<00:22, 12365.58it/s] 19%|█▉        | 65299/343741 [00:03<00:18, 14972.67it/s] 20%|█▉        | 68356/343741 [00:03<00:15, 17731.61it/s] 21%|██        | 71343/343741 [00:03<00:13, 20181.87it/s] 22%|██▏       | 74444/343741 [00:03<00:11, 22605.42it/s] 23%|██▎       | 77456/343741 [00:03<00:10, 24304.11it/s] 23%|██▎       | 80551/343741 [00:03<00:10, 26005.86it/s] 24%|██▍       | 83611/343741 [00:03<00:09, 27234.98it/s] 25%|██▌       | 86591/343741 [00:03<00:09, 27633.13it/s] 26%|██▌       | 89635/343741 [00:03<00:08, 28421.52it/s] 27%|██▋       | 92690/343741 [00:03<00:08, 29030.14it/s] 28%|██▊       | 95726/343741 [00:04<00:08, 29414.53it/s] 29%|██▊       | 98777/343741 [00:04<00:08, 29734.39it/s] 30%|██▉       | 101799/343741 [00:04<00:08, 29822.47it/s] 31%|███       | 104842/343741 [00:04<00:07, 29999.06it/s] 31%|███▏      | 107888/343741 [00:04<00:07, 30135.51it/s] 32%|███▏      | 110919/343741 [00:04<00:07, 30172.16it/s] 33%|███▎      | 113949/343741 [00:05<00:19, 11849.61it/s] 34%|███▍      | 116973/343741 [00:05<00:15, 14485.21it/s] 35%|███▍      | 120015/343741 [00:05<00:13, 17193.16it/s] 36%|███▌      | 123057/343741 [00:05<00:11, 19776.67it/s] 37%|███▋      | 126106/343741 [00:05<00:09, 22113.59it/s] 38%|███▊      | 129100/343741 [00:05<00:08, 23971.45it/s] 38%|███▊      | 132153/343741 [00:05<00:08, 25631.62it/s] 39%|███▉      | 135116/343741 [00:05<00:07, 26693.55it/s] 40%|████      | 138194/343741 [00:05<00:07, 27817.57it/s] 41%|████      | 141195/343741 [00:06<00:07, 28435.86it/s] 42%|████▏     | 144290/343741 [00:06<00:06, 29157.71it/s] 43%|████▎     | 147313/343741 [00:06<00:06, 29188.87it/s] 44%|████▍     | 150389/343741 [00:06<00:06, 29645.34it/s] 45%|████▍     | 153408/343741 [00:06<00:06, 29648.28it/s] 46%|████▌     | 156477/343741 [00:06<00:06, 29953.58it/s] 46%|████▋     | 159500/343741 [00:06<00:06, 29571.10it/s] 47%|████▋     | 162522/343741 [00:06<00:06, 29760.79it/s] 48%|████▊     | 165572/343741 [00:06<00:05, 29976.38it/s] 49%|████▉     | 168607/343741 [00:06<00:05, 30084.89it/s] 50%|████▉     | 171643/343741 [00:07<00:05, 30164.80it/s] 51%|█████     | 174665/343741 [00:07<00:15, 10886.88it/s] 52%|█████▏    | 177699/343741 [00:07<00:12, 13479.87it/s] 53%|█████▎    | 180719/343741 [00:07<00:10, 16154.35it/s] 53%|█████▎    | 183579/343741 [00:08<00:08, 18469.36it/s] 54%|█████▍    | 186672/343741 [00:08<00:07, 21084.96it/s] 55%|█████▌    | 189636/343741 [00:08<00:06, 23057.70it/s] 56%|█████▌    | 192712/343741 [00:08<00:06, 24966.55it/s] 57%|█████▋    | 195732/343741 [00:08<00:05, 26333.98it/s] 58%|█████▊    | 198765/343741 [00:08<00:05, 27418.56it/s] 59%|█████▊    | 201752/343741 [00:08<00:05, 28102.19it/s] 60%|█████▉    | 204856/343741 [00:08<00:04, 28939.65it/s] 60%|██████    | 207932/343741 [00:08<00:04, 29464.60it/s] 61%|██████▏   | 210967/343741 [00:08<00:04, 29697.69it/s] 62%|██████▏   | 214024/343741 [00:09<00:04, 29952.82it/s] 63%|██████▎   | 217064/343741 [00:09<00:04, 30023.40it/s] 64%|██████▍   | 220098/343741 [00:09<00:04, 30064.74it/s] 65%|██████▍   | 223127/343741 [00:09<00:04, 29998.53it/s] 66%|██████▌   | 226146/343741 [00:09<00:03, 30052.50it/s] 67%|██████▋   | 229162/343741 [00:09<00:03, 29638.73it/s] 68%|██████▊   | 232212/343741 [00:09<00:03, 29889.68it/s] 68%|██████▊   | 235251/343741 [00:09<00:03, 30036.03it/s] 69%|██████▉   | 238260/343741 [00:09<00:03, 29958.91it/s] 70%|███████   | 241260/343741 [00:09<00:03, 29940.99it/s] 71%|███████   | 244257/343741 [00:10<00:03, 29826.45it/s] 72%|███████▏  | 247280/343741 [00:10<00:03, 29944.64it/s] 73%|███████▎  | 250276/343741 [00:10<00:03, 29819.81it/s] 74%|███████▎  | 253316/343741 [00:10<00:03, 29989.49it/s] 75%|███████▍  | 256316/343741 [00:11<00:09, 9624.41it/s]  75%|███████▌  | 259302/343741 [00:11<00:07, 12060.46it/s] 76%|███████▋  | 262300/343741 [00:11<00:05, 14690.06it/s] 77%|███████▋  | 265330/343741 [00:11<00:04, 17394.47it/s] 78%|███████▊  | 268341/343741 [00:11<00:03, 19916.81it/s] 79%|███████▉  | 271367/343741 [00:11<00:03, 22199.55it/s] 80%|███████▉  | 274371/343741 [00:11<00:02, 24078.98it/s] 81%|████████  | 277423/343741 [00:11<00:02, 25721.53it/s] 82%|████████▏ | 280395/343741 [00:11<00:02, 26788.69it/s] 82%|████████▏ | 283481/343741 [00:12<00:02, 27912.07it/s] 83%|████████▎ | 286480/343741 [00:12<00:02, 28426.84it/s] 84%|████████▍ | 289471/343741 [00:12<00:01, 28655.63it/s] 85%|████████▌ | 292454/343741 [00:12<00:01, 28992.11it/s] 86%|████████▌ | 295492/343741 [00:12<00:01, 29394.87it/s] 87%|████████▋ | 298485/343741 [00:12<00:01, 29496.55it/s] 88%|████████▊ | 301541/343741 [00:12<00:01, 29808.37it/s] 89%|████████▊ | 304596/343741 [00:12<00:01, 30026.94it/s] 89%|████████▉ | 307618/343741 [00:12<00:01, 30008.39it/s] 90%|█████████ | 310647/343741 [00:12<00:01, 30090.11it/s] 91%|█████████▏| 313666/343741 [00:13<00:01, 29995.15it/s] 92%|█████████▏| 316705/343741 [00:13<00:00, 30111.15it/s] 93%|█████████▎| 319721/343741 [00:13<00:00, 30078.86it/s] 94%|█████████▍| 322780/343741 [00:13<00:00, 30230.61it/s] 95%|█████████▍| 325806/343741 [00:13<00:00, 30186.60it/s] 96%|█████████▌| 328871/343741 [00:13<00:00, 30324.46it/s] 97%|█████████▋| 331905/343741 [00:13<00:00, 29924.29it/s] 97%|█████████▋| 334902/343741 [00:13<00:00, 29936.12it/s] 98%|█████████▊| 337926/343741 [00:13<00:00, 30024.90it/s] 99%|█████████▉| 340930/343741 [00:14<00:00, 29992.49it/s]100%|██████████| 343741/343741 [00:14<00:00, 24383.25it/s]
  0%|          | 0/56357 [00:00<?, ?it/s]  6%|▋         | 3583/56357 [00:00<00:01, 35819.53it/s] 13%|█▎        | 7165/56357 [00:00<00:01, 34400.38it/s] 19%|█▉        | 10609/56357 [00:00<00:01, 33678.44it/s] 25%|██▌       | 14162/56357 [00:00<00:01, 34385.82it/s] 31%|███▏      | 17671/56357 [00:00<00:01, 34632.45it/s] 38%|███▊      | 21349/56357 [00:00<00:00, 35353.30it/s] 44%|████▍     | 24887/56357 [00:00<00:00, 35343.60it/s] 51%|█████     | 28489/56357 [00:00<00:00, 35555.69it/s] 57%|█████▋    | 32066/56357 [00:00<00:00, 35620.58it/s] 63%|██████▎   | 35629/56357 [00:01<00:00, 35581.63it/s] 70%|██████▉   | 39188/56357 [00:01<00:00, 35513.98it/s] 76%|███████▌  | 42815/56357 [00:01<00:00, 35741.60it/s] 82%|████████▏ | 46390/56357 [00:01<00:00, 35605.75it/s] 89%|████████▊ | 49951/56357 [00:01<00:00, 35476.87it/s] 95%|█████████▍| 53499/56357 [00:01<00:00, 35476.58it/s]100%|██████████| 56357/56357 [00:01<00:00, 35312.56it/s]
  0%|          | 0/23248 [00:00<?, ?it/s] 17%|█▋        | 3844/23248 [00:00<00:00, 38402.50it/s] 33%|███▎      | 7685/23248 [00:00<00:00, 38313.42it/s] 50%|████▉     | 11556/23248 [00:00<00:00, 38489.18it/s] 66%|██████▋   | 15405/23248 [00:00<00:00, 38278.92it/s] 83%|████████▎ | 19273/23248 [00:00<00:00, 38420.37it/s] 99%|█████████▉| 23116/23248 [00:00<00:00, 38212.98it/s]100%|██████████| 23248/23248 [00:00<00:00, 38260.54it/s]
dataset loaded from path: 
data/ud/ud-treebanks-v2.1/UD_Spanish/inter-layer-17/UD_Spanish-train-bloom-1b1-intermediate-global_step200000.pkl
data/ud/ud-treebanks-v2.1/UD_Spanish/inter-layer-17/UD_Spanish-dev-bloom-1b1-intermediate-global_step200000.pkl
data/ud/ud-treebanks-v2.1/UD_Spanish/inter-layer-17/UD_Spanish-test-bloom-1b1-intermediate-global_step200000.pkl
Embedding dimensionality: 1536
Pre-training probe (if possible)...
Traceback (most recent call last):
  File "run.py", line 102, in <module>
    args.func(args)
  File "/home/s2308470/multilingual-typology-probing/commands.py", line 166, in greedy
    trainer.train()
  File "/home/s2308470/multilingual-typology-probing/probekit/trainers/trainer.py", line 21, in train
    self._train()
  File "/home/s2308470/multilingual-typology-probing/probekit/trainers/neural_probe_trainer.py", line 30, in _train
    self._train_for_dimensions()
  File "/home/s2308470/multilingual-typology-probing/trainers/flexible_neural_probe_trainer.py", line 72, in _train_for_dimensions
    inputs_tensor_shuffled = inputs_tensor[shuffled_indices]
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 1.63 GiB (GPU 0; 5.94 GiB total capacity; 4.18 GiB already allocated; 1.51 GiB free; 4.21 GiB reserved in total by PyTorch) If reserved memory is >> allocated memory try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF
