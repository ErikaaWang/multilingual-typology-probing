python run.py --language UD_Catalan --experiment-name inter-layer-17 --attribute POS --trainer poisson --gpu --embedding bloom-1b1-intermediate-global_step100000 greedy --selection-size 50 --selection-criterion mi
Setting up datasets (['UD_Catalan'], POS) and probes...
  0%|          | 0/441656 [00:00<?, ?it/s]  1%|          | 2291/441656 [00:00<00:19, 22901.78it/s]  1%|          | 5260/441656 [00:00<00:16, 26891.18it/s]  2%|▏         | 8257/441656 [00:00<00:15, 28293.89it/s]  3%|▎         | 11137/441656 [00:00<00:15, 28490.89it/s]  3%|▎         | 14111/441656 [00:00<00:14, 28940.07it/s]  4%|▍         | 17006/441656 [00:00<00:14, 28829.24it/s]  5%|▍         | 20001/441656 [00:00<00:14, 29194.03it/s]  5%|▌         | 23033/441656 [00:00<00:14, 29414.68it/s]  6%|▌         | 26008/441656 [00:00<00:14, 29512.83it/s]  7%|▋         | 28960/441656 [00:01<00:14, 29214.31it/s]  7%|▋         | 31883/441656 [00:01<00:14, 28677.71it/s]  8%|▊         | 34933/441656 [00:01<00:13, 29215.30it/s]  9%|▊         | 37858/441656 [00:01<00:36, 11002.02it/s]  9%|▉         | 40716/441656 [00:01<00:29, 13434.61it/s] 10%|▉         | 43737/441656 [00:02<00:24, 16203.66it/s] 11%|█         | 46497/441656 [00:02<00:21, 18377.73it/s] 11%|█         | 49493/441656 [00:02<00:18, 20858.28it/s] 12%|█▏        | 52497/441656 [00:02<00:16, 23007.93it/s] 13%|█▎        | 55454/441656 [00:02<00:15, 24652.52it/s] 13%|█▎        | 58468/441656 [00:02<00:14, 26098.69it/s] 14%|█▍        | 61423/441656 [00:02<00:14, 27040.66it/s] 15%|█▍        | 64392/441656 [00:02<00:13, 27784.32it/s] 15%|█▌        | 67327/441656 [00:02<00:13, 28024.82it/s] 16%|█▌        | 70314/441656 [00:02<00:13, 28555.91it/s] 17%|█▋        | 73290/441656 [00:03<00:12, 28906.78it/s] 17%|█▋        | 76267/441656 [00:03<00:12, 29159.45it/s] 18%|█▊        | 79241/441656 [00:03<00:12, 29330.35it/s] 19%|█▊        | 82203/441656 [00:03<00:12, 28829.13it/s] 19%|█▉        | 85216/441656 [00:03<00:12, 29210.40it/s] 20%|█▉        | 88153/441656 [00:04<00:36, 9736.02it/s]  21%|██        | 91105/441656 [00:04<00:28, 12173.55it/s] 21%|██▏       | 93934/441656 [00:04<00:23, 14585.72it/s] 22%|██▏       | 96893/441656 [00:04<00:20, 17228.31it/s] 23%|██▎       | 99802/441656 [00:04<00:17, 19612.23it/s] 23%|██▎       | 102833/441656 [00:04<00:15, 21997.96it/s] 24%|██▍       | 105834/441656 [00:04<00:14, 23932.36it/s] 25%|██▍       | 108758/441656 [00:04<00:13, 25294.19it/s] 25%|██▌       | 111701/441656 [00:05<00:12, 26400.06it/s] 26%|██▌       | 114680/441656 [00:05<00:11, 27337.40it/s] 27%|██▋       | 117608/441656 [00:05<00:11, 27864.24it/s] 27%|██▋       | 120610/441656 [00:05<00:11, 28483.08it/s] 28%|██▊       | 123645/441656 [00:05<00:10, 29025.16it/s] 29%|██▊       | 126619/441656 [00:05<00:10, 28853.19it/s] 29%|██▉       | 129555/441656 [00:05<00:10, 28664.69it/s] 30%|███       | 132566/441656 [00:05<00:10, 29085.85it/s] 31%|███       | 135501/441656 [00:05<00:10, 29072.10it/s] 31%|███▏      | 138538/441656 [00:05<00:10, 29452.46it/s] 32%|███▏      | 141509/441656 [00:06<00:10, 29527.19it/s] 33%|███▎      | 144559/441656 [00:06<00:09, 29814.39it/s] 33%|███▎      | 147548/441656 [00:06<00:09, 29738.37it/s] 34%|███▍      | 150527/441656 [00:07<00:38, 7594.44it/s]  35%|███▍      | 153553/441656 [00:07<00:29, 9817.14it/s] 35%|███▌      | 156471/441656 [00:07<00:23, 12196.32it/s] 36%|███▌      | 159328/441656 [00:07<00:19, 14640.90it/s] 37%|███▋      | 162198/441656 [00:07<00:16, 17111.80it/s] 37%|███▋      | 165264/441656 [00:07<00:13, 19830.97it/s] 38%|███▊      | 168089/441656 [00:07<00:12, 21551.47it/s] 39%|███▊      | 170960/441656 [00:08<00:11, 23270.11it/s] 39%|███▉      | 173973/441656 [00:08<00:10, 25021.40it/s] 40%|████      | 176946/441656 [00:08<00:10, 26279.34it/s] 41%|████      | 179980/441656 [00:08<00:09, 27399.49it/s] 41%|████▏     | 183022/441656 [00:08<00:09, 28253.02it/s] 42%|████▏     | 185996/441656 [00:08<00:08, 28505.84it/s] 43%|████▎     | 189008/441656 [00:08<00:08, 28972.61it/s] 43%|████▎     | 192010/441656 [00:08<00:08, 29277.24it/s] 44%|████▍     | 195027/441656 [00:08<00:08, 29537.96it/s] 45%|████▍     | 198019/441656 [00:08<00:08, 29419.84it/s] 46%|████▌     | 200988/441656 [00:09<00:08, 28859.04it/s] 46%|████▌     | 203957/441656 [00:09<00:08, 29100.25it/s] 47%|████▋     | 206882/441656 [00:09<00:08, 29087.02it/s] 48%|████▊     | 209937/441656 [00:09<00:07, 29517.50it/s] 48%|████▊     | 212897/441656 [00:09<00:07, 29399.10it/s] 49%|████▉     | 215970/441656 [00:09<00:07, 29790.10it/s] 50%|████▉     | 218954/441656 [00:09<00:07, 29511.92it/s] 50%|█████     | 221909/441656 [00:09<00:07, 29343.59it/s] 51%|█████     | 224898/441656 [00:09<00:07, 29504.82it/s] 52%|█████▏    | 227851/441656 [00:09<00:07, 29277.61it/s] 52%|█████▏    | 230781/441656 [00:11<00:31, 6668.37it/s]  53%|█████▎    | 233590/441656 [00:11<00:24, 8552.40it/s] 54%|█████▎    | 236402/441656 [00:11<00:19, 10736.23it/s] 54%|█████▍    | 239327/441656 [00:11<00:15, 13282.09it/s] 55%|█████▍    | 242273/441656 [00:11<00:12, 15938.18it/s] 56%|█████▌    | 245278/441656 [00:11<00:10, 18618.73it/s] 56%|█████▌    | 248250/441656 [00:11<00:09, 20986.96it/s] 57%|█████▋    | 251121/441656 [00:11<00:08, 22789.62it/s] 58%|█████▊    | 254135/441656 [00:12<00:07, 24627.42it/s] 58%|█████▊    | 257099/441656 [00:12<00:07, 25946.53it/s] 59%|█████▉    | 260093/441656 [00:12<00:06, 27037.35it/s] 60%|█████▉    | 263118/441656 [00:12<00:06, 27937.84it/s] 60%|██████    | 266086/441656 [00:12<00:06, 28233.02it/s] 61%|██████    | 269032/441656 [00:12<00:06, 28565.97it/s] 62%|██████▏   | 271980/441656 [00:12<00:05, 28830.09it/s] 62%|██████▏   | 274962/441656 [00:12<00:05, 29119.84it/s] 63%|██████▎   | 277918/441656 [00:12<00:05, 29194.95it/s] 64%|██████▎   | 280979/441656 [00:12<00:05, 29612.09it/s] 64%|██████▍   | 283983/441656 [00:13<00:05, 29737.25it/s] 65%|██████▍   | 286973/441656 [00:13<00:05, 29379.97it/s] 66%|██████▌   | 290009/441656 [00:13<00:05, 29669.02it/s] 66%|██████▋   | 292985/441656 [00:13<00:05, 29602.12it/s] 67%|██████▋   | 295952/441656 [00:13<00:04, 29551.71it/s] 68%|██████▊   | 298931/441656 [00:13<00:04, 29621.17it/s] 68%|██████▊   | 301942/441656 [00:13<00:04, 29765.60it/s] 69%|██████▉   | 304921/441656 [00:13<00:04, 29279.08it/s] 70%|██████▉   | 307853/441656 [00:13<00:04, 29199.11it/s] 70%|███████   | 310894/441656 [00:13<00:04, 29556.16it/s] 71%|███████   | 313852/441656 [00:14<00:04, 29126.92it/s] 72%|███████▏  | 316871/441656 [00:14<00:04, 29439.76it/s] 72%|███████▏  | 319831/441656 [00:14<00:04, 29270.73it/s] 73%|███████▎  | 322872/441656 [00:14<00:04, 29604.93it/s] 74%|███████▍  | 325896/441656 [00:14<00:03, 29792.05it/s] 74%|███████▍  | 328877/441656 [00:15<00:17, 6465.25it/s]  75%|███████▌  | 331660/441656 [00:15<00:13, 8271.60it/s] 76%|███████▌  | 334396/441656 [00:15<00:10, 10328.78it/s] 76%|███████▋  | 337043/441656 [00:16<00:08, 12481.93it/s] 77%|███████▋  | 339780/441656 [00:16<00:06, 14865.12it/s] 78%|███████▊  | 342570/441656 [00:16<00:05, 17290.66it/s] 78%|███████▊  | 345230/441656 [00:16<00:05, 19245.32it/s] 79%|███████▉  | 347945/441656 [00:16<00:04, 21068.70it/s] 79%|███████▉  | 350668/441656 [00:16<00:04, 22595.11it/s] 80%|████████  | 353353/441656 [00:16<00:03, 23376.99it/s] 81%|████████  | 355997/441656 [00:16<00:03, 24165.26it/s] 81%|████████  | 358714/441656 [00:16<00:03, 24996.82it/s] 82%|████████▏ | 361412/441656 [00:16<00:03, 25558.34it/s] 82%|████████▏ | 364105/441656 [00:17<00:03, 25807.25it/s] 83%|████████▎ | 366832/441656 [00:17<00:02, 26223.54it/s] 84%|████████▎ | 369571/441656 [00:17<00:02, 26562.83it/s] 84%|████████▍ | 372331/441656 [00:17<00:02, 26866.75it/s] 85%|████████▍ | 375048/441656 [00:17<00:02, 26325.55it/s] 86%|████████▌ | 377803/441656 [00:17<00:02, 26681.94it/s] 86%|████████▌ | 380532/441656 [00:17<00:02, 26858.09it/s] 87%|████████▋ | 383231/441656 [00:17<00:02, 26783.98it/s] 87%|████████▋ | 385960/441656 [00:17<00:02, 26933.23it/s] 88%|████████▊ | 388670/441656 [00:17<00:01, 26981.38it/s] 89%|████████▊ | 391373/441656 [00:18<00:01, 26733.89it/s] 89%|████████▉ | 394050/441656 [00:18<00:01, 26713.37it/s] 90%|████████▉ | 396725/441656 [00:18<00:01, 26721.57it/s] 90%|█████████ | 399450/441656 [00:18<00:01, 26878.20it/s] 91%|█████████ | 402140/441656 [00:18<00:01, 26705.66it/s] 92%|█████████▏| 404876/441656 [00:18<00:01, 26897.80it/s] 92%|█████████▏| 407606/441656 [00:18<00:01, 27015.14it/s] 93%|█████████▎| 410309/441656 [00:18<00:01, 26844.28it/s] 94%|█████████▎| 412995/441656 [00:18<00:01, 26843.86it/s] 94%|█████████▍| 415692/441656 [00:18<00:00, 26880.88it/s] 95%|█████████▍| 418381/441656 [00:19<00:00, 26852.52it/s] 95%|█████████▌| 421067/441656 [00:19<00:00, 26756.80it/s] 96%|█████████▌| 423780/441656 [00:19<00:00, 26867.17it/s] 97%|█████████▋| 426467/441656 [00:19<00:00, 26657.44it/s] 97%|█████████▋| 429179/441656 [00:19<00:00, 26792.30it/s] 98%|█████████▊| 431859/441656 [00:19<00:00, 26159.84it/s] 98%|█████████▊| 434554/441656 [00:19<00:00, 26389.75it/s] 99%|█████████▉| 437323/441656 [00:19<00:00, 26772.47it/s]100%|█████████▉| 440031/441656 [00:19<00:00, 26861.96it/s]100%|██████████| 441656/441656 [00:19<00:00, 22139.04it/s]
  0%|          | 0/53198 [00:00<?, ?it/s]  6%|▌         | 3139/53198 [00:00<00:01, 31387.19it/s] 12%|█▏        | 6505/53198 [00:00<00:01, 32722.54it/s] 18%|█▊        | 9778/53198 [00:00<00:01, 32412.60it/s] 25%|██▍       | 13117/53198 [00:00<00:01, 32534.89it/s] 31%|███       | 16511/53198 [00:00<00:01, 33036.46it/s] 37%|███▋      | 19949/53198 [00:00<00:00, 33487.87it/s] 44%|████▍     | 23341/53198 [00:00<00:00, 33626.50it/s] 50%|█████     | 26751/53198 [00:00<00:00, 33774.30it/s] 57%|█████▋    | 30129/53198 [00:00<00:00, 33243.67it/s] 63%|██████▎   | 33578/53198 [00:01<00:00, 33621.13it/s] 69%|██████▉   | 36942/53198 [00:01<00:00, 33387.39it/s] 76%|███████▌  | 40360/53198 [00:01<00:00, 33623.39it/s] 82%|████████▏ | 43724/53198 [00:01<00:00, 33332.98it/s] 88%|████████▊ | 47059/53198 [00:01<00:00, 32973.46it/s] 95%|█████████▍| 50506/53198 [00:01<00:00, 33415.69it/s]100%|██████████| 53198/53198 [00:01<00:00, 33245.93it/s]
  0%|          | 0/35912 [00:00<?, ?it/s] 10%|▉         | 3494/35912 [00:00<00:00, 34930.29it/s] 20%|█▉        | 7065/35912 [00:00<00:00, 35387.47it/s] 30%|███       | 10783/35912 [00:00<00:00, 36204.43it/s] 40%|████      | 14463/35912 [00:00<00:00, 36436.91it/s] 50%|█████     | 18107/35912 [00:00<00:00, 34818.90it/s] 60%|██████    | 21601/35912 [00:00<00:00, 33767.51it/s] 70%|██████▉   | 24989/35912 [00:00<00:00, 33724.66it/s] 79%|███████▉  | 28369/35912 [00:00<00:00, 33598.27it/s] 88%|████████▊ | 31776/35912 [00:00<00:00, 33741.12it/s] 98%|█████████▊| 35154/35912 [00:01<00:00, 33008.99it/s]100%|██████████| 35912/35912 [00:01<00:00, 34073.93it/s]
dataset loaded from path: 
data/ud/ud-treebanks-v2.1/UD_Catalan/inter-layer-17/UD_Catalan-train-bloom-1b1-intermediate-global_step100000.pkl
data/ud/ud-treebanks-v2.1/UD_Catalan/inter-layer-17/UD_Catalan-dev-bloom-1b1-intermediate-global_step100000.pkl
data/ud/ud-treebanks-v2.1/UD_Catalan/inter-layer-17/UD_Catalan-test-bloom-1b1-intermediate-global_step100000.pkl
Embedding dimensionality: 1536
Pre-training probe (if possible)...
Traceback (most recent call last):
  File "run.py", line 102, in <module>
    args.func(args)
  File "/home/s2308470/multilingual-typology-probing/commands.py", line 166, in greedy
    trainer.train()
  File "/home/s2308470/multilingual-typology-probing/probekit/trainers/trainer.py", line 21, in train
    self._train()
  File "/home/s2308470/multilingual-typology-probing/probekit/trainers/neural_probe_trainer.py", line 30, in _train
    self._train_for_dimensions()
  File "/home/s2308470/multilingual-typology-probing/trainers/flexible_neural_probe_trainer.py", line 72, in _train_for_dimensions
    inputs_tensor_shuffled = inputs_tensor[shuffled_indices]
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 2.21 GiB (GPU 0; 5.94 GiB total capacity; 5.41 GiB already allocated; 285.31 MiB free; 5.44 GiB reserved in total by PyTorch) If reserved memory is >> allocated memory try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF
