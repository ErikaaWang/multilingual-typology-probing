python run.py --language UD_Catalan --experiment-name inter-layer-13 --attribute POS --trainer poisson --gpu --embedding bloom-1b1-intermediate-global_step300000 greedy --selection-size 50 --selection-criterion mi
Setting up datasets (['UD_Catalan'], POS) and probes...
  0%|          | 0/441656 [00:00<?, ?it/s]  0%|          | 2194/441656 [00:00<00:20, 21931.86it/s]  1%|          | 5055/441656 [00:00<00:16, 25858.80it/s]  2%|▏         | 7966/441656 [00:00<00:15, 27340.79it/s]  2%|▏         | 10793/441656 [00:00<00:15, 27703.71it/s]  3%|▎         | 13668/441656 [00:00<00:15, 28080.26it/s]  4%|▎         | 16538/441656 [00:00<00:15, 28288.62it/s]  4%|▍         | 19407/441656 [00:00<00:14, 28416.60it/s]  5%|▌         | 22291/441656 [00:00<00:14, 28547.91it/s]  6%|▌         | 25151/441656 [00:00<00:14, 28562.86it/s]  6%|▋         | 28061/441656 [00:01<00:14, 28726.55it/s]  7%|▋         | 30974/441656 [00:01<00:14, 28847.45it/s]  8%|▊         | 33859/441656 [00:01<00:14, 28331.54it/s]  8%|▊         | 36695/441656 [00:01<00:35, 11458.32it/s]  9%|▉         | 39566/441656 [00:01<00:28, 13999.31it/s] 10%|▉         | 42384/441656 [00:01<00:24, 16464.34it/s] 10%|█         | 45211/441656 [00:02<00:21, 18811.95it/s] 11%|█         | 48090/441656 [00:02<00:18, 21018.49it/s] 11%|█▏        | 50768/441656 [00:02<00:17, 22131.26it/s] 12%|█▏        | 53407/441656 [00:02<00:16, 23159.64it/s] 13%|█▎        | 56039/441656 [00:02<00:16, 23924.17it/s] 13%|█▎        | 58662/441656 [00:02<00:15, 24503.30it/s] 14%|█▍        | 61279/441656 [00:02<00:15, 24791.07it/s] 14%|█▍        | 63905/441656 [00:02<00:14, 25208.09it/s] 15%|█▌        | 66511/441656 [00:02<00:14, 25358.43it/s] 16%|█▌        | 69125/441656 [00:03<00:14, 25585.61it/s] 16%|█▌        | 71727/441656 [00:03<00:14, 25614.07it/s] 17%|█▋        | 74595/441656 [00:03<00:13, 26515.95it/s] 18%|█▊        | 77377/441656 [00:03<00:13, 26901.67it/s] 18%|█▊        | 80084/441656 [00:03<00:13, 26852.24it/s] 19%|█▊        | 82781/441656 [00:03<00:13, 26618.19it/s] 19%|█▉        | 85452/441656 [00:03<00:13, 26457.35it/s] 20%|█▉        | 88104/441656 [00:04<00:35, 9948.84it/s]  21%|██        | 90658/441656 [00:04<00:29, 12085.23it/s] 21%|██        | 93289/441656 [00:04<00:24, 14413.77it/s] 22%|██▏       | 95750/441656 [00:04<00:21, 16345.30it/s] 22%|██▏       | 98391/441656 [00:04<00:18, 18488.57it/s] 23%|██▎       | 101014/441656 [00:04<00:16, 20293.06it/s] 23%|██▎       | 103590/441656 [00:04<00:15, 21657.66it/s] 24%|██▍       | 106210/441656 [00:04<00:14, 22851.46it/s] 25%|██▍       | 108842/441656 [00:05<00:13, 23797.88it/s] 25%|██▌       | 111457/441656 [00:05<00:13, 24456.49it/s] 26%|██▌       | 114042/441656 [00:05<00:13, 24836.44it/s] 26%|██▋       | 116657/441656 [00:05<00:12, 25213.35it/s] 27%|██▋       | 119270/441656 [00:05<00:12, 25480.40it/s] 28%|██▊       | 121875/441656 [00:05<00:12, 25647.07it/s] 28%|██▊       | 124476/441656 [00:05<00:12, 25260.18it/s] 29%|██▉       | 127084/441656 [00:05<00:12, 25499.08it/s] 29%|██▉       | 129695/441656 [00:05<00:12, 25676.97it/s] 30%|██▉       | 132310/441656 [00:05<00:11, 25814.28it/s] 31%|███       | 134901/441656 [00:06<00:11, 25736.16it/s] 31%|███       | 137542/441656 [00:06<00:11, 25933.53it/s] 32%|███▏      | 140160/441656 [00:06<00:11, 26004.05it/s] 32%|███▏      | 142788/441656 [00:06<00:11, 26085.71it/s] 33%|███▎      | 145399/441656 [00:06<00:11, 25951.28it/s] 34%|███▎      | 148023/441656 [00:06<00:11, 26035.86it/s] 34%|███▍      | 150628/441656 [00:07<00:33, 8811.11it/s]  35%|███▍      | 153241/441656 [00:07<00:26, 10996.26it/s] 35%|███▌      | 155855/441656 [00:07<00:21, 13286.31it/s] 36%|███▌      | 158467/441656 [00:07<00:18, 15580.91it/s] 36%|███▋      | 161067/441656 [00:07<00:15, 17699.90it/s] 37%|███▋      | 163677/441656 [00:07<00:14, 19589.80it/s] 38%|███▊      | 166258/441656 [00:07<00:13, 21101.74it/s] 38%|███▊      | 168776/441656 [00:08<00:12, 21895.94it/s] 39%|███▉      | 171359/441656 [00:08<00:11, 22945.67it/s] 39%|███▉      | 173974/441656 [00:08<00:11, 23829.14it/s] 40%|███▉      | 176564/441656 [00:08<00:10, 24413.93it/s] 41%|████      | 179122/441656 [00:08<00:10, 24685.55it/s] 41%|████      | 181731/441656 [00:08<00:10, 25091.79it/s] 42%|████▏     | 184348/441656 [00:08<00:10, 25406.89it/s] 42%|████▏     | 186945/441656 [00:08<00:09, 25570.99it/s] 43%|████▎     | 189532/441656 [00:08<00:09, 25513.87it/s] 44%|████▎     | 192137/441656 [00:08<00:09, 25670.64it/s] 44%|████▍     | 194763/441656 [00:09<00:09, 25843.48it/s] 45%|████▍     | 197358/441656 [00:09<00:09, 25482.46it/s] 45%|████▌     | 199955/441656 [00:09<00:09, 25566.76it/s] 46%|████▌     | 202565/441656 [00:09<00:09, 25722.08it/s] 46%|████▋     | 205175/441656 [00:09<00:09, 25833.34it/s] 47%|████▋     | 207762/441656 [00:09<00:09, 25842.06it/s] 48%|████▊     | 210368/441656 [00:09<00:08, 25905.99it/s] 48%|████▊     | 212961/441656 [00:09<00:08, 25788.53it/s] 49%|████▉     | 215547/441656 [00:09<00:08, 25807.35it/s] 49%|████▉     | 218137/441656 [00:09<00:08, 25833.02it/s] 50%|████▉     | 220742/441656 [00:10<00:08, 25896.87it/s] 51%|█████     | 223333/441656 [00:10<00:08, 25751.47it/s] 51%|█████     | 225909/441656 [00:10<00:08, 25511.09it/s] 52%|█████▏    | 228501/441656 [00:10<00:08, 25630.66it/s] 52%|█████▏    | 231065/441656 [00:11<00:27, 7754.47it/s]  53%|█████▎    | 233656/441656 [00:11<00:21, 9824.39it/s] 53%|█████▎    | 236071/441656 [00:11<00:17, 11830.33it/s] 54%|█████▍    | 238675/441656 [00:11<00:14, 14198.49it/s] 55%|█████▍    | 241230/441656 [00:11<00:12, 16380.91it/s] 55%|█████▌    | 243836/441656 [00:11<00:10, 18466.98it/s] 56%|█████▌    | 246345/441656 [00:11<00:09, 20025.17it/s] 56%|█████▋    | 248959/441656 [00:11<00:08, 21563.40it/s] 57%|█████▋    | 251518/441656 [00:12<00:08, 22626.32it/s] 58%|█████▊    | 254125/441656 [00:12<00:07, 23569.41it/s] 58%|█████▊    | 256704/441656 [00:12<00:07, 24193.52it/s] 59%|█████▊    | 259274/441656 [00:12<00:07, 24624.40it/s] 59%|█████▉    | 261850/441656 [00:12<00:07, 24953.18it/s] 60%|█████▉    | 264417/441656 [00:12<00:07, 24942.48it/s] 60%|██████    | 267029/441656 [00:12<00:06, 25285.92it/s] 61%|██████    | 269606/441656 [00:12<00:06, 25427.54it/s] 62%|██████▏   | 272174/441656 [00:12<00:06, 25419.46it/s] 62%|██████▏   | 274778/441656 [00:12<00:06, 25601.60it/s] 63%|██████▎   | 277351/441656 [00:13<00:06, 25611.24it/s] 63%|██████▎   | 279927/441656 [00:13<00:06, 25539.49it/s] 64%|██████▍   | 282513/441656 [00:13<00:06, 25632.48it/s] 65%|██████▍   | 285100/441656 [00:13<00:06, 25700.27it/s] 65%|██████▌   | 287692/441656 [00:13<00:05, 25764.32it/s] 66%|██████▌   | 290296/441656 [00:13<00:05, 25844.81it/s] 66%|██████▋   | 292883/441656 [00:13<00:05, 25419.05it/s] 67%|██████▋   | 295480/441656 [00:13<00:05, 25579.70it/s] 67%|██████▋   | 298069/441656 [00:13<00:05, 25669.75it/s] 68%|██████▊   | 300651/441656 [00:13<00:05, 25712.67it/s] 69%|██████▊   | 303224/441656 [00:14<00:05, 25614.40it/s] 69%|██████▉   | 305810/441656 [00:14<00:05, 25682.53it/s] 70%|██████▉   | 308379/441656 [00:14<00:05, 25675.19it/s] 70%|███████   | 310962/441656 [00:14<00:05, 25720.35it/s] 71%|███████   | 313535/441656 [00:14<00:05, 25560.39it/s] 72%|███████▏  | 316112/441656 [00:14<00:04, 25621.57it/s] 72%|███████▏  | 318675/441656 [00:14<00:04, 25583.70it/s] 73%|███████▎  | 321253/441656 [00:14<00:04, 25640.16it/s] 73%|███████▎  | 323818/441656 [00:14<00:04, 25119.05it/s] 74%|███████▍  | 326357/441656 [00:14<00:04, 25196.60it/s] 74%|███████▍  | 328879/441656 [00:16<00:19, 5905.12it/s]  75%|███████▌  | 331457/441656 [00:16<00:14, 7699.35it/s] 76%|███████▌  | 334037/441656 [00:16<00:11, 9766.79it/s] 76%|███████▌  | 336646/441656 [00:16<00:08, 12056.32it/s] 77%|███████▋  | 339207/441656 [00:16<00:07, 14318.35it/s] 77%|███████▋  | 341829/441656 [00:16<00:06, 16609.34it/s] 78%|███████▊  | 344404/441656 [00:16<00:05, 18580.43it/s] 79%|███████▊  | 346959/441656 [00:16<00:04, 20220.56it/s] 79%|███████▉  | 349475/441656 [00:16<00:04, 21311.69it/s] 80%|███████▉  | 352073/441656 [00:17<00:03, 22539.39it/s] 80%|████████  | 354677/441656 [00:17<00:03, 23493.89it/s] 81%|████████  | 357291/441656 [00:17<00:03, 24235.00it/s] 81%|████████▏ | 359901/441656 [00:17<00:03, 24648.53it/s] 82%|████████▏ | 362507/441656 [00:17<00:03, 25053.84it/s] 83%|████████▎ | 365113/441656 [00:17<00:03, 25346.74it/s] 83%|████████▎ | 367717/441656 [00:17<00:02, 25550.55it/s] 84%|████████▍ | 370326/441656 [00:17<00:02, 25707.41it/s] 84%|████████▍ | 372923/441656 [00:17<00:02, 25617.29it/s] 85%|████████▌ | 375535/441656 [00:17<00:02, 25765.89it/s] 86%|████████▌ | 378125/441656 [00:18<00:02, 25431.70it/s] 86%|████████▌ | 380748/441656 [00:18<00:02, 25665.16it/s] 87%|████████▋ | 383322/441656 [00:18<00:02, 25625.70it/s] 87%|████████▋ | 385947/441656 [00:18<00:02, 25809.54it/s] 88%|████████▊ | 388535/441656 [00:18<00:02, 25829.59it/s] 89%|████████▊ | 391183/441656 [00:18<00:01, 26022.68it/s] 89%|████████▉ | 393788/441656 [00:18<00:01, 25899.89it/s] 90%|████████▉ | 396411/441656 [00:18<00:01, 25996.58it/s] 90%|█████████ | 399012/441656 [00:18<00:01, 25848.95it/s] 91%|█████████ | 401626/441656 [00:18<00:01, 25933.14it/s] 92%|█████████▏| 404220/441656 [00:19<00:01, 25519.03it/s] 92%|█████████▏| 406825/441656 [00:19<00:01, 25673.90it/s] 93%|█████████▎| 409437/441656 [00:19<00:01, 25805.63it/s] 93%|█████████▎| 412053/441656 [00:19<00:01, 25908.63it/s] 94%|█████████▍| 414645/441656 [00:19<00:01, 25818.14it/s] 94%|█████████▍| 417245/441656 [00:19<00:00, 25870.23it/s] 95%|█████████▌| 419837/441656 [00:19<00:00, 25881.90it/s] 96%|█████████▌| 422437/441656 [00:19<00:00, 25915.45it/s] 96%|█████████▌| 425029/441656 [00:19<00:00, 25704.73it/s] 97%|█████████▋| 427625/441656 [00:19<00:00, 25778.93it/s] 97%|█████████▋| 430204/441656 [00:20<00:00, 25763.83it/s] 98%|█████████▊| 432798/441656 [00:20<00:00, 25815.26it/s] 99%|█████████▊| 435380/441656 [00:20<00:00, 25499.71it/s] 99%|█████████▉| 437931/441656 [00:20<00:00, 25437.34it/s]100%|█████████▉| 440532/441656 [00:20<00:00, 25605.90it/s]100%|██████████| 441656/441656 [00:20<00:00, 21499.09it/s]
  0%|          | 0/53198 [00:00<?, ?it/s]  6%|▋         | 3397/53198 [00:00<00:01, 33959.91it/s] 13%|█▎        | 6817/53198 [00:00<00:01, 33772.28it/s] 19%|█▉        | 10310/53198 [00:00<00:01, 34294.63it/s] 26%|██▌       | 13740/53198 [00:00<00:01, 33906.14it/s] 33%|███▎      | 17317/53198 [00:00<00:01, 34384.41it/s] 39%|███▉      | 20857/53198 [00:00<00:00, 34724.36it/s] 46%|████▌     | 24331/53198 [00:00<00:00, 33970.20it/s] 52%|█████▏    | 27837/53198 [00:00<00:00, 34307.09it/s] 59%|█████▉    | 31407/53198 [00:00<00:00, 34735.26it/s] 66%|██████▌   | 34884/53198 [00:01<00:00, 34717.59it/s] 72%|███████▏  | 38358/53198 [00:01<00:00, 34656.69it/s] 79%|███████▊  | 41871/53198 [00:01<00:00, 34799.23it/s] 85%|████████▌ | 45352/53198 [00:01<00:00, 34703.12it/s] 92%|█████████▏| 48823/53198 [00:01<00:00, 34653.98it/s] 98%|█████████▊| 52289/53198 [00:01<00:00, 34264.34it/s]100%|██████████| 53198/53198 [00:01<00:00, 34253.83it/s]
  0%|          | 0/35912 [00:00<?, ?it/s] 10%|▉         | 3459/35912 [00:00<00:00, 34581.05it/s] 19%|█▉        | 6923/35912 [00:00<00:00, 34611.08it/s] 29%|██▉       | 10401/35912 [00:00<00:00, 34683.65it/s] 39%|███▊      | 13875/35912 [00:00<00:00, 34702.87it/s] 48%|████▊     | 17346/35912 [00:00<00:00, 34396.03it/s] 58%|█████▊    | 20787/35912 [00:00<00:00, 32915.00it/s] 67%|██████▋   | 24090/35912 [00:00<00:00, 32642.75it/s] 77%|███████▋  | 27541/35912 [00:00<00:00, 33217.21it/s] 86%|████████▋ | 31002/35912 [00:00<00:00, 33640.69it/s] 96%|█████████▌| 34391/35912 [00:01<00:00, 33715.71it/s]100%|██████████| 35912/35912 [00:01<00:00, 33820.27it/s]
dataset loaded from path: 
data/ud/ud-treebanks-v2.1/UD_Catalan/inter-layer-13/UD_Catalan-train-bloom-1b1-intermediate-global_step300000.pkl
data/ud/ud-treebanks-v2.1/UD_Catalan/inter-layer-13/UD_Catalan-dev-bloom-1b1-intermediate-global_step300000.pkl
data/ud/ud-treebanks-v2.1/UD_Catalan/inter-layer-13/UD_Catalan-test-bloom-1b1-intermediate-global_step300000.pkl
Embedding dimensionality: 1536
Pre-training probe (if possible)...
Traceback (most recent call last):
  File "run.py", line 102, in <module>
    args.func(args)
  File "/home/s2308470/multilingual-typology-probing/commands.py", line 166, in greedy
    trainer.train()
  File "/home/s2308470/multilingual-typology-probing/probekit/trainers/trainer.py", line 21, in train
    self._train()
  File "/home/s2308470/multilingual-typology-probing/probekit/trainers/neural_probe_trainer.py", line 30, in _train
    self._train_for_dimensions()
  File "/home/s2308470/multilingual-typology-probing/trainers/flexible_neural_probe_trainer.py", line 72, in _train_for_dimensions
    inputs_tensor_shuffled = inputs_tensor[shuffled_indices]
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 2.21 GiB (GPU 0; 5.94 GiB total capacity; 5.41 GiB already allocated; 285.31 MiB free; 5.44 GiB reserved in total by PyTorch) If reserved memory is >> allocated memory try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF
