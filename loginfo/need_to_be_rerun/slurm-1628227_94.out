python run.py --language UD_Spanish --experiment-name inter-layer-17 --attribute POS --trainer poisson --gpu --embedding bloom-1b1-intermediate-global_step100000 greedy --selection-size 50 --selection-criterion mi
Setting up datasets (['UD_Spanish'], POS) and probes...
  0%|          | 0/343741 [00:00<?, ?it/s]  0%|          | 1625/343741 [00:00<00:21, 16247.07it/s]  1%|          | 3767/343741 [00:00<00:17, 19288.19it/s]  2%|▏         | 5903/343741 [00:00<00:16, 20229.77it/s]  2%|▏         | 8059/343741 [00:00<00:16, 20753.47it/s]  3%|▎         | 10201/343741 [00:00<00:15, 20991.14it/s]  4%|▎         | 12360/343741 [00:00<00:15, 21192.58it/s]  4%|▍         | 14487/343741 [00:00<00:15, 21215.71it/s]  5%|▍         | 16629/343741 [00:00<00:15, 21279.04it/s]  5%|▌         | 18785/343741 [00:00<00:15, 21363.93it/s]  6%|▌         | 20922/343741 [00:01<00:31, 10254.50it/s]  7%|▋         | 23042/343741 [00:01<00:26, 12165.30it/s]  7%|▋         | 25028/343741 [00:01<00:23, 13700.90it/s]  8%|▊         | 27020/343741 [00:01<00:21, 15079.58it/s]  8%|▊         | 29087/343741 [00:01<00:19, 16424.47it/s]  9%|▉         | 31215/343741 [00:01<00:17, 17664.47it/s] 10%|▉         | 33353/343741 [00:01<00:16, 18657.93it/s] 10%|█         | 35485/343741 [00:02<00:15, 19393.02it/s] 11%|█         | 37618/343741 [00:02<00:15, 19939.21it/s] 12%|█▏        | 39753/343741 [00:02<00:14, 20343.33it/s] 12%|█▏        | 41904/343741 [00:02<00:14, 20682.61it/s] 13%|█▎        | 44047/343741 [00:02<00:14, 20899.32it/s] 13%|█▎        | 46194/343741 [00:02<00:14, 21066.74it/s] 14%|█▍        | 48338/343741 [00:02<00:13, 21175.17it/s] 15%|█▍        | 50473/343741 [00:02<00:14, 20573.45it/s] 15%|█▌        | 52546/343741 [00:02<00:14, 20324.65it/s] 16%|█▌        | 54590/343741 [00:02<00:14, 20216.49it/s] 16%|█▋        | 56620/343741 [00:03<00:14, 20160.01it/s] 17%|█▋        | 58642/343741 [00:03<00:14, 20136.41it/s] 18%|█▊        | 60660/343741 [00:03<00:31, 8924.86it/s]  18%|█▊        | 62682/343741 [00:03<00:26, 10702.23it/s] 19%|█▉        | 64563/343741 [00:03<00:22, 12190.43it/s] 19%|█▉        | 66552/343741 [00:03<00:20, 13789.17it/s] 20%|█▉        | 68537/343741 [00:04<00:18, 15174.96it/s] 21%|██        | 70529/343741 [00:04<00:16, 16342.30it/s] 21%|██        | 72516/343741 [00:04<00:15, 17260.00it/s] 22%|██▏       | 74510/343741 [00:04<00:14, 17983.67it/s] 22%|██▏       | 76513/343741 [00:04<00:14, 18554.23it/s] 23%|██▎       | 78517/343741 [00:04<00:13, 18975.87it/s] 23%|██▎       | 80537/343741 [00:04<00:13, 19329.16it/s] 24%|██▍       | 82533/343741 [00:04<00:13, 19512.82it/s] 25%|██▍       | 84547/343741 [00:04<00:13, 19696.37it/s] 25%|██▌       | 86545/343741 [00:05<00:13, 19452.61it/s] 26%|██▌       | 88528/343741 [00:05<00:13, 19563.04it/s] 26%|██▋       | 90499/343741 [00:05<00:12, 19508.43it/s] 27%|██▋       | 92498/343741 [00:05<00:12, 19649.42it/s] 27%|██▋       | 94509/343741 [00:05<00:12, 19785.76it/s] 28%|██▊       | 96509/343741 [00:05<00:12, 19847.73it/s] 29%|██▊       | 98516/343741 [00:05<00:12, 19911.32it/s] 29%|██▉       | 100549/343741 [00:05<00:12, 20034.42it/s] 30%|██▉       | 102555/343741 [00:05<00:12, 20009.06it/s] 30%|███       | 104558/343741 [00:05<00:11, 19984.46it/s] 31%|███       | 106558/343741 [00:06<00:11, 19980.48it/s] 32%|███▏      | 108557/343741 [00:06<00:11, 19727.49it/s] 32%|███▏      | 110545/343741 [00:06<00:11, 19769.81it/s] 33%|███▎      | 112523/343741 [00:06<00:28, 8118.74it/s]  33%|███▎      | 114527/343741 [00:06<00:23, 9890.25it/s] 34%|███▍      | 116513/343741 [00:06<00:19, 11636.34it/s] 34%|███▍      | 118518/343741 [00:07<00:16, 13319.13it/s] 35%|███▌      | 120510/343741 [00:07<00:15, 14785.98it/s] 36%|███▌      | 122431/343741 [00:07<00:13, 15849.94it/s] 36%|███▌      | 124436/343741 [00:07<00:12, 16925.09it/s] 37%|███▋      | 126429/343741 [00:07<00:12, 17728.90it/s] 37%|███▋      | 128438/343741 [00:07<00:11, 18381.74it/s] 38%|███▊      | 130437/343741 [00:07<00:11, 18834.93it/s] 39%|███▊      | 132435/343741 [00:07<00:11, 19162.65it/s] 39%|███▉      | 134433/343741 [00:07<00:10, 19398.70it/s] 40%|███▉      | 136431/343741 [00:07<00:10, 19546.50it/s] 40%|████      | 138452/343741 [00:08<00:10, 19741.09it/s] 41%|████      | 140456/343741 [00:08<00:10, 19828.28it/s] 41%|████▏     | 142455/343741 [00:08<00:10, 19861.29it/s] 42%|████▏     | 144453/343741 [00:08<00:10, 19679.76it/s] 43%|████▎     | 146435/343741 [00:08<00:10, 19719.56it/s] 43%|████▎     | 148440/343741 [00:08<00:09, 19815.24it/s] 44%|████▍     | 150426/343741 [00:08<00:09, 19817.14it/s] 44%|████▍     | 152411/343741 [00:08<00:09, 19812.10it/s] 45%|████▍     | 154416/343741 [00:08<00:09, 19882.92it/s] 46%|████▌     | 156415/343741 [00:08<00:09, 19913.05it/s] 46%|████▌     | 158423/343741 [00:09<00:09, 19960.61it/s] 47%|████▋     | 160420/343741 [00:09<00:09, 19961.17it/s] 47%|████▋     | 162423/343741 [00:09<00:09, 19978.86it/s] 48%|████▊     | 164422/343741 [00:09<00:09, 19901.08it/s] 48%|████▊     | 166413/343741 [00:09<00:09, 19665.38it/s] 49%|████▉     | 168411/343741 [00:09<00:08, 19758.10it/s] 50%|████▉     | 170403/343741 [00:09<00:08, 19804.40it/s] 50%|█████     | 172393/343741 [00:09<00:08, 19829.85it/s] 51%|█████     | 174398/343741 [00:09<00:08, 19893.48it/s] 51%|█████▏    | 176388/343741 [00:10<00:22, 7298.43it/s]  52%|█████▏    | 178394/343741 [00:10<00:18, 9027.59it/s] 52%|█████▏    | 180383/343741 [00:10<00:15, 10788.95it/s] 53%|█████▎    | 182378/343741 [00:10<00:12, 12511.27it/s] 54%|█████▎    | 184368/343741 [00:10<00:11, 14075.52it/s] 54%|█████▍    | 186365/343741 [00:11<00:10, 15444.22it/s] 55%|█████▍    | 188363/343741 [00:11<00:09, 16573.77it/s] 55%|█████▌    | 190366/343741 [00:11<00:08, 17479.70it/s] 56%|█████▌    | 192369/343741 [00:11<00:08, 18174.89it/s] 57%|█████▋    | 194378/343741 [00:11<00:07, 18709.61it/s] 57%|█████▋    | 196360/343741 [00:11<00:07, 19025.57it/s] 58%|█████▊    | 198342/343741 [00:11<00:07, 19080.01it/s] 58%|█████▊    | 200345/343741 [00:11<00:07, 19354.17it/s] 59%|█████▉    | 202348/343741 [00:11<00:07, 19551.29it/s] 59%|█████▉    | 204359/343741 [00:11<00:07, 19713.87it/s] 60%|██████    | 206360/343741 [00:12<00:06, 19801.00it/s] 61%|██████    | 208369/343741 [00:12<00:06, 19884.33it/s] 61%|██████    | 210368/343741 [00:12<00:06, 19888.94it/s] 62%|██████▏   | 212364/343741 [00:12<00:06, 19907.12it/s] 62%|██████▏   | 214360/343741 [00:12<00:06, 19910.50it/s] 63%|██████▎   | 216384/343741 [00:12<00:06, 20005.84it/s] 64%|██████▎   | 218387/343741 [00:12<00:06, 19758.40it/s] 64%|██████▍   | 220377/343741 [00:12<00:06, 19799.40it/s] 65%|██████▍   | 222382/343741 [00:12<00:06, 19870.90it/s] 65%|██████▌   | 224371/343741 [00:12<00:06, 19870.56it/s] 66%|██████▌   | 226359/343741 [00:13<00:05, 19839.53it/s] 66%|██████▋   | 228350/343741 [00:13<00:05, 19859.32it/s] 67%|██████▋   | 230342/343741 [00:13<00:05, 19875.34it/s] 68%|██████▊   | 232332/343741 [00:13<00:05, 19880.33it/s] 68%|██████▊   | 234321/343741 [00:13<00:05, 19857.48it/s] 69%|██████▉   | 236323/343741 [00:13<00:05, 19905.48it/s] 69%|██████▉   | 238314/343741 [00:13<00:05, 19659.21it/s] 70%|██████▉   | 240292/343741 [00:13<00:05, 19692.54it/s] 70%|███████   | 242272/343741 [00:13<00:05, 19721.59it/s] 71%|███████   | 244260/343741 [00:13<00:05, 19765.84it/s] 72%|███████▏  | 246256/343741 [00:14<00:04, 19820.61it/s] 72%|███████▏  | 248239/343741 [00:14<00:04, 19820.81it/s] 73%|███████▎  | 250243/343741 [00:14<00:04, 19885.78it/s] 73%|███████▎  | 252232/343741 [00:14<00:04, 19871.05it/s] 74%|███████▍  | 254220/343741 [00:14<00:04, 19797.76it/s] 75%|███████▍  | 256200/343741 [00:15<00:17, 4916.85it/s]  75%|███████▌  | 258129/343741 [00:15<00:13, 6294.65it/s] 76%|███████▌  | 260126/343741 [00:15<00:10, 7941.43it/s] 76%|███████▋  | 262111/343741 [00:15<00:08, 9689.06it/s] 77%|███████▋  | 264096/343741 [00:16<00:06, 11450.02it/s] 77%|███████▋  | 266095/343741 [00:16<00:05, 13144.31it/s] 78%|███████▊  | 268076/343741 [00:16<00:05, 14615.42it/s] 79%|███████▊  | 270070/343741 [00:16<00:04, 15892.28it/s] 79%|███████▉  | 272057/343741 [00:16<00:04, 16906.59it/s] 80%|███████▉  | 274048/343741 [00:16<00:03, 17707.86it/s] 80%|████████  | 276020/343741 [00:16<00:03, 18261.37it/s] 81%|████████  | 277988/343741 [00:16<00:03, 18538.04it/s] 81%|████████▏ | 279981/343741 [00:16<00:03, 18936.42it/s] 82%|████████▏ | 281973/343741 [00:16<00:03, 19220.83it/s] 83%|████████▎ | 283973/343741 [00:17<00:03, 19446.95it/s] 83%|████████▎ | 285968/343741 [00:17<00:02, 19592.62it/s] 84%|████████▍ | 287978/343741 [00:17<00:02, 19717.98it/s] 84%|████████▍ | 289987/343741 [00:17<00:02, 19826.39it/s] 85%|████████▍ | 291983/343741 [00:17<00:02, 19790.42it/s] 86%|████████▌ | 293978/343741 [00:17<00:02, 19834.95it/s] 86%|████████▌ | 295972/343741 [00:17<00:02, 19864.63it/s] 87%|████████▋ | 297963/343741 [00:17<00:02, 19712.36it/s] 87%|████████▋ | 299951/343741 [00:17<00:02, 19760.28it/s] 88%|████████▊ | 301957/343741 [00:17<00:02, 19847.50it/s] 88%|████████▊ | 303944/343741 [00:18<00:02, 19823.69it/s] 89%|████████▉ | 305933/343741 [00:18<00:01, 19842.73it/s] 90%|████████▉ | 307928/343741 [00:18<00:01, 19871.42it/s] 90%|█████████ | 309921/343741 [00:18<00:01, 19886.79it/s] 91%|█████████ | 311922/343741 [00:18<00:01, 19922.68it/s] 91%|█████████▏| 313915/343741 [00:18<00:01, 19910.92it/s] 92%|█████████▏| 315917/343741 [00:18<00:01, 19940.62it/s] 92%|█████████▏| 317912/343741 [00:18<00:01, 19914.35it/s] 93%|█████████▎| 319904/343741 [00:18<00:01, 19625.69it/s] 94%|█████████▎| 321885/343741 [00:18<00:01, 19677.42it/s] 94%|█████████▍| 323860/343741 [00:19<00:01, 19695.96it/s] 95%|█████████▍| 325844/343741 [00:19<00:00, 19736.19it/s] 95%|█████████▌| 327841/343741 [00:19<00:00, 19805.47it/s] 96%|█████████▌| 329822/343741 [00:19<00:00, 19795.45it/s] 97%|█████████▋| 331802/343741 [00:19<00:00, 19737.80it/s] 97%|█████████▋| 333776/343741 [00:19<00:00, 19716.94it/s] 98%|█████████▊| 335752/343741 [00:19<00:00, 19727.79it/s] 98%|█████████▊| 337727/343741 [00:19<00:00, 19731.60it/s] 99%|█████████▉| 339701/343741 [00:19<00:00, 19470.16it/s] 99%|█████████▉| 341669/343741 [00:19<00:00, 19530.08it/s]100%|█████████▉| 343648/343741 [00:20<00:00, 19604.79it/s]100%|██████████| 343741/343741 [00:20<00:00, 17156.02it/s]
  0%|          | 0/56357 [00:00<?, ?it/s]  4%|▍         | 2391/56357 [00:00<00:02, 23902.73it/s]  8%|▊         | 4782/56357 [00:00<00:02, 23488.64it/s] 13%|█▎        | 7132/56357 [00:00<00:02, 23258.03it/s] 17%|█▋        | 9459/56357 [00:00<00:02, 22830.02it/s] 21%|██        | 11803/56357 [00:00<00:01, 23045.04it/s] 25%|██▌       | 14274/56357 [00:00<00:01, 23601.12it/s] 30%|██▉       | 16771/56357 [00:00<00:01, 24043.82it/s] 34%|███▍      | 19238/56357 [00:00<00:01, 24241.13it/s] 39%|███▊      | 21722/56357 [00:00<00:01, 24426.58it/s] 43%|████▎     | 24166/56357 [00:01<00:01, 24362.46it/s] 47%|████▋     | 26603/56357 [00:01<00:01, 24091.48it/s] 51%|█████▏    | 29014/56357 [00:01<00:01, 23491.76it/s] 56%|█████▌    | 31367/56357 [00:01<00:01, 23076.10it/s] 60%|█████▉    | 33678/56357 [00:01<00:00, 22821.44it/s] 64%|██████▍   | 35963/56357 [00:01<00:00, 22477.34it/s] 68%|██████▊   | 38213/56357 [00:01<00:00, 22179.15it/s] 72%|███████▏  | 40462/56357 [00:01<00:00, 22267.53it/s] 76%|███████▌  | 42690/56357 [00:01<00:00, 22091.09it/s] 80%|███████▉  | 44900/56357 [00:01<00:00, 22073.96it/s] 84%|████████▎ | 47108/56357 [00:02<00:00, 21942.69it/s] 88%|████████▊ | 49318/56357 [00:02<00:00, 21986.60it/s] 91%|█████████▏| 51517/56357 [00:02<00:00, 21945.55it/s] 95%|█████████▌| 53798/56357 [00:02<00:00, 22200.50it/s]100%|█████████▉| 56241/56357 [00:02<00:00, 22863.81it/s]100%|██████████| 56357/56357 [00:02<00:00, 22955.22it/s]
  0%|          | 0/23248 [00:00<?, ?it/s] 10%|█         | 2391/23248 [00:00<00:00, 23908.37it/s] 21%|██        | 4782/23248 [00:00<00:00, 22707.43it/s] 31%|███       | 7191/23248 [00:00<00:00, 23319.04it/s] 41%|████▏     | 9636/23248 [00:00<00:00, 23753.96it/s] 52%|█████▏    | 12101/23248 [00:00<00:00, 24072.63it/s] 63%|██████▎   | 14571/23248 [00:00<00:00, 24283.58it/s] 73%|███████▎  | 17008/23248 [00:00<00:00, 24310.77it/s] 84%|████████▎ | 19458/23248 [00:00<00:00, 24367.63it/s] 94%|█████████▍| 21927/23248 [00:00<00:00, 24466.33it/s]100%|██████████| 23248/23248 [00:00<00:00, 24104.30it/s]
dataset loaded from path: 
data/ud/ud-treebanks-v2.1/UD_Spanish/inter-layer-17/UD_Spanish-train-bloom-1b1-intermediate-global_step100000.pkl
data/ud/ud-treebanks-v2.1/UD_Spanish/inter-layer-17/UD_Spanish-dev-bloom-1b1-intermediate-global_step100000.pkl
data/ud/ud-treebanks-v2.1/UD_Spanish/inter-layer-17/UD_Spanish-test-bloom-1b1-intermediate-global_step100000.pkl
Embedding dimensionality: 1536
Pre-training probe (if possible)...
Traceback (most recent call last):
  File "run.py", line 102, in <module>
    args.func(args)
  File "/home/s2308470/multilingual-typology-probing/commands.py", line 166, in greedy
    trainer.train()
  File "/home/s2308470/multilingual-typology-probing/probekit/trainers/trainer.py", line 21, in train
    self._train()
  File "/home/s2308470/multilingual-typology-probing/probekit/trainers/neural_probe_trainer.py", line 30, in _train
    self._train_for_dimensions()
  File "/home/s2308470/multilingual-typology-probing/trainers/flexible_neural_probe_trainer.py", line 72, in _train_for_dimensions
    inputs_tensor_shuffled = inputs_tensor[shuffled_indices]
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 1.63 GiB (GPU 0; 5.94 GiB total capacity; 4.18 GiB already allocated; 1.51 GiB free; 4.21 GiB reserved in total by PyTorch) If reserved memory is >> allocated memory try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF
