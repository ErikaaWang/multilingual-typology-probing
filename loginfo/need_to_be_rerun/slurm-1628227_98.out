python run.py --language UD_Spanish --experiment-name inter-layer-17 --attribute POS --trainer poisson --gpu --embedding bloom-1b1-intermediate-global_step500000 greedy --selection-size 50 --selection-criterion mi
Setting up datasets (['UD_Spanish'], POS) and probes...
  0%|          | 0/343741 [00:00<?, ?it/s]  1%|          | 1735/343741 [00:00<00:19, 17342.12it/s]  1%|          | 3951/343741 [00:00<00:16, 20169.85it/s]  2%|▏         | 6174/343741 [00:00<00:15, 21107.73it/s]  2%|▏         | 8364/343741 [00:00<00:15, 21416.03it/s]  3%|▎         | 10579/343741 [00:00<00:15, 21679.33it/s]  4%|▎         | 12793/343741 [00:00<00:15, 21834.15it/s]  4%|▍         | 15015/343741 [00:00<00:14, 21959.21it/s]  5%|▌         | 17249/343741 [00:00<00:14, 22078.60it/s]  6%|▌         | 19464/343741 [00:00<00:14, 22100.39it/s]  6%|▋         | 21675/343741 [00:01<00:30, 10584.70it/s]  7%|▋         | 23606/343741 [00:01<00:26, 12105.05it/s]  7%|▋         | 25636/343741 [00:01<00:23, 13738.59it/s]  8%|▊         | 27687/343741 [00:01<00:20, 15239.02it/s]  9%|▊         | 29844/343741 [00:01<00:18, 16760.02it/s]  9%|▉         | 32007/343741 [00:01<00:17, 18003.76it/s] 10%|▉         | 34212/343741 [00:01<00:16, 19085.49it/s] 11%|█         | 36430/343741 [00:02<00:15, 19938.78it/s] 11%|█         | 38651/343741 [00:02<00:14, 20580.27it/s] 12%|█▏        | 40873/343741 [00:02<00:14, 21051.57it/s] 13%|█▎        | 43091/343741 [00:02<00:14, 21379.58it/s] 13%|█▎        | 45316/343741 [00:02<00:13, 21632.99it/s] 14%|█▍        | 47515/343741 [00:02<00:13, 21180.03it/s] 14%|█▍        | 49660/343741 [00:02<00:14, 20923.52it/s] 15%|█▌        | 51772/343741 [00:02<00:14, 20759.50it/s] 16%|█▌        | 53861/343741 [00:02<00:14, 20620.29it/s] 16%|█▋        | 55933/343741 [00:02<00:14, 20525.40it/s] 17%|█▋        | 57992/343741 [00:03<00:13, 20469.67it/s] 17%|█▋        | 60044/343741 [00:03<00:13, 20436.49it/s] 18%|█▊        | 62091/343741 [00:03<00:31, 9008.62it/s]  19%|█▊        | 64124/343741 [00:03<00:25, 10784.32it/s] 19%|█▉        | 66156/343741 [00:03<00:22, 12528.88it/s] 20%|█▉        | 68194/343741 [00:04<00:19, 14155.91it/s] 20%|██        | 70237/343741 [00:04<00:17, 15588.85it/s] 21%|██        | 72270/343741 [00:04<00:16, 16754.01it/s] 22%|██▏       | 74305/343741 [00:04<00:15, 17688.03it/s] 22%|██▏       | 76342/343741 [00:04<00:14, 18414.03it/s] 23%|██▎       | 78375/343741 [00:04<00:14, 18946.66it/s] 23%|██▎       | 80417/343741 [00:04<00:13, 19364.53it/s] 24%|██▍       | 82466/343741 [00:04<00:13, 19688.42it/s] 25%|██▍       | 84493/343741 [00:04<00:13, 19591.62it/s] 25%|██▌       | 86545/343741 [00:04<00:12, 19861.34it/s] 26%|██▌       | 88575/343741 [00:05<00:12, 19988.14it/s] 26%|██▋       | 90603/343741 [00:05<00:12, 20071.39it/s] 27%|██▋       | 92636/343741 [00:05<00:12, 20146.03it/s] 28%|██▊       | 94670/343741 [00:05<00:12, 20200.87it/s] 28%|██▊       | 96708/343741 [00:05<00:12, 20251.32it/s] 29%|██▊       | 98751/343741 [00:05<00:12, 20303.66it/s] 29%|██▉       | 100785/343741 [00:05<00:11, 20286.72it/s] 30%|██▉       | 102831/343741 [00:05<00:11, 20336.26it/s] 31%|███       | 104867/343741 [00:05<00:11, 20325.30it/s] 31%|███       | 106912/343741 [00:05<00:11, 20361.29it/s] 32%|███▏      | 108949/343741 [00:06<00:11, 20188.51it/s] 32%|███▏      | 110986/343741 [00:06<00:11, 20241.95it/s] 33%|███▎      | 113011/343741 [00:06<00:27, 8330.80it/s]  33%|███▎      | 115051/343741 [00:06<00:22, 10131.85it/s] 34%|███▍      | 117087/343741 [00:06<00:19, 11928.59it/s] 35%|███▍      | 119128/343741 [00:06<00:16, 13629.83it/s] 35%|███▌      | 121098/343741 [00:07<00:14, 14980.63it/s] 36%|███▌      | 123133/343741 [00:07<00:13, 16276.72it/s] 36%|███▋      | 125188/343741 [00:07<00:12, 17372.13it/s] 37%|███▋      | 127222/343741 [00:07<00:11, 18166.61it/s] 38%|███▊      | 129257/343741 [00:07<00:11, 18767.17it/s] 38%|███▊      | 131293/343741 [00:07<00:11, 19217.53it/s] 39%|███▉      | 133331/343741 [00:07<00:10, 19550.90it/s] 39%|███▉      | 135373/343741 [00:07<00:10, 19802.27it/s] 40%|███▉      | 137432/343741 [00:07<00:10, 20032.01it/s] 41%|████      | 139472/343741 [00:07<00:10, 20140.40it/s] 41%|████      | 141521/343741 [00:08<00:09, 20242.69it/s] 42%|████▏     | 143562/343741 [00:08<00:09, 20047.30it/s] 42%|████▏     | 145610/343741 [00:08<00:09, 20173.89it/s] 43%|████▎     | 147656/343741 [00:08<00:09, 20256.29it/s] 44%|████▎     | 149713/343741 [00:08<00:09, 20347.90it/s] 44%|████▍     | 151755/343741 [00:08<00:09, 20368.94it/s] 45%|████▍     | 153812/343741 [00:08<00:09, 20427.65it/s] 45%|████▌     | 155857/343741 [00:08<00:09, 20379.88it/s] 46%|████▌     | 157919/343741 [00:08<00:09, 20450.44it/s] 47%|████▋     | 159966/343741 [00:09<00:09, 20408.05it/s] 47%|████▋     | 162008/343741 [00:09<00:08, 20384.67it/s] 48%|████▊     | 164053/343741 [00:09<00:08, 20402.45it/s] 48%|████▊     | 166099/343741 [00:09<00:08, 20418.65it/s] 49%|████▉     | 168142/343741 [00:09<00:08, 20171.44it/s] 50%|████▉     | 170190/343741 [00:09<00:08, 20262.63it/s] 50%|█████     | 172234/343741 [00:09<00:08, 20312.84it/s] 51%|█████     | 174288/343741 [00:09<00:08, 20380.29it/s] 51%|█████▏    | 176327/343741 [00:10<00:22, 7559.21it/s]  52%|█████▏    | 178285/343741 [00:10<00:17, 9202.26it/s] 52%|█████▏    | 180316/343741 [00:10<00:14, 11016.49it/s] 53%|█████▎    | 182348/343741 [00:10<00:12, 12776.86it/s] 54%|█████▎    | 184387/343741 [00:10<00:11, 14395.92it/s] 54%|█████▍    | 186440/343741 [00:10<00:09, 15824.55it/s] 55%|█████▍    | 188486/343741 [00:10<00:09, 16981.37it/s] 55%|█████▌    | 190538/343741 [00:11<00:08, 17909.79it/s] 56%|█████▌    | 192577/343741 [00:11<00:08, 18584.71it/s] 57%|█████▋    | 194624/343741 [00:11<00:07, 19111.94it/s] 57%|█████▋    | 196662/343741 [00:11<00:07, 19473.53it/s] 58%|█████▊    | 198712/343741 [00:11<00:07, 19771.06it/s] 58%|█████▊    | 200761/343741 [00:11<00:07, 19981.35it/s] 59%|█████▉    | 202800/343741 [00:11<00:07, 19872.21it/s] 60%|█████▉    | 204845/343741 [00:11<00:06, 20041.12it/s] 60%|██████    | 206890/343741 [00:11<00:06, 20161.54it/s] 61%|██████    | 208938/343741 [00:11<00:06, 20255.50it/s] 61%|██████▏   | 210979/343741 [00:12<00:06, 20295.56it/s] 62%|██████▏   | 213016/343741 [00:12<00:06, 20308.72it/s] 63%|██████▎   | 215058/343741 [00:12<00:06, 20338.94it/s] 63%|██████▎   | 217096/343741 [00:12<00:06, 20344.92it/s] 64%|██████▎   | 219133/343741 [00:12<00:06, 20322.48it/s] 64%|██████▍   | 221180/343741 [00:12<00:06, 20365.54it/s] 65%|██████▍   | 223218/343741 [00:12<00:05, 20368.68it/s] 66%|██████▌   | 225256/343741 [00:12<00:05, 20130.77it/s] 66%|██████▌   | 227274/343741 [00:12<00:05, 20143.65it/s] 67%|██████▋   | 229315/343741 [00:12<00:05, 20221.30it/s] 67%|██████▋   | 231353/343741 [00:13<00:05, 20266.82it/s] 68%|██████▊   | 233391/343741 [00:13<00:05, 20298.79it/s] 68%|██████▊   | 235429/343741 [00:13<00:05, 20322.04it/s] 69%|██████▉   | 237462/343741 [00:13<00:05, 20320.93it/s] 70%|██████▉   | 239504/343741 [00:13<00:05, 20316.63it/s] 70%|███████   | 241581/343741 [00:13<00:04, 20449.37it/s] 71%|███████   | 243627/343741 [00:13<00:04, 20351.81it/s] 71%|███████▏  | 245663/343741 [00:13<00:04, 20331.80it/s] 72%|███████▏  | 247697/343741 [00:13<00:04, 20332.67it/s] 73%|███████▎  | 249731/343741 [00:13<00:04, 20092.71it/s] 73%|███████▎  | 251783/343741 [00:14<00:04, 20219.15it/s] 74%|███████▍  | 253813/343741 [00:14<00:04, 20240.85it/s] 74%|███████▍  | 255838/343741 [00:15<00:16, 5324.67it/s]  75%|███████▌  | 257873/343741 [00:15<00:12, 6839.49it/s] 76%|███████▌  | 259907/343741 [00:15<00:09, 8539.11it/s] 76%|███████▌  | 261937/343741 [00:15<00:07, 10331.45it/s] 77%|███████▋  | 263975/343741 [00:15<00:06, 12128.11it/s] 77%|███████▋  | 265999/343741 [00:15<00:05, 13777.34it/s] 78%|███████▊  | 268038/343741 [00:15<00:04, 15266.21it/s] 79%|███████▊  | 270063/343741 [00:15<00:04, 16478.45it/s] 79%|███████▉  | 272081/343741 [00:16<00:04, 17431.76it/s] 80%|███████▉  | 274076/343741 [00:16<00:03, 18030.13it/s] 80%|████████  | 276107/343741 [00:16<00:03, 18659.25it/s] 81%|████████  | 278143/343741 [00:16<00:03, 19138.82it/s] 82%|████████▏ | 280179/343741 [00:16<00:03, 19488.18it/s] 82%|████████▏ | 282213/343741 [00:16<00:03, 19735.52it/s] 83%|████████▎ | 284250/343741 [00:16<00:02, 19920.14it/s] 83%|████████▎ | 286281/343741 [00:16<00:02, 20034.12it/s] 84%|████████▍ | 288309/343741 [00:16<00:02, 20100.03it/s] 84%|████████▍ | 290345/343741 [00:16<00:02, 20176.84it/s] 85%|████████▌ | 292375/343741 [00:17<00:02, 20210.61it/s] 86%|████████▌ | 294405/343741 [00:17<00:02, 20037.68it/s] 86%|████████▌ | 296448/343741 [00:17<00:02, 20153.55it/s] 87%|████████▋ | 298484/343741 [00:17<00:02, 20213.83it/s] 87%|████████▋ | 300560/343741 [00:17<00:02, 20376.19it/s] 88%|████████▊ | 302600/343741 [00:17<00:02, 20356.19it/s] 89%|████████▊ | 304642/343741 [00:17<00:01, 20372.49it/s] 89%|████████▉ | 306688/343741 [00:17<00:01, 20397.58it/s] 90%|████████▉ | 308729/343741 [00:17<00:01, 20364.47it/s] 90%|█████████ | 310778/343741 [00:17<00:01, 20398.62it/s] 91%|█████████ | 312819/343741 [00:18<00:01, 20376.08it/s] 92%|█████████▏| 314857/343741 [00:18<00:01, 20216.37it/s] 92%|█████████▏| 316893/343741 [00:18<00:01, 20257.10it/s] 93%|█████████▎| 318937/343741 [00:18<00:01, 20309.65it/s] 93%|█████████▎| 320969/343741 [00:18<00:01, 20300.96it/s] 94%|█████████▍| 323006/343741 [00:18<00:01, 20319.86it/s] 95%|█████████▍| 325048/343741 [00:18<00:00, 20347.57it/s] 95%|█████████▌| 327092/343741 [00:18<00:00, 20374.36it/s] 96%|█████████▌| 329130/343741 [00:18<00:00, 20351.32it/s] 96%|█████████▋| 331177/343741 [00:18<00:00, 20385.82it/s] 97%|█████████▋| 333216/343741 [00:19<00:00, 20329.47it/s] 98%|█████████▊| 335250/343741 [00:19<00:00, 20130.33it/s] 98%|█████████▊| 337295/343741 [00:19<00:00, 20223.12it/s] 99%|█████████▊| 339335/343741 [00:19<00:00, 20275.37it/s] 99%|█████████▉| 341373/343741 [00:19<00:00, 20304.57it/s]100%|█████████▉| 343424/343741 [00:19<00:00, 20364.78it/s]100%|██████████| 343741/343741 [00:19<00:00, 17572.80it/s]
  0%|          | 0/56357 [00:00<?, ?it/s]  4%|▍         | 2507/56357 [00:00<00:02, 25061.54it/s]  9%|▉         | 5014/56357 [00:00<00:02, 24479.94it/s] 13%|█▎        | 7463/56357 [00:00<00:02, 24014.13it/s] 18%|█▊        | 9876/56357 [00:00<00:01, 24055.37it/s] 22%|██▏       | 12283/56357 [00:00<00:01, 24003.54it/s] 26%|██▋       | 14880/56357 [00:00<00:01, 24663.07it/s] 31%|███       | 17537/56357 [00:00<00:01, 25281.51it/s] 36%|███▌      | 20126/56357 [00:00<00:01, 25473.50it/s] 40%|████      | 22779/56357 [00:00<00:01, 25801.90it/s] 45%|████▌     | 25437/56357 [00:01<00:01, 26038.98it/s] 50%|████▉     | 28094/56357 [00:01<00:01, 26199.79it/s] 55%|█████▍    | 30715/56357 [00:01<00:00, 26134.97it/s] 59%|█████▉    | 33393/56357 [00:01<00:00, 26326.47it/s] 64%|██████▍   | 36026/56357 [00:01<00:00, 26010.21it/s] 69%|██████▊   | 38628/56357 [00:01<00:00, 25941.05it/s] 73%|███████▎  | 41223/56357 [00:01<00:00, 25889.42it/s] 78%|███████▊  | 43842/56357 [00:01<00:00, 25976.70it/s] 82%|████████▏ | 46441/56357 [00:01<00:00, 25583.38it/s] 87%|████████▋ | 49001/56357 [00:01<00:00, 24676.58it/s] 91%|█████████▏| 51476/56357 [00:02<00:00, 23964.69it/s] 96%|█████████▌| 53880/56357 [00:02<00:00, 23845.75it/s]100%|██████████| 56357/56357 [00:02<00:00, 25139.38it/s]
  0%|          | 0/23248 [00:00<?, ?it/s] 11%|█         | 2543/23248 [00:00<00:00, 25423.60it/s] 22%|██▏       | 5186/23248 [00:00<00:00, 26014.49it/s] 34%|███▎      | 7824/23248 [00:00<00:00, 26179.28it/s] 45%|████▍     | 10451/23248 [00:00<00:00, 26213.60it/s] 56%|█████▌    | 13073/23248 [00:00<00:00, 26120.46it/s] 68%|██████▊   | 15696/23248 [00:00<00:00, 26154.72it/s] 79%|███████▉  | 18324/23248 [00:00<00:00, 26192.56it/s] 90%|█████████ | 20944/23248 [00:00<00:00, 25917.19it/s]100%|██████████| 23248/23248 [00:00<00:00, 25754.61it/s]
dataset loaded from path: 
data/ud/ud-treebanks-v2.1/UD_Spanish/inter-layer-17/UD_Spanish-train-bloom-1b1-intermediate-global_step500000.pkl
data/ud/ud-treebanks-v2.1/UD_Spanish/inter-layer-17/UD_Spanish-dev-bloom-1b1-intermediate-global_step500000.pkl
data/ud/ud-treebanks-v2.1/UD_Spanish/inter-layer-17/UD_Spanish-test-bloom-1b1-intermediate-global_step500000.pkl
Embedding dimensionality: 1536
Pre-training probe (if possible)...
Traceback (most recent call last):
  File "run.py", line 102, in <module>
    args.func(args)
  File "/home/s2308470/multilingual-typology-probing/commands.py", line 166, in greedy
    trainer.train()
  File "/home/s2308470/multilingual-typology-probing/probekit/trainers/trainer.py", line 21, in train
    self._train()
  File "/home/s2308470/multilingual-typology-probing/probekit/trainers/neural_probe_trainer.py", line 30, in _train
    self._train_for_dimensions()
  File "/home/s2308470/multilingual-typology-probing/trainers/flexible_neural_probe_trainer.py", line 72, in _train_for_dimensions
    inputs_tensor_shuffled = inputs_tensor[shuffled_indices]
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 1.63 GiB (GPU 0; 5.94 GiB total capacity; 4.18 GiB already allocated; 1.51 GiB free; 4.21 GiB reserved in total by PyTorch) If reserved memory is >> allocated memory try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF
