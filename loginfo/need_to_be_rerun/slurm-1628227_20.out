python run.py --language UD_Catalan --experiment-name inter-layer-17 --attribute POS --trainer poisson --gpu --embedding bloom-1b1-intermediate-global_step1000 greedy --selection-size 50 --selection-criterion mi
Setting up datasets (['UD_Catalan'], POS) and probes...
  0%|          | 0/441656 [00:00<?, ?it/s]  1%|          | 2361/441656 [00:00<00:18, 23601.30it/s]  1%|          | 5306/441656 [00:00<00:16, 27038.36it/s]  2%|▏         | 8158/441656 [00:00<00:15, 27706.62it/s]  2%|▏         | 10961/441656 [00:00<00:15, 27831.80it/s]  3%|▎         | 13868/441656 [00:00<00:15, 28276.98it/s]  4%|▍         | 16747/441656 [00:00<00:14, 28450.09it/s]  4%|▍         | 19593/441656 [00:00<00:14, 28436.94it/s]  5%|▌         | 22508/441656 [00:00<00:14, 28653.97it/s]  6%|▌         | 25383/441656 [00:00<00:14, 28682.23it/s]  6%|▋         | 28305/441656 [00:01<00:14, 28847.57it/s]  7%|▋         | 31296/441656 [00:01<00:14, 29171.36it/s]  8%|▊         | 34214/441656 [00:01<00:14, 28957.95it/s]  8%|▊         | 37111/441656 [00:01<00:37, 10662.54it/s]  9%|▉         | 40007/441656 [00:01<00:30, 13144.66it/s] 10%|▉         | 42915/441656 [00:02<00:25, 15745.20it/s] 10%|█         | 45824/441656 [00:02<00:21, 18268.29it/s] 11%|█         | 48628/441656 [00:02<00:19, 20346.14it/s] 12%|█▏        | 51574/441656 [00:02<00:17, 22468.57it/s] 12%|█▏        | 54516/441656 [00:02<00:15, 24203.49it/s] 13%|█▎        | 57336/441656 [00:02<00:15, 24941.24it/s] 14%|█▎        | 60254/441656 [00:02<00:14, 26085.69it/s] 14%|█▍        | 63187/441656 [00:02<00:14, 26988.68it/s] 15%|█▍        | 66158/441656 [00:02<00:13, 27762.84it/s] 16%|█▌        | 69096/441656 [00:02<00:13, 28227.96it/s] 16%|█▋        | 72000/441656 [00:03<00:13, 28260.37it/s] 17%|█▋        | 74979/441656 [00:03<00:12, 28706.15it/s] 18%|█▊        | 77891/441656 [00:03<00:12, 28690.76it/s] 18%|█▊        | 80838/441656 [00:03<00:12, 28918.33it/s] 19%|█▉        | 83783/441656 [00:03<00:12, 29075.15it/s] 20%|█▉        | 86705/441656 [00:04<00:36, 9699.80it/s]  20%|██        | 89626/441656 [00:04<00:29, 12121.37it/s] 21%|██        | 92549/441656 [00:04<00:23, 14697.39it/s] 22%|██▏       | 95398/441656 [00:04<00:20, 17139.16it/s] 22%|██▏       | 98331/441656 [00:04<00:17, 19598.87it/s] 23%|██▎       | 101190/441656 [00:04<00:15, 21610.13it/s] 24%|██▎       | 103992/441656 [00:04<00:14, 23162.15it/s] 24%|██▍       | 106891/441656 [00:04<00:13, 24659.14it/s] 25%|██▍       | 109881/441656 [00:05<00:12, 26064.28it/s] 26%|██▌       | 112801/441656 [00:05<00:12, 26932.19it/s] 26%|██▌       | 115731/441656 [00:05<00:11, 27601.68it/s] 27%|██▋       | 118650/441656 [00:05<00:11, 28058.36it/s] 28%|██▊       | 121616/441656 [00:05<00:11, 28524.95it/s] 28%|██▊       | 124538/441656 [00:05<00:11, 28502.23it/s] 29%|██▉       | 127503/441656 [00:05<00:10, 28837.57it/s] 30%|██▉       | 130422/441656 [00:05<00:10, 28894.21it/s] 30%|███       | 133336/441656 [00:05<00:10, 28570.27it/s] 31%|███       | 136211/441656 [00:05<00:10, 28321.95it/s] 31%|███▏      | 139056/441656 [00:06<00:10, 28354.56it/s] 32%|███▏      | 142038/441656 [00:06<00:10, 28784.03it/s] 33%|███▎      | 144984/441656 [00:06<00:10, 28983.19it/s] 33%|███▎      | 147888/441656 [00:06<00:10, 28794.36it/s] 34%|███▍      | 150772/441656 [00:07<00:36, 7901.90it/s]  35%|███▍      | 153666/441656 [00:07<00:28, 10095.34it/s] 35%|███▌      | 156607/441656 [00:07<00:22, 12598.82it/s] 36%|███▌      | 159545/441656 [00:07<00:18, 15220.58it/s] 37%|███▋      | 162372/441656 [00:07<00:15, 17601.66it/s] 37%|███▋      | 165269/441656 [00:07<00:13, 19951.75it/s] 38%|███▊      | 168239/441656 [00:07<00:12, 22173.94it/s] 39%|███▉      | 171181/441656 [00:08<00:11, 23953.99it/s] 39%|███▉      | 174164/441656 [00:08<00:10, 25479.25it/s] 40%|████      | 177060/441656 [00:08<00:10, 25780.27it/s] 41%|████      | 180018/441656 [00:08<00:09, 26818.60it/s] 41%|████▏     | 182927/441656 [00:08<00:09, 27454.85it/s] 42%|████▏     | 185804/441656 [00:08<00:09, 27673.55it/s] 43%|████▎     | 188831/441656 [00:08<00:08, 28423.89it/s] 43%|████▎     | 191741/441656 [00:08<00:08, 28252.49it/s] 44%|████▍     | 194678/441656 [00:08<00:08, 28575.08it/s] 45%|████▍     | 197682/441656 [00:08<00:08, 28995.96it/s] 45%|████▌     | 200607/441656 [00:09<00:08, 28998.55it/s] 46%|████▌     | 203580/441656 [00:09<00:08, 29214.44it/s] 47%|████▋     | 206528/441656 [00:09<00:08, 29291.16it/s] 47%|████▋     | 209466/441656 [00:09<00:08, 29002.83it/s] 48%|████▊     | 212420/441656 [00:09<00:07, 29161.05it/s] 49%|████▉     | 215341/441656 [00:09<00:07, 28687.88it/s] 49%|████▉     | 218241/441656 [00:09<00:07, 28779.29it/s] 50%|█████     | 221132/441656 [00:09<00:07, 28812.27it/s] 51%|█████     | 224045/441656 [00:09<00:07, 28905.35it/s] 51%|█████▏    | 227030/441656 [00:09<00:07, 29186.11it/s] 52%|█████▏    | 229951/441656 [00:11<00:33, 6368.64it/s]  53%|█████▎    | 232950/441656 [00:11<00:24, 8380.18it/s] 53%|█████▎    | 235829/441656 [00:11<00:19, 10586.47it/s] 54%|█████▍    | 238720/441656 [00:11<00:15, 13042.85it/s] 55%|█████▍    | 241494/441656 [00:11<00:12, 15404.48it/s] 55%|█████▌    | 244335/441656 [00:11<00:11, 17832.37it/s] 56%|█████▌    | 247151/441656 [00:11<00:09, 20006.38it/s] 57%|█████▋    | 250045/441656 [00:11<00:08, 22071.04it/s] 57%|█████▋    | 252847/441656 [00:12<00:08, 23547.04it/s] 58%|█████▊    | 255679/441656 [00:12<00:07, 24796.35it/s] 59%|█████▊    | 258535/441656 [00:12<00:07, 25819.96it/s] 59%|█████▉    | 261357/441656 [00:12<00:06, 26314.04it/s] 60%|█████▉    | 264207/441656 [00:12<00:06, 26935.08it/s] 60%|██████    | 267103/441656 [00:12<00:06, 27518.30it/s] 61%|██████    | 269943/441656 [00:12<00:06, 27358.87it/s] 62%|██████▏   | 272741/441656 [00:12<00:06, 27376.79it/s] 62%|██████▏   | 275630/441656 [00:12<00:05, 27816.84it/s] 63%|██████▎   | 278444/441656 [00:12<00:05, 27767.62it/s] 64%|██████▎   | 281405/441656 [00:13<00:05, 28309.96it/s] 64%|██████▍   | 284253/441656 [00:13<00:05, 28275.40it/s] 65%|██████▌   | 287114/441656 [00:13<00:05, 28372.70it/s] 66%|██████▌   | 290057/441656 [00:13<00:05, 28684.10it/s] 66%|██████▋   | 292932/441656 [00:13<00:05, 28415.87it/s] 67%|██████▋   | 295872/441656 [00:13<00:05, 28706.32it/s] 68%|██████▊   | 298747/441656 [00:13<00:04, 28615.20it/s] 68%|██████▊   | 301611/441656 [00:13<00:04, 28290.04it/s] 69%|██████▉   | 304503/441656 [00:13<00:04, 28474.10it/s] 70%|██████▉   | 307353/441656 [00:14<00:04, 28074.86it/s] 70%|███████   | 310239/441656 [00:14<00:04, 28303.70it/s] 71%|███████   | 313121/441656 [00:14<00:04, 28456.00it/s] 72%|███████▏  | 315969/441656 [00:14<00:04, 28395.65it/s] 72%|███████▏  | 318811/441656 [00:14<00:04, 28401.60it/s] 73%|███████▎  | 321730/441656 [00:14<00:04, 28636.30it/s] 73%|███████▎  | 324595/441656 [00:14<00:04, 28465.54it/s] 74%|███████▍  | 327528/441656 [00:14<00:03, 28722.22it/s] 75%|███████▍  | 330401/441656 [00:16<00:18, 5965.57it/s]  75%|███████▌  | 333075/441656 [00:16<00:14, 7655.73it/s] 76%|███████▌  | 335755/441656 [00:16<00:10, 9649.17it/s] 77%|███████▋  | 338448/441656 [00:16<00:08, 11886.64it/s] 77%|███████▋  | 341114/441656 [00:16<00:07, 14192.13it/s] 78%|███████▊  | 343687/441656 [00:16<00:06, 16294.69it/s] 78%|███████▊  | 346231/441656 [00:16<00:05, 18119.02it/s] 79%|███████▉  | 348905/441656 [00:16<00:04, 20076.98it/s] 80%|███████▉  | 351504/441656 [00:16<00:04, 21494.36it/s] 80%|████████  | 354184/441656 [00:16<00:03, 22866.85it/s] 81%|████████  | 356877/441656 [00:17<00:03, 23963.04it/s] 81%|████████▏ | 359526/441656 [00:17<00:03, 24663.89it/s] 82%|████████▏ | 362173/441656 [00:17<00:03, 25175.78it/s] 83%|████████▎ | 364826/441656 [00:17<00:03, 25565.13it/s] 83%|████████▎ | 367523/441656 [00:17<00:02, 25973.41it/s] 84%|████████▍ | 370194/441656 [00:17<00:02, 26188.54it/s] 84%|████████▍ | 372857/441656 [00:17<00:02, 26140.56it/s] 85%|████████▌ | 375540/441656 [00:17<00:02, 26342.70it/s] 86%|████████▌ | 378213/441656 [00:17<00:02, 26455.32it/s] 86%|████████▌ | 380904/441656 [00:18<00:02, 26511.92it/s] 87%|████████▋ | 383566/441656 [00:18<00:02, 26510.67it/s] 87%|████████▋ | 386225/441656 [00:18<00:02, 25596.16it/s] 88%|████████▊ | 388900/441656 [00:18<00:02, 25930.88it/s] 89%|████████▊ | 391503/441656 [00:18<00:01, 25952.45it/s] 89%|████████▉ | 394105/441656 [00:18<00:01, 25960.52it/s] 90%|████████▉ | 396796/441656 [00:18<00:01, 26239.21it/s] 90%|█████████ | 399424/441656 [00:18<00:01, 26050.68it/s] 91%|█████████ | 402046/441656 [00:18<00:01, 26100.04it/s] 92%|█████████▏| 404732/441656 [00:18<00:01, 26324.31it/s] 92%|█████████▏| 407402/441656 [00:19<00:01, 26433.68it/s] 93%|█████████▎| 410088/441656 [00:19<00:01, 26560.49it/s] 93%|█████████▎| 412745/441656 [00:19<00:01, 26249.35it/s] 94%|█████████▍| 415384/441656 [00:19<00:00, 26288.22it/s] 95%|█████████▍| 418046/441656 [00:19<00:00, 26384.94it/s] 95%|█████████▌| 420686/441656 [00:19<00:00, 26376.10it/s] 96%|█████████▌| 423325/441656 [00:19<00:00, 26223.74it/s] 96%|█████████▋| 425948/441656 [00:19<00:00, 25986.13it/s] 97%|█████████▋| 428604/441656 [00:19<00:00, 26153.17it/s] 98%|█████████▊| 431242/441656 [00:19<00:00, 26218.06it/s] 98%|█████████▊| 433865/441656 [00:20<00:00, 26064.67it/s] 99%|█████████▉| 436592/441656 [00:20<00:00, 26420.93it/s] 99%|█████████▉| 439246/441656 [00:20<00:00, 26454.08it/s]100%|██████████| 441656/441656 [00:20<00:00, 21735.38it/s]
  0%|          | 0/53198 [00:00<?, ?it/s]  6%|▋         | 3359/53198 [00:00<00:01, 33581.55it/s] 13%|█▎        | 6718/53198 [00:00<00:01, 33565.07it/s] 19%|█▉        | 10075/53198 [00:00<00:01, 32855.64it/s] 25%|██▌       | 13425/53198 [00:00<00:01, 33103.52it/s] 32%|███▏      | 16930/53198 [00:00<00:01, 33798.39it/s] 38%|███▊      | 20312/53198 [00:00<00:00, 33675.61it/s] 45%|████▍     | 23681/53198 [00:00<00:00, 33401.13it/s] 51%|█████     | 27130/53198 [00:00<00:00, 33741.39it/s] 57%|█████▋    | 30506/53198 [00:00<00:00, 33691.85it/s] 64%|██████▎   | 33876/53198 [00:01<00:00, 33543.15it/s] 70%|███████   | 37260/53198 [00:01<00:00, 33632.55it/s] 76%|███████▋  | 40624/53198 [00:01<00:00, 32916.97it/s] 83%|████████▎ | 44058/53198 [00:01<00:00, 33337.07it/s] 89%|████████▉ | 47395/53198 [00:01<00:00, 33183.43it/s] 95%|█████████▌| 50781/53198 [00:01<00:00, 33384.25it/s]100%|██████████| 53198/53198 [00:01<00:00, 33387.65it/s]
  0%|          | 0/35912 [00:00<?, ?it/s] 10%|▉         | 3523/35912 [00:00<00:00, 35223.99it/s] 20%|█▉        | 7159/35912 [00:00<00:00, 35888.03it/s] 30%|███       | 10868/35912 [00:00<00:00, 36433.42it/s] 40%|████      | 14512/35912 [00:00<00:00, 35538.39it/s] 50%|█████     | 18070/35912 [00:00<00:00, 34416.07it/s] 60%|█████▉    | 21519/35912 [00:00<00:00, 34434.23it/s] 70%|██████▉   | 24967/35912 [00:00<00:00, 33890.00it/s] 79%|███████▉  | 28360/35912 [00:00<00:00, 33404.00it/s] 88%|████████▊ | 31742/35912 [00:00<00:00, 33529.46it/s] 98%|█████████▊| 35098/35912 [00:01<00:00, 33439.97it/s]100%|██████████| 35912/35912 [00:01<00:00, 34130.14it/s]
dataset loaded from path: 
data/ud/ud-treebanks-v2.1/UD_Catalan/inter-layer-17/UD_Catalan-train-bloom-1b1-intermediate-global_step1000.pkl
data/ud/ud-treebanks-v2.1/UD_Catalan/inter-layer-17/UD_Catalan-dev-bloom-1b1-intermediate-global_step1000.pkl
data/ud/ud-treebanks-v2.1/UD_Catalan/inter-layer-17/UD_Catalan-test-bloom-1b1-intermediate-global_step1000.pkl
Embedding dimensionality: 1536
Pre-training probe (if possible)...
Traceback (most recent call last):
  File "run.py", line 102, in <module>
    args.func(args)
  File "/home/s2308470/multilingual-typology-probing/commands.py", line 166, in greedy
    trainer.train()
  File "/home/s2308470/multilingual-typology-probing/probekit/trainers/trainer.py", line 21, in train
    self._train()
  File "/home/s2308470/multilingual-typology-probing/probekit/trainers/neural_probe_trainer.py", line 30, in _train
    self._train_for_dimensions()
  File "/home/s2308470/multilingual-typology-probing/trainers/flexible_neural_probe_trainer.py", line 72, in _train_for_dimensions
    inputs_tensor_shuffled = inputs_tensor[shuffled_indices]
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 2.21 GiB (GPU 0; 5.94 GiB total capacity; 5.41 GiB already allocated; 285.31 MiB free; 5.44 GiB reserved in total by PyTorch) If reserved memory is >> allocated memory try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF
