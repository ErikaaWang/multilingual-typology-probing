python run.py --language UD_Spanish --experiment-name inter-layer-13 --attribute POS --trainer poisson --gpu --embedding bloom-1b1 greedy --selection-size 50 --selection-criterion mi
Setting up datasets (['UD_Spanish'], POS) and probes...
  0%|          | 0/343741 [00:00<?, ?it/s]  1%|          | 2438/343741 [00:00<00:14, 24377.18it/s]  2%|▏         | 5708/343741 [00:00<00:11, 29119.31it/s]  3%|▎         | 9011/343741 [00:00<00:10, 30897.60it/s]  4%|▎         | 12188/343741 [00:00<00:10, 31237.36it/s]  5%|▍         | 15519/343741 [00:00<00:10, 31981.31it/s]  5%|▌         | 18718/343741 [00:00<00:10, 31843.74it/s]  6%|▋         | 21903/343741 [00:01<00:22, 14603.17it/s]  7%|▋         | 25165/343741 [00:01<00:17, 17771.13it/s]  8%|▊         | 28451/343741 [00:01<00:15, 20800.11it/s]  9%|▉         | 31546/343741 [00:01<00:13, 23062.08it/s] 10%|█         | 34763/343741 [00:01<00:12, 25259.87it/s] 11%|█         | 37951/343741 [00:01<00:11, 26956.25it/s] 12%|█▏        | 41203/343741 [00:01<00:10, 28445.72it/s] 13%|█▎        | 44382/343741 [00:01<00:10, 29367.24it/s] 14%|█▍        | 47612/343741 [00:01<00:09, 30198.03it/s] 15%|█▍        | 50793/343741 [00:01<00:09, 30661.49it/s] 16%|█▌        | 54078/343741 [00:02<00:09, 31297.69it/s] 17%|█▋        | 57304/343741 [00:02<00:09, 31578.87it/s] 18%|█▊        | 60551/343741 [00:02<00:08, 31839.55it/s] 19%|█▊        | 63773/343741 [00:02<00:20, 13463.52it/s] 20%|█▉        | 67037/343741 [00:02<00:16, 16371.59it/s] 20%|██        | 70313/343741 [00:03<00:14, 19289.46it/s] 21%|██▏       | 73600/343741 [00:03<00:12, 22042.52it/s] 22%|██▏       | 76931/343741 [00:03<00:10, 24571.56it/s] 23%|██▎       | 80211/343741 [00:03<00:09, 26569.80it/s] 24%|██▍       | 83541/343741 [00:03<00:09, 28302.06it/s] 25%|██▌       | 86800/343741 [00:03<00:08, 29453.92it/s] 26%|██▌       | 90056/343741 [00:03<00:08, 30312.42it/s] 27%|██▋       | 93286/343741 [00:03<00:08, 30620.24it/s] 28%|██▊       | 96528/343741 [00:03<00:07, 31134.64it/s] 29%|██▉       | 99854/343741 [00:03<00:07, 31751.66it/s] 30%|███       | 103125/343741 [00:04<00:07, 32031.98it/s] 31%|███       | 106459/343741 [00:04<00:07, 32416.07it/s] 32%|███▏      | 109748/343741 [00:04<00:07, 32553.36it/s] 33%|███▎      | 113029/343741 [00:04<00:17, 12952.38it/s] 34%|███▍      | 116274/343741 [00:04<00:14, 15767.75it/s] 35%|███▍      | 119590/343741 [00:05<00:11, 18741.85it/s] 36%|███▌      | 122684/343741 [00:05<00:10, 21136.08it/s] 37%|███▋      | 125930/343741 [00:05<00:09, 23593.74it/s] 38%|███▊      | 129186/343741 [00:05<00:08, 25727.54it/s] 39%|███▊      | 132445/343741 [00:05<00:07, 27467.74it/s] 39%|███▉      | 135771/343741 [00:05<00:07, 29008.05it/s] 40%|████      | 139077/343741 [00:05<00:06, 30122.21it/s] 41%|████▏     | 142411/343741 [00:05<00:06, 31030.10it/s] 42%|████▏     | 145696/343741 [00:05<00:06, 31552.03it/s] 43%|████▎     | 149030/343741 [00:05<00:06, 31929.76it/s] 44%|████▍     | 152341/343741 [00:06<00:05, 32273.74it/s] 45%|████▌     | 155626/343741 [00:06<00:05, 32335.29it/s] 46%|████▌     | 158980/343741 [00:06<00:05, 32689.81it/s] 47%|████▋     | 162278/343741 [00:06<00:05, 32773.80it/s] 48%|████▊     | 165612/343741 [00:06<00:05, 32941.29it/s] 49%|████▉     | 168921/343741 [00:06<00:05, 32461.31it/s] 50%|█████     | 172187/343741 [00:06<00:05, 32518.05it/s] 51%|█████     | 175447/343741 [00:07<00:14, 11984.11it/s] 52%|█████▏    | 178683/343741 [00:07<00:11, 14736.09it/s] 53%|█████▎    | 182016/343741 [00:07<00:09, 17743.52it/s] 54%|█████▍    | 185205/343741 [00:07<00:07, 20397.72it/s] 55%|█████▍    | 188522/343741 [00:07<00:06, 23097.59it/s] 56%|█████▌    | 191782/343741 [00:07<00:06, 25300.20it/s] 57%|█████▋    | 195090/343741 [00:07<00:05, 27234.45it/s] 58%|█████▊    | 198271/343741 [00:08<00:05, 28235.56it/s] 59%|█████▊    | 201609/343741 [00:08<00:04, 29627.86it/s] 60%|█████▉    | 204820/343741 [00:08<00:04, 30314.64it/s] 61%|██████    | 208049/343741 [00:08<00:04, 30877.10it/s] 61%|██████▏   | 211372/343741 [00:08<00:04, 31556.95it/s] 62%|██████▏   | 214654/343741 [00:08<00:04, 31919.90it/s] 63%|██████▎   | 217929/343741 [00:08<00:03, 32162.61it/s] 64%|██████▍   | 221192/343741 [00:08<00:03, 31552.90it/s] 65%|██████▌   | 224492/343741 [00:08<00:03, 31974.17it/s] 66%|██████▌   | 227718/343741 [00:08<00:03, 32055.69it/s] 67%|██████▋   | 231015/343741 [00:09<00:03, 32325.82it/s] 68%|██████▊   | 234285/343741 [00:09<00:03, 32434.93it/s] 69%|██████▉   | 237538/343741 [00:09<00:03, 32345.94it/s] 70%|███████   | 240802/343741 [00:09<00:03, 32432.38it/s] 71%|███████   | 244050/343741 [00:09<00:03, 32088.88it/s] 72%|███████▏  | 247351/343741 [00:09<00:02, 32358.56it/s] 73%|███████▎  | 250590/343741 [00:09<00:02, 32192.53it/s] 74%|███████▍  | 253843/343741 [00:09<00:02, 32288.78it/s] 75%|███████▍  | 257074/343741 [00:10<00:08, 10497.52it/s] 76%|███████▌  | 260380/343741 [00:10<00:06, 13240.12it/s] 77%|███████▋  | 263566/343741 [00:10<00:05, 15994.72it/s] 78%|███████▊  | 266847/343741 [00:10<00:04, 18928.20it/s] 79%|███████▊  | 270053/343741 [00:10<00:03, 21547.62it/s] 80%|███████▉  | 273277/343741 [00:11<00:02, 23865.53it/s] 80%|████████  | 276502/343741 [00:11<00:02, 25877.87it/s] 81%|████████▏ | 279690/343741 [00:11<00:02, 27409.51it/s] 82%|████████▏ | 283012/343741 [00:11<00:02, 28961.65it/s] 83%|████████▎ | 286243/343741 [00:11<00:01, 29885.23it/s] 84%|████████▍ | 289500/343741 [00:11<00:01, 30644.46it/s] 85%|████████▌ | 292763/343741 [00:11<00:01, 31214.32it/s] 86%|████████▌ | 296054/343741 [00:11<00:01, 31706.70it/s] 87%|████████▋ | 299308/343741 [00:11<00:01, 31948.31it/s] 88%|████████▊ | 302560/343741 [00:11<00:01, 32042.53it/s] 89%|████████▉ | 305834/343741 [00:12<00:01, 32246.74it/s] 90%|████████▉ | 309111/343741 [00:12<00:01, 32400.75it/s] 91%|█████████ | 312435/343741 [00:12<00:00, 32648.77it/s] 92%|█████████▏| 315714/343741 [00:12<00:00, 32576.34it/s] 93%|█████████▎| 318982/343741 [00:12<00:00, 32558.53it/s] 94%|█████████▎| 322248/343741 [00:12<00:00, 32587.58it/s] 95%|█████████▍| 325583/343741 [00:12<00:00, 32814.14it/s] 96%|█████████▌| 328868/343741 [00:12<00:00, 32762.95it/s] 97%|█████████▋| 332147/343741 [00:12<00:00, 32602.50it/s] 98%|█████████▊| 335410/343741 [00:12<00:00, 32522.22it/s] 99%|█████████▊| 338664/343741 [00:13<00:00, 32396.97it/s] 99%|█████████▉| 341909/343741 [00:13<00:00, 32409.92it/s]100%|██████████| 343741/343741 [00:13<00:00, 26027.77it/s]
  0%|          | 0/56357 [00:00<?, ?it/s]  7%|▋         | 3827/56357 [00:00<00:01, 38263.38it/s] 14%|█▎        | 7654/56357 [00:00<00:01, 37390.17it/s] 20%|██        | 11395/56357 [00:00<00:01, 37236.34it/s] 27%|██▋       | 15259/56357 [00:00<00:01, 37783.49it/s] 34%|███▍      | 19039/56357 [00:00<00:00, 37767.26it/s] 41%|████      | 22880/56357 [00:00<00:00, 37983.56it/s] 47%|████▋     | 26693/56357 [00:00<00:00, 38030.47it/s] 54%|█████▍    | 30497/56357 [00:00<00:00, 37710.67it/s] 61%|██████    | 34342/56357 [00:00<00:00, 37936.48it/s] 68%|██████▊   | 38137/56357 [00:01<00:00, 37353.03it/s] 74%|███████▍  | 41912/56357 [00:01<00:00, 37470.12it/s] 81%|████████  | 45684/56357 [00:01<00:00, 37532.55it/s] 88%|████████▊ | 49486/56357 [00:01<00:00, 37678.21it/s] 95%|█████████▍| 53337/56357 [00:01<00:00, 37926.92it/s]100%|██████████| 56357/56357 [00:01<00:00, 37708.48it/s]
  0%|          | 0/23248 [00:00<?, ?it/s] 18%|█▊        | 4101/23248 [00:00<00:00, 41001.83it/s] 36%|███▌      | 8255/23248 [00:00<00:00, 41316.89it/s] 53%|█████▎    | 12387/23248 [00:00<00:00, 41265.14it/s] 71%|███████   | 16542/23248 [00:00<00:00, 41375.38it/s] 89%|████████▉ | 20680/23248 [00:00<00:00, 41316.99it/s]100%|██████████| 23248/23248 [00:00<00:00, 40878.27it/s]
dataset loaded from path: 
data/ud/ud-treebanks-v2.1/UD_Spanish/inter-layer-13/UD_Spanish-train-bloom-1b1.pkl
data/ud/ud-treebanks-v2.1/UD_Spanish/inter-layer-13/UD_Spanish-dev-bloom-1b1.pkl
data/ud/ud-treebanks-v2.1/UD_Spanish/inter-layer-13/UD_Spanish-test-bloom-1b1.pkl
Embedding dimensionality: 1536
Pre-training probe (if possible)...
Traceback (most recent call last):
  File "run.py", line 102, in <module>
    args.func(args)
  File "/home/s2308470/multilingual-typology-probing/commands.py", line 166, in greedy
    trainer.train()
  File "/home/s2308470/multilingual-typology-probing/probekit/trainers/trainer.py", line 21, in train
    self._train()
  File "/home/s2308470/multilingual-typology-probing/probekit/trainers/neural_probe_trainer.py", line 30, in _train
    self._train_for_dimensions()
  File "/home/s2308470/multilingual-typology-probing/trainers/flexible_neural_probe_trainer.py", line 72, in _train_for_dimensions
    inputs_tensor_shuffled = inputs_tensor[shuffled_indices]
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 1.63 GiB (GPU 0; 5.94 GiB total capacity; 4.18 GiB already allocated; 1.51 GiB free; 4.21 GiB reserved in total by PyTorch) If reserved memory is >> allocated memory try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF
