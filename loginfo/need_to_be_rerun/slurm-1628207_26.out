python run.py --language UD_Catalan --experiment-name inter-layer-13 --attribute POS --trainer poisson --gpu --embedding bloom-1b1-intermediate-global_step500000 greedy --selection-size 50 --selection-criterion mi
Setting up datasets (['UD_Catalan'], POS) and probes...
  0%|          | 0/441656 [00:00<?, ?it/s]  1%|          | 2275/441656 [00:00<00:19, 22747.64it/s]  1%|          | 5306/441656 [00:00<00:16, 27192.06it/s]  2%|▏         | 8333/441656 [00:00<00:15, 28478.25it/s]  3%|▎         | 11374/441656 [00:00<00:14, 29234.86it/s]  3%|▎         | 14434/441656 [00:00<00:14, 29725.70it/s]  4%|▍         | 17411/441656 [00:00<00:14, 29738.13it/s]  5%|▍         | 20461/441656 [00:00<00:14, 29985.86it/s]  5%|▌         | 23460/441656 [00:00<00:13, 29892.97it/s]  6%|▌         | 26531/441656 [00:00<00:13, 30145.07it/s]  7%|▋         | 29546/441656 [00:01<00:13, 30067.51it/s]  7%|▋         | 32615/441656 [00:01<00:13, 30255.53it/s]  8%|▊         | 35641/441656 [00:01<00:13, 30127.97it/s]  9%|▉         | 38654/441656 [00:01<00:32, 12353.90it/s]  9%|▉         | 41678/441656 [00:01<00:26, 15038.23it/s] 10%|█         | 44650/441656 [00:01<00:22, 17630.69it/s] 11%|█         | 47694/441656 [00:02<00:19, 20210.33it/s] 11%|█▏        | 50699/441656 [00:02<00:17, 22408.75it/s] 12%|█▏        | 53765/441656 [00:02<00:15, 24404.98it/s] 13%|█▎        | 56807/441656 [00:02<00:14, 25825.73it/s] 14%|█▎        | 59848/441656 [00:02<00:14, 27050.70it/s] 14%|█▍        | 62810/441656 [00:02<00:13, 27578.89it/s] 15%|█▍        | 65809/441656 [00:02<00:13, 28255.94it/s] 16%|█▌        | 68885/441656 [00:02<00:12, 28973.60it/s] 16%|█▋        | 71889/441656 [00:02<00:12, 29282.70it/s] 17%|█▋        | 74971/441656 [00:02<00:12, 29733.38it/s] 18%|█▊        | 77994/441656 [00:03<00:12, 29820.32it/s] 18%|█▊        | 81070/441656 [00:03<00:11, 30097.97it/s] 19%|█▉        | 84105/441656 [00:03<00:11, 30168.30it/s] 20%|█▉        | 87139/441656 [00:03<00:32, 10994.87it/s] 20%|██        | 90207/441656 [00:04<00:25, 13635.54it/s] 21%|██        | 93235/441656 [00:04<00:21, 16312.27it/s] 22%|██▏       | 96306/441656 [00:04<00:18, 19001.24it/s] 22%|██▏       | 99321/441656 [00:04<00:16, 21349.62it/s] 23%|██▎       | 102397/441656 [00:04<00:14, 23525.66it/s] 24%|██▍       | 105410/441656 [00:04<00:13, 25165.45it/s] 25%|██▍       | 108444/441656 [00:04<00:12, 26519.78it/s] 25%|██▌       | 111497/441656 [00:04<00:11, 27610.14it/s] 26%|██▌       | 114494/441656 [00:04<00:11, 27833.49it/s] 27%|██▋       | 117554/441656 [00:04<00:11, 28614.45it/s] 27%|██▋       | 120538/441656 [00:05<00:11, 28963.45it/s] 28%|██▊       | 123599/441656 [00:05<00:10, 29440.93it/s] 29%|██▊       | 126605/441656 [00:05<00:10, 29523.46it/s] 29%|██▉       | 129636/441656 [00:05<00:10, 29753.95it/s] 30%|███       | 132651/441656 [00:05<00:10, 29867.76it/s] 31%|███       | 135690/441656 [00:05<00:10, 30019.55it/s] 31%|███▏      | 138772/441656 [00:05<00:10, 30256.52it/s] 32%|███▏      | 141809/441656 [00:05<00:09, 30270.40it/s] 33%|███▎      | 144901/441656 [00:05<00:09, 30462.79it/s] 33%|███▎      | 147953/441656 [00:05<00:09, 29922.80it/s] 34%|███▍      | 150952/441656 [00:06<00:32, 8963.09it/s]  35%|███▍      | 153813/441656 [00:06<00:25, 11167.82it/s] 36%|███▌      | 156880/441656 [00:07<00:20, 13862.24it/s] 36%|███▌      | 159939/441656 [00:07<00:16, 16618.88it/s] 37%|███▋      | 162907/441656 [00:07<00:14, 19107.40it/s] 38%|███▊      | 165953/441656 [00:07<00:12, 21535.87it/s] 38%|███▊      | 168945/441656 [00:07<00:11, 23496.79it/s] 39%|███▉      | 171983/441656 [00:07<00:10, 25221.12it/s] 40%|███▉      | 174991/441656 [00:07<00:10, 26501.72it/s] 40%|████      | 178082/441656 [00:07<00:09, 27706.27it/s] 41%|████      | 181090/441656 [00:07<00:09, 28372.71it/s] 42%|████▏     | 184181/441656 [00:07<00:08, 29098.39it/s] 42%|████▏     | 187212/441656 [00:08<00:08, 29177.02it/s] 43%|████▎     | 190247/441656 [00:08<00:08, 29517.20it/s] 44%|████▍     | 193290/441656 [00:08<00:08, 29784.61it/s] 44%|████▍     | 196329/441656 [00:08<00:08, 29962.25it/s] 45%|████▌     | 199403/441656 [00:08<00:08, 30190.97it/s] 46%|████▌     | 202448/441656 [00:08<00:07, 30266.68it/s] 47%|████▋     | 205502/441656 [00:08<00:07, 30345.83it/s] 47%|████▋     | 208548/441656 [00:08<00:07, 30293.95it/s] 48%|████▊     | 211585/441656 [00:08<00:07, 30314.34it/s] 49%|████▊     | 214622/441656 [00:08<00:07, 30315.86it/s] 49%|████▉     | 217658/441656 [00:09<00:07, 29810.27it/s] 50%|████▉     | 220741/441656 [00:09<00:07, 30109.35it/s] 51%|█████     | 223756/441656 [00:09<00:07, 30041.43it/s] 51%|█████▏    | 226836/441656 [00:09<00:07, 30266.04it/s] 52%|█████▏    | 229865/441656 [00:10<00:28, 7549.34it/s]  53%|█████▎    | 232886/441656 [00:10<00:21, 9724.83it/s] 53%|█████▎    | 235892/441656 [00:10<00:16, 12177.37it/s] 54%|█████▍    | 238921/441656 [00:10<00:13, 14839.30it/s] 55%|█████▍    | 241984/441656 [00:10<00:11, 17578.64it/s] 55%|█████▌    | 244988/441656 [00:10<00:09, 20053.63it/s] 56%|█████▌    | 248053/441656 [00:11<00:08, 22395.06it/s] 57%|█████▋    | 251035/441656 [00:11<00:07, 24175.83it/s] 58%|█████▊    | 254080/441656 [00:11<00:07, 25775.93it/s] 58%|█████▊    | 257060/441656 [00:11<00:07, 26301.41it/s] 59%|█████▉    | 260065/441656 [00:11<00:06, 27320.69it/s] 60%|█████▉    | 263051/441656 [00:11<00:06, 28028.89it/s] 60%|██████    | 266006/441656 [00:11<00:06, 28333.80it/s] 61%|██████    | 268947/441656 [00:11<00:06, 28615.59it/s] 62%|██████▏   | 271889/441656 [00:11<00:05, 28847.71it/s] 62%|██████▏   | 274838/441656 [00:12<00:05, 29034.28it/s] 63%|██████▎   | 277802/441656 [00:12<00:05, 29212.28it/s] 64%|██████▎   | 280751/441656 [00:12<00:05, 29237.12it/s] 64%|██████▍   | 283738/441656 [00:12<00:05, 29422.27it/s] 65%|██████▍   | 286694/441656 [00:12<00:05, 29299.98it/s] 66%|██████▌   | 289634/441656 [00:12<00:05, 29066.33it/s] 66%|██████▌   | 292548/441656 [00:12<00:05, 29068.16it/s] 67%|██████▋   | 295517/441656 [00:12<00:04, 29250.24it/s] 68%|██████▊   | 298459/441656 [00:12<00:04, 29299.92it/s] 68%|██████▊   | 301400/441656 [00:12<00:04, 29330.70it/s] 69%|██████▉   | 304371/441656 [00:13<00:04, 29443.53it/s] 70%|██████▉   | 307317/441656 [00:13<00:04, 29447.40it/s] 70%|███████   | 310292/441656 [00:13<00:04, 29534.88it/s] 71%|███████   | 313272/441656 [00:13<00:04, 29613.72it/s] 72%|███████▏  | 316234/441656 [00:13<00:04, 29532.54it/s] 72%|███████▏  | 319188/441656 [00:13<00:04, 29512.44it/s] 73%|███████▎  | 322140/441656 [00:13<00:04, 29437.53it/s] 74%|███████▎  | 325100/441656 [00:13<00:03, 29482.50it/s] 74%|███████▍  | 328077/441656 [00:13<00:03, 29567.70it/s] 75%|███████▍  | 331034/441656 [00:15<00:16, 6613.85it/s]  76%|███████▌  | 333794/441656 [00:15<00:12, 8446.55it/s] 76%|███████▌  | 336450/441656 [00:15<00:10, 10455.38it/s] 77%|███████▋  | 339129/441656 [00:15<00:08, 12689.47it/s] 77%|███████▋  | 341879/441656 [00:15<00:06, 15110.05it/s] 78%|███████▊  | 344610/441656 [00:15<00:05, 17419.07it/s] 79%|███████▊  | 347332/441656 [00:15<00:04, 19505.13it/s] 79%|███████▉  | 350094/441656 [00:15<00:04, 21396.81it/s] 80%|███████▉  | 352828/441656 [00:15<00:03, 22881.52it/s] 81%|████████  | 355595/441656 [00:15<00:03, 24139.90it/s] 81%|████████  | 358319/441656 [00:16<00:03, 24985.79it/s] 82%|████████▏ | 361061/441656 [00:16<00:03, 25666.50it/s] 82%|████████▏ | 363819/441656 [00:16<00:02, 26212.36it/s] 83%|████████▎ | 366556/441656 [00:16<00:02, 26485.11it/s] 84%|████████▎ | 369286/441656 [00:16<00:02, 26302.87it/s] 84%|████████▍ | 372043/441656 [00:16<00:02, 26669.44it/s] 85%|████████▍ | 374758/441656 [00:16<00:02, 26809.68it/s] 85%|████████▌ | 377495/441656 [00:16<00:02, 26971.74it/s] 86%|████████▌ | 380275/441656 [00:16<00:02, 27216.39it/s] 87%|████████▋ | 383012/441656 [00:16<00:02, 27163.56it/s] 87%|████████▋ | 385773/441656 [00:17<00:02, 27295.35it/s] 88%|████████▊ | 388510/441656 [00:17<00:01, 27302.21it/s] 89%|████████▊ | 391299/441656 [00:17<00:01, 27476.54it/s] 89%|████████▉ | 394051/441656 [00:17<00:01, 27360.22it/s] 90%|████████▉ | 396813/441656 [00:17<00:01, 27436.53it/s] 90%|█████████ | 399559/441656 [00:17<00:01, 27390.55it/s] 91%|█████████ | 402300/441656 [00:17<00:01, 27367.92it/s] 92%|█████████▏| 405045/441656 [00:17<00:01, 27389.62it/s] 92%|█████████▏| 407785/441656 [00:17<00:01, 27003.65it/s] 93%|█████████▎| 410487/441656 [00:17<00:01, 26822.17it/s] 94%|█████████▎| 413236/441656 [00:18<00:01, 27019.16it/s] 94%|█████████▍| 415981/441656 [00:18<00:00, 27146.33it/s] 95%|█████████▍| 418702/441656 [00:18<00:00, 27083.42it/s] 95%|█████████▌| 421411/441656 [00:18<00:00, 27047.88it/s] 96%|█████████▌| 424122/441656 [00:18<00:00, 27063.78it/s] 97%|█████████▋| 426876/441656 [00:18<00:00, 27203.72it/s] 97%|█████████▋| 429597/441656 [00:18<00:00, 27148.18it/s] 98%|█████████▊| 432355/441656 [00:18<00:00, 27276.01it/s] 99%|█████████▊| 435120/441656 [00:18<00:00, 27386.69it/s] 99%|█████████▉| 437859/441656 [00:18<00:00, 27290.71it/s]100%|█████████▉| 440614/441656 [00:19<00:00, 27365.49it/s]100%|██████████| 441656/441656 [00:19<00:00, 23080.30it/s]
  0%|          | 0/53198 [00:00<?, ?it/s]  6%|▋         | 3455/53198 [00:00<00:01, 34542.13it/s] 13%|█▎        | 6910/53198 [00:00<00:01, 33905.75it/s] 19%|█▉        | 10331/53198 [00:00<00:01, 34039.71it/s] 26%|██▌       | 13803/53198 [00:00<00:01, 34304.17it/s] 33%|███▎      | 17309/53198 [00:00<00:01, 34572.64it/s] 39%|███▉      | 20799/53198 [00:00<00:00, 34682.05it/s] 46%|████▌     | 24268/53198 [00:00<00:00, 34599.95it/s] 52%|█████▏    | 27796/53198 [00:00<00:00, 34813.18it/s] 59%|█████▉    | 31278/53198 [00:00<00:00, 34184.60it/s] 65%|██████▌   | 34736/53198 [00:01<00:00, 34303.00it/s] 72%|███████▏  | 38169/53198 [00:01<00:00, 34165.30it/s] 78%|███████▊  | 41587/53198 [00:01<00:00, 34139.88it/s] 85%|████████▍ | 45002/53198 [00:01<00:00, 34129.57it/s] 91%|█████████ | 48507/53198 [00:01<00:00, 34404.94it/s] 98%|█████████▊| 51949/53198 [00:01<00:00, 34324.60it/s]100%|██████████| 53198/53198 [00:01<00:00, 34327.54it/s]
  0%|          | 0/35912 [00:00<?, ?it/s] 10%|█         | 3685/35912 [00:00<00:00, 36847.05it/s] 21%|██        | 7370/35912 [00:00<00:00, 35724.11it/s] 31%|███       | 11116/35912 [00:00<00:00, 36498.81it/s] 41%|████      | 14769/35912 [00:00<00:00, 36502.99it/s] 51%|█████▏    | 18421/35912 [00:00<00:00, 35708.18it/s] 61%|██████    | 21996/35912 [00:00<00:00, 35120.63it/s] 71%|███████   | 25512/35912 [00:00<00:00, 34943.18it/s] 81%|████████  | 29009/35912 [00:00<00:00, 34609.65it/s] 90%|█████████ | 32472/35912 [00:00<00:00, 34430.85it/s]100%|██████████| 35912/35912 [00:01<00:00, 35102.20it/s]
dataset loaded from path: 
data/ud/ud-treebanks-v2.1/UD_Catalan/inter-layer-13/UD_Catalan-train-bloom-1b1-intermediate-global_step500000.pkl
data/ud/ud-treebanks-v2.1/UD_Catalan/inter-layer-13/UD_Catalan-dev-bloom-1b1-intermediate-global_step500000.pkl
data/ud/ud-treebanks-v2.1/UD_Catalan/inter-layer-13/UD_Catalan-test-bloom-1b1-intermediate-global_step500000.pkl
Embedding dimensionality: 1536
Pre-training probe (if possible)...
Traceback (most recent call last):
  File "run.py", line 102, in <module>
    args.func(args)
  File "/home/s2308470/multilingual-typology-probing/commands.py", line 166, in greedy
    trainer.train()
  File "/home/s2308470/multilingual-typology-probing/probekit/trainers/trainer.py", line 21, in train
    self._train()
  File "/home/s2308470/multilingual-typology-probing/probekit/trainers/neural_probe_trainer.py", line 30, in _train
    self._train_for_dimensions()
  File "/home/s2308470/multilingual-typology-probing/trainers/flexible_neural_probe_trainer.py", line 72, in _train_for_dimensions
    inputs_tensor_shuffled = inputs_tensor[shuffled_indices]
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 2.21 GiB (GPU 0; 5.94 GiB total capacity; 5.41 GiB already allocated; 285.31 MiB free; 5.44 GiB reserved in total by PyTorch) If reserved memory is >> allocated memory try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF
