python run.py --language UD_Spanish --experiment-name inter-layer-13 --attribute POS --trainer poisson --gpu --embedding bloom-1b1-intermediate-global_step600000 greedy --selection-size 50 --selection-criterion mi
Setting up datasets (['UD_Spanish'], POS) and probes...
  0%|          | 0/343741 [00:00<?, ?it/s]  1%|          | 2417/343741 [00:00<00:14, 24161.67it/s]  2%|▏         | 5506/343741 [00:00<00:12, 28117.70it/s]  2%|▏         | 8549/343741 [00:00<00:11, 29171.77it/s]  3%|▎         | 11639/343741 [00:00<00:11, 29851.50it/s]  4%|▍         | 14720/343741 [00:00<00:10, 30193.27it/s]  5%|▌         | 17886/343741 [00:00<00:10, 30689.13it/s]  6%|▌         | 20955/343741 [00:01<00:23, 13736.83it/s]  7%|▋         | 24073/343741 [00:01<00:19, 16751.55it/s]  8%|▊         | 27111/343741 [00:01<00:16, 19449.68it/s]  9%|▉         | 30204/343741 [00:01<00:14, 21979.70it/s] 10%|▉         | 33229/343741 [00:01<00:12, 23960.49it/s] 11%|█         | 36357/343741 [00:01<00:11, 25825.24it/s] 11%|█▏        | 39482/343741 [00:01<00:11, 27154.45it/s] 12%|█▏        | 42608/343741 [00:01<00:10, 28283.60it/s] 13%|█▎        | 45641/343741 [00:01<00:10, 28671.56it/s] 14%|█▍        | 48674/343741 [00:01<00:10, 29144.30it/s] 15%|█▌        | 51780/343741 [00:02<00:09, 29697.74it/s] 16%|█▌        | 54825/343741 [00:02<00:09, 29773.10it/s] 17%|█▋        | 57947/343741 [00:02<00:09, 30195.40it/s] 18%|█▊        | 61004/343741 [00:02<00:21, 12861.84it/s] 19%|█▊        | 64118/343741 [00:02<00:17, 15640.54it/s] 19%|█▉        | 66742/343741 [00:03<00:15, 17531.38it/s] 20%|██        | 69522/343741 [00:03<00:13, 19615.92it/s] 21%|██        | 72455/343741 [00:03<00:12, 21799.99it/s] 22%|██▏       | 75494/343741 [00:03<00:11, 23887.19it/s] 23%|██▎       | 78569/343741 [00:03<00:10, 25655.05it/s] 24%|██▎       | 81631/343741 [00:03<00:09, 26989.68it/s] 25%|██▍       | 84694/343741 [00:03<00:09, 27998.97it/s] 26%|██▌       | 87834/343741 [00:03<00:08, 28962.61it/s] 26%|██▋       | 90921/343741 [00:03<00:08, 29511.14it/s] 27%|██▋       | 94071/343741 [00:03<00:08, 30090.98it/s] 28%|██▊       | 97148/343741 [00:04<00:08, 30168.78it/s] 29%|██▉       | 100213/343741 [00:04<00:08, 29669.68it/s] 30%|███       | 103215/343741 [00:04<00:08, 29075.96it/s] 31%|███       | 106149/343741 [00:04<00:08, 28987.86it/s] 32%|███▏      | 109066/343741 [00:04<00:08, 28653.30it/s] 33%|███▎      | 111945/343741 [00:05<00:20, 11440.89it/s] 33%|███▎      | 114781/343741 [00:05<00:16, 13847.66it/s] 34%|███▍      | 117553/343741 [00:05<00:13, 16190.48it/s] 35%|███▌      | 120365/343741 [00:05<00:12, 18509.06it/s] 36%|███▌      | 123257/343741 [00:05<00:10, 20771.13it/s] 37%|███▋      | 126015/343741 [00:05<00:09, 22383.12it/s] 37%|███▋      | 128841/343741 [00:05<00:09, 23867.01it/s] 38%|███▊      | 131644/343741 [00:05<00:08, 24970.00it/s] 39%|███▉      | 134401/343741 [00:05<00:08, 25598.62it/s] 40%|███▉      | 137148/343741 [00:05<00:07, 26053.62it/s] 41%|████      | 139890/343741 [00:06<00:07, 26443.26it/s] 42%|████▏     | 142706/343741 [00:06<00:07, 26939.06it/s] 42%|████▏     | 145515/343741 [00:06<00:07, 27275.31it/s] 43%|████▎     | 148292/343741 [00:06<00:07, 27155.10it/s] 44%|████▍     | 151130/343741 [00:06<00:07, 27358.85it/s] 45%|████▍     | 153932/343741 [00:06<00:06, 27552.86it/s] 46%|████▌     | 156705/343741 [00:06<00:06, 27515.46it/s] 46%|████▋     | 159524/343741 [00:06<00:06, 27714.40it/s] 47%|████▋     | 162305/343741 [00:06<00:06, 27696.41it/s] 48%|████▊     | 165106/343741 [00:06<00:06, 27788.98it/s] 49%|████▉     | 167922/343741 [00:07<00:06, 27897.17it/s] 50%|████▉     | 170715/343741 [00:07<00:06, 27903.65it/s] 50%|█████     | 173559/343741 [00:07<00:06, 28060.80it/s] 51%|█████▏    | 176367/343741 [00:08<00:17, 9836.08it/s]  52%|█████▏    | 179120/343741 [00:08<00:13, 12142.60it/s] 53%|█████▎    | 181946/343741 [00:08<00:11, 14672.97it/s] 54%|█████▎    | 184751/343741 [00:08<00:09, 17123.11it/s] 55%|█████▍    | 187511/343741 [00:08<00:08, 19294.90it/s] 55%|█████▌    | 190325/343741 [00:08<00:07, 21315.40it/s] 56%|█████▌    | 193120/343741 [00:08<00:06, 22948.08it/s] 57%|█████▋    | 195831/343741 [00:08<00:06, 23863.52it/s] 58%|█████▊    | 198676/343741 [00:08<00:05, 25099.43it/s] 59%|█████▊    | 201498/343741 [00:08<00:05, 25964.98it/s] 59%|█████▉    | 204309/343741 [00:09<00:05, 26572.58it/s] 60%|██████    | 207169/343741 [00:09<00:05, 27156.14it/s] 61%|██████    | 210026/343741 [00:09<00:04, 27565.93it/s] 62%|██████▏   | 212844/343741 [00:09<00:04, 27537.43it/s] 63%|██████▎   | 215709/343741 [00:09<00:04, 27862.44it/s] 64%|██████▎   | 218526/343741 [00:09<00:04, 27822.20it/s] 64%|██████▍   | 221339/343741 [00:09<00:04, 27912.45it/s] 65%|██████▌   | 224188/343741 [00:09<00:04, 28082.79it/s] 66%|██████▌   | 227007/343741 [00:09<00:04, 27660.05it/s] 67%|██████▋   | 229857/343741 [00:09<00:04, 27902.79it/s] 68%|██████▊   | 232699/343741 [00:10<00:03, 28054.76it/s] 69%|██████▊   | 235510/343741 [00:10<00:03, 27961.80it/s] 69%|██████▉   | 238322/343741 [00:10<00:03, 28006.15it/s] 70%|███████   | 241171/343741 [00:10<00:03, 28149.90it/s] 71%|███████   | 243994/343741 [00:10<00:03, 28172.94it/s] 72%|███████▏  | 246833/343741 [00:10<00:03, 28236.55it/s] 73%|███████▎  | 249689/343741 [00:10<00:03, 28331.21it/s] 73%|███████▎  | 252523/343741 [00:10<00:03, 28158.83it/s] 74%|███████▍  | 255340/343741 [00:11<00:10, 8502.32it/s]  75%|███████▌  | 258152/343741 [00:11<00:07, 10738.67it/s] 76%|███████▌  | 260927/343741 [00:11<00:06, 13120.68it/s] 77%|███████▋  | 263762/343741 [00:11<00:05, 15659.29it/s] 78%|███████▊  | 266613/343741 [00:12<00:04, 18130.82it/s] 78%|███████▊  | 269258/343741 [00:12<00:03, 19856.84it/s] 79%|███████▉  | 271984/343741 [00:12<00:03, 21594.18it/s] 80%|███████▉  | 274775/343741 [00:12<00:02, 23180.05it/s] 81%|████████  | 277490/343741 [00:12<00:02, 24226.30it/s] 82%|████████▏ | 280336/343741 [00:12<00:02, 25383.30it/s] 82%|████████▏ | 283167/343741 [00:12<00:02, 26205.45it/s] 83%|████████▎ | 285939/343741 [00:12<00:02, 26568.18it/s] 84%|████████▍ | 288770/343741 [00:12<00:02, 27071.14it/s] 85%|████████▍ | 291554/343741 [00:12<00:01, 27295.66it/s] 86%|████████▌ | 294357/343741 [00:13<00:01, 27511.27it/s] 86%|████████▋ | 297147/343741 [00:13<00:01, 27527.13it/s] 87%|████████▋ | 299927/343741 [00:13<00:01, 27331.61it/s] 88%|████████▊ | 302680/343741 [00:13<00:01, 27326.76it/s] 89%|████████▉ | 305469/343741 [00:13<00:01, 27491.97it/s] 90%|████████▉ | 308312/343741 [00:13<00:01, 27769.94it/s] 91%|█████████ | 311096/343741 [00:13<00:01, 27773.05it/s] 91%|█████████▏| 313879/343741 [00:13<00:01, 27715.30it/s] 92%|█████████▏| 316750/343741 [00:13<00:00, 28010.80it/s] 93%|█████████▎| 319554/343741 [00:13<00:00, 27927.66it/s] 94%|█████████▍| 322376/343741 [00:14<00:00, 28012.14it/s] 95%|█████████▍| 325179/343741 [00:14<00:00, 27965.96it/s] 95%|█████████▌| 327977/343741 [00:14<00:00, 27919.85it/s] 96%|█████████▌| 330844/343741 [00:14<00:00, 28143.43it/s] 97%|█████████▋| 333659/343741 [00:14<00:00, 27833.11it/s] 98%|█████████▊| 336451/343741 [00:14<00:00, 27855.55it/s] 99%|█████████▊| 339254/343741 [00:14<00:00, 27906.58it/s]100%|█████████▉| 342092/343741 [00:14<00:00, 28047.41it/s]100%|██████████| 343741/343741 [00:14<00:00, 23260.65it/s]
  0%|          | 0/56357 [00:00<?, ?it/s]  6%|▌         | 3511/56357 [00:00<00:01, 35101.92it/s] 12%|█▏        | 7024/56357 [00:00<00:01, 35115.75it/s] 19%|█▊        | 10536/56357 [00:00<00:01, 34632.10it/s] 25%|██▌       | 14226/56357 [00:00<00:01, 35517.81it/s] 32%|███▏      | 17968/56357 [00:00<00:01, 36199.15it/s] 39%|███▉      | 21868/56357 [00:00<00:00, 37025.89it/s] 46%|████▌     | 25712/56357 [00:00<00:00, 37484.25it/s] 52%|█████▏    | 29461/56357 [00:00<00:00, 37042.95it/s] 59%|█████▉    | 33295/56357 [00:00<00:00, 37441.56it/s] 66%|██████▌   | 37041/56357 [00:01<00:00, 37138.90it/s] 72%|███████▏  | 40757/56357 [00:01<00:00, 36509.19it/s] 79%|███████▉  | 44411/56357 [00:01<00:00, 36085.92it/s] 85%|████████▌ | 48022/56357 [00:01<00:00, 35639.50it/s] 92%|█████████▏| 51588/56357 [00:01<00:00, 35313.36it/s] 98%|█████████▊| 55362/56357 [00:01<00:00, 36024.78it/s]100%|██████████| 56357/56357 [00:01<00:00, 36232.20it/s]
  0%|          | 0/23248 [00:00<?, ?it/s] 16%|█▌        | 3760/23248 [00:00<00:00, 37591.52it/s] 32%|███▏      | 7520/23248 [00:00<00:00, 37221.44it/s] 48%|████▊     | 11254/23248 [00:00<00:00, 37271.10it/s] 65%|██████▍   | 15071/23248 [00:00<00:00, 37622.45it/s] 81%|████████  | 18883/23248 [00:00<00:00, 37798.15it/s] 97%|█████████▋| 22663/23248 [00:00<00:00, 37651.38it/s]100%|██████████| 23248/23248 [00:00<00:00, 37492.56it/s]
dataset loaded from path: 
data/ud/ud-treebanks-v2.1/UD_Spanish/inter-layer-13/UD_Spanish-train-bloom-1b1-intermediate-global_step600000.pkl
data/ud/ud-treebanks-v2.1/UD_Spanish/inter-layer-13/UD_Spanish-dev-bloom-1b1-intermediate-global_step600000.pkl
data/ud/ud-treebanks-v2.1/UD_Spanish/inter-layer-13/UD_Spanish-test-bloom-1b1-intermediate-global_step600000.pkl
Embedding dimensionality: 1536
Pre-training probe (if possible)...
Traceback (most recent call last):
  File "run.py", line 102, in <module>
    args.func(args)
  File "/home/s2308470/multilingual-typology-probing/commands.py", line 166, in greedy
    trainer.train()
  File "/home/s2308470/multilingual-typology-probing/probekit/trainers/trainer.py", line 21, in train
    self._train()
  File "/home/s2308470/multilingual-typology-probing/probekit/trainers/neural_probe_trainer.py", line 30, in _train
    self._train_for_dimensions()
  File "/home/s2308470/multilingual-typology-probing/trainers/flexible_neural_probe_trainer.py", line 72, in _train_for_dimensions
    inputs_tensor_shuffled = inputs_tensor[shuffled_indices]
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 1.63 GiB (GPU 0; 5.94 GiB total capacity; 4.18 GiB already allocated; 1.51 GiB free; 4.21 GiB reserved in total by PyTorch) If reserved memory is >> allocated memory try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF
