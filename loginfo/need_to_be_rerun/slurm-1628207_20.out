python run.py --language UD_Catalan --experiment-name inter-layer-13 --attribute POS --trainer poisson --gpu --embedding bloom-1b1-intermediate-global_step1000 greedy --selection-size 50 --selection-criterion mi
Setting up datasets (['UD_Catalan'], POS) and probes...
  0%|          | 0/441656 [00:00<?, ?it/s]  1%|          | 2445/441656 [00:00<00:17, 24442.97it/s]  1%|▏         | 5648/441656 [00:00<00:15, 28900.03it/s]  2%|▏         | 8733/441656 [00:00<00:14, 29785.72it/s]  3%|▎         | 11938/441656 [00:00<00:14, 30677.65it/s]  3%|▎         | 15092/441656 [00:00<00:13, 30985.04it/s]  4%|▍         | 18251/441656 [00:00<00:13, 31189.97it/s]  5%|▍         | 21401/441656 [00:00<00:13, 31290.20it/s]  6%|▌         | 24618/441656 [00:00<00:13, 31567.79it/s]  6%|▋         | 27775/441656 [00:00<00:13, 31549.71it/s]  7%|▋         | 31002/441656 [00:01<00:12, 31770.08it/s]  8%|▊         | 34180/441656 [00:01<00:12, 31699.74it/s]  8%|▊         | 37351/441656 [00:01<00:31, 12991.60it/s]  9%|▉         | 40494/441656 [00:01<00:25, 15774.03it/s] 10%|▉         | 43706/441656 [00:01<00:21, 18672.65it/s] 11%|█         | 46878/441656 [00:01<00:18, 21309.54it/s] 11%|█▏        | 50099/441656 [00:02<00:16, 23750.05it/s] 12%|█▏        | 53303/441656 [00:02<00:15, 25758.17it/s] 13%|█▎        | 56523/441656 [00:02<00:14, 27413.71it/s] 14%|█▎        | 59632/441656 [00:02<00:13, 27383.41it/s] 14%|█▍        | 62627/441656 [00:02<00:13, 27870.12it/s] 15%|█▍        | 65598/441656 [00:02<00:13, 28049.31it/s] 16%|█▌        | 68533/441656 [00:02<00:13, 28205.81it/s] 16%|█▌        | 71470/441656 [00:02<00:12, 28536.42it/s] 17%|█▋        | 74624/441656 [00:02<00:12, 29404.23it/s] 18%|█▊        | 77808/441656 [00:02<00:12, 30065.34it/s] 18%|█▊        | 80965/441656 [00:03<00:11, 30505.96it/s] 19%|█▉        | 84129/441656 [00:03<00:11, 30839.42it/s] 20%|█▉        | 87232/441656 [00:03<00:29, 11976.23it/s] 20%|██        | 90126/441656 [00:03<00:24, 14372.91it/s] 21%|██        | 92998/441656 [00:04<00:20, 16781.98it/s] 22%|██▏       | 95915/441656 [00:04<00:18, 19178.61it/s] 22%|██▏       | 98804/441656 [00:04<00:16, 21281.42it/s] 23%|██▎       | 101635/441656 [00:04<00:14, 22940.55it/s] 24%|██▎       | 104563/441656 [00:04<00:13, 24538.17it/s] 24%|██▍       | 107386/441656 [00:04<00:13, 25245.84it/s] 25%|██▍       | 110322/441656 [00:04<00:12, 26365.48it/s] 26%|██▌       | 113244/441656 [00:04<00:12, 27164.48it/s] 26%|██▋       | 116106/441656 [00:04<00:11, 27578.26it/s] 27%|██▋       | 119024/441656 [00:04<00:11, 28040.98it/s] 28%|██▊       | 121966/441656 [00:05<00:11, 28442.86it/s] 28%|██▊       | 124863/441656 [00:05<00:11, 28532.48it/s] 29%|██▉       | 127787/441656 [00:05<00:10, 28740.49it/s] 30%|██▉       | 130688/441656 [00:05<00:10, 28726.34it/s] 30%|███       | 133615/441656 [00:05<00:10, 28887.02it/s] 31%|███       | 136517/441656 [00:05<00:10, 28913.89it/s] 32%|███▏      | 139418/441656 [00:05<00:10, 28424.56it/s] 32%|███▏      | 142300/441656 [00:05<00:10, 28539.11it/s] 33%|███▎      | 145182/441656 [00:05<00:10, 28558.90it/s] 34%|███▎      | 148099/441656 [00:05<00:10, 28737.11it/s] 34%|███▍      | 150976/441656 [00:06<00:28, 10064.16it/s] 35%|███▍      | 153854/441656 [00:06<00:23, 12491.48it/s] 35%|███▌      | 156763/441656 [00:06<00:18, 15085.91it/s] 36%|███▌      | 159693/441656 [00:06<00:15, 17680.47it/s] 37%|███▋      | 162540/441656 [00:07<00:14, 19911.28it/s] 37%|███▋      | 165475/441656 [00:07<00:12, 22063.09it/s] 38%|███▊      | 168404/441656 [00:07<00:11, 23838.53it/s] 39%|███▉      | 171298/441656 [00:07<00:10, 25161.85it/s] 39%|███▉      | 174169/441656 [00:07<00:10, 26119.32it/s] 40%|████      | 177035/441656 [00:07<00:09, 26825.05it/s] 41%|████      | 179890/441656 [00:07<00:09, 27151.63it/s] 41%|████▏     | 182806/441656 [00:07<00:09, 27718.21it/s] 42%|████▏     | 185689/441656 [00:07<00:09, 28039.24it/s] 43%|████▎     | 188610/441656 [00:07<00:08, 28380.18it/s] 43%|████▎     | 191493/441656 [00:08<00:08, 28490.88it/s] 44%|████▍     | 194390/441656 [00:08<00:08, 28632.28it/s] 45%|████▍     | 197318/441656 [00:08<00:08, 28823.47it/s] 45%|████▌     | 200216/441656 [00:08<00:08, 28856.80it/s] 46%|████▌     | 203159/441656 [00:08<00:08, 29025.78it/s] 47%|████▋     | 206070/441656 [00:08<00:08, 29045.49it/s] 47%|████▋     | 208980/441656 [00:08<00:08, 28624.14it/s] 48%|████▊     | 211929/441656 [00:08<00:07, 28878.40it/s] 49%|████▊     | 214829/441656 [00:08<00:07, 28911.54it/s] 49%|████▉     | 217764/441656 [00:08<00:07, 29041.27it/s] 50%|████▉     | 220708/441656 [00:09<00:07, 29157.52it/s] 51%|█████     | 223626/441656 [00:09<00:07, 29106.93it/s] 51%|█████▏    | 226564/441656 [00:09<00:07, 29185.51it/s] 52%|█████▏    | 229484/441656 [00:09<00:07, 29121.36it/s] 53%|█████▎    | 232397/441656 [00:10<00:23, 9058.07it/s]  53%|█████▎    | 235326/441656 [00:10<00:18, 11430.23it/s] 54%|█████▍    | 238167/441656 [00:10<00:14, 13866.21it/s] 55%|█████▍    | 241101/441656 [00:10<00:12, 16497.70it/s] 55%|█████▌    | 244015/441656 [00:10<00:10, 18968.50it/s] 56%|█████▌    | 246775/441656 [00:10<00:09, 20851.02it/s] 57%|█████▋    | 249660/441656 [00:10<00:08, 22750.28it/s] 57%|█████▋    | 252614/441656 [00:10<00:07, 24469.13it/s] 58%|█████▊    | 255492/441656 [00:11<00:07, 25613.49it/s] 59%|█████▊    | 258439/441656 [00:11<00:06, 26674.36it/s] 59%|█████▉    | 261315/441656 [00:11<00:06, 27262.26it/s] 60%|█████▉    | 264263/441656 [00:11<00:06, 27896.71it/s] 60%|██████    | 267187/441656 [00:11<00:06, 28285.48it/s] 61%|██████    | 270092/441656 [00:11<00:06, 28491.75it/s] 62%|██████▏   | 273017/441656 [00:11<00:05, 28712.81it/s] 62%|██████▏   | 275927/441656 [00:11<00:05, 28441.37it/s] 63%|██████▎   | 278844/441656 [00:11<00:05, 28655.19it/s] 64%|██████▍   | 281768/441656 [00:11<00:05, 28827.01it/s] 64%|██████▍   | 284665/441656 [00:12<00:05, 28776.67it/s] 65%|██████▌   | 287568/441656 [00:12<00:05, 28849.11it/s] 66%|██████▌   | 290460/441656 [00:12<00:05, 28813.10it/s] 66%|██████▋   | 293403/441656 [00:12<00:05, 28994.05it/s] 67%|██████▋   | 296323/441656 [00:12<00:05, 29053.59it/s] 68%|██████▊   | 299231/441656 [00:12<00:04, 28896.18it/s] 68%|██████▊   | 302146/441656 [00:12<00:04, 28969.31it/s] 69%|██████▉   | 305045/441656 [00:12<00:04, 28683.97it/s] 70%|██████▉   | 307927/441656 [00:12<00:04, 28722.36it/s] 70%|███████   | 310850/441656 [00:12<00:04, 28870.61it/s] 71%|███████   | 313738/441656 [00:13<00:04, 28793.49it/s] 72%|███████▏  | 316667/441656 [00:13<00:04, 28940.11it/s] 72%|███████▏  | 319584/441656 [00:13<00:04, 29005.84it/s] 73%|███████▎  | 322485/441656 [00:13<00:04, 28950.45it/s] 74%|███████▎  | 325385/441656 [00:13<00:04, 28963.01it/s] 74%|███████▍  | 328282/441656 [00:13<00:03, 28820.70it/s] 75%|███████▍  | 331165/441656 [00:14<00:15, 7002.90it/s]  76%|███████▌  | 334060/441656 [00:14<00:11, 9062.57it/s] 76%|███████▋  | 336946/441656 [00:14<00:09, 11402.70it/s] 77%|███████▋  | 339862/441656 [00:14<00:07, 13968.11it/s] 78%|███████▊  | 342782/441656 [00:15<00:05, 16573.52it/s] 78%|███████▊  | 345646/441656 [00:15<00:05, 18942.82it/s] 79%|███████▉  | 348566/441656 [00:15<00:04, 21189.71it/s] 80%|███████▉  | 351477/441656 [00:15<00:03, 23075.73it/s] 80%|████████  | 354361/441656 [00:15<00:03, 24539.39it/s] 81%|████████  | 357253/441656 [00:15<00:03, 25705.31it/s] 82%|████████▏ | 360117/441656 [00:15<00:03, 26370.03it/s] 82%|████████▏ | 363020/441656 [00:15<00:02, 27117.54it/s] 83%|████████▎ | 365941/441656 [00:15<00:02, 27716.17it/s] 84%|████████▎ | 368822/441656 [00:15<00:02, 28009.02it/s] 84%|████████▍ | 371749/441656 [00:16<00:02, 28375.46it/s] 85%|████████▍ | 374642/441656 [00:16<00:02, 28453.12it/s] 85%|████████▌ | 377554/441656 [00:16<00:02, 28647.50it/s] 86%|████████▌ | 380464/441656 [00:16<00:02, 28779.39it/s] 87%|████████▋ | 383362/441656 [00:16<00:02, 28758.01it/s] 87%|████████▋ | 386252/441656 [00:16<00:01, 28748.10it/s] 88%|████████▊ | 389165/441656 [00:16<00:01, 28860.83it/s] 89%|████████▉ | 392058/441656 [00:16<00:01, 28429.59it/s] 89%|████████▉ | 394966/441656 [00:16<00:01, 28621.37it/s] 90%|█████████ | 397850/441656 [00:16<00:01, 28685.51it/s] 91%|█████████ | 400743/441656 [00:17<00:01, 28757.40it/s] 91%|█████████▏| 403658/441656 [00:17<00:01, 28873.61it/s] 92%|█████████▏| 406548/441656 [00:17<00:01, 28817.40it/s] 93%|█████████▎| 409470/441656 [00:17<00:01, 28935.23it/s] 93%|█████████▎| 412391/441656 [00:17<00:01, 29016.40it/s] 94%|█████████▍| 415294/441656 [00:17<00:00, 28601.62it/s] 95%|█████████▍| 418210/441656 [00:17<00:00, 28764.91it/s] 95%|█████████▌| 421088/441656 [00:17<00:00, 28348.03it/s] 96%|█████████▌| 423998/441656 [00:17<00:00, 28566.77it/s] 97%|█████████▋| 426907/441656 [00:17<00:00, 28720.08it/s] 97%|█████████▋| 429781/441656 [00:18<00:00, 28655.87it/s] 98%|█████████▊| 432707/441656 [00:18<00:00, 28834.09it/s] 99%|█████████▊| 435592/441656 [00:18<00:00, 28800.57it/s] 99%|█████████▉| 438496/441656 [00:18<00:00, 28871.07it/s]100%|█████████▉| 441404/441656 [00:18<00:00, 28931.72it/s]100%|██████████| 441656/441656 [00:18<00:00, 23859.92it/s]
  0%|          | 0/53198 [00:00<?, ?it/s]  7%|▋         | 3934/53198 [00:00<00:01, 39329.63it/s] 15%|█▍        | 7867/53198 [00:00<00:01, 38947.88it/s] 22%|██▏       | 11833/53198 [00:00<00:01, 39266.69it/s] 30%|██▉       | 15853/53198 [00:00<00:00, 39631.89it/s] 37%|███▋      | 19860/53198 [00:00<00:00, 39787.61it/s] 45%|████▍     | 23839/53198 [00:00<00:00, 39022.92it/s] 52%|█████▏    | 27745/53198 [00:00<00:00, 38575.31it/s] 59%|█████▉    | 31605/53198 [00:00<00:00, 38473.57it/s] 67%|██████▋   | 35571/53198 [00:00<00:00, 38837.16it/s] 74%|███████▍  | 39457/53198 [00:01<00:00, 38785.75it/s] 82%|████████▏ | 43384/53198 [00:01<00:00, 38931.90it/s] 89%|████████▉ | 47357/53198 [00:01<00:00, 39172.57it/s] 96%|█████████▋| 51275/53198 [00:01<00:00, 39131.02it/s]100%|██████████| 53198/53198 [00:01<00:00, 38945.36it/s]
  0%|          | 0/35912 [00:00<?, ?it/s] 11%|█         | 3821/35912 [00:00<00:00, 38203.84it/s] 21%|██▏       | 7716/35912 [00:00<00:00, 38637.01it/s] 33%|███▎      | 11679/35912 [00:00<00:00, 39086.39it/s] 44%|████▎     | 15628/35912 [00:00<00:00, 39244.25it/s] 54%|█████▍    | 19553/35912 [00:00<00:00, 38542.71it/s] 65%|██████▌   | 23410/35912 [00:00<00:00, 37810.20it/s] 76%|███████▌  | 27195/35912 [00:00<00:00, 37344.16it/s] 86%|████████▌ | 30969/35912 [00:00<00:00, 37454.48it/s] 97%|█████████▋| 34909/35912 [00:00<00:00, 38051.19it/s]100%|██████████| 35912/35912 [00:00<00:00, 38186.96it/s]
dataset loaded from path: 
data/ud/ud-treebanks-v2.1/UD_Catalan/inter-layer-13/UD_Catalan-train-bloom-1b1-intermediate-global_step1000.pkl
data/ud/ud-treebanks-v2.1/UD_Catalan/inter-layer-13/UD_Catalan-dev-bloom-1b1-intermediate-global_step1000.pkl
data/ud/ud-treebanks-v2.1/UD_Catalan/inter-layer-13/UD_Catalan-test-bloom-1b1-intermediate-global_step1000.pkl
Embedding dimensionality: 1536
Pre-training probe (if possible)...
Traceback (most recent call last):
  File "run.py", line 102, in <module>
    args.func(args)
  File "/home/s2308470/multilingual-typology-probing/commands.py", line 166, in greedy
    trainer.train()
  File "/home/s2308470/multilingual-typology-probing/probekit/trainers/trainer.py", line 21, in train
    self._train()
  File "/home/s2308470/multilingual-typology-probing/probekit/trainers/neural_probe_trainer.py", line 30, in _train
    self._train_for_dimensions()
  File "/home/s2308470/multilingual-typology-probing/trainers/flexible_neural_probe_trainer.py", line 72, in _train_for_dimensions
    inputs_tensor_shuffled = inputs_tensor[shuffled_indices]
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 2.21 GiB (GPU 0; 5.94 GiB total capacity; 5.41 GiB already allocated; 285.31 MiB free; 5.44 GiB reserved in total by PyTorch) If reserved memory is >> allocated memory try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF
