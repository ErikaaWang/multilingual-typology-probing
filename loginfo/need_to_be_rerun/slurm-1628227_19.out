python run.py --language UD_Catalan --experiment-name inter-layer-17 --attribute POS --trainer poisson --gpu --embedding bloom-1b1 greedy --selection-size 50 --selection-criterion mi
Setting up datasets (['UD_Catalan'], POS) and probes...
  0%|          | 0/441656 [00:00<?, ?it/s]  0%|          | 2166/441656 [00:00<00:20, 21657.28it/s]  1%|          | 5020/441656 [00:00<00:16, 25701.93it/s]  2%|▏         | 7948/441656 [00:00<00:15, 27333.08it/s]  2%|▏         | 10682/441656 [00:00<00:15, 27190.02it/s]  3%|▎         | 13597/441656 [00:00<00:15, 27891.64it/s]  4%|▎         | 16516/441656 [00:00<00:15, 28331.34it/s]  4%|▍         | 19358/441656 [00:00<00:14, 28355.80it/s]  5%|▌         | 22194/441656 [00:00<00:14, 28253.14it/s]  6%|▌         | 25068/441656 [00:00<00:14, 28402.87it/s]  6%|▋         | 27909/441656 [00:01<00:14, 28269.26it/s]  7%|▋         | 30816/441656 [00:01<00:14, 28512.29it/s]  8%|▊         | 33668/441656 [00:01<00:14, 28308.09it/s]  8%|▊         | 36500/441656 [00:01<00:38, 10429.52it/s]  9%|▉         | 39353/441656 [00:01<00:31, 12902.00it/s] 10%|▉         | 42107/441656 [00:02<00:26, 15290.29it/s] 10%|█         | 45013/441656 [00:02<00:22, 17894.05it/s] 11%|█         | 47839/441656 [00:02<00:19, 20097.46it/s] 11%|█▏        | 50644/441656 [00:02<00:17, 21949.54it/s] 12%|█▏        | 53560/441656 [00:02<00:16, 23748.52it/s] 13%|█▎        | 56328/441656 [00:02<00:15, 24606.59it/s] 13%|█▎        | 59106/441656 [00:02<00:15, 25466.91it/s] 14%|█▍        | 61895/441656 [00:02<00:14, 26142.17it/s] 15%|█▍        | 64747/441656 [00:02<00:14, 26819.64it/s] 15%|█▌        | 67562/441656 [00:02<00:13, 27204.20it/s] 16%|█▌        | 70472/441656 [00:03<00:13, 27758.17it/s] 17%|█▋        | 73340/441656 [00:03<00:13, 28026.88it/s] 17%|█▋        | 76183/441656 [00:03<00:12, 28125.98it/s] 18%|█▊        | 79024/441656 [00:03<00:12, 28193.69it/s] 19%|█▊        | 81888/441656 [00:03<00:12, 28325.65it/s] 19%|█▉        | 84735/441656 [00:03<00:12, 28242.57it/s] 20%|█▉        | 87569/441656 [00:04<00:38, 9237.19it/s]  20%|██        | 90414/441656 [00:04<00:30, 11583.25it/s] 21%|██        | 93152/441656 [00:04<00:25, 13929.32it/s] 22%|██▏       | 96032/441656 [00:04<00:20, 16532.28it/s] 22%|██▏       | 98880/441656 [00:04<00:18, 18921.27it/s] 23%|██▎       | 101537/441656 [00:04<00:16, 20578.02it/s] 24%|██▎       | 104503/441656 [00:04<00:14, 22762.60it/s] 24%|██▍       | 107267/441656 [00:05<00:13, 24008.61it/s] 25%|██▍       | 110017/441656 [00:05<00:13, 24927.08it/s] 26%|██▌       | 112850/441656 [00:05<00:12, 25866.52it/s] 26%|██▌       | 115646/441656 [00:05<00:12, 26458.55it/s] 27%|██▋       | 118525/441656 [00:05<00:11, 27127.36it/s] 27%|██▋       | 121387/441656 [00:05<00:11, 27559.66it/s] 28%|██▊       | 124212/441656 [00:05<00:11, 27535.92it/s] 29%|██▉       | 127031/441656 [00:05<00:11, 27726.21it/s] 29%|██▉       | 129882/441656 [00:05<00:11, 27957.30it/s] 30%|███       | 132702/441656 [00:05<00:11, 27219.25it/s] 31%|███       | 135623/441656 [00:06<00:11, 27799.20it/s] 31%|███▏      | 138487/441656 [00:06<00:10, 28044.89it/s] 32%|███▏      | 141309/441656 [00:06<00:10, 28094.78it/s] 33%|███▎      | 144169/441656 [00:06<00:10, 28241.45it/s] 33%|███▎      | 147036/441656 [00:06<00:10, 28368.16it/s] 34%|███▍      | 149878/441656 [00:07<00:40, 7217.39it/s]  35%|███▍      | 152752/441656 [00:07<00:30, 9322.95it/s] 35%|███▌      | 155697/441656 [00:07<00:24, 11790.62it/s] 36%|███▌      | 158462/441656 [00:07<00:20, 14154.16it/s] 37%|███▋      | 161431/441656 [00:07<00:16, 16881.12it/s] 37%|███▋      | 164255/441656 [00:08<00:14, 19148.70it/s] 38%|███▊      | 167055/441656 [00:08<00:13, 21117.71it/s] 38%|███▊      | 169823/441656 [00:08<00:11, 22698.34it/s] 39%|███▉      | 172583/441656 [00:08<00:11, 23953.60it/s] 40%|███▉      | 175464/441656 [00:08<00:10, 25252.49it/s] 40%|████      | 178397/441656 [00:08<00:09, 26379.85it/s] 41%|████      | 181233/441656 [00:08<00:09, 26881.87it/s] 42%|████▏     | 184063/441656 [00:08<00:09, 27205.19it/s] 42%|████▏     | 186884/441656 [00:08<00:09, 27290.85it/s] 43%|████▎     | 189709/441656 [00:08<00:09, 27568.44it/s] 44%|████▎     | 192614/441656 [00:09<00:08, 28003.69it/s] 44%|████▍     | 195513/441656 [00:09<00:08, 28294.65it/s] 45%|████▍     | 198368/441656 [00:09<00:08, 28357.31it/s] 46%|████▌     | 201243/441656 [00:09<00:08, 28472.07it/s] 46%|████▌     | 204103/441656 [00:09<00:08, 27895.16it/s] 47%|████▋     | 207022/441656 [00:09<00:08, 28273.75it/s] 48%|████▊     | 209913/441656 [00:09<00:08, 28460.38it/s] 48%|████▊     | 212766/441656 [00:09<00:08, 28418.47it/s] 49%|████▉     | 215736/441656 [00:09<00:07, 28798.36it/s] 50%|████▉     | 218692/441656 [00:09<00:07, 29023.89it/s] 50%|█████     | 221597/441656 [00:10<00:07, 28711.36it/s] 51%|█████     | 224471/441656 [00:10<00:07, 28714.67it/s] 51%|█████▏    | 227345/441656 [00:10<00:07, 28398.81it/s] 52%|█████▏    | 230187/441656 [00:11<00:32, 6584.52it/s]  53%|█████▎    | 233025/441656 [00:11<00:24, 8530.27it/s] 53%|█████▎    | 235587/441656 [00:11<00:19, 10463.30it/s] 54%|█████▍    | 238412/441656 [00:11<00:15, 12937.52it/s] 55%|█████▍    | 241301/441656 [00:11<00:12, 15581.77it/s] 55%|█████▌    | 244143/441656 [00:12<00:10, 18038.77it/s] 56%|█████▌    | 246979/441656 [00:12<00:09, 20254.46it/s] 57%|█████▋    | 249839/441656 [00:12<00:08, 22213.21it/s] 57%|█████▋    | 252610/441656 [00:12<00:08, 23514.83it/s] 58%|█████▊    | 255370/441656 [00:12<00:07, 24541.28it/s] 58%|█████▊    | 258210/441656 [00:12<00:07, 25592.81it/s] 59%|█████▉    | 261027/441656 [00:12<00:06, 26171.60it/s] 60%|█████▉    | 263880/441656 [00:12<00:06, 26841.52it/s] 60%|██████    | 266751/441656 [00:12<00:06, 27380.92it/s] 61%|██████    | 269571/441656 [00:12<00:06, 27409.25it/s] 62%|██████▏   | 272369/441656 [00:13<00:06, 27157.40it/s] 62%|██████▏   | 275133/441656 [00:13<00:06, 27297.37it/s] 63%|██████▎   | 277909/441656 [00:13<00:05, 27430.82it/s] 64%|██████▎   | 280816/441656 [00:13<00:05, 27913.52it/s] 64%|██████▍   | 283623/441656 [00:13<00:05, 27922.32it/s] 65%|██████▍   | 286426/441656 [00:13<00:05, 27908.15it/s] 66%|██████▌   | 289306/441656 [00:13<00:05, 28172.35it/s] 66%|██████▌   | 292173/441656 [00:13<00:05, 28318.75it/s] 67%|██████▋   | 295009/441656 [00:13<00:05, 28019.60it/s] 67%|██████▋   | 297815/441656 [00:13<00:05, 27968.86it/s] 68%|██████▊   | 300667/441656 [00:14<00:05, 28129.86it/s] 69%|██████▊   | 303482/441656 [00:14<00:04, 27818.86it/s] 69%|██████▉   | 306312/441656 [00:14<00:04, 27958.63it/s] 70%|███████   | 309169/441656 [00:14<00:04, 28140.05it/s] 71%|███████   | 311985/441656 [00:14<00:04, 28011.33it/s] 71%|███████▏  | 314823/441656 [00:14<00:04, 28119.76it/s] 72%|███████▏  | 317693/441656 [00:14<00:04, 28290.85it/s] 73%|███████▎  | 320523/441656 [00:14<00:04, 28142.78it/s] 73%|███████▎  | 323338/441656 [00:14<00:04, 28065.99it/s] 74%|███████▍  | 326145/441656 [00:14<00:04, 27779.80it/s] 74%|███████▍  | 328924/441656 [00:16<00:19, 5850.65it/s]  75%|███████▌  | 331585/441656 [00:16<00:14, 7550.60it/s] 76%|███████▌  | 334165/441656 [00:16<00:11, 9461.66it/s] 76%|███████▋  | 336803/441656 [00:16<00:09, 11632.81it/s] 77%|███████▋  | 339352/441656 [00:16<00:07, 13799.91it/s] 77%|███████▋  | 341999/441656 [00:16<00:06, 16112.51it/s] 78%|███████▊  | 344503/441656 [00:16<00:05, 17921.51it/s] 79%|███████▊  | 347143/441656 [00:17<00:04, 19851.08it/s] 79%|███████▉  | 349753/441656 [00:17<00:04, 21377.08it/s] 80%|███████▉  | 352385/441656 [00:17<00:03, 22657.81it/s] 80%|████████  | 355035/441656 [00:17<00:03, 23694.77it/s] 81%|████████  | 357651/441656 [00:17<00:03, 24381.01it/s] 82%|████████▏ | 360257/441656 [00:17<00:03, 24693.42it/s] 82%|████████▏ | 362845/441656 [00:17<00:03, 25004.54it/s] 83%|████████▎ | 365474/441656 [00:17<00:03, 25377.39it/s] 83%|████████▎ | 368072/441656 [00:17<00:02, 25416.89it/s] 84%|████████▍ | 370674/441656 [00:17<00:02, 25593.37it/s] 85%|████████▍ | 373340/441656 [00:18<00:02, 25908.08it/s] 85%|████████▌ | 375956/441656 [00:18<00:02, 25980.76it/s] 86%|████████▌ | 378570/441656 [00:18<00:02, 25990.24it/s] 86%|████████▋ | 381180/441656 [00:18<00:02, 25837.97it/s] 87%|████████▋ | 383772/441656 [00:18<00:02, 25348.83it/s] 87%|████████▋ | 386412/441656 [00:18<00:02, 25655.17it/s] 88%|████████▊ | 389008/441656 [00:18<00:02, 25744.54it/s] 89%|████████▊ | 391611/441656 [00:18<00:01, 25827.69it/s] 89%|████████▉ | 394207/441656 [00:18<00:01, 25866.23it/s] 90%|████████▉ | 396812/441656 [00:18<00:01, 25918.66it/s] 90%|█████████ | 399494/441656 [00:19<00:01, 26186.08it/s] 91%|█████████ | 402114/441656 [00:19<00:01, 26096.40it/s] 92%|█████████▏| 404729/441656 [00:19<00:01, 26110.04it/s] 92%|█████████▏| 407364/441656 [00:19<00:01, 26178.72it/s] 93%|█████████▎| 409983/441656 [00:19<00:01, 26117.70it/s] 93%|█████████▎| 412596/441656 [00:19<00:01, 26047.67it/s] 94%|█████████▍| 415272/441656 [00:19<00:01, 26259.52it/s] 95%|█████████▍| 417903/441656 [00:19<00:00, 26271.89it/s] 95%|█████████▌| 420531/441656 [00:19<00:00, 25596.53it/s] 96%|█████████▌| 423171/441656 [00:19<00:00, 25830.98it/s] 96%|█████████▋| 425758/441656 [00:20<00:00, 25740.88it/s] 97%|█████████▋| 428466/441656 [00:20<00:00, 26135.17it/s] 98%|█████████▊| 431107/441656 [00:20<00:00, 26216.30it/s] 98%|█████████▊| 433731/441656 [00:20<00:00, 25955.90it/s] 99%|█████████▉| 436384/441656 [00:20<00:00, 26123.44it/s] 99%|█████████▉| 439035/441656 [00:20<00:00, 26236.12it/s]100%|██████████| 441656/441656 [00:20<00:00, 21398.89it/s]
  0%|          | 0/53198 [00:00<?, ?it/s]  6%|▌         | 3312/53198 [00:00<00:01, 33117.58it/s] 12%|█▏        | 6624/53198 [00:00<00:01, 32592.42it/s] 19%|█▊        | 9884/53198 [00:00<00:01, 31048.58it/s] 25%|██▍       | 13166/53198 [00:00<00:01, 31723.07it/s] 31%|███       | 16455/53198 [00:00<00:01, 32131.42it/s] 37%|███▋      | 19749/53198 [00:00<00:01, 32398.44it/s] 44%|████▎     | 23192/53198 [00:00<00:00, 33054.84it/s] 50%|████▉     | 26501/53198 [00:00<00:00, 32929.04it/s] 56%|█████▌    | 29918/53198 [00:00<00:00, 33246.25it/s] 63%|██████▎   | 33269/53198 [00:01<00:00, 33325.68it/s] 69%|██████▉   | 36603/53198 [00:01<00:00, 32213.51it/s] 75%|███████▌  | 39951/53198 [00:01<00:00, 32586.92it/s] 81%|████████  | 43217/53198 [00:01<00:00, 32329.10it/s] 87%|████████▋ | 46465/53198 [00:01<00:00, 32371.21it/s] 93%|█████████▎| 49706/53198 [00:01<00:00, 32322.60it/s]100%|█████████▉| 53019/53198 [00:01<00:00, 32155.73it/s]100%|██████████| 53198/53198 [00:01<00:00, 32400.93it/s]
  0%|          | 0/35912 [00:00<?, ?it/s]  9%|▉         | 3331/35912 [00:00<00:00, 33302.89it/s] 19%|█▉        | 6929/35912 [00:00<00:00, 34875.97it/s] 29%|██▉       | 10417/35912 [00:00<00:00, 33529.62it/s] 39%|███▊      | 13900/35912 [00:00<00:00, 34026.54it/s] 48%|████▊     | 17345/35912 [00:00<00:00, 34175.42it/s] 58%|█████▊    | 20766/35912 [00:00<00:00, 33354.29it/s] 67%|██████▋   | 24107/35912 [00:00<00:00, 32650.46it/s] 76%|███████▋  | 27420/35912 [00:00<00:00, 32796.77it/s] 85%|████████▌ | 30704/35912 [00:00<00:00, 32200.20it/s] 95%|█████████▍| 34067/35912 [00:01<00:00, 32627.64it/s]100%|██████████| 35912/35912 [00:01<00:00, 32950.54it/s]
dataset loaded from path: 
data/ud/ud-treebanks-v2.1/UD_Catalan/inter-layer-17/UD_Catalan-train-bloom-1b1.pkl
data/ud/ud-treebanks-v2.1/UD_Catalan/inter-layer-17/UD_Catalan-dev-bloom-1b1.pkl
data/ud/ud-treebanks-v2.1/UD_Catalan/inter-layer-17/UD_Catalan-test-bloom-1b1.pkl
Embedding dimensionality: 1536
Pre-training probe (if possible)...
Traceback (most recent call last):
  File "run.py", line 102, in <module>
    args.func(args)
  File "/home/s2308470/multilingual-typology-probing/commands.py", line 166, in greedy
    trainer.train()
  File "/home/s2308470/multilingual-typology-probing/probekit/trainers/trainer.py", line 21, in train
    self._train()
  File "/home/s2308470/multilingual-typology-probing/probekit/trainers/neural_probe_trainer.py", line 30, in _train
    self._train_for_dimensions()
  File "/home/s2308470/multilingual-typology-probing/trainers/flexible_neural_probe_trainer.py", line 72, in _train_for_dimensions
    inputs_tensor_shuffled = inputs_tensor[shuffled_indices]
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 2.21 GiB (GPU 0; 5.94 GiB total capacity; 5.41 GiB already allocated; 285.31 MiB free; 5.44 GiB reserved in total by PyTorch) If reserved memory is >> allocated memory try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF
