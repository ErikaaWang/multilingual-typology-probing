python run.py --language UD_Spanish --experiment-name inter-layer-13 --attribute POS --trainer poisson --gpu --embedding bloom-1b1-intermediate-global_step100000 greedy --selection-size 50 --selection-criterion mi
Setting up datasets (['UD_Spanish'], POS) and probes...
  0%|          | 0/343741 [00:00<?, ?it/s]  1%|          | 2372/343741 [00:00<00:14, 23715.78it/s]  2%|▏         | 5475/343741 [00:00<00:12, 28016.86it/s]  2%|▏         | 8472/343741 [00:00<00:11, 28907.22it/s]  3%|▎         | 11703/343741 [00:00<00:10, 30247.02it/s]  4%|▍         | 14834/343741 [00:00<00:10, 30626.43it/s]  5%|▌         | 18053/343741 [00:00<00:10, 31154.41it/s]  6%|▌         | 21169/343741 [00:01<00:23, 13533.81it/s]  7%|▋         | 24221/343741 [00:01<00:19, 16397.46it/s]  8%|▊         | 27264/343741 [00:01<00:16, 19120.75it/s]  9%|▉         | 30387/343741 [00:01<00:14, 21748.70it/s] 10%|▉         | 33414/343741 [00:01<00:13, 23765.23it/s] 11%|█         | 36545/343741 [00:01<00:11, 25670.14it/s] 11%|█▏        | 39508/343741 [00:01<00:11, 26397.72it/s] 12%|█▏        | 42599/343741 [00:01<00:10, 27625.80it/s] 13%|█▎        | 45704/343741 [00:01<00:10, 28583.78it/s] 14%|█▍        | 48736/343741 [00:02<00:10, 29079.14it/s] 15%|█▌        | 51873/343741 [00:02<00:09, 29742.57it/s] 16%|█▌        | 54928/343741 [00:02<00:09, 29868.49it/s] 17%|█▋        | 58047/343741 [00:02<00:09, 30256.36it/s] 18%|█▊        | 61113/343741 [00:02<00:24, 11738.31it/s] 19%|█▊        | 64255/343741 [00:03<00:19, 14501.81it/s] 20%|█▉        | 67423/343741 [00:03<00:15, 17371.11it/s] 21%|██        | 70581/343741 [00:03<00:13, 20108.44it/s] 21%|██▏       | 73720/343741 [00:03<00:11, 22542.25it/s] 22%|██▏       | 76664/343741 [00:03<00:11, 24157.33it/s] 23%|██▎       | 79606/343741 [00:03<00:10, 25421.24it/s] 24%|██▍       | 82772/343741 [00:03<00:09, 27067.54it/s] 25%|██▍       | 85892/343741 [00:03<00:09, 28197.14it/s] 26%|██▌       | 89086/343741 [00:03<00:08, 29248.00it/s] 27%|██▋       | 92251/343741 [00:03<00:08, 29934.21it/s] 28%|██▊       | 95408/343741 [00:04<00:08, 30406.63it/s] 29%|██▊       | 98577/343741 [00:04<00:07, 30781.14it/s] 30%|██▉       | 101760/343741 [00:04<00:07, 31088.22it/s] 31%|███       | 104913/343741 [00:04<00:07, 31217.93it/s] 31%|███▏      | 108103/343741 [00:04<00:07, 31418.55it/s] 32%|███▏      | 111266/343741 [00:05<00:19, 12170.86it/s] 33%|███▎      | 114501/343741 [00:05<00:15, 15025.00it/s] 34%|███▍      | 117593/343741 [00:05<00:12, 17696.43it/s] 35%|███▌      | 120804/343741 [00:05<00:10, 20486.31it/s] 36%|███▌      | 123946/343741 [00:05<00:09, 22854.22it/s] 37%|███▋      | 127168/343741 [00:05<00:08, 25066.12it/s] 38%|███▊      | 130282/343741 [00:05<00:08, 26598.24it/s] 39%|███▉      | 133400/343741 [00:05<00:07, 27811.45it/s] 40%|███▉      | 136527/343741 [00:05<00:07, 28759.75it/s] 41%|████      | 139666/343741 [00:05<00:06, 29500.00it/s] 42%|████▏     | 142830/343741 [00:06<00:06, 30113.26it/s] 42%|████▏     | 146019/343741 [00:06<00:06, 30628.84it/s] 43%|████▎     | 149163/343741 [00:06<00:06, 30856.53it/s] 44%|████▍     | 152306/343741 [00:06<00:06, 30595.97it/s] 45%|████▌     | 155467/343741 [00:06<00:06, 30891.75it/s] 46%|████▌     | 158663/343741 [00:06<00:05, 31205.05it/s] 47%|████▋     | 161805/343741 [00:06<00:05, 31170.07it/s] 48%|████▊     | 165032/343741 [00:06<00:05, 31493.33it/s] 49%|████▉     | 168192/343741 [00:06<00:05, 31303.97it/s] 50%|████▉     | 171380/343741 [00:06<00:05, 31472.83it/s] 51%|█████     | 174533/343741 [00:07<00:15, 11231.98it/s] 52%|█████▏    | 177720/343741 [00:07<00:11, 13952.16it/s] 53%|█████▎    | 180651/343741 [00:07<00:09, 16385.34it/s] 53%|█████▎    | 183844/343741 [00:07<00:08, 19254.37it/s] 54%|█████▍    | 187004/343741 [00:08<00:07, 21810.51it/s] 55%|█████▌    | 190224/343741 [00:08<00:06, 24192.91it/s] 56%|█████▌    | 193349/343741 [00:08<00:05, 25933.79it/s] 57%|█████▋    | 196576/343741 [00:08<00:05, 27584.07it/s] 58%|█████▊    | 199681/343741 [00:08<00:05, 28523.82it/s] 59%|█████▉    | 202904/343741 [00:08<00:04, 29557.65it/s] 60%|█████▉    | 206044/343741 [00:08<00:04, 30073.57it/s] 61%|██████    | 209200/343741 [00:08<00:04, 30502.58it/s] 62%|██████▏   | 212346/343741 [00:08<00:04, 30781.62it/s] 63%|██████▎   | 215515/343741 [00:08<00:04, 31047.15it/s] 64%|██████▎   | 218667/343741 [00:09<00:04, 31126.10it/s] 65%|██████▍   | 221864/343741 [00:09<00:03, 31373.66it/s] 65%|██████▌   | 225025/343741 [00:09<00:03, 30971.54it/s] 66%|██████▋   | 228221/343741 [00:09<00:03, 31260.64it/s] 67%|██████▋   | 231360/343741 [00:09<00:03, 31213.14it/s] 68%|██████▊   | 234518/343741 [00:09<00:03, 31320.72it/s] 69%|██████▉   | 237657/343741 [00:09<00:03, 31292.25it/s] 70%|███████   | 240791/343741 [00:09<00:03, 31295.70it/s] 71%|███████   | 243924/343741 [00:09<00:03, 31261.32it/s] 72%|███████▏  | 247085/343741 [00:09<00:03, 31362.61it/s] 73%|███████▎  | 250223/343741 [00:10<00:03, 31080.88it/s] 74%|███████▎  | 253367/343741 [00:10<00:02, 31185.43it/s] 75%|███████▍  | 256487/343741 [00:11<00:08, 9892.71it/s]  76%|███████▌  | 259649/343741 [00:11<00:06, 12478.71it/s] 76%|███████▋  | 262776/343741 [00:11<00:05, 15200.78it/s] 77%|███████▋  | 265947/343741 [00:11<00:04, 18036.66it/s] 78%|███████▊  | 269076/343741 [00:11<00:03, 20616.61it/s] 79%|███████▉  | 272285/343741 [00:11<00:03, 23133.43it/s] 80%|████████  | 275425/343741 [00:11<00:02, 25105.71it/s] 81%|████████  | 278629/343741 [00:11<00:02, 26867.83it/s] 82%|████████▏ | 281734/343741 [00:11<00:02, 27979.36it/s] 83%|████████▎ | 284926/343741 [00:11<00:02, 29063.61it/s] 84%|████████▍ | 288065/343741 [00:12<00:01, 29719.86it/s] 85%|████████▍ | 291281/343741 [00:12<00:01, 30420.44it/s] 86%|████████▌ | 294438/343741 [00:12<00:01, 30745.17it/s] 87%|████████▋ | 297631/343741 [00:12<00:01, 31092.11it/s] 88%|████████▊ | 300798/343741 [00:12<00:01, 31079.87it/s] 88%|████████▊ | 303947/343741 [00:12<00:01, 31182.71it/s] 89%|████████▉ | 307100/343741 [00:12<00:01, 31283.10it/s] 90%|█████████ | 310259/343741 [00:12<00:01, 31373.62it/s] 91%|█████████ | 313411/343741 [00:12<00:00, 31203.28it/s] 92%|█████████▏| 316542/343741 [00:12<00:00, 31193.84it/s] 93%|█████████▎| 319669/343741 [00:13<00:00, 31079.13it/s] 94%|█████████▍| 322829/343741 [00:13<00:00, 31232.00it/s] 95%|█████████▍| 325956/343741 [00:13<00:00, 31237.86it/s] 96%|█████████▌| 329083/343741 [00:13<00:00, 30901.62it/s] 97%|█████████▋| 332247/343741 [00:13<00:00, 31118.44it/s] 98%|█████████▊| 335445/343741 [00:13<00:00, 31373.91it/s] 98%|█████████▊| 338584/343741 [00:13<00:00, 31344.02it/s] 99%|█████████▉| 341760/343741 [00:13<00:00, 31467.48it/s]100%|██████████| 343741/343741 [00:13<00:00, 24911.97it/s]
  0%|          | 0/56357 [00:00<?, ?it/s]  6%|▋         | 3638/56357 [00:00<00:01, 36375.61it/s] 13%|█▎        | 7276/56357 [00:00<00:01, 33865.82it/s] 19%|█▉        | 10885/56357 [00:00<00:01, 34839.77it/s] 26%|██▌       | 14478/56357 [00:00<00:01, 35256.48it/s] 32%|███▏      | 18019/56357 [00:00<00:01, 35308.85it/s] 38%|███▊      | 21598/56357 [00:00<00:00, 35468.01it/s] 45%|████▍     | 25194/56357 [00:00<00:00, 35626.88it/s] 51%|█████     | 28774/56357 [00:00<00:00, 35680.31it/s] 57%|█████▋    | 32368/56357 [00:00<00:00, 35707.55it/s] 64%|██████▍   | 36029/56357 [00:01<00:00, 35984.33it/s] 70%|███████   | 39629/56357 [00:01<00:00, 35796.58it/s] 77%|███████▋  | 43224/56357 [00:01<00:00, 35841.92it/s] 83%|████████▎ | 46870/56357 [00:01<00:00, 36026.16it/s] 90%|████████▉ | 50474/56357 [00:01<00:00, 35972.13it/s] 96%|█████████▌| 54073/56357 [00:01<00:00, 35973.77it/s]100%|██████████| 56357/56357 [00:01<00:00, 35675.73it/s]
  0%|          | 0/23248 [00:00<?, ?it/s] 17%|█▋        | 3959/23248 [00:00<00:00, 39583.81it/s] 34%|███▍      | 7918/23248 [00:00<00:00, 38898.24it/s] 51%|█████     | 11875/23248 [00:00<00:00, 39197.58it/s] 68%|██████▊   | 15798/23248 [00:00<00:00, 39203.05it/s] 85%|████████▌ | 19769/23248 [00:00<00:00, 39384.29it/s]100%|██████████| 23248/23248 [00:00<00:00, 39228.42it/s]
dataset loaded from path: 
data/ud/ud-treebanks-v2.1/UD_Spanish/inter-layer-13/UD_Spanish-train-bloom-1b1-intermediate-global_step100000.pkl
data/ud/ud-treebanks-v2.1/UD_Spanish/inter-layer-13/UD_Spanish-dev-bloom-1b1-intermediate-global_step100000.pkl
data/ud/ud-treebanks-v2.1/UD_Spanish/inter-layer-13/UD_Spanish-test-bloom-1b1-intermediate-global_step100000.pkl
Embedding dimensionality: 1536
Pre-training probe (if possible)...
Traceback (most recent call last):
  File "run.py", line 102, in <module>
    args.func(args)
  File "/home/s2308470/multilingual-typology-probing/commands.py", line 166, in greedy
    trainer.train()
  File "/home/s2308470/multilingual-typology-probing/probekit/trainers/trainer.py", line 21, in train
    self._train()
  File "/home/s2308470/multilingual-typology-probing/probekit/trainers/neural_probe_trainer.py", line 30, in _train
    self._train_for_dimensions()
  File "/home/s2308470/multilingual-typology-probing/trainers/flexible_neural_probe_trainer.py", line 72, in _train_for_dimensions
    inputs_tensor_shuffled = inputs_tensor[shuffled_indices]
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 1.63 GiB (GPU 0; 5.94 GiB total capacity; 4.18 GiB already allocated; 1.51 GiB free; 4.21 GiB reserved in total by PyTorch) If reserved memory is >> allocated memory try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF
