python run.py --language UD_Spanish --experiment-name inter-layer-17 --attribute POS --trainer poisson --gpu --embedding bloom-1b1-intermediate-global_step600000 greedy --selection-size 50 --selection-criterion mi
Setting up datasets (['UD_Spanish'], POS) and probes...
  0%|          | 0/343741 [00:00<?, ?it/s]  1%|          | 2481/343741 [00:00<00:13, 24802.81it/s]  2%|▏         | 5675/343741 [00:00<00:11, 28998.39it/s]  3%|▎         | 8808/343741 [00:00<00:11, 30060.63it/s]  3%|▎         | 11982/343741 [00:00<00:10, 30720.85it/s]  4%|▍         | 15150/343741 [00:00<00:10, 31065.09it/s]  5%|▌         | 18308/343741 [00:00<00:10, 31144.27it/s]  6%|▌         | 21423/343741 [00:01<00:22, 14142.51it/s]  7%|▋         | 24568/343741 [00:01<00:18, 17164.33it/s]  8%|▊         | 27703/343741 [00:01<00:15, 19995.49it/s]  9%|▉         | 30828/343741 [00:01<00:13, 22492.75it/s] 10%|▉         | 33788/343741 [00:01<00:12, 24203.09it/s] 11%|█         | 36918/343741 [00:01<00:11, 26018.27it/s] 12%|█▏        | 39922/343741 [00:01<00:11, 27092.75it/s] 13%|█▎        | 43048/343741 [00:01<00:10, 28245.01it/s] 13%|█▎        | 46071/343741 [00:01<00:10, 28767.82it/s] 14%|█▍        | 49124/343741 [00:01<00:10, 29273.14it/s] 15%|█▌        | 52189/343741 [00:02<00:09, 29671.59it/s] 16%|█▌        | 55377/343741 [00:02<00:09, 30318.62it/s] 17%|█▋        | 58500/343741 [00:02<00:09, 30586.09it/s] 18%|█▊        | 61596/343741 [00:02<00:22, 12659.67it/s] 19%|█▉        | 64772/343741 [00:02<00:17, 15503.36it/s] 20%|█▉        | 67864/343741 [00:03<00:15, 18207.10it/s] 21%|██        | 71085/343741 [00:03<00:12, 21011.15it/s] 22%|██▏       | 74244/343741 [00:03<00:11, 23364.67it/s] 23%|██▎       | 77456/343741 [00:03<00:10, 25395.21it/s] 23%|██▎       | 80707/343741 [00:03<00:09, 27212.58it/s] 24%|██▍       | 83846/343741 [00:03<00:09, 28328.12it/s] 25%|██▌       | 86957/343741 [00:03<00:08, 29095.23it/s] 26%|██▌       | 90065/343741 [00:03<00:08, 29361.45it/s] 27%|██▋       | 93274/343741 [00:03<00:08, 30138.79it/s] 28%|██▊       | 96448/343741 [00:03<00:08, 30601.83it/s] 29%|██▉       | 99669/343741 [00:04<00:07, 31071.18it/s] 30%|██▉       | 102829/343741 [00:04<00:07, 31075.27it/s] 31%|███       | 106011/343741 [00:04<00:07, 31293.71it/s] 32%|███▏      | 109167/343741 [00:04<00:07, 31187.53it/s] 33%|███▎      | 112304/343741 [00:04<00:18, 12419.20it/s] 34%|███▎      | 115438/343741 [00:05<00:15, 15145.47it/s] 35%|███▍      | 118616/343741 [00:05<00:12, 17985.24it/s] 35%|███▌      | 121573/343741 [00:05<00:10, 20255.43it/s] 36%|███▋      | 124664/343741 [00:05<00:09, 22585.23it/s] 37%|███▋      | 127880/343741 [00:05<00:08, 24864.13it/s] 38%|███▊      | 131077/343741 [00:05<00:07, 26666.01it/s] 39%|███▉      | 134275/343741 [00:05<00:07, 28079.57it/s] 40%|███▉      | 137420/343741 [00:05<00:07, 29005.90it/s] 41%|████      | 140630/343741 [00:05<00:06, 29755.68it/s] 42%|████▏     | 143825/343741 [00:05<00:06, 30382.43it/s] 43%|████▎     | 146973/343741 [00:06<00:06, 30481.64it/s] 44%|████▎     | 150188/343741 [00:06<00:06, 30965.81it/s] 45%|████▍     | 153355/343741 [00:06<00:06, 31170.81it/s] 46%|████▌     | 156563/343741 [00:06<00:05, 31437.39it/s] 46%|████▋     | 159735/343741 [00:06<00:05, 31411.92it/s] 47%|████▋     | 162944/343741 [00:06<00:05, 31612.11it/s] 48%|████▊     | 166119/343741 [00:06<00:05, 31062.97it/s] 49%|████▉     | 169299/343741 [00:06<00:05, 31278.73it/s] 50%|█████     | 172436/343741 [00:06<00:05, 31215.80it/s] 51%|█████     | 175564/343741 [00:07<00:14, 11397.61it/s] 52%|█████▏    | 178651/343741 [00:07<00:11, 14006.12it/s] 53%|█████▎    | 181881/343741 [00:07<00:09, 16944.08it/s] 54%|█████▍    | 185015/343741 [00:07<00:08, 19629.84it/s] 55%|█████▍    | 188230/343741 [00:07<00:06, 22264.54it/s] 56%|█████▌    | 191216/343741 [00:08<00:06, 24018.78it/s] 57%|█████▋    | 194453/343741 [00:08<00:05, 26089.64it/s] 57%|█████▋    | 197541/343741 [00:08<00:05, 27341.07it/s] 58%|█████▊    | 200762/343741 [00:08<00:04, 28664.44it/s] 59%|█████▉    | 203873/343741 [00:08<00:04, 29233.27it/s] 60%|██████    | 207089/343741 [00:08<00:04, 30064.36it/s] 61%|██████    | 210223/343741 [00:08<00:04, 30429.73it/s] 62%|██████▏   | 213405/343741 [00:08<00:04, 30835.12it/s] 63%|██████▎   | 216553/343741 [00:08<00:04, 30870.34it/s] 64%|██████▍   | 219685/343741 [00:08<00:04, 31001.80it/s] 65%|██████▍   | 222817/343741 [00:09<00:03, 30798.61it/s] 66%|██████▌   | 225966/343741 [00:09<00:03, 31002.09it/s] 67%|██████▋   | 229083/343741 [00:09<00:03, 30743.56it/s] 68%|██████▊   | 232219/343741 [00:09<00:03, 30923.56it/s] 68%|██████▊   | 235384/343741 [00:09<00:03, 31138.35it/s] 69%|██████▉   | 238504/343741 [00:09<00:03, 31013.44it/s] 70%|███████   | 241610/343741 [00:09<00:03, 30933.51it/s] 71%|███████   | 244818/343741 [00:09<00:03, 31274.30it/s] 72%|███████▏  | 247948/343741 [00:09<00:03, 31148.95it/s] 73%|███████▎  | 251140/343741 [00:09<00:02, 31377.13it/s] 74%|███████▍  | 254280/343741 [00:10<00:02, 31263.05it/s] 75%|███████▍  | 257408/343741 [00:10<00:08, 10056.36it/s] 76%|███████▌  | 260569/343741 [00:10<00:06, 12653.08it/s] 77%|███████▋  | 263681/343741 [00:11<00:05, 15364.77it/s] 78%|███████▊  | 266856/343741 [00:11<00:04, 18205.03it/s] 79%|███████▊  | 269976/343741 [00:11<00:03, 20784.56it/s] 79%|███████▉  | 273144/343741 [00:11<00:03, 23190.06it/s] 80%|████████  | 276276/343741 [00:11<00:02, 25139.74it/s] 81%|████████▏ | 279485/343741 [00:11<00:02, 26912.29it/s] 82%|████████▏ | 282584/343741 [00:11<00:02, 28000.66it/s] 83%|████████▎ | 285747/343741 [00:11<00:01, 29000.74it/s] 84%|████████▍ | 288863/343741 [00:11<00:01, 29586.58it/s] 85%|████████▍ | 292059/343741 [00:11<00:01, 30266.59it/s] 86%|████████▌ | 295197/343741 [00:12<00:01, 30522.61it/s] 87%|████████▋ | 298372/343741 [00:12<00:01, 30881.39it/s] 88%|████████▊ | 301516/343741 [00:12<00:01, 30557.14it/s] 89%|████████▊ | 304701/343741 [00:12<00:01, 30933.88it/s] 90%|████████▉ | 307823/343741 [00:12<00:01, 30825.47it/s] 90%|█████████ | 311019/343741 [00:12<00:01, 31159.19it/s] 91%|█████████▏| 314150/343741 [00:12<00:00, 31138.26it/s] 92%|█████████▏| 317279/343741 [00:12<00:00, 31182.49it/s] 93%|█████████▎| 320405/343741 [00:12<00:00, 31184.55it/s] 94%|█████████▍| 323592/343741 [00:13<00:00, 31386.14it/s] 95%|█████████▌| 326735/343741 [00:13<00:00, 31143.75it/s] 96%|█████████▌| 329931/343741 [00:13<00:00, 31386.03it/s] 97%|█████████▋| 333072/343741 [00:13<00:00, 31072.71it/s] 98%|█████████▊| 336193/343741 [00:13<00:00, 31110.61it/s] 99%|█████████▊| 339306/343741 [00:13<00:00, 31082.12it/s]100%|█████████▉| 342510/343741 [00:13<00:00, 31365.35it/s]100%|██████████| 343741/343741 [00:13<00:00, 25184.00it/s]
  0%|          | 0/56357 [00:00<?, ?it/s]  7%|▋         | 3667/56357 [00:00<00:01, 36660.51it/s] 13%|█▎        | 7334/56357 [00:00<00:01, 35608.45it/s] 20%|█▉        | 11012/56357 [00:00<00:01, 36133.27it/s] 26%|██▌       | 14646/56357 [00:00<00:01, 36211.44it/s] 32%|███▏      | 18277/56357 [00:00<00:01, 36245.31it/s] 39%|███▉      | 21952/56357 [00:00<00:00, 36413.55it/s] 45%|████▌     | 25594/56357 [00:00<00:00, 36005.26it/s] 52%|█████▏    | 29219/56357 [00:00<00:00, 36069.39it/s] 58%|█████▊    | 32837/56357 [00:00<00:00, 36103.13it/s] 65%|██████▍   | 36504/56357 [00:01<00:00, 36274.62it/s] 71%|███████   | 40132/56357 [00:01<00:00, 36196.62it/s] 78%|███████▊  | 43753/56357 [00:01<00:00, 35806.10it/s] 84%|████████▍ | 47335/56357 [00:01<00:00, 35794.31it/s] 90%|█████████ | 50998/56357 [00:01<00:00, 36044.17it/s] 97%|█████████▋| 54604/56357 [00:01<00:00, 35963.26it/s]100%|██████████| 56357/56357 [00:01<00:00, 36059.95it/s]
  0%|          | 0/23248 [00:00<?, ?it/s] 17%|█▋        | 3850/23248 [00:00<00:00, 38490.77it/s] 33%|███▎      | 7700/23248 [00:00<00:00, 37570.68it/s] 50%|████▉     | 11530/23248 [00:00<00:00, 37897.92it/s] 66%|██████▋   | 15453/23248 [00:00<00:00, 38418.35it/s] 83%|████████▎ | 19325/23248 [00:00<00:00, 38522.85it/s]100%|█████████▉| 23213/23248 [00:00<00:00, 38641.78it/s]100%|██████████| 23248/23248 [00:00<00:00, 38384.70it/s]
dataset loaded from path: 
data/ud/ud-treebanks-v2.1/UD_Spanish/inter-layer-17/UD_Spanish-train-bloom-1b1-intermediate-global_step600000.pkl
data/ud/ud-treebanks-v2.1/UD_Spanish/inter-layer-17/UD_Spanish-dev-bloom-1b1-intermediate-global_step600000.pkl
data/ud/ud-treebanks-v2.1/UD_Spanish/inter-layer-17/UD_Spanish-test-bloom-1b1-intermediate-global_step600000.pkl
Embedding dimensionality: 1536
Pre-training probe (if possible)...
Traceback (most recent call last):
  File "run.py", line 102, in <module>
    args.func(args)
  File "/home/s2308470/multilingual-typology-probing/commands.py", line 166, in greedy
    trainer.train()
  File "/home/s2308470/multilingual-typology-probing/probekit/trainers/trainer.py", line 21, in train
    self._train()
  File "/home/s2308470/multilingual-typology-probing/probekit/trainers/neural_probe_trainer.py", line 30, in _train
    self._train_for_dimensions()
  File "/home/s2308470/multilingual-typology-probing/trainers/flexible_neural_probe_trainer.py", line 72, in _train_for_dimensions
    inputs_tensor_shuffled = inputs_tensor[shuffled_indices]
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 1.63 GiB (GPU 0; 5.94 GiB total capacity; 4.18 GiB already allocated; 1.51 GiB free; 4.21 GiB reserved in total by PyTorch) If reserved memory is >> allocated memory try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF
