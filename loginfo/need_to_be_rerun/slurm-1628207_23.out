python run.py --language UD_Catalan --experiment-name inter-layer-13 --attribute POS --trainer poisson --gpu --embedding bloom-1b1-intermediate-global_step200000 greedy --selection-size 50 --selection-criterion mi
Setting up datasets (['UD_Catalan'], POS) and probes...
  0%|          | 0/441656 [00:00<?, ?it/s]  1%|          | 2260/441656 [00:00<00:19, 22591.35it/s]  1%|          | 5115/441656 [00:00<00:16, 26093.60it/s]  2%|▏         | 7983/441656 [00:00<00:15, 27271.40it/s]  2%|▏         | 10801/441656 [00:00<00:15, 27628.16it/s]  3%|▎         | 13652/441656 [00:00<00:15, 27945.21it/s]  4%|▎         | 16500/441656 [00:00<00:15, 28123.70it/s]  4%|▍         | 19313/441656 [00:00<00:15, 27971.84it/s]  5%|▌         | 22111/441656 [00:00<00:15, 27962.92it/s]  6%|▌         | 24958/441656 [00:00<00:14, 28116.87it/s]  6%|▋         | 27770/441656 [00:01<00:14, 28066.45it/s]  7%|▋         | 30635/441656 [00:01<00:14, 28241.75it/s]  8%|▊         | 33460/441656 [00:01<00:14, 28222.83it/s]  8%|▊         | 36283/441656 [00:01<00:35, 11501.62it/s]  9%|▉         | 39116/441656 [00:01<00:28, 14019.54it/s] 10%|▉         | 41975/441656 [00:01<00:24, 16585.32it/s] 10%|█         | 44770/441656 [00:02<00:21, 18868.70it/s] 11%|█         | 47633/441656 [00:02<00:18, 21045.74it/s] 11%|█▏        | 50489/441656 [00:02<00:17, 22860.25it/s] 12%|█▏        | 53291/441656 [00:02<00:16, 24183.89it/s] 13%|█▎        | 56038/441656 [00:02<00:15, 24966.32it/s] 13%|█▎        | 58867/441656 [00:02<00:14, 25883.28it/s] 14%|█▍        | 61656/441656 [00:02<00:14, 26450.43it/s] 15%|█▍        | 64503/441656 [00:02<00:13, 27029.58it/s] 15%|█▌        | 67301/441656 [00:02<00:13, 27304.20it/s] 16%|█▌        | 70104/441656 [00:02<00:13, 27516.65it/s] 17%|█▋        | 72944/441656 [00:03<00:13, 27776.34it/s] 17%|█▋        | 75754/441656 [00:03<00:13, 27661.40it/s] 18%|█▊        | 78594/441656 [00:03<00:13, 27878.62it/s] 18%|█▊        | 81415/441656 [00:03<00:12, 27974.75it/s] 19%|█▉        | 84224/441656 [00:03<00:12, 27925.37it/s] 20%|█▉        | 87025/441656 [00:04<00:34, 10192.76it/s] 20%|██        | 89840/441656 [00:04<00:27, 12605.93it/s] 21%|██        | 92635/441656 [00:04<00:23, 15077.24it/s] 22%|██▏       | 95449/441656 [00:04<00:19, 17519.65it/s] 22%|██▏       | 98231/441656 [00:04<00:17, 19690.19it/s] 23%|██▎       | 101083/441656 [00:04<00:15, 21664.93it/s] 23%|██▎       | 103765/441656 [00:04<00:14, 22912.74it/s] 24%|██▍       | 106621/441656 [00:04<00:13, 24385.89it/s] 25%|██▍       | 109421/441656 [00:04<00:13, 25365.58it/s] 25%|██▌       | 112207/441656 [00:05<00:12, 26060.72it/s] 26%|██▌       | 115053/441656 [00:05<00:12, 26743.32it/s] 27%|██▋       | 117883/441656 [00:05<00:11, 27128.53it/s] 27%|██▋       | 120708/441656 [00:05<00:11, 27454.37it/s] 28%|██▊       | 123533/441656 [00:05<00:11, 27686.70it/s] 29%|██▊       | 126342/441656 [00:05<00:11, 27731.49it/s] 29%|██▉       | 129187/441656 [00:05<00:11, 27942.90it/s] 30%|██▉       | 132002/441656 [00:05<00:11, 27612.09it/s] 31%|███       | 134779/441656 [00:05<00:11, 27657.44it/s] 31%|███       | 137565/441656 [00:05<00:10, 27716.72it/s] 32%|███▏      | 140398/441656 [00:06<00:10, 27884.61it/s] 32%|███▏      | 143192/441656 [00:06<00:10, 27848.02it/s] 33%|███▎      | 146009/441656 [00:06<00:10, 27943.09it/s] 34%|███▎      | 148832/441656 [00:06<00:10, 28028.11it/s] 34%|███▍      | 151637/441656 [00:07<00:37, 7833.30it/s]  35%|███▍      | 154400/441656 [00:07<00:28, 9945.01it/s] 36%|███▌      | 157192/441656 [00:07<00:23, 12322.09it/s] 36%|███▌      | 160028/441656 [00:07<00:18, 14869.95it/s] 37%|███▋      | 162797/441656 [00:07<00:16, 17241.03it/s] 37%|███▋      | 165606/441656 [00:07<00:14, 19508.39it/s] 38%|███▊      | 168428/441656 [00:07<00:12, 21510.21it/s] 39%|███▉      | 171145/441656 [00:08<00:11, 22696.70it/s] 39%|███▉      | 173988/441656 [00:08<00:11, 24180.72it/s] 40%|████      | 176836/441656 [00:08<00:10, 25340.31it/s] 41%|████      | 179610/441656 [00:08<00:10, 26007.78it/s] 41%|████▏     | 182455/441656 [00:08<00:09, 26701.66it/s] 42%|████▏     | 185257/441656 [00:08<00:09, 26980.83it/s] 43%|████▎     | 188091/441656 [00:08<00:09, 27374.66it/s] 43%|████▎     | 190904/441656 [00:08<00:09, 27593.61it/s] 44%|████▍     | 193707/441656 [00:08<00:08, 27665.85it/s] 45%|████▍     | 196557/441656 [00:08<00:08, 27911.13it/s] 45%|████▌     | 199413/441656 [00:09<00:08, 28101.67it/s] 46%|████▌     | 202239/441656 [00:09<00:08, 27580.61it/s] 46%|████▋     | 205066/441656 [00:09<00:08, 27781.00it/s] 47%|████▋     | 207881/441656 [00:09<00:08, 27887.90it/s] 48%|████▊     | 210677/441656 [00:09<00:08, 27902.02it/s] 48%|████▊     | 213475/441656 [00:09<00:08, 27922.77it/s] 49%|████▉     | 216324/441656 [00:09<00:08, 28090.37it/s] 50%|████▉     | 219136/441656 [00:09<00:07, 28000.39it/s] 50%|█████     | 221978/441656 [00:09<00:07, 28123.72it/s] 51%|█████     | 224792/441656 [00:09<00:07, 28004.89it/s] 52%|█████▏    | 227594/441656 [00:10<00:07, 27887.22it/s] 52%|█████▏    | 230384/441656 [00:11<00:30, 6891.75it/s]  53%|█████▎    | 233236/441656 [00:11<00:23, 8949.83it/s] 53%|█████▎    | 235830/441656 [00:11<00:18, 10982.60it/s] 54%|█████▍    | 238644/441656 [00:11<00:15, 13487.08it/s] 55%|█████▍    | 241429/441656 [00:11<00:12, 15964.85it/s] 55%|█████▌    | 244218/441656 [00:11<00:10, 18321.73it/s] 56%|█████▌    | 246975/441656 [00:11<00:09, 20358.55it/s] 57%|█████▋    | 249802/441656 [00:11<00:08, 22250.47it/s] 57%|█████▋    | 252607/441656 [00:11<00:07, 23725.76it/s] 58%|█████▊    | 255356/441656 [00:12<00:07, 24676.88it/s] 58%|█████▊    | 258167/441656 [00:12<00:07, 25622.19it/s] 59%|█████▉    | 260991/441656 [00:12<00:06, 26360.46it/s] 60%|█████▉    | 263772/441656 [00:12<00:06, 26734.77it/s] 60%|██████    | 266551/441656 [00:12<00:06, 27038.89it/s] 61%|██████    | 269328/441656 [00:12<00:06, 27250.64it/s] 62%|██████▏   | 272105/441656 [00:12<00:06, 27313.92it/s] 62%|██████▏   | 274914/441656 [00:12<00:06, 27542.63it/s] 63%|██████▎   | 277749/441656 [00:12<00:05, 27779.90it/s] 64%|██████▎   | 280546/441656 [00:12<00:05, 27726.23it/s] 64%|██████▍   | 283367/441656 [00:13<00:05, 27869.69it/s] 65%|██████▍   | 286205/441656 [00:13<00:05, 28020.90it/s] 65%|██████▌   | 289014/441656 [00:13<00:05, 27907.58it/s] 66%|██████▌   | 291836/441656 [00:13<00:05, 27997.57it/s] 67%|██████▋   | 294639/441656 [00:13<00:05, 27888.49it/s] 67%|██████▋   | 297444/441656 [00:13<00:05, 27934.60it/s] 68%|██████▊   | 300240/441656 [00:13<00:05, 27850.65it/s] 69%|██████▊   | 303029/441656 [00:13<00:04, 27831.76it/s] 69%|██████▉   | 305814/441656 [00:13<00:04, 27528.48it/s] 70%|██████▉   | 308630/441656 [00:13<00:04, 27713.76it/s] 71%|███████   | 311429/441656 [00:14<00:04, 27703.39it/s] 71%|███████   | 314242/441656 [00:14<00:04, 27827.85it/s] 72%|███████▏  | 317056/441656 [00:14<00:04, 27920.13it/s] 72%|███████▏  | 319849/441656 [00:14<00:04, 27828.43it/s] 73%|███████▎  | 322633/441656 [00:14<00:04, 27680.96it/s] 74%|███████▎  | 325444/441656 [00:14<00:04, 27807.91it/s] 74%|███████▍  | 328229/441656 [00:14<00:04, 27762.03it/s] 75%|███████▍  | 331006/441656 [00:15<00:16, 6675.43it/s]  76%|███████▌  | 333570/441656 [00:15<00:12, 8438.50it/s] 76%|███████▌  | 336167/441656 [00:16<00:10, 10493.67it/s] 77%|███████▋  | 338750/441656 [00:16<00:08, 12693.44it/s] 77%|███████▋  | 341301/441656 [00:16<00:06, 14872.52it/s] 78%|███████▊  | 343884/441656 [00:16<00:05, 17013.75it/s] 78%|███████▊  | 346469/441656 [00:16<00:05, 18941.49it/s] 79%|███████▉  | 349018/441656 [00:16<00:04, 20496.15it/s] 80%|███████▉  | 351579/441656 [00:16<00:04, 21791.10it/s] 80%|████████  | 354113/441656 [00:16<00:03, 22507.28it/s] 81%|████████  | 356699/441656 [00:16<00:03, 23420.77it/s] 81%|████████▏ | 359243/441656 [00:16<00:03, 23985.02it/s] 82%|████████▏ | 361839/441656 [00:17<00:03, 24549.69it/s] 83%|████████▎ | 364392/441656 [00:17<00:03, 24798.25it/s] 83%|████████▎ | 366995/441656 [00:17<00:02, 25157.79it/s] 84%|████████▎ | 369579/441656 [00:17<00:02, 25357.66it/s] 84%|████████▍ | 372174/441656 [00:17<00:02, 25530.95it/s] 85%|████████▍ | 374752/441656 [00:17<00:02, 25376.00it/s] 85%|████████▌ | 377356/441656 [00:17<00:02, 25570.01it/s] 86%|████████▌ | 379937/441656 [00:17<00:02, 25639.61it/s] 87%|████████▋ | 382521/441656 [00:17<00:02, 25697.26it/s] 87%|████████▋ | 385103/441656 [00:17<00:02, 25655.70it/s] 88%|████████▊ | 387695/441656 [00:18<00:02, 25733.32it/s] 88%|████████▊ | 390272/441656 [00:18<00:02, 25376.78it/s] 89%|████████▉ | 392887/441656 [00:18<00:01, 25605.33it/s] 90%|████████▉ | 395481/441656 [00:18<00:01, 25703.35it/s] 90%|█████████ | 398054/441656 [00:18<00:01, 25680.04it/s] 91%|█████████ | 400638/441656 [00:18<00:01, 25726.94it/s] 91%|█████████▏| 403212/441656 [00:18<00:01, 25720.13it/s] 92%|█████████▏| 405789/441656 [00:18<00:01, 25733.73it/s] 92%|█████████▏| 408363/441656 [00:18<00:01, 25682.03it/s] 93%|█████████▎| 410932/441656 [00:18<00:01, 25682.37it/s] 94%|█████████▎| 413532/441656 [00:19<00:01, 25775.21it/s] 94%|█████████▍| 416116/441656 [00:19<00:00, 25792.49it/s] 95%|█████████▍| 418696/441656 [00:19<00:00, 25761.19it/s] 95%|█████████▌| 421273/441656 [00:19<00:00, 25664.44it/s] 96%|█████████▌| 423865/441656 [00:19<00:00, 25737.92it/s] 97%|█████████▋| 426439/441656 [00:19<00:00, 25712.38it/s] 97%|█████████▋| 429011/441656 [00:19<00:00, 25348.98it/s] 98%|█████████▊| 431557/441656 [00:19<00:00, 25381.11it/s] 98%|█████████▊| 434152/441656 [00:19<00:00, 25548.73it/s] 99%|█████████▉| 436767/441656 [00:19<00:00, 25725.00it/s] 99%|█████████▉| 439341/441656 [00:20<00:00, 25638.33it/s]100%|██████████| 441656/441656 [00:20<00:00, 21891.85it/s]
  0%|          | 0/53198 [00:00<?, ?it/s]  6%|▌         | 3101/53198 [00:00<00:01, 31005.67it/s] 12%|█▏        | 6411/53198 [00:00<00:01, 32231.70it/s] 18%|█▊        | 9635/53198 [00:00<00:01, 31672.64it/s] 24%|██▍       | 13009/53198 [00:00<00:01, 32477.14it/s] 31%|███       | 16270/53198 [00:00<00:01, 32522.04it/s] 37%|███▋      | 19584/53198 [00:00<00:01, 32730.54it/s] 43%|████▎     | 22919/53198 [00:00<00:00, 32929.41it/s] 49%|████▉     | 26228/53198 [00:00<00:00, 32977.36it/s] 56%|█████▌    | 29565/53198 [00:00<00:00, 33096.92it/s] 62%|██████▏   | 32875/53198 [00:01<00:00, 32926.22it/s] 68%|██████▊   | 36173/53198 [00:01<00:00, 32939.44it/s] 74%|███████▍  | 39468/53198 [00:01<00:00, 32831.96it/s] 80%|████████  | 42752/53198 [00:01<00:00, 32665.93it/s] 87%|████████▋ | 46038/53198 [00:01<00:00, 32723.34it/s] 93%|█████████▎| 49311/53198 [00:01<00:00, 32032.25it/s] 99%|█████████▉| 52626/53198 [00:01<00:00, 32361.04it/s]100%|██████████| 53198/53198 [00:01<00:00, 32536.35it/s]
  0%|          | 0/35912 [00:00<?, ?it/s] 10%|▉         | 3512/35912 [00:00<00:00, 35109.15it/s] 20%|█▉        | 7046/35912 [00:00<00:00, 35241.83it/s] 30%|██▉       | 10658/35912 [00:00<00:00, 35639.18it/s] 40%|███▉      | 14222/35912 [00:00<00:00, 35626.17it/s] 50%|████▉     | 17785/35912 [00:00<00:00, 34632.29it/s] 59%|█████▉    | 21253/35912 [00:00<00:00, 34196.93it/s] 69%|██████▊   | 24677/35912 [00:00<00:00, 33456.99it/s] 78%|███████▊  | 28027/35912 [00:00<00:00, 32573.09it/s] 87%|████████▋ | 31290/35912 [00:00<00:00, 32565.61it/s] 96%|█████████▌| 34551/35912 [00:01<00:00, 32466.25it/s]100%|██████████| 35912/35912 [00:01<00:00, 33529.54it/s]
dataset loaded from path: 
data/ud/ud-treebanks-v2.1/UD_Catalan/inter-layer-13/UD_Catalan-train-bloom-1b1-intermediate-global_step200000.pkl
data/ud/ud-treebanks-v2.1/UD_Catalan/inter-layer-13/UD_Catalan-dev-bloom-1b1-intermediate-global_step200000.pkl
data/ud/ud-treebanks-v2.1/UD_Catalan/inter-layer-13/UD_Catalan-test-bloom-1b1-intermediate-global_step200000.pkl
Embedding dimensionality: 1536
Pre-training probe (if possible)...
Traceback (most recent call last):
  File "run.py", line 102, in <module>
    args.func(args)
  File "/home/s2308470/multilingual-typology-probing/commands.py", line 166, in greedy
    trainer.train()
  File "/home/s2308470/multilingual-typology-probing/probekit/trainers/trainer.py", line 21, in train
    self._train()
  File "/home/s2308470/multilingual-typology-probing/probekit/trainers/neural_probe_trainer.py", line 30, in _train
    self._train_for_dimensions()
  File "/home/s2308470/multilingual-typology-probing/trainers/flexible_neural_probe_trainer.py", line 72, in _train_for_dimensions
    inputs_tensor_shuffled = inputs_tensor[shuffled_indices]
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 2.21 GiB (GPU 0; 5.94 GiB total capacity; 5.41 GiB already allocated; 285.31 MiB free; 5.44 GiB reserved in total by PyTorch) If reserved memory is >> allocated memory try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF
