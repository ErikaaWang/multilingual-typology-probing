python run.py --language UD_Catalan --experiment-name inter-layer-17 --attribute POS --trainer poisson --gpu --embedding bloom-1b1-intermediate-global_step200000 greedy --selection-size 50 --selection-criterion mi
Setting up datasets (['UD_Catalan'], POS) and probes...
  0%|          | 0/441656 [00:00<?, ?it/s]  1%|          | 2404/441656 [00:00<00:18, 24034.12it/s]  1%|          | 5411/441656 [00:00<00:15, 27579.27it/s]  2%|▏         | 8438/441656 [00:00<00:15, 28803.10it/s]  3%|▎         | 11459/441656 [00:00<00:14, 29357.55it/s]  3%|▎         | 14476/441656 [00:00<00:14, 29647.08it/s]  4%|▍         | 17512/441656 [00:00<00:14, 29885.95it/s]  5%|▍         | 20537/441656 [00:00<00:14, 30002.34it/s]  5%|▌         | 23584/441656 [00:00<00:13, 30148.61it/s]  6%|▌         | 26701/441656 [00:00<00:13, 30466.48it/s]  7%|▋         | 29748/441656 [00:01<00:13, 30208.65it/s]  7%|▋         | 32835/441656 [00:01<00:13, 30407.29it/s]  8%|▊         | 35877/441656 [00:01<00:37, 10696.22it/s]  9%|▉         | 38892/441656 [00:01<00:30, 13265.26it/s]  9%|▉         | 41898/441656 [00:02<00:25, 15930.95it/s] 10%|█         | 44747/441656 [00:02<00:21, 18252.28it/s] 11%|█         | 47654/441656 [00:02<00:19, 20511.63it/s] 11%|█▏        | 50595/441656 [00:02<00:17, 22555.42it/s] 12%|█▏        | 53606/441656 [00:02<00:15, 24421.35it/s] 13%|█▎        | 56729/441656 [00:02<00:14, 26195.96it/s] 14%|█▎        | 59679/441656 [00:02<00:14, 26768.65it/s] 14%|█▍        | 62765/441656 [00:02<00:13, 27901.24it/s] 15%|█▍        | 65803/441656 [00:02<00:13, 28602.82it/s] 16%|█▌        | 68889/441656 [00:02<00:12, 29252.29it/s] 16%|█▋        | 71905/441656 [00:03<00:12, 29454.30it/s] 17%|█▋        | 74915/441656 [00:03<00:12, 29633.84it/s] 18%|█▊        | 77924/441656 [00:03<00:12, 29357.92it/s] 18%|█▊        | 80932/441656 [00:03<00:12, 29568.58it/s] 19%|█▉        | 83912/441656 [00:03<00:12, 29633.20it/s] 20%|█▉        | 86892/441656 [00:04<00:37, 9519.61it/s]  20%|██        | 89928/441656 [00:04<00:29, 12015.28it/s] 21%|██        | 92875/441656 [00:04<00:23, 14564.93it/s] 22%|██▏       | 95925/441656 [00:04<00:19, 17315.72it/s] 22%|██▏       | 98977/441656 [00:04<00:17, 19927.27it/s] 23%|██▎       | 101909/441656 [00:04<00:15, 21995.62it/s] 24%|██▍       | 104945/441656 [00:04<00:14, 23997.26it/s] 24%|██▍       | 107858/441656 [00:04<00:13, 25035.02it/s] 25%|██▌       | 110950/441656 [00:05<00:12, 26591.83it/s] 26%|██▌       | 113926/441656 [00:05<00:11, 27458.88it/s] 26%|██▋       | 116932/441656 [00:05<00:11, 28190.27it/s] 27%|██▋       | 119900/441656 [00:05<00:14, 21628.70it/s] 28%|██▊       | 122775/441656 [00:05<00:13, 23311.85it/s] 28%|██▊       | 125788/441656 [00:05<00:12, 25031.50it/s] 29%|██▉       | 128766/441656 [00:05<00:11, 26289.71it/s] 30%|██▉       | 131839/441656 [00:05<00:11, 27508.56it/s] 31%|███       | 134726/441656 [00:05<00:11, 27889.53it/s] 31%|███       | 137655/441656 [00:06<00:10, 28289.28it/s] 32%|███▏      | 140554/441656 [00:06<00:10, 28247.71it/s] 33%|███▎      | 143540/441656 [00:06<00:10, 28716.11it/s] 33%|███▎      | 146447/441656 [00:06<00:10, 28727.66it/s] 34%|███▍      | 149372/441656 [00:06<00:10, 28879.58it/s] 34%|███▍      | 152278/441656 [00:07<00:38, 7588.59it/s]  35%|███▌      | 155320/441656 [00:07<00:29, 9872.01it/s] 36%|███▌      | 158304/441656 [00:07<00:22, 12368.19it/s] 37%|███▋      | 161283/441656 [00:07<00:18, 15007.33it/s] 37%|███▋      | 164256/441656 [00:07<00:15, 17586.27it/s] 38%|███▊      | 167342/441656 [00:08<00:13, 20270.95it/s] 39%|███▊      | 170392/441656 [00:08<00:12, 22563.55it/s] 39%|███▉      | 173407/441656 [00:08<00:10, 24402.99it/s] 40%|███▉      | 176443/441656 [00:08<00:10, 25935.41it/s] 41%|████      | 179417/441656 [00:08<00:09, 26251.74it/s] 41%|████▏     | 182380/441656 [00:08<00:09, 27169.06it/s] 42%|████▏     | 185301/441656 [00:08<00:09, 27739.70it/s] 43%|████▎     | 188267/441656 [00:08<00:08, 28285.45it/s] 43%|████▎     | 191347/441656 [00:08<00:08, 29012.80it/s] 44%|████▍     | 194323/441656 [00:08<00:08, 29212.96it/s] 45%|████▍     | 197309/441656 [00:09<00:08, 29401.80it/s] 45%|████▌     | 200364/441656 [00:09<00:08, 29740.96it/s] 46%|████▌     | 203435/441656 [00:09<00:07, 30027.73it/s] 47%|████▋     | 206457/441656 [00:09<00:07, 29685.49it/s] 47%|████▋     | 209533/441656 [00:09<00:07, 30002.15it/s] 48%|████▊     | 212544/441656 [00:09<00:07, 30022.47it/s] 49%|████▉     | 215554/441656 [00:09<00:07, 29479.52it/s] 50%|████▉     | 218644/441656 [00:09<00:07, 29895.78it/s] 50%|█████     | 221640/441656 [00:09<00:07, 29745.02it/s] 51%|█████     | 224769/441656 [00:09<00:07, 30201.02it/s] 52%|█████▏    | 227793/441656 [00:10<00:07, 30043.30it/s] 52%|█████▏    | 230800/441656 [00:11<00:33, 6213.65it/s]  53%|█████▎    | 233728/441656 [00:11<00:25, 8070.79it/s] 54%|█████▎    | 236754/441656 [00:11<00:19, 10361.89it/s] 54%|█████▍    | 239752/441656 [00:11<00:15, 12883.19it/s] 55%|█████▍    | 242460/441656 [00:11<00:13, 14948.65it/s] 56%|█████▌    | 245456/441656 [00:11<00:11, 17651.47it/s] 56%|█████▌    | 248371/441656 [00:12<00:09, 20002.72it/s] 57%|█████▋    | 251182/441656 [00:12<00:08, 21835.18it/s] 58%|█████▊    | 254142/441656 [00:12<00:07, 23729.44it/s] 58%|█████▊    | 257111/441656 [00:12<00:07, 25269.00it/s] 59%|█████▉    | 260027/441656 [00:12<00:06, 26317.32it/s] 60%|█████▉    | 262964/441656 [00:12<00:06, 27165.39it/s] 60%|██████    | 265960/441656 [00:12<00:06, 27959.59it/s] 61%|██████    | 268915/441656 [00:12<00:06, 28417.76it/s] 62%|██████▏   | 271856/441656 [00:12<00:05, 28406.80it/s] 62%|██████▏   | 274777/441656 [00:12<00:05, 28638.53it/s] 63%|██████▎   | 277692/441656 [00:13<00:05, 28786.83it/s] 64%|██████▎   | 280606/441656 [00:13<00:05, 28463.57it/s] 64%|██████▍   | 283512/441656 [00:13<00:05, 28635.19it/s] 65%|██████▍   | 286394/441656 [00:13<00:05, 28394.40it/s] 65%|██████▌   | 289273/441656 [00:13<00:05, 28510.37it/s] 66%|██████▌   | 292192/441656 [00:13<00:05, 28709.24it/s] 67%|██████▋   | 295070/441656 [00:13<00:05, 28386.93it/s] 67%|██████▋   | 297968/441656 [00:13<00:05, 28560.29it/s] 68%|██████▊   | 300838/441656 [00:13<00:04, 28599.58it/s] 69%|██████▉   | 303793/441656 [00:13<00:04, 28880.36it/s] 69%|██████▉   | 306726/441656 [00:14<00:04, 29013.15it/s] 70%|███████   | 309629/441656 [00:14<00:04, 28530.14it/s] 71%|███████   | 312643/441656 [00:14<00:04, 29001.75it/s] 71%|███████▏  | 315564/441656 [00:14<00:04, 29060.08it/s] 72%|███████▏  | 318472/441656 [00:14<00:04, 28951.74it/s] 73%|███████▎  | 321491/441656 [00:14<00:04, 29319.22it/s] 73%|███████▎  | 324425/441656 [00:14<00:04, 29121.08it/s] 74%|███████▍  | 327354/441656 [00:14<00:03, 29170.60it/s] 75%|███████▍  | 330272/441656 [00:16<00:18, 6048.18it/s]  75%|███████▌  | 332930/441656 [00:16<00:14, 7714.00it/s] 76%|███████▌  | 335705/441656 [00:16<00:10, 9795.05it/s] 77%|███████▋  | 338460/441656 [00:16<00:08, 12088.68it/s] 77%|███████▋  | 341085/441656 [00:16<00:07, 14294.74it/s] 78%|███████▊  | 343783/441656 [00:16<00:05, 16603.07it/s] 78%|███████▊  | 346427/441656 [00:16<00:05, 18626.71it/s] 79%|███████▉  | 349101/441656 [00:16<00:04, 20472.55it/s] 80%|███████▉  | 351846/441656 [00:16<00:04, 22182.66it/s] 80%|████████  | 354509/441656 [00:17<00:03, 23038.80it/s] 81%|████████  | 357259/441656 [00:17<00:03, 24231.52it/s] 81%|████████▏ | 359922/441656 [00:17<00:03, 24710.01it/s] 82%|████████▏ | 362634/441656 [00:17<00:03, 25387.67it/s] 83%|████████▎ | 365369/441656 [00:17<00:02, 25949.86it/s] 83%|████████▎ | 368182/441656 [00:17<00:02, 26581.56it/s] 84%|████████▍ | 370905/441656 [00:17<00:02, 26679.10it/s] 85%|████████▍ | 373619/441656 [00:17<00:02, 26525.52it/s] 85%|████████▌ | 376304/441656 [00:17<00:02, 26589.67it/s] 86%|████████▌ | 378986/441656 [00:17<00:02, 26585.76it/s] 86%|████████▋ | 381704/441656 [00:18<00:02, 26760.15it/s] 87%|████████▋ | 384392/441656 [00:18<00:02, 26509.17it/s] 88%|████████▊ | 387117/441656 [00:18<00:02, 26727.80it/s] 88%|████████▊ | 389796/441656 [00:18<00:01, 26699.87it/s] 89%|████████▉ | 392471/441656 [00:18<00:01, 26437.92it/s] 89%|████████▉ | 395189/441656 [00:18<00:01, 26655.65it/s] 90%|█████████ | 397858/441656 [00:18<00:01, 26644.40it/s] 91%|█████████ | 400618/441656 [00:18<00:01, 26927.23it/s] 91%|█████████▏| 403367/441656 [00:18<00:01, 27092.71it/s] 92%|█████████▏| 406102/441656 [00:18<00:01, 27037.40it/s] 93%|█████████▎| 408910/441656 [00:19<00:01, 27345.98it/s] 93%|█████████▎| 411706/441656 [00:19<00:01, 27527.21it/s] 94%|█████████▍| 414460/441656 [00:19<00:00, 27206.82it/s] 94%|█████████▍| 417182/441656 [00:19<00:00, 26905.13it/s] 95%|█████████▌| 419889/441656 [00:19<00:00, 26952.75it/s] 96%|█████████▌| 422586/441656 [00:19<00:00, 26912.63it/s] 96%|█████████▋| 425278/441656 [00:19<00:00, 26741.37it/s] 97%|█████████▋| 427953/441656 [00:19<00:00, 26688.01it/s] 98%|█████████▊| 430623/441656 [00:19<00:00, 26363.22it/s] 98%|█████████▊| 433276/441656 [00:19<00:00, 26411.07it/s] 99%|█████████▊| 435949/441656 [00:20<00:00, 26504.55it/s] 99%|█████████▉| 438742/441656 [00:20<00:00, 26927.14it/s]100%|█████████▉| 441545/441656 [00:20<00:00, 27254.18it/s]100%|██████████| 441656/441656 [00:20<00:00, 21774.21it/s]
  0%|          | 0/53198 [00:00<?, ?it/s]  6%|▋         | 3352/53198 [00:00<00:01, 33516.20it/s] 13%|█▎        | 6704/53198 [00:00<00:01, 32822.75it/s] 19%|█▉        | 9988/53198 [00:00<00:01, 32113.59it/s] 25%|██▌       | 13423/53198 [00:00<00:01, 32976.94it/s] 32%|███▏      | 16851/53198 [00:00<00:01, 33439.71it/s] 38%|███▊      | 20198/53198 [00:00<00:01, 32659.70it/s] 44%|████▍     | 23639/53198 [00:00<00:00, 33217.66it/s] 51%|█████     | 27195/53198 [00:00<00:00, 33951.47it/s] 58%|█████▊    | 30603/53198 [00:00<00:00, 33988.73it/s] 64%|██████▍   | 34140/53198 [00:01<00:00, 34410.09it/s] 71%|███████   | 37617/53198 [00:01<00:00, 34516.16it/s] 77%|███████▋  | 41071/53198 [00:01<00:00, 34446.92it/s] 84%|████████▍ | 44617/53198 [00:01<00:00, 34571.20it/s] 90%|█████████ | 48075/53198 [00:01<00:00, 34539.10it/s] 97%|█████████▋| 51530/53198 [00:01<00:00, 33674.25it/s]100%|██████████| 53198/53198 [00:01<00:00, 33748.95it/s]
  0%|          | 0/35912 [00:00<?, ?it/s]  9%|▉         | 3352/35912 [00:00<00:00, 33515.00it/s] 19%|█▉        | 6994/35912 [00:00<00:00, 34817.78it/s] 30%|███       | 10838/35912 [00:00<00:00, 36459.66it/s] 40%|████      | 14485/35912 [00:00<00:00, 35949.24it/s] 50%|█████     | 18082/35912 [00:00<00:00, 35228.43it/s] 60%|██████    | 21608/35912 [00:00<00:00, 34387.01it/s] 70%|██████▉   | 25051/35912 [00:00<00:00, 33366.14it/s] 79%|███████▉  | 28537/35912 [00:00<00:00, 33819.56it/s] 89%|████████▉ | 32089/35912 [00:00<00:00, 34332.86it/s] 99%|█████████▉| 35528/35912 [00:01<00:00, 34023.65it/s]100%|██████████| 35912/35912 [00:01<00:00, 34386.47it/s]
dataset loaded from path: 
data/ud/ud-treebanks-v2.1/UD_Catalan/inter-layer-17/UD_Catalan-train-bloom-1b1-intermediate-global_step200000.pkl
data/ud/ud-treebanks-v2.1/UD_Catalan/inter-layer-17/UD_Catalan-dev-bloom-1b1-intermediate-global_step200000.pkl
data/ud/ud-treebanks-v2.1/UD_Catalan/inter-layer-17/UD_Catalan-test-bloom-1b1-intermediate-global_step200000.pkl
Embedding dimensionality: 1536
Pre-training probe (if possible)...
Traceback (most recent call last):
  File "run.py", line 102, in <module>
    args.func(args)
  File "/home/s2308470/multilingual-typology-probing/commands.py", line 166, in greedy
    trainer.train()
  File "/home/s2308470/multilingual-typology-probing/probekit/trainers/trainer.py", line 21, in train
    self._train()
  File "/home/s2308470/multilingual-typology-probing/probekit/trainers/neural_probe_trainer.py", line 30, in _train
    self._train_for_dimensions()
  File "/home/s2308470/multilingual-typology-probing/trainers/flexible_neural_probe_trainer.py", line 72, in _train_for_dimensions
    inputs_tensor_shuffled = inputs_tensor[shuffled_indices]
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 2.21 GiB (GPU 0; 5.94 GiB total capacity; 5.41 GiB already allocated; 285.31 MiB free; 5.44 GiB reserved in total by PyTorch) If reserved memory is >> allocated memory try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF
