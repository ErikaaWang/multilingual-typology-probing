python run.py --language UD_Spanish --experiment-name inter-layer-17 --attribute POS --trainer poisson --gpu --embedding bloom-1b1-intermediate-global_step10000 greedy --selection-size 50 --selection-criterion mi
Setting up datasets (['UD_Spanish'], POS) and probes...
  0%|          | 0/343741 [00:00<?, ?it/s]  0%|          | 1671/343741 [00:00<00:20, 16706.67it/s]  1%|          | 3893/343741 [00:00<00:17, 19945.66it/s]  2%|▏         | 6102/343741 [00:00<00:16, 20920.05it/s]  2%|▏         | 8307/343741 [00:00<00:15, 21364.12it/s]  3%|▎         | 10535/343741 [00:00<00:15, 21693.29it/s]  4%|▎         | 12768/343741 [00:00<00:15, 21908.77it/s]  4%|▍         | 14999/343741 [00:00<00:14, 22039.33it/s]  5%|▌         | 17235/343741 [00:00<00:14, 22139.33it/s]  6%|▌         | 19463/343741 [00:00<00:14, 22181.47it/s]  6%|▋         | 21682/343741 [00:01<00:30, 10553.01it/s]  7%|▋         | 23916/343741 [00:01<00:25, 12595.83it/s]  8%|▊         | 26147/343741 [00:01<00:21, 14523.10it/s]  8%|▊         | 28385/343741 [00:01<00:19, 16257.25it/s]  9%|▉         | 30481/343741 [00:01<00:18, 17384.70it/s] 10%|▉         | 32703/343741 [00:01<00:16, 18616.63it/s] 10%|█         | 34932/343741 [00:01<00:15, 19596.46it/s] 11%|█         | 37163/343741 [00:02<00:15, 20343.60it/s] 11%|█▏        | 39390/343741 [00:02<00:14, 20888.01it/s] 12%|█▏        | 41586/343741 [00:02<00:14, 21194.90it/s] 13%|█▎        | 43815/343741 [00:02<00:13, 21511.82it/s] 13%|█▎        | 46059/343741 [00:02<00:13, 21783.65it/s] 14%|█▍        | 48274/343741 [00:02<00:13, 21857.68it/s] 15%|█▍        | 50500/343741 [00:02<00:13, 21976.42it/s] 15%|█▌        | 52717/343741 [00:02<00:13, 22030.81it/s] 16%|█▌        | 54933/343741 [00:02<00:13, 21582.68it/s] 17%|█▋        | 57102/343741 [00:02<00:13, 21377.68it/s] 17%|█▋        | 59248/343741 [00:03<00:13, 21204.49it/s] 18%|█▊        | 61374/343741 [00:03<00:30, 9384.30it/s]  18%|█▊        | 63459/343741 [00:03<00:25, 11177.88it/s] 19%|█▉        | 65529/343741 [00:03<00:21, 12916.08it/s] 20%|█▉        | 67621/343741 [00:03<00:18, 14571.62it/s] 20%|██        | 69596/343741 [00:04<00:17, 15752.35it/s] 21%|██        | 71666/343741 [00:04<00:16, 16967.70it/s] 21%|██▏       | 73752/343741 [00:04<00:15, 17978.25it/s] 22%|██▏       | 75836/343741 [00:04<00:14, 18751.73it/s] 23%|██▎       | 77930/343741 [00:04<00:13, 19359.72it/s] 23%|██▎       | 80011/343741 [00:04<00:13, 19770.44it/s] 24%|██▍       | 82102/343741 [00:04<00:13, 20098.28it/s] 24%|██▍       | 84177/343741 [00:04<00:12, 20286.57it/s] 25%|██▌       | 86264/343741 [00:04<00:12, 20458.07it/s] 26%|██▌       | 88348/343741 [00:04<00:12, 20569.38it/s] 26%|██▋       | 90438/343741 [00:05<00:12, 20665.97it/s] 27%|██▋       | 92520/343741 [00:05<00:12, 20425.22it/s] 28%|██▊       | 94606/343741 [00:05<00:12, 20548.53it/s] 28%|██▊       | 96695/343741 [00:05<00:11, 20647.87it/s] 29%|██▊       | 98786/343741 [00:05<00:11, 20724.30it/s] 29%|██▉       | 100863/343741 [00:05<00:11, 20695.27it/s] 30%|██▉       | 102946/343741 [00:05<00:11, 20734.89it/s] 31%|███       | 105037/343741 [00:05<00:11, 20784.92it/s] 31%|███       | 107122/343741 [00:05<00:11, 20802.54it/s] 32%|███▏      | 109211/343741 [00:05<00:11, 20826.68it/s] 32%|███▏      | 111295/343741 [00:06<00:27, 8457.97it/s]  33%|███▎      | 113377/343741 [00:06<00:22, 10288.06it/s] 34%|███▎      | 115440/343741 [00:06<00:18, 12092.52it/s] 34%|███▍      | 117530/343741 [00:06<00:16, 13848.44it/s] 35%|███▍      | 119625/343741 [00:06<00:14, 15422.74it/s] 35%|███▌      | 121685/343741 [00:06<00:13, 16666.61it/s] 36%|███▌      | 123772/343741 [00:07<00:12, 17741.01it/s] 37%|███▋      | 125854/343741 [00:07<00:11, 18564.39it/s] 37%|███▋      | 127944/343741 [00:07<00:11, 19209.91it/s] 38%|███▊      | 129998/343741 [00:07<00:11, 19419.07it/s] 38%|███▊      | 132088/343741 [00:07<00:10, 19841.28it/s] 39%|███▉      | 134161/343741 [00:07<00:10, 20097.29it/s] 40%|███▉      | 136233/343741 [00:07<00:10, 20279.46it/s] 40%|████      | 138321/343741 [00:07<00:10, 20454.76it/s] 41%|████      | 140399/343741 [00:07<00:09, 20549.05it/s] 41%|████▏     | 142486/343741 [00:08<00:09, 20641.23it/s] 42%|████▏     | 144563/343741 [00:08<00:09, 20638.15it/s] 43%|████▎     | 146660/343741 [00:08<00:09, 20735.81it/s] 43%|████▎     | 148740/343741 [00:08<00:09, 20733.95it/s] 44%|████▍     | 150818/343741 [00:08<00:09, 20710.05it/s] 44%|████▍     | 152910/343741 [00:08<00:09, 20770.04it/s] 45%|████▌     | 154990/343741 [00:08<00:09, 20525.31it/s] 46%|████▌     | 157091/343741 [00:08<00:09, 20667.26it/s] 46%|████▋     | 159163/343741 [00:08<00:08, 20680.46it/s] 47%|████▋     | 161250/343741 [00:08<00:08, 20736.42it/s] 48%|████▊     | 163325/343741 [00:09<00:08, 20721.25it/s] 48%|████▊     | 165408/343741 [00:09<00:08, 20753.03it/s] 49%|████▊     | 167487/343741 [00:09<00:08, 20762.43it/s] 49%|████▉     | 169571/343741 [00:09<00:08, 20783.87it/s] 50%|████▉     | 171670/343741 [00:09<00:08, 20843.20it/s] 51%|█████     | 173755/343741 [00:09<00:08, 20806.35it/s] 51%|█████     | 175836/343741 [00:10<00:21, 7661.30it/s]  52%|█████▏    | 177905/343741 [00:10<00:17, 9433.83it/s] 52%|█████▏    | 180002/343741 [00:10<00:14, 11310.47it/s] 53%|█████▎    | 182058/343741 [00:10<00:12, 13054.24it/s] 54%|█████▎    | 184126/343741 [00:10<00:10, 14672.58it/s] 54%|█████▍    | 186207/343741 [00:10<00:09, 16099.09it/s] 55%|█████▍    | 188293/343741 [00:10<00:08, 17284.73it/s] 55%|█████▌    | 190309/343741 [00:10<00:08, 18012.18it/s] 56%|█████▌    | 192387/343741 [00:10<00:08, 18764.86it/s] 57%|█████▋    | 194481/343741 [00:11<00:07, 19372.94it/s] 57%|█████▋    | 196565/343741 [00:11<00:07, 19791.89it/s] 58%|█████▊    | 198640/343741 [00:11<00:07, 20068.71it/s] 58%|█████▊    | 200721/343741 [00:11<00:07, 20284.39it/s] 59%|█████▉    | 202804/343741 [00:11<00:06, 20444.75it/s] 60%|█████▉    | 204881/343741 [00:11<00:06, 20539.89it/s] 60%|██████    | 206965/343741 [00:11<00:06, 20626.24it/s] 61%|██████    | 209049/343741 [00:11<00:06, 20687.36it/s] 61%|██████▏   | 211143/343741 [00:11<00:06, 20761.71it/s] 62%|██████▏   | 213227/343741 [00:11<00:06, 20456.55it/s] 63%|██████▎   | 215303/343741 [00:12<00:06, 20545.63it/s] 63%|██████▎   | 217381/343741 [00:12<00:06, 20613.69it/s] 64%|██████▍   | 219467/343741 [00:12<00:06, 20686.66it/s] 64%|██████▍   | 221544/343741 [00:12<00:05, 20709.84it/s] 65%|██████▌   | 223634/343741 [00:12<00:05, 20764.14it/s] 66%|██████▌   | 225718/343741 [00:12<00:05, 20785.43it/s] 66%|██████▋   | 227798/343741 [00:12<00:05, 20756.25it/s] 67%|██████▋   | 229878/343741 [00:12<00:05, 20766.38it/s] 67%|██████▋   | 231956/343741 [00:12<00:05, 20763.56it/s] 68%|██████▊   | 234034/343741 [00:12<00:05, 20766.06it/s] 69%|██████▊   | 236111/343741 [00:13<00:05, 20513.23it/s] 69%|██████▉   | 238190/343741 [00:13<00:05, 20593.05it/s] 70%|██████▉   | 240276/343741 [00:13<00:05, 20669.44it/s] 71%|███████   | 242344/343741 [00:13<00:04, 20659.14it/s] 71%|███████   | 244421/343741 [00:13<00:04, 20689.80it/s] 72%|███████▏  | 246507/343741 [00:13<00:04, 20738.64it/s] 72%|███████▏  | 248592/343741 [00:13<00:04, 20769.13it/s] 73%|███████▎  | 250686/343741 [00:13<00:04, 20819.28it/s] 74%|███████▎  | 252769/343741 [00:13<00:04, 20774.05it/s] 74%|███████▍  | 254847/343741 [00:14<00:16, 5417.84it/s]  75%|███████▍  | 256924/343741 [00:15<00:12, 6957.77it/s] 75%|███████▌  | 259001/343741 [00:15<00:09, 8688.38it/s] 76%|███████▌  | 261009/343741 [00:15<00:07, 10417.76it/s] 77%|███████▋  | 263074/343741 [00:15<00:06, 12241.05it/s] 77%|███████▋  | 265161/343741 [00:15<00:05, 13991.04it/s] 78%|███████▊  | 267221/343741 [00:15<00:04, 15474.96it/s] 78%|███████▊  | 269286/343741 [00:15<00:04, 16731.53it/s] 79%|███████▉  | 271368/343741 [00:15<00:04, 17783.38it/s] 80%|███████▉  | 273452/343741 [00:15<00:03, 18603.48it/s] 80%|████████  | 275541/343741 [00:15<00:03, 19237.06it/s] 81%|████████  | 277614/343741 [00:16<00:03, 19659.93it/s] 81%|████████▏ | 279705/343741 [00:16<00:03, 20018.92it/s] 82%|████████▏ | 281778/343741 [00:16<00:03, 19988.01it/s] 83%|████████▎ | 283853/343741 [00:16<00:02, 20209.67it/s] 83%|████████▎ | 285933/343741 [00:16<00:02, 20381.36it/s] 84%|████████▍ | 288015/343741 [00:16<00:02, 20508.20it/s] 84%|████████▍ | 290107/343741 [00:16<00:02, 20627.58it/s] 85%|████████▌ | 292186/343741 [00:16<00:02, 20673.83it/s] 86%|████████▌ | 294279/343741 [00:16<00:02, 20721.54it/s] 86%|████████▌ | 296374/343741 [00:16<00:02, 20788.02it/s] 87%|████████▋ | 298458/343741 [00:17<00:02, 20732.64it/s] 87%|████████▋ | 300539/343741 [00:17<00:02, 20754.21it/s] 88%|████████▊ | 302617/343741 [00:17<00:01, 20568.79it/s] 89%|████████▊ | 304692/343741 [00:17<00:01, 20622.23it/s] 89%|████████▉ | 306763/343741 [00:17<00:01, 20647.24it/s] 90%|████████▉ | 308840/343741 [00:17<00:01, 20681.40it/s] 90%|█████████ | 310909/343741 [00:17<00:01, 20673.75it/s] 91%|█████████ | 312986/343741 [00:17<00:01, 20702.21it/s] 92%|█████████▏| 315057/343741 [00:17<00:01, 20688.70it/s] 92%|█████████▏| 317132/343741 [00:17<00:01, 20706.72it/s] 93%|█████████▎| 319224/343741 [00:18<00:01, 20768.96it/s] 93%|█████████▎| 321302/343741 [00:18<00:01, 20761.60it/s] 94%|█████████▍| 323379/343741 [00:18<00:00, 20620.59it/s] 95%|█████████▍| 325450/343741 [00:18<00:00, 20646.06it/s] 95%|█████████▌| 327526/343741 [00:18<00:00, 20677.95it/s] 96%|█████████▌| 329611/343741 [00:18<00:00, 20727.95it/s] 96%|█████████▋| 331688/343741 [00:18<00:00, 20738.23it/s] 97%|█████████▋| 333779/343741 [00:18<00:00, 20789.28it/s] 98%|█████████▊| 335858/343741 [00:18<00:00, 20784.81it/s] 98%|█████████▊| 337953/343741 [00:18<00:00, 20831.45it/s] 99%|█████████▉| 340037/343741 [00:19<00:00, 20777.54it/s]100%|█████████▉| 342115/343741 [00:19<00:00, 20752.98it/s]100%|██████████| 343741/343741 [00:19<00:00, 17872.32it/s]
  0%|          | 0/56357 [00:00<?, ?it/s]  4%|▍         | 2478/56357 [00:00<00:02, 24771.99it/s]  9%|▉         | 4956/56357 [00:00<00:02, 24310.30it/s] 13%|█▎        | 7388/56357 [00:00<00:02, 24000.55it/s] 17%|█▋        | 9792/56357 [00:00<00:01, 24008.27it/s] 22%|██▏       | 12222/56357 [00:00<00:01, 24109.22it/s] 26%|██▋       | 14794/56357 [00:00<00:01, 24650.77it/s] 31%|███       | 17318/56357 [00:00<00:01, 24839.17it/s] 35%|███▌      | 19820/56357 [00:00<00:01, 24894.48it/s] 40%|███▉      | 22378/56357 [00:00<00:01, 25107.01it/s] 44%|████▍     | 24889/56357 [00:01<00:01, 24940.99it/s] 49%|████▊     | 27448/56357 [00:01<00:01, 25137.57it/s] 53%|█████▎    | 30007/56357 [00:01<00:01, 25273.81it/s] 58%|█████▊    | 32541/56357 [00:01<00:00, 25292.04it/s] 62%|██████▏   | 35071/56357 [00:01<00:00, 25263.76it/s] 67%|██████▋   | 37598/56357 [00:01<00:00, 24845.96it/s] 71%|███████   | 40085/56357 [00:01<00:00, 24620.40it/s] 75%|███████▌  | 42549/56357 [00:01<00:00, 24452.66it/s] 80%|███████▉  | 45014/56357 [00:01<00:00, 24509.48it/s] 84%|████████▍ | 47539/56357 [00:01<00:00, 24728.82it/s] 89%|████████▉ | 50097/56357 [00:02<00:00, 24981.13it/s] 93%|█████████▎| 52668/56357 [00:02<00:00, 25190.16it/s] 98%|█████████▊| 55249/56357 [00:02<00:00, 25374.69it/s]100%|██████████| 56357/56357 [00:02<00:00, 24855.07it/s]
  0%|          | 0/23248 [00:00<?, ?it/s] 10%|▉         | 2287/23248 [00:00<00:00, 22860.16it/s] 21%|██        | 4847/23248 [00:00<00:00, 24466.72it/s] 32%|███▏      | 7441/23248 [00:00<00:00, 25135.38it/s] 43%|████▎     | 10032/23248 [00:00<00:00, 25437.67it/s] 54%|█████▍    | 12600/23248 [00:00<00:00, 25523.00it/s] 65%|██████▌   | 15196/23248 [00:00<00:00, 25668.31it/s] 77%|███████▋  | 17802/23248 [00:00<00:00, 25793.15it/s] 88%|████████▊ | 20383/23248 [00:00<00:00, 25795.41it/s] 99%|█████████▉| 22963/23248 [00:00<00:00, 25411.96it/s]100%|██████████| 23248/23248 [00:00<00:00, 25296.66it/s]
dataset loaded from path: 
data/ud/ud-treebanks-v2.1/UD_Spanish/inter-layer-17/UD_Spanish-train-bloom-1b1-intermediate-global_step10000.pkl
data/ud/ud-treebanks-v2.1/UD_Spanish/inter-layer-17/UD_Spanish-dev-bloom-1b1-intermediate-global_step10000.pkl
data/ud/ud-treebanks-v2.1/UD_Spanish/inter-layer-17/UD_Spanish-test-bloom-1b1-intermediate-global_step10000.pkl
Embedding dimensionality: 1536
Pre-training probe (if possible)...
Traceback (most recent call last):
  File "run.py", line 102, in <module>
    args.func(args)
  File "/home/s2308470/multilingual-typology-probing/commands.py", line 166, in greedy
    trainer.train()
  File "/home/s2308470/multilingual-typology-probing/probekit/trainers/trainer.py", line 21, in train
    self._train()
  File "/home/s2308470/multilingual-typology-probing/probekit/trainers/neural_probe_trainer.py", line 30, in _train
    self._train_for_dimensions()
  File "/home/s2308470/multilingual-typology-probing/trainers/flexible_neural_probe_trainer.py", line 72, in _train_for_dimensions
    inputs_tensor_shuffled = inputs_tensor[shuffled_indices]
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 1.63 GiB (GPU 0; 5.94 GiB total capacity; 4.18 GiB already allocated; 1.51 GiB free; 4.21 GiB reserved in total by PyTorch) If reserved memory is >> allocated memory try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF
