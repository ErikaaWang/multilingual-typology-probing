python run.py --language UD_Catalan --experiment-name inter-layer-13 --attribute POS --trainer poisson --gpu --embedding bloom-1b1-intermediate-global_step400000 greedy --selection-size 50 --selection-criterion mi
Setting up datasets (['UD_Catalan'], POS) and probes...
  0%|          | 0/441656 [00:00<?, ?it/s]  1%|          | 2216/441656 [00:00<00:19, 22156.06it/s]  1%|          | 5080/441656 [00:00<00:16, 25966.71it/s]  2%|▏         | 7969/441656 [00:00<00:15, 27296.54it/s]  2%|▏         | 10744/441656 [00:00<00:15, 27471.85it/s]  3%|▎         | 13617/441656 [00:00<00:15, 27924.15it/s]  4%|▎         | 16471/441656 [00:00<00:15, 28132.76it/s]  4%|▍         | 19299/441656 [00:00<00:14, 28178.22it/s]  5%|▌         | 22119/441656 [00:00<00:14, 28182.92it/s]  6%|▌         | 25000/441656 [00:00<00:14, 28376.62it/s]  6%|▋         | 27838/441656 [00:01<00:14, 28241.73it/s]  7%|▋         | 30714/441656 [00:01<00:14, 28399.27it/s]  8%|▊         | 33555/441656 [00:01<00:14, 27855.67it/s]  8%|▊         | 36343/441656 [00:01<00:36, 11044.82it/s]  9%|▉         | 39211/441656 [00:01<00:29, 13593.44it/s] 10%|▉         | 42086/441656 [00:02<00:24, 16186.52it/s] 10%|█         | 44859/441656 [00:02<00:21, 18453.08it/s] 11%|█         | 47757/441656 [00:02<00:18, 20758.14it/s] 11%|█▏        | 50428/441656 [00:02<00:17, 21991.99it/s] 12%|█▏        | 53071/441656 [00:02<00:16, 23073.38it/s] 13%|█▎        | 55709/441656 [00:02<00:16, 23854.33it/s] 13%|█▎        | 58336/441656 [00:02<00:15, 24493.16it/s] 14%|█▍        | 60960/441656 [00:02<00:15, 24909.96it/s] 14%|█▍        | 63576/441656 [00:02<00:14, 25261.67it/s] 15%|█▍        | 66192/441656 [00:02<00:14, 25380.02it/s] 16%|█▌        | 68825/441656 [00:03<00:14, 25654.34it/s] 16%|█▌        | 71456/441656 [00:03<00:14, 25845.61it/s] 17%|█▋        | 74283/441656 [00:03<00:13, 26561.64it/s] 17%|█▋        | 77081/441656 [00:03<00:13, 26980.30it/s] 18%|█▊        | 79796/441656 [00:03<00:13, 26893.86it/s] 19%|█▊        | 82498/441656 [00:03<00:13, 26533.96it/s] 19%|█▉        | 85161/441656 [00:03<00:13, 26443.46it/s] 20%|█▉        | 87812/441656 [00:04<00:35, 9857.65it/s]  20%|██        | 90423/441656 [00:04<00:29, 12066.22it/s] 21%|██        | 93028/441656 [00:04<00:24, 14339.62it/s] 22%|██▏       | 95525/441656 [00:04<00:21, 16342.43it/s] 22%|██▏       | 98175/441656 [00:04<00:18, 18496.66it/s] 23%|██▎       | 100805/441656 [00:04<00:16, 20310.93it/s] 23%|██▎       | 103388/441656 [00:04<00:15, 21686.90it/s] 24%|██▍       | 106024/441656 [00:05<00:14, 22913.41it/s] 25%|██▍       | 108651/441656 [00:05<00:13, 23828.43it/s] 25%|██▌       | 111269/441656 [00:05<00:13, 24485.83it/s] 26%|██▌       | 113860/441656 [00:05<00:13, 24873.63it/s] 26%|██▋       | 116491/441656 [00:05<00:12, 25288.74it/s] 27%|██▋       | 119114/441656 [00:05<00:12, 25563.41it/s] 28%|██▊       | 121723/441656 [00:05<00:12, 25715.56it/s] 28%|██▊       | 124331/441656 [00:05<00:12, 25485.80it/s] 29%|██▊       | 126917/441656 [00:05<00:12, 25594.29it/s] 29%|██▉       | 129573/441656 [00:05<00:12, 25878.85it/s] 30%|██▉       | 132197/441656 [00:06<00:11, 25983.92it/s] 31%|███       | 134805/441656 [00:06<00:11, 25915.34it/s] 31%|███       | 137431/441656 [00:06<00:11, 26015.28it/s] 32%|███▏      | 140038/441656 [00:06<00:11, 25980.47it/s] 32%|███▏      | 142691/441656 [00:06<00:11, 26141.27it/s] 33%|███▎      | 145308/441656 [00:06<00:11, 25977.48it/s] 33%|███▎      | 147932/441656 [00:06<00:11, 26055.04it/s] 34%|███▍      | 150539/441656 [00:07<00:33, 8676.96it/s]  35%|███▍      | 153134/441656 [00:07<00:26, 10824.09it/s] 35%|███▌      | 155776/441656 [00:07<00:21, 13175.66it/s] 36%|███▌      | 158319/441656 [00:07<00:18, 15347.19it/s] 36%|███▋      | 160964/441656 [00:07<00:15, 17589.37it/s] 37%|███▋      | 163573/441656 [00:07<00:14, 19492.62it/s] 38%|███▊      | 166083/441656 [00:07<00:13, 20851.51it/s] 38%|███▊      | 168697/441656 [00:08<00:12, 22211.38it/s] 39%|███▉      | 171285/441656 [00:08<00:11, 23196.34it/s] 39%|███▉      | 173941/441656 [00:08<00:11, 24128.09it/s] 40%|███▉      | 176547/441656 [00:08<00:10, 24673.31it/s] 41%|████      | 179136/441656 [00:08<00:10, 25000.55it/s] 41%|████      | 181734/441656 [00:08<00:10, 25284.41it/s] 42%|████▏     | 184356/441656 [00:08<00:10, 25558.52it/s] 42%|████▏     | 186956/441656 [00:08<00:09, 25624.25it/s] 43%|████▎     | 189549/441656 [00:08<00:09, 25659.23it/s] 44%|████▎     | 192195/441656 [00:08<00:09, 25894.71it/s] 44%|████▍     | 194869/441656 [00:09<00:09, 26144.18it/s] 45%|████▍     | 197495/441656 [00:09<00:09, 25866.32it/s] 45%|████▌     | 200113/441656 [00:09<00:09, 25957.58it/s] 46%|████▌     | 202750/441656 [00:09<00:09, 26079.81it/s] 47%|████▋     | 205402/441656 [00:09<00:09, 26208.75it/s] 47%|████▋     | 208026/441656 [00:09<00:08, 26167.84it/s] 48%|████▊     | 210645/441656 [00:09<00:08, 26114.04it/s] 48%|████▊     | 213259/441656 [00:09<00:08, 26119.72it/s] 49%|████▉     | 215893/441656 [00:09<00:08, 26184.55it/s] 49%|████▉     | 218524/441656 [00:09<00:08, 26220.63it/s] 50%|█████     | 221147/441656 [00:10<00:08, 26198.58it/s] 51%|█████     | 223794/441656 [00:10<00:08, 26277.52it/s] 51%|█████▏    | 226423/441656 [00:10<00:08, 25941.08it/s] 52%|█████▏    | 229107/441656 [00:10<00:08, 26206.43it/s] 52%|█████▏    | 231729/441656 [00:11<00:26, 7892.69it/s]  53%|█████▎    | 234268/441656 [00:11<00:20, 9879.73it/s] 54%|█████▎    | 236933/441656 [00:11<00:16, 12220.62it/s] 54%|█████▍    | 239586/441656 [00:11<00:13, 14599.61it/s] 55%|█████▍    | 242180/441656 [00:11<00:11, 16775.53it/s] 55%|█████▌    | 244836/441656 [00:11<00:10, 18880.50it/s] 56%|█████▌    | 247500/441656 [00:11<00:09, 20703.98it/s] 57%|█████▋    | 250151/441656 [00:11<00:08, 22161.90it/s] 57%|█████▋    | 252769/441656 [00:12<00:08, 23223.13it/s] 58%|█████▊    | 255414/441656 [00:12<00:07, 24105.38it/s] 58%|█████▊    | 258066/441656 [00:12<00:07, 24782.14it/s] 59%|█████▉    | 260689/441656 [00:12<00:07, 25160.54it/s] 60%|█████▉    | 263308/441656 [00:12<00:07, 25434.54it/s] 60%|██████    | 265924/441656 [00:12<00:06, 25363.13it/s] 61%|██████    | 268557/441656 [00:12<00:06, 25643.22it/s] 61%|██████▏   | 271185/441656 [00:12<00:06, 25828.68it/s] 62%|██████▏   | 273817/441656 [00:12<00:06, 25971.95it/s] 63%|██████▎   | 276433/441656 [00:12<00:06, 25975.91it/s] 63%|██████▎   | 279070/441656 [00:13<00:06, 26091.83it/s] 64%|██████▍   | 281703/441656 [00:13<00:06, 26161.93it/s] 64%|██████▍   | 284326/441656 [00:13<00:06, 26140.54it/s] 65%|██████▍   | 286952/441656 [00:13<00:05, 26173.94it/s] 66%|██████▌   | 289627/441656 [00:13<00:05, 26345.27it/s] 66%|██████▌   | 292274/441656 [00:13<00:05, 26380.25it/s] 67%|██████▋   | 294914/441656 [00:13<00:05, 25979.15it/s] 67%|██████▋   | 297550/441656 [00:13<00:05, 26090.37it/s] 68%|██████▊   | 300196/441656 [00:13<00:05, 26199.30it/s] 69%|██████▊   | 302820/441656 [00:13<00:05, 26208.11it/s] 69%|██████▉   | 305442/441656 [00:14<00:05, 26086.53it/s] 70%|██████▉   | 308088/441656 [00:14<00:05, 26194.65it/s] 70%|███████   | 310709/441656 [00:14<00:05, 26188.65it/s] 71%|███████   | 313338/441656 [00:14<00:04, 26217.84it/s] 72%|███████▏  | 315961/441656 [00:14<00:04, 26103.74it/s] 72%|███████▏  | 318604/441656 [00:14<00:04, 26198.41it/s] 73%|███████▎  | 321253/441656 [00:14<00:04, 26284.22it/s] 73%|███████▎  | 323882/441656 [00:14<00:04, 25923.09it/s] 74%|███████▍  | 326476/441656 [00:14<00:04, 25811.94it/s] 75%|███████▍  | 329059/441656 [00:16<00:18, 6019.34it/s]  75%|███████▌  | 331701/441656 [00:16<00:14, 7853.71it/s] 76%|███████▌  | 334312/441656 [00:16<00:10, 9931.65it/s] 76%|███████▋  | 336883/441656 [00:16<00:08, 12137.97it/s] 77%|███████▋  | 339489/441656 [00:16<00:07, 14455.92it/s] 77%|███████▋  | 342121/441656 [00:16<00:05, 16735.02it/s] 78%|███████▊  | 344775/441656 [00:16<00:05, 18845.72it/s] 79%|███████▊  | 347353/441656 [00:16<00:04, 20475.66it/s] 79%|███████▉  | 349996/441656 [00:16<00:04, 21972.42it/s] 80%|███████▉  | 352603/441656 [00:17<00:03, 23053.26it/s] 80%|████████  | 355189/441656 [00:17<00:03, 23702.16it/s] 81%|████████  | 357761/441656 [00:17<00:03, 24209.67it/s] 82%|████████▏ | 360351/441656 [00:17<00:03, 24690.74it/s] 82%|████████▏ | 362956/441656 [00:17<00:03, 25083.51it/s] 83%|████████▎ | 365616/441656 [00:17<00:02, 25524.96it/s] 83%|████████▎ | 368244/441656 [00:17<00:02, 25746.29it/s] 84%|████████▍ | 370873/441656 [00:17<00:02, 25904.99it/s] 85%|████████▍ | 373518/441656 [00:17<00:02, 26064.30it/s] 85%|████████▌ | 376176/441656 [00:17<00:02, 26215.45it/s] 86%|████████▌ | 378811/441656 [00:18<00:02, 26093.94it/s] 86%|████████▋ | 381430/441656 [00:18<00:02, 25899.92it/s] 87%|████████▋ | 384044/441656 [00:18<00:02, 25968.73it/s] 88%|████████▊ | 386680/441656 [00:18<00:02, 26082.60it/s] 88%|████████▊ | 389292/441656 [00:18<00:02, 26052.92it/s] 89%|████████▊ | 391914/441656 [00:18<00:01, 26101.82it/s] 89%|████████▉ | 394536/441656 [00:18<00:01, 26134.94it/s] 90%|████████▉ | 397204/441656 [00:18<00:01, 26296.98it/s] 91%|█████████ | 399835/441656 [00:18<00:01, 26112.66it/s] 91%|█████████ | 402494/441656 [00:18<00:01, 26252.36it/s] 92%|█████████▏| 405134/441656 [00:19<00:01, 26294.08it/s] 92%|█████████▏| 407799/441656 [00:19<00:01, 26398.68it/s] 93%|█████████▎| 410440/441656 [00:19<00:01, 25740.04it/s] 94%|█████████▎| 413018/441656 [00:19<00:01, 25731.91it/s] 94%|█████████▍| 415594/441656 [00:19<00:01, 25721.11it/s] 95%|█████████▍| 418178/441656 [00:19<00:00, 25747.35it/s] 95%|█████████▌| 420766/441656 [00:19<00:00, 25785.99it/s] 96%|█████████▌| 423346/441656 [00:19<00:00, 25693.77it/s] 96%|█████████▋| 425943/441656 [00:19<00:00, 25774.02it/s] 97%|█████████▋| 428543/441656 [00:19<00:00, 25838.73it/s] 98%|█████████▊| 431128/441656 [00:20<00:00, 25728.33it/s] 98%|█████████▊| 433702/441656 [00:20<00:00, 25664.57it/s] 99%|█████████▉| 436290/441656 [00:20<00:00, 25726.95it/s] 99%|█████████▉| 438895/441656 [00:20<00:00, 25822.84it/s]100%|█████████▉| 441478/441656 [00:20<00:00, 25511.90it/s]100%|██████████| 441656/441656 [00:20<00:00, 21603.27it/s]
  0%|          | 0/53198 [00:00<?, ?it/s]  7%|▋         | 3490/53198 [00:00<00:01, 34889.39it/s] 13%|█▎        | 6979/53198 [00:00<00:01, 34081.23it/s] 20%|█▉        | 10538/53198 [00:00<00:01, 34756.92it/s] 26%|██▋       | 14016/53198 [00:00<00:01, 34513.99it/s] 33%|███▎      | 17538/53198 [00:00<00:01, 34763.88it/s] 40%|███▉      | 21054/53198 [00:00<00:00, 34896.13it/s] 46%|████▌     | 24545/53198 [00:00<00:00, 34516.55it/s] 53%|█████▎    | 28025/53198 [00:00<00:00, 34603.95it/s] 59%|█████▉    | 31631/53198 [00:00<00:00, 35055.05it/s] 66%|██████▌   | 35138/53198 [00:01<00:00, 34641.95it/s] 73%|███████▎  | 38640/53198 [00:01<00:00, 34754.12it/s] 79%|███████▉  | 42226/53198 [00:01<00:00, 35087.18it/s] 86%|████████▌ | 45758/53198 [00:01<00:00, 35155.90it/s] 93%|█████████▎| 49275/53198 [00:01<00:00, 35098.75it/s] 99%|█████████▉| 52786/53198 [00:01<00:00, 34895.12it/s]100%|██████████| 53198/53198 [00:01<00:00, 34757.78it/s]
  0%|          | 0/35912 [00:00<?, ?it/s]  9%|▉         | 3396/35912 [00:00<00:00, 33953.48it/s] 19%|█▉        | 6899/35912 [00:00<00:00, 34581.07it/s] 29%|██▉       | 10440/35912 [00:00<00:00, 34954.94it/s] 39%|███▉      | 13936/35912 [00:00<00:00, 34695.57it/s] 48%|████▊     | 17406/35912 [00:00<00:00, 34467.92it/s] 58%|█████▊    | 20854/35912 [00:00<00:00, 33748.53it/s] 67%|██████▋   | 24232/35912 [00:00<00:00, 33652.72it/s] 77%|███████▋  | 27779/35912 [00:00<00:00, 34218.64it/s] 87%|████████▋ | 31251/35912 [00:00<00:00, 34372.24it/s] 97%|█████████▋| 34748/35912 [00:01<00:00, 34554.38it/s]100%|██████████| 35912/35912 [00:01<00:00, 34385.12it/s]
dataset loaded from path: 
data/ud/ud-treebanks-v2.1/UD_Catalan/inter-layer-13/UD_Catalan-train-bloom-1b1-intermediate-global_step400000.pkl
data/ud/ud-treebanks-v2.1/UD_Catalan/inter-layer-13/UD_Catalan-dev-bloom-1b1-intermediate-global_step400000.pkl
data/ud/ud-treebanks-v2.1/UD_Catalan/inter-layer-13/UD_Catalan-test-bloom-1b1-intermediate-global_step400000.pkl
Embedding dimensionality: 1536
Pre-training probe (if possible)...
Traceback (most recent call last):
  File "run.py", line 102, in <module>
    args.func(args)
  File "/home/s2308470/multilingual-typology-probing/commands.py", line 166, in greedy
    trainer.train()
  File "/home/s2308470/multilingual-typology-probing/probekit/trainers/trainer.py", line 21, in train
    self._train()
  File "/home/s2308470/multilingual-typology-probing/probekit/trainers/neural_probe_trainer.py", line 30, in _train
    self._train_for_dimensions()
  File "/home/s2308470/multilingual-typology-probing/trainers/flexible_neural_probe_trainer.py", line 72, in _train_for_dimensions
    inputs_tensor_shuffled = inputs_tensor[shuffled_indices]
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 2.21 GiB (GPU 0; 5.94 GiB total capacity; 5.41 GiB already allocated; 285.31 MiB free; 5.44 GiB reserved in total by PyTorch) If reserved memory is >> allocated memory try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF
