python run.py --language UD_Spanish --experiment-name inter-layer-17 --attribute POS --trainer poisson --gpu --embedding bloom-1b1 greedy --selection-size 50 --selection-criterion mi
Setting up datasets (['UD_Spanish'], POS) and probes...
  0%|          | 0/343741 [00:00<?, ?it/s]  0%|          | 1614/343741 [00:00<00:21, 16136.67it/s]  1%|          | 3711/343741 [00:00<00:17, 18975.79it/s]  2%|▏         | 5822/343741 [00:00<00:16, 19947.22it/s]  2%|▏         | 7935/343741 [00:00<00:16, 20410.87it/s]  3%|▎         | 10052/343741 [00:00<00:16, 20683.23it/s]  4%|▎         | 12163/343741 [00:00<00:15, 20825.02it/s]  4%|▍         | 14286/343741 [00:00<00:15, 20955.68it/s]  5%|▍         | 16389/343741 [00:00<00:15, 20978.35it/s]  5%|▌         | 18514/343741 [00:00<00:15, 21061.38it/s]  6%|▌         | 20621/343741 [00:01<00:32, 10072.24it/s]  7%|▋         | 22734/343741 [00:01<00:26, 11997.61it/s]  7%|▋         | 24841/343741 [00:01<00:23, 13804.15it/s]  8%|▊         | 26943/343741 [00:01<00:20, 15401.90it/s]  8%|▊         | 29061/343741 [00:01<00:18, 16789.66it/s]  9%|▉         | 31082/343741 [00:01<00:17, 17607.38it/s] 10%|▉         | 33210/343741 [00:01<00:16, 18586.95it/s] 10%|█         | 35330/343741 [00:02<00:15, 19307.55it/s] 11%|█         | 37469/343741 [00:02<00:15, 19895.26it/s] 12%|█▏        | 39578/343741 [00:02<00:15, 20237.98it/s] 12%|█▏        | 41699/343741 [00:02<00:14, 20519.30it/s] 13%|█▎        | 43831/343741 [00:02<00:14, 20752.31it/s] 13%|█▎        | 45953/343741 [00:02<00:14, 20888.77it/s] 14%|█▍        | 48088/343741 [00:02<00:14, 21024.32it/s] 15%|█▍        | 50214/343741 [00:02<00:13, 21092.51it/s] 15%|█▌        | 52356/343741 [00:02<00:13, 21187.49it/s] 16%|█▌        | 54484/343741 [00:02<00:13, 20680.57it/s] 16%|█▋        | 56561/343741 [00:03<00:14, 20411.94it/s] 17%|█▋        | 58609/343741 [00:03<00:14, 20286.32it/s] 18%|█▊        | 60642/343741 [00:03<00:14, 20179.61it/s] 18%|█▊        | 62663/343741 [00:03<00:31, 8970.16it/s]  19%|█▉        | 64640/343741 [00:03<00:26, 10668.59it/s] 19%|█▉        | 66618/343741 [00:03<00:22, 12340.25it/s] 20%|█▉        | 68512/343741 [00:04<00:20, 13710.30it/s] 21%|██        | 70487/343741 [00:04<00:18, 15091.35it/s] 21%|██        | 72481/343741 [00:04<00:16, 16285.09it/s] 22%|██▏       | 74446/343741 [00:04<00:15, 17160.24it/s] 22%|██▏       | 76411/343741 [00:04<00:14, 17833.73it/s] 23%|██▎       | 78386/343741 [00:04<00:14, 18365.94it/s] 23%|██▎       | 80368/343741 [00:04<00:14, 18779.83it/s] 24%|██▍       | 82358/343741 [00:04<00:13, 19103.42it/s] 25%|██▍       | 84339/343741 [00:04<00:13, 19307.14it/s] 25%|██▌       | 86330/343741 [00:04<00:13, 19483.78it/s] 26%|██▌       | 88307/343741 [00:05<00:13, 19562.67it/s] 26%|██▋       | 90283/343741 [00:05<00:13, 19359.27it/s] 27%|██▋       | 92267/343741 [00:05<00:12, 19500.46it/s] 27%|██▋       | 94257/343741 [00:05<00:12, 19609.09it/s] 28%|██▊       | 96278/343741 [00:05<00:12, 19785.77it/s] 29%|██▊       | 98262/343741 [00:05<00:12, 19796.46it/s] 29%|██▉       | 100248/343741 [00:05<00:12, 19813.63it/s] 30%|██▉       | 102236/343741 [00:05<00:12, 19830.26it/s] 30%|███       | 104221/343741 [00:05<00:12, 19789.78it/s] 31%|███       | 106202/343741 [00:06<00:12, 19761.92it/s] 31%|███▏      | 108190/343741 [00:06<00:11, 19794.16it/s] 32%|███▏      | 110179/343741 [00:06<00:11, 19822.37it/s] 33%|███▎      | 112162/343741 [00:06<00:28, 8038.63it/s]  33%|███▎      | 114145/343741 [00:06<00:23, 9781.32it/s] 34%|███▍      | 116138/343741 [00:06<00:19, 11549.77it/s] 34%|███▍      | 118118/343741 [00:07<00:17, 13194.12it/s] 35%|███▍      | 120114/343741 [00:07<00:15, 14692.96it/s] 36%|███▌      | 122098/343741 [00:07<00:13, 15929.81it/s] 36%|███▌      | 124083/343741 [00:07<00:12, 16930.42it/s] 37%|███▋      | 126011/343741 [00:07<00:12, 17510.15it/s] 37%|███▋      | 128031/343741 [00:07<00:11, 18186.47it/s] 38%|███▊      | 130065/343741 [00:07<00:11, 18790.96it/s] 38%|███▊      | 132050/343741 [00:07<00:11, 19092.96it/s] 39%|███▉      | 134049/343741 [00:07<00:10, 19353.49it/s] 40%|███▉      | 136038/343741 [00:07<00:10, 19509.30it/s] 40%|████      | 138022/343741 [00:08<00:10, 19587.93it/s] 41%|████      | 140018/343741 [00:08<00:10, 19697.24it/s] 41%|████▏     | 142015/343741 [00:08<00:10, 19777.24it/s] 42%|████▏     | 144020/343741 [00:08<00:10, 19855.67it/s] 42%|████▏     | 146014/343741 [00:08<00:10, 19642.41it/s] 43%|████▎     | 148017/343741 [00:08<00:09, 19754.78it/s] 44%|████▎     | 150008/343741 [00:08<00:09, 19800.66it/s] 44%|████▍     | 151994/343741 [00:08<00:09, 19817.20it/s] 45%|████▍     | 153991/343741 [00:08<00:09, 19860.77it/s] 45%|████▌     | 155992/343741 [00:09<00:09, 19902.87it/s] 46%|████▌     | 158000/343741 [00:09<00:09, 19954.61it/s] 47%|████▋     | 159997/343741 [00:09<00:09, 19953.44it/s] 47%|████▋     | 162002/343741 [00:09<00:09, 19981.48it/s] 48%|████▊     | 164004/343741 [00:09<00:08, 19991.09it/s] 48%|████▊     | 166004/343741 [00:09<00:08, 19961.38it/s] 49%|████▉     | 168001/343741 [00:09<00:08, 19956.44it/s] 49%|████▉     | 169997/343741 [00:09<00:08, 19804.57it/s] 50%|█████     | 172003/343741 [00:09<00:08, 19878.25it/s] 51%|█████     | 173995/343741 [00:09<00:08, 19888.87it/s] 51%|█████     | 175985/343741 [00:10<00:22, 7322.19it/s]  52%|█████▏    | 177958/343741 [00:10<00:18, 9007.75it/s] 52%|█████▏    | 179869/343741 [00:10<00:15, 10649.02it/s] 53%|█████▎    | 181844/343741 [00:10<00:13, 12363.08it/s] 53%|█████▎    | 183821/343741 [00:10<00:11, 13933.14it/s] 54%|█████▍    | 185797/343741 [00:11<00:10, 15287.66it/s] 55%|█████▍    | 187783/343741 [00:11<00:09, 16426.47it/s] 55%|█████▌    | 189768/343741 [00:11<00:08, 17325.35it/s] 56%|█████▌    | 191760/343741 [00:11<00:08, 18032.63it/s] 56%|█████▋    | 193736/343741 [00:11<00:08, 18516.31it/s] 57%|█████▋    | 195729/343741 [00:11<00:07, 18918.06it/s] 58%|█████▊    | 197699/343741 [00:11<00:07, 19140.81it/s] 58%|█████▊    | 199684/343741 [00:11<00:07, 19347.58it/s] 59%|█████▊    | 201703/343741 [00:11<00:07, 19507.45it/s] 59%|█████▉    | 203682/343741 [00:11<00:07, 19453.14it/s] 60%|█████▉    | 205686/343741 [00:12<00:07, 19624.88it/s] 60%|██████    | 207673/343741 [00:12<00:06, 19694.26it/s] 61%|██████    | 209679/343741 [00:12<00:06, 19800.84it/s] 62%|██████▏   | 211667/343741 [00:12<00:06, 19821.98it/s] 62%|██████▏   | 213659/343741 [00:12<00:06, 19850.60it/s] 63%|██████▎   | 215653/343741 [00:12<00:06, 19877.05it/s] 63%|██████▎   | 217644/343741 [00:12<00:06, 19857.52it/s] 64%|██████▍   | 219642/343741 [00:12<00:06, 19891.64it/s] 64%|██████▍   | 221633/343741 [00:12<00:06, 19884.30it/s] 65%|██████▌   | 223629/343741 [00:12<00:06, 19905.78it/s] 66%|██████▌   | 225621/343741 [00:13<00:06, 19674.92it/s] 66%|██████▌   | 227598/343741 [00:13<00:05, 19702.74it/s] 67%|██████▋   | 229583/343741 [00:13<00:05, 19744.55it/s] 67%|██████▋   | 231577/343741 [00:13<00:05, 19802.21it/s] 68%|██████▊   | 233569/343741 [00:13<00:05, 19835.90it/s] 69%|██████▊   | 235553/343741 [00:13<00:05, 19820.33it/s] 69%|██████▉   | 237541/343741 [00:13<00:05, 19837.19it/s] 70%|██████▉   | 239525/343741 [00:13<00:05, 19832.53it/s] 70%|███████   | 241534/343741 [00:13<00:05, 19908.89it/s] 71%|███████   | 243525/343741 [00:13<00:05, 19855.47it/s] 71%|███████▏  | 245511/343741 [00:14<00:04, 19682.90it/s] 72%|███████▏  | 247506/343741 [00:14<00:04, 19761.81it/s] 73%|███████▎  | 249496/343741 [00:14<00:04, 19801.17it/s] 73%|███████▎  | 251482/343741 [00:14<00:04, 19815.97it/s] 74%|███████▎  | 253475/343741 [00:14<00:04, 19847.91it/s] 74%|███████▍  | 255460/343741 [00:15<00:17, 4906.51it/s]  75%|███████▍  | 257433/343741 [00:15<00:13, 6323.72it/s] 75%|███████▌  | 259403/343741 [00:15<00:10, 7930.85it/s] 76%|███████▌  | 261392/343741 [00:15<00:08, 9682.65it/s] 77%|███████▋  | 263367/343741 [00:16<00:07, 11424.57it/s] 77%|███████▋  | 265280/343741 [00:16<00:06, 12951.80it/s] 78%|███████▊  | 267266/343741 [00:16<00:05, 14474.80it/s] 78%|███████▊  | 269250/343741 [00:16<00:04, 15760.19it/s] 79%|███████▉  | 271241/343741 [00:16<00:04, 16817.31it/s] 79%|███████▉  | 273251/343741 [00:16<00:03, 17692.02it/s] 80%|████████  | 275242/343741 [00:16<00:03, 18302.96it/s] 81%|████████  | 277223/343741 [00:16<00:03, 18728.47it/s] 81%|████████  | 279199/343741 [00:16<00:03, 19012.99it/s] 82%|████████▏ | 281184/343741 [00:16<00:03, 19255.23it/s] 82%|████████▏ | 283176/343741 [00:17<00:03, 19448.38it/s] 83%|████████▎ | 285158/343741 [00:17<00:03, 19402.04it/s] 84%|████████▎ | 287138/343741 [00:17<00:02, 19518.94it/s] 84%|████████▍ | 289129/343741 [00:17<00:02, 19634.40it/s] 85%|████████▍ | 291106/343741 [00:17<00:02, 19670.27it/s] 85%|████████▌ | 293083/343741 [00:17<00:02, 19687.13it/s] 86%|████████▌ | 295063/343741 [00:17<00:02, 19720.52it/s] 86%|████████▋ | 297049/343741 [00:17<00:02, 19759.35it/s] 87%|████████▋ | 299045/343741 [00:17<00:02, 19816.92it/s] 88%|████████▊ | 301029/343741 [00:17<00:02, 19815.46it/s] 88%|████████▊ | 303021/343741 [00:18<00:02, 19843.57it/s] 89%|████████▊ | 305007/343741 [00:18<00:01, 19619.27it/s] 89%|████████▉ | 306986/343741 [00:18<00:01, 19668.53it/s] 90%|████████▉ | 308980/343741 [00:18<00:01, 19713.47it/s] 90%|█████████ | 310988/343741 [00:18<00:01, 19820.58it/s] 91%|█████████ | 312972/343741 [00:18<00:01, 19824.52it/s] 92%|█████████▏| 314955/343741 [00:18<00:01, 19799.83it/s] 92%|█████████▏| 316938/343741 [00:18<00:01, 19807.38it/s] 93%|█████████▎| 318920/343741 [00:18<00:01, 19808.97it/s] 93%|█████████▎| 320902/343741 [00:18<00:01, 19770.43it/s] 94%|█████████▍| 322880/343741 [00:19<00:01, 19747.11it/s] 95%|█████████▍| 324855/343741 [00:19<00:00, 19573.76it/s] 95%|█████████▌| 326838/343741 [00:19<00:00, 19649.61it/s] 96%|█████████▌| 328821/343741 [00:19<00:00, 19701.18it/s] 96%|█████████▌| 330798/343741 [00:19<00:00, 19720.85it/s] 97%|█████████▋| 332786/343741 [00:19<00:00, 19765.46it/s] 97%|█████████▋| 334763/343741 [00:19<00:00, 19698.19it/s] 98%|█████████▊| 336742/343741 [00:19<00:00, 19724.59it/s] 99%|█████████▊| 338723/343741 [00:19<00:00, 19749.20it/s] 99%|█████████▉| 340699/343741 [00:19<00:00, 19751.03it/s]100%|█████████▉| 342692/343741 [00:20<00:00, 19802.06it/s]100%|██████████| 343741/343741 [00:20<00:00, 17119.68it/s]
  0%|          | 0/56357 [00:00<?, ?it/s]  4%|▍         | 2382/56357 [00:00<00:02, 23815.59it/s]  8%|▊         | 4764/56357 [00:00<00:02, 23127.73it/s] 13%|█▎        | 7079/56357 [00:00<00:02, 23045.59it/s] 17%|█▋        | 9385/56357 [00:00<00:02, 22708.30it/s] 21%|██        | 11697/56357 [00:00<00:01, 22852.11it/s] 25%|██▌       | 14143/56357 [00:00<00:01, 23391.52it/s] 29%|██▉       | 16623/56357 [00:00<00:01, 23845.98it/s] 34%|███▍      | 19122/56357 [00:00<00:01, 24205.09it/s] 38%|███▊      | 21600/56357 [00:00<00:01, 24381.15it/s] 43%|████▎     | 24039/56357 [00:01<00:01, 24205.62it/s] 47%|████▋     | 26516/56357 [00:01<00:01, 24375.06it/s] 51%|█████▏    | 28983/56357 [00:01<00:01, 24462.39it/s] 56%|█████▌    | 31457/56357 [00:01<00:01, 24543.62it/s] 60%|██████    | 33953/56357 [00:01<00:00, 24667.84it/s] 65%|██████▍   | 36421/56357 [00:01<00:00, 24390.19it/s] 69%|██████▉   | 38861/56357 [00:01<00:00, 23895.84it/s] 73%|███████▎  | 41254/56357 [00:01<00:00, 23756.09it/s] 77%|███████▋  | 43632/56357 [00:01<00:00, 23660.82it/s] 82%|████████▏ | 46081/56357 [00:01<00:00, 23904.89it/s] 86%|████████▌ | 48536/56357 [00:02<00:00, 24094.42it/s] 90%|█████████ | 50998/56357 [00:02<00:00, 24250.27it/s] 95%|█████████▍| 53424/56357 [00:02<00:00, 24245.85it/s] 99%|█████████▉| 55850/56357 [00:02<00:00, 23966.24it/s]100%|██████████| 56357/56357 [00:02<00:00, 23958.37it/s]
  0%|          | 0/23248 [00:00<?, ?it/s] 10%|▉         | 2288/23248 [00:00<00:00, 22870.92it/s] 20%|██        | 4742/23248 [00:00<00:00, 23847.23it/s] 31%|███       | 7191/23248 [00:00<00:00, 24136.45it/s] 42%|████▏     | 9671/23248 [00:00<00:00, 24394.76it/s] 52%|█████▏    | 12125/23248 [00:00<00:00, 24443.52it/s] 63%|██████▎   | 14589/23248 [00:00<00:00, 24507.81it/s] 73%|███████▎  | 17040/23248 [00:00<00:00, 24341.57it/s] 84%|████████▍ | 19481/23248 [00:00<00:00, 24360.65it/s] 94%|█████████▍| 21918/23248 [00:00<00:00, 24218.36it/s]100%|██████████| 23248/23248 [00:00<00:00, 24022.40it/s]
dataset loaded from path: 
data/ud/ud-treebanks-v2.1/UD_Spanish/inter-layer-17/UD_Spanish-train-bloom-1b1.pkl
data/ud/ud-treebanks-v2.1/UD_Spanish/inter-layer-17/UD_Spanish-dev-bloom-1b1.pkl
data/ud/ud-treebanks-v2.1/UD_Spanish/inter-layer-17/UD_Spanish-test-bloom-1b1.pkl
Embedding dimensionality: 1536
Pre-training probe (if possible)...
Traceback (most recent call last):
  File "run.py", line 102, in <module>
    args.func(args)
  File "/home/s2308470/multilingual-typology-probing/commands.py", line 166, in greedy
    trainer.train()
  File "/home/s2308470/multilingual-typology-probing/probekit/trainers/trainer.py", line 21, in train
    self._train()
  File "/home/s2308470/multilingual-typology-probing/probekit/trainers/neural_probe_trainer.py", line 30, in _train
    self._train_for_dimensions()
  File "/home/s2308470/multilingual-typology-probing/trainers/flexible_neural_probe_trainer.py", line 72, in _train_for_dimensions
    inputs_tensor_shuffled = inputs_tensor[shuffled_indices]
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 1.63 GiB (GPU 0; 5.94 GiB total capacity; 4.18 GiB already allocated; 1.51 GiB free; 4.21 GiB reserved in total by PyTorch) If reserved memory is >> allocated memory try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF
