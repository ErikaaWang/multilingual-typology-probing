python run.py --language UD_Catalan --experiment-name inter-layer-17 --attribute POS --trainer poisson --gpu --embedding bloom-1b1-intermediate-global_step10000 greedy --selection-size 50 --selection-criterion mi
Setting up datasets (['UD_Catalan'], POS) and probes...
  0%|          | 0/441656 [00:00<?, ?it/s]  1%|          | 2296/441656 [00:00<00:19, 22955.42it/s]  1%|          | 5188/441656 [00:00<00:16, 26458.83it/s]  2%|▏         | 8094/441656 [00:00<00:15, 27644.16it/s]  2%|▏         | 10939/441656 [00:00<00:15, 27960.63it/s]  3%|▎         | 13783/441656 [00:00<00:15, 28131.28it/s]  4%|▍         | 16597/441656 [00:00<00:15, 28047.57it/s]  4%|▍         | 19402/441656 [00:00<00:15, 27920.54it/s]  5%|▌         | 22307/441656 [00:00<00:14, 28277.57it/s]  6%|▌         | 25136/441656 [00:00<00:14, 28264.50it/s]  6%|▋         | 27972/441656 [00:01<00:14, 28292.05it/s]  7%|▋         | 30915/441656 [00:01<00:14, 28637.91it/s]  8%|▊         | 33779/441656 [00:01<00:14, 28527.40it/s]  8%|▊         | 36632/441656 [00:01<00:38, 10643.56it/s]  9%|▉         | 39501/441656 [00:01<00:30, 13143.53it/s] 10%|▉         | 42342/441656 [00:02<00:25, 15665.93it/s] 10%|█         | 45270/441656 [00:02<00:21, 18265.14it/s] 11%|█         | 48208/441656 [00:02<00:19, 20646.31it/s] 12%|█▏        | 51067/441656 [00:02<00:17, 22506.83it/s] 12%|█▏        | 54007/441656 [00:02<00:16, 24227.62it/s] 13%|█▎        | 56821/441656 [00:02<00:15, 25181.12it/s] 14%|█▎        | 59768/441656 [00:02<00:14, 26350.47it/s] 14%|█▍        | 62623/441656 [00:02<00:14, 26966.84it/s] 15%|█▍        | 65472/441656 [00:02<00:13, 27369.01it/s] 15%|█▌        | 68318/441656 [00:02<00:13, 27447.48it/s] 16%|█▌        | 71157/441656 [00:03<00:13, 27707.88it/s] 17%|█▋        | 73982/441656 [00:03<00:13, 27850.60it/s] 17%|█▋        | 76869/441656 [00:03<00:12, 28149.40it/s] 18%|█▊        | 79802/441656 [00:03<00:12, 28498.82it/s] 19%|█▊        | 82672/441656 [00:03<00:12, 28512.92it/s] 19%|█▉        | 85590/441656 [00:03<00:12, 28709.73it/s] 20%|██        | 88471/441656 [00:04<00:36, 9726.00it/s]  21%|██        | 91238/441656 [00:04<00:29, 11989.18it/s] 21%|██▏       | 94190/441656 [00:04<00:23, 14665.58it/s] 22%|██▏       | 96981/441656 [00:04<00:20, 17036.99it/s] 23%|██▎       | 99888/441656 [00:04<00:17, 19487.60it/s] 23%|██▎       | 102752/441656 [00:04<00:15, 21549.71it/s] 24%|██▍       | 105495/441656 [00:04<00:14, 22980.13it/s] 25%|██▍       | 108401/441656 [00:05<00:13, 24548.31it/s] 25%|██▌       | 111315/441656 [00:05<00:12, 25782.91it/s] 26%|██▌       | 114143/441656 [00:05<00:12, 25845.55it/s] 27%|██▋       | 117050/441656 [00:05<00:12, 26745.69it/s] 27%|██▋       | 119925/441656 [00:05<00:11, 27314.54it/s] 28%|██▊       | 122771/441656 [00:05<00:11, 27645.32it/s] 28%|██▊       | 125701/441656 [00:05<00:11, 28126.77it/s] 29%|██▉       | 128562/441656 [00:05<00:11, 28027.10it/s] 30%|██▉       | 131554/441656 [00:05<00:10, 28582.40it/s] 30%|███       | 134513/441656 [00:05<00:10, 28879.16it/s] 31%|███       | 137419/441656 [00:06<00:10, 28257.30it/s] 32%|███▏      | 140351/441656 [00:06<00:10, 28567.76it/s] 32%|███▏      | 143219/441656 [00:06<00:10, 28434.93it/s] 33%|███▎      | 146071/441656 [00:06<00:10, 28019.49it/s] 34%|███▎      | 149039/441656 [00:06<00:10, 28504.46it/s] 34%|███▍      | 151895/441656 [00:07<00:38, 7553.46it/s]  35%|███▌      | 154831/441656 [00:07<00:29, 9745.44it/s] 36%|███▌      | 157714/441656 [00:07<00:23, 12141.58it/s] 36%|███▋      | 160635/441656 [00:07<00:19, 14737.30it/s] 37%|███▋      | 163568/441656 [00:07<00:16, 17341.33it/s] 38%|███▊      | 166412/441656 [00:07<00:14, 19595.29it/s] 38%|███▊      | 169334/441656 [00:08<00:12, 21759.77it/s] 39%|███▉      | 172255/441656 [00:08<00:11, 23571.30it/s] 40%|███▉      | 175164/441656 [00:08<00:10, 24992.12it/s] 40%|████      | 178079/441656 [00:08<00:10, 26108.92it/s] 41%|████      | 180956/441656 [00:08<00:09, 26515.22it/s] 42%|████▏     | 183868/441656 [00:08<00:09, 27247.13it/s] 42%|████▏     | 186730/441656 [00:08<00:09, 27602.70it/s] 43%|████▎     | 189588/441656 [00:08<00:09, 27727.43it/s] 44%|████▎     | 192546/441656 [00:08<00:08, 28267.36it/s] 44%|████▍     | 195480/441656 [00:08<00:08, 28582.26it/s] 45%|████▍     | 198374/441656 [00:09<00:08, 28208.69it/s] 46%|████▌     | 201259/441656 [00:09<00:08, 28396.21it/s] 46%|████▌     | 204156/441656 [00:09<00:08, 28471.53it/s] 47%|████▋     | 207098/441656 [00:09<00:08, 28751.10it/s] 48%|████▊     | 210014/441656 [00:09<00:08, 28871.45it/s] 48%|████▊     | 212908/441656 [00:09<00:07, 28681.96it/s] 49%|████▉     | 215831/441656 [00:09<00:07, 28842.43it/s] 50%|████▉     | 218719/441656 [00:09<00:07, 28652.03it/s] 50%|█████     | 221587/441656 [00:09<00:07, 28657.89it/s] 51%|█████     | 224545/441656 [00:10<00:07, 28930.14it/s] 51%|█████▏    | 227440/441656 [00:10<00:07, 28714.64it/s] 52%|█████▏    | 230313/441656 [00:11<00:33, 6287.59it/s]  53%|█████▎    | 233199/441656 [00:11<00:25, 8208.29it/s] 53%|█████▎    | 236029/441656 [00:11<00:19, 10385.59it/s] 54%|█████▍    | 238992/441656 [00:11<00:15, 12965.56it/s] 55%|█████▍    | 241878/441656 [00:11<00:12, 15520.04it/s] 55%|█████▌    | 244692/441656 [00:11<00:11, 17876.51it/s] 56%|█████▌    | 247607/441656 [00:12<00:09, 20250.04it/s] 57%|█████▋    | 250395/441656 [00:12<00:08, 21753.74it/s] 57%|█████▋    | 253145/441656 [00:12<00:08, 23166.50it/s] 58%|█████▊    | 256061/441656 [00:12<00:07, 24724.24it/s] 59%|█████▊    | 258919/441656 [00:12<00:07, 25767.28it/s] 59%|█████▉    | 261735/441656 [00:12<00:06, 26312.23it/s] 60%|█████▉    | 264615/441656 [00:12<00:06, 27018.05it/s] 61%|██████    | 267471/441656 [00:12<00:06, 27462.31it/s] 61%|██████    | 270326/441656 [00:12<00:06, 27778.52it/s] 62%|██████▏   | 273169/441656 [00:12<00:06, 27968.33it/s] 62%|██████▏   | 276011/441656 [00:13<00:05, 28038.61it/s] 63%|██████▎   | 278846/441656 [00:13<00:05, 28029.68it/s] 64%|██████▍   | 281671/441656 [00:13<00:05, 27795.68it/s] 64%|██████▍   | 284467/441656 [00:13<00:05, 27775.04it/s] 65%|██████▌   | 287368/441656 [00:13<00:05, 28140.29it/s] 66%|██████▌   | 290231/441656 [00:13<00:05, 28283.96it/s] 66%|██████▋   | 293072/441656 [00:13<00:05, 28320.91it/s] 67%|██████▋   | 295909/441656 [00:13<00:05, 28128.11it/s] 68%|██████▊   | 298784/441656 [00:13<00:05, 28310.61it/s] 68%|██████▊   | 301620/441656 [00:13<00:04, 28323.15it/s] 69%|██████▉   | 304454/441656 [00:14<00:04, 28302.63it/s] 70%|██████▉   | 307286/441656 [00:14<00:04, 28190.97it/s] 70%|███████   | 310131/441656 [00:14<00:04, 28265.90it/s] 71%|███████   | 312976/441656 [00:14<00:04, 28317.96it/s] 72%|███████▏  | 315809/441656 [00:14<00:04, 27984.27it/s] 72%|███████▏  | 318736/441656 [00:14<00:04, 28363.44it/s] 73%|███████▎  | 321597/441656 [00:14<00:04, 28434.03it/s] 73%|███████▎  | 324442/441656 [00:14<00:04, 28290.69it/s] 74%|███████▍  | 327360/441656 [00:14<00:04, 28553.24it/s] 75%|███████▍  | 330217/441656 [00:16<00:18, 6001.29it/s]  75%|███████▌  | 332778/441656 [00:16<00:14, 7613.15it/s] 76%|███████▌  | 335410/441656 [00:16<00:11, 9579.05it/s] 77%|███████▋  | 338072/441656 [00:16<00:08, 11803.38it/s] 77%|███████▋  | 340746/441656 [00:16<00:07, 14150.52it/s] 78%|███████▊  | 343278/441656 [00:16<00:06, 16197.07it/s] 78%|███████▊  | 345885/441656 [00:16<00:05, 18244.87it/s] 79%|███████▉  | 348534/441656 [00:16<00:04, 20128.47it/s] 80%|███████▉  | 351213/441656 [00:16<00:04, 21767.02it/s] 80%|████████  | 353818/441656 [00:17<00:03, 22497.22it/s] 81%|████████  | 356499/441656 [00:17<00:03, 23650.23it/s] 81%|████████▏ | 359167/441656 [00:17<00:03, 24485.78it/s] 82%|████████▏ | 361808/441656 [00:17<00:03, 25029.55it/s] 83%|████████▎ | 364453/441656 [00:17<00:03, 25431.60it/s] 83%|████████▎ | 367095/441656 [00:17<00:02, 25717.85it/s] 84%|████████▎ | 369760/441656 [00:17<00:02, 25990.50it/s] 84%|████████▍ | 372405/441656 [00:17<00:02, 26123.91it/s] 85%|████████▍ | 375048/441656 [00:17<00:02, 26060.38it/s] 86%|████████▌ | 377689/441656 [00:18<00:02, 26162.08it/s] 86%|████████▌ | 380340/441656 [00:18<00:02, 26264.04it/s] 87%|████████▋ | 382996/441656 [00:18<00:02, 26351.10it/s] 87%|████████▋ | 385639/441656 [00:18<00:02, 26237.91it/s] 88%|████████▊ | 388269/441656 [00:18<00:02, 26206.51it/s] 89%|████████▊ | 390921/441656 [00:18<00:01, 26296.65it/s] 89%|████████▉ | 393554/441656 [00:18<00:01, 25381.52it/s] 90%|████████▉ | 396211/441656 [00:18<00:01, 25725.80it/s] 90%|█████████ | 398887/441656 [00:18<00:01, 26027.45it/s] 91%|█████████ | 401528/441656 [00:18<00:01, 26140.03it/s] 92%|█████████▏| 404146/441656 [00:19<00:01, 26059.72it/s] 92%|█████████▏| 406755/441656 [00:19<00:01, 26068.21it/s] 93%|█████████▎| 409399/441656 [00:19<00:01, 26175.60it/s] 93%|█████████▎| 412024/441656 [00:19<00:01, 26194.93it/s] 94%|█████████▍| 414645/441656 [00:19<00:01, 26148.91it/s] 94%|█████████▍| 417307/441656 [00:19<00:00, 26286.69it/s] 95%|█████████▌| 419937/441656 [00:19<00:00, 26266.88it/s] 96%|█████████▌| 422639/441656 [00:19<00:00, 26491.35it/s] 96%|█████████▋| 425289/441656 [00:19<00:00, 26450.06it/s] 97%|█████████▋| 427938/441656 [00:19<00:00, 26459.83it/s] 97%|█████████▋| 430585/441656 [00:20<00:00, 25845.49it/s] 98%|█████████▊| 433204/441656 [00:20<00:00, 25945.46it/s] 99%|█████████▊| 435852/441656 [00:20<00:00, 26102.22it/s] 99%|█████████▉| 438477/441656 [00:20<00:00, 26132.96it/s]100%|█████████▉| 441166/441656 [00:20<00:00, 26356.61it/s]100%|██████████| 441656/441656 [00:20<00:00, 21600.39it/s]
  0%|          | 0/53198 [00:00<?, ?it/s]  6%|▌         | 3137/53198 [00:00<00:01, 31363.60it/s] 12%|█▏        | 6349/53198 [00:00<00:01, 31803.62it/s] 18%|█▊        | 9530/53198 [00:00<00:01, 31228.39it/s] 24%|██▍       | 12970/53198 [00:00<00:01, 32465.19it/s] 31%|███       | 16308/53198 [00:00<00:01, 32789.16it/s] 37%|███▋      | 19589/53198 [00:00<00:01, 32626.75it/s] 43%|████▎     | 23008/53198 [00:00<00:00, 33132.58it/s] 49%|████▉     | 26323/53198 [00:00<00:00, 33087.09it/s] 56%|█████▌    | 29793/53198 [00:00<00:00, 33587.61it/s] 62%|██████▏   | 33153/53198 [00:01<00:00, 33429.30it/s] 69%|██████▊   | 36497/53198 [00:01<00:00, 33309.69it/s] 75%|███████▌  | 39908/53198 [00:01<00:00, 33549.08it/s] 81%|████████▏ | 43264/53198 [00:01<00:00, 33045.55it/s] 88%|████████▊ | 46571/53198 [00:01<00:00, 32683.07it/s] 94%|█████████▎| 49842/53198 [00:01<00:00, 32684.64it/s]100%|█████████▉| 53112/53198 [00:01<00:00, 32659.88it/s]100%|██████████| 53198/53198 [00:01<00:00, 32808.58it/s]
  0%|          | 0/35912 [00:00<?, ?it/s] 10%|▉         | 3565/35912 [00:00<00:00, 35644.34it/s] 20%|█▉        | 7130/35912 [00:00<00:00, 34489.21it/s] 30%|███       | 10880/35912 [00:00<00:00, 35835.53it/s] 40%|████      | 14470/35912 [00:00<00:00, 35856.61it/s] 50%|█████     | 18059/35912 [00:00<00:00, 34944.64it/s] 60%|██████    | 21559/35912 [00:00<00:00, 33912.91it/s] 69%|██████▉   | 24958/35912 [00:00<00:00, 33379.33it/s] 79%|███████▉  | 28301/35912 [00:00<00:00, 33215.80it/s] 88%|████████▊ | 31758/35912 [00:00<00:00, 33626.18it/s] 98%|█████████▊| 35124/35912 [00:01<00:00, 33161.68it/s]100%|██████████| 35912/35912 [00:01<00:00, 33918.35it/s]
dataset loaded from path: 
data/ud/ud-treebanks-v2.1/UD_Catalan/inter-layer-17/UD_Catalan-train-bloom-1b1-intermediate-global_step10000.pkl
data/ud/ud-treebanks-v2.1/UD_Catalan/inter-layer-17/UD_Catalan-dev-bloom-1b1-intermediate-global_step10000.pkl
data/ud/ud-treebanks-v2.1/UD_Catalan/inter-layer-17/UD_Catalan-test-bloom-1b1-intermediate-global_step10000.pkl
Embedding dimensionality: 1536
Pre-training probe (if possible)...
Traceback (most recent call last):
  File "run.py", line 102, in <module>
    args.func(args)
  File "/home/s2308470/multilingual-typology-probing/commands.py", line 166, in greedy
    trainer.train()
  File "/home/s2308470/multilingual-typology-probing/probekit/trainers/trainer.py", line 21, in train
    self._train()
  File "/home/s2308470/multilingual-typology-probing/probekit/trainers/neural_probe_trainer.py", line 30, in _train
    self._train_for_dimensions()
  File "/home/s2308470/multilingual-typology-probing/trainers/flexible_neural_probe_trainer.py", line 72, in _train_for_dimensions
    inputs_tensor_shuffled = inputs_tensor[shuffled_indices]
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 2.21 GiB (GPU 0; 5.94 GiB total capacity; 5.41 GiB already allocated; 285.31 MiB free; 5.44 GiB reserved in total by PyTorch) If reserved memory is >> allocated memory try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF
