python run.py --language UD_Spanish --experiment-name inter-layer-13 --attribute POS --trainer poisson --gpu --embedding bloom-1b1-intermediate-global_step10000 greedy --selection-size 50 --selection-criterion mi
Setting up datasets (['UD_Spanish'], POS) and probes...
  0%|          | 0/343741 [00:00<?, ?it/s]  0%|          | 325/343741 [00:00<01:58, 2899.95it/s]  1%|          | 3267/343741 [00:00<00:19, 17759.84it/s]  2%|▏         | 6075/343741 [00:00<00:15, 22250.45it/s]  3%|▎         | 9033/343741 [00:00<00:13, 25080.49it/s]  3%|▎         | 11603/343741 [00:00<00:13, 25300.01it/s]  4%|▍         | 14156/343741 [00:00<00:13, 24443.02it/s]  5%|▍         | 16621/343741 [00:00<00:13, 23657.54it/s]  6%|▌         | 19582/343741 [00:00<00:12, 25464.21it/s]  6%|▋         | 22149/343741 [00:01<00:26, 12015.90it/s]  7%|▋         | 24987/343741 [00:01<00:21, 14784.23it/s]  8%|▊         | 27788/343741 [00:01<00:18, 17358.28it/s]  9%|▉         | 30731/343741 [00:01<00:15, 19983.35it/s] 10%|▉         | 33532/343741 [00:01<00:14, 21885.15it/s] 11%|█         | 36165/343741 [00:01<00:14, 21676.47it/s] 11%|█▏        | 39158/343741 [00:01<00:12, 23772.08it/s] 12%|█▏        | 41884/343741 [00:02<00:12, 24699.53it/s] 13%|█▎        | 44864/343741 [00:02<00:11, 26103.57it/s] 14%|█▍        | 47745/343741 [00:02<00:11, 26867.37it/s] 15%|█▍        | 50638/343741 [00:02<00:10, 27459.78it/s] 16%|█▌        | 53572/343741 [00:02<00:10, 28004.79it/s] 16%|█▋        | 56494/343741 [00:02<00:10, 28359.24it/s] 17%|█▋        | 59395/343741 [00:02<00:09, 28548.78it/s] 18%|█▊        | 62279/343741 [00:03<00:23, 12135.03it/s] 19%|█▉        | 64930/343741 [00:03<00:19, 14324.06it/s] 20%|█▉        | 67614/343741 [00:03<00:16, 16560.64it/s] 20%|██        | 70356/343741 [00:03<00:14, 18768.30it/s] 21%|██▏       | 73216/343741 [00:03<00:12, 20981.10it/s] 22%|██▏       | 76144/343741 [00:03<00:11, 22999.30it/s] 23%|██▎       | 79109/343741 [00:03<00:10, 24713.17it/s] 24%|██▍       | 82010/343741 [00:03<00:10, 25868.06it/s] 25%|██▍       | 84996/343741 [00:03<00:09, 26975.95it/s] 26%|██▌       | 87959/343741 [00:04<00:09, 27727.70it/s] 26%|██▋       | 90858/343741 [00:04<00:09, 27168.95it/s] 27%|██▋       | 93666/343741 [00:04<00:09, 27115.76it/s] 28%|██▊       | 96441/343741 [00:04<00:09, 26868.14it/s] 29%|██▉       | 99172/343741 [00:04<00:09, 26912.82it/s] 30%|██▉       | 101895/343741 [00:04<00:08, 26910.88it/s] 30%|███       | 104621/343741 [00:04<00:08, 27012.48it/s] 31%|███       | 107338/343741 [00:04<00:08, 26933.87it/s] 32%|███▏      | 110053/343741 [00:04<00:08, 26996.50it/s] 33%|███▎      | 112761/343741 [00:05<00:21, 10675.48it/s] 34%|███▎      | 115432/343741 [00:05<00:17, 12948.31it/s] 34%|███▍      | 118160/343741 [00:05<00:14, 15380.52it/s] 35%|███▌      | 120857/343741 [00:05<00:12, 17641.79it/s] 36%|███▌      | 123597/343741 [00:05<00:11, 19768.48it/s] 37%|███▋      | 126228/343741 [00:06<00:10, 21320.66it/s] 38%|███▊      | 128912/343741 [00:06<00:09, 22718.42it/s] 38%|███▊      | 131581/343741 [00:06<00:08, 23773.26it/s] 39%|███▉      | 134256/343741 [00:06<00:08, 24590.69it/s] 40%|███▉      | 136896/343741 [00:06<00:08, 24778.96it/s] 41%|████      | 139631/343741 [00:06<00:08, 25509.67it/s] 41%|████▏     | 142318/343741 [00:06<00:07, 25902.37it/s] 42%|████▏     | 145002/343741 [00:06<00:07, 26174.79it/s] 43%|████▎     | 147685/343741 [00:06<00:07, 26365.83it/s] 44%|████▍     | 150423/343741 [00:06<00:07, 26663.77it/s] 45%|████▍     | 153118/343741 [00:07<00:07, 26748.20it/s] 45%|████▌     | 155810/343741 [00:07<00:07, 26647.35it/s] 46%|████▌     | 158490/343741 [00:07<00:06, 26690.32it/s] 47%|████▋     | 161191/343741 [00:07<00:06, 26784.69it/s] 48%|████▊     | 163876/343741 [00:07<00:06, 26686.23it/s] 48%|████▊     | 166549/343741 [00:07<00:06, 26206.23it/s] 49%|████▉     | 169203/343741 [00:07<00:06, 26303.89it/s] 50%|█████     | 171936/343741 [00:07<00:06, 26606.64it/s] 51%|█████     | 174600/343741 [00:08<00:17, 9454.91it/s]  52%|█████▏    | 177335/343741 [00:08<00:14, 11801.55it/s] 52%|█████▏    | 180007/343741 [00:08<00:11, 14093.84it/s] 53%|█████▎    | 182706/343741 [00:08<00:09, 16456.81it/s] 54%|█████▍    | 185341/343741 [00:08<00:08, 18508.97it/s] 55%|█████▍    | 188080/343741 [00:08<00:07, 20538.99it/s] 56%|█████▌    | 190793/343741 [00:09<00:06, 22160.04it/s] 56%|█████▋    | 193450/343741 [00:09<00:06, 23305.91it/s] 57%|█████▋    | 196124/343741 [00:09<00:06, 24235.48it/s] 58%|█████▊    | 198848/343741 [00:09<00:05, 25070.97it/s] 59%|█████▊    | 201529/343741 [00:09<00:05, 25563.85it/s] 59%|█████▉    | 204237/343741 [00:09<00:05, 26001.06it/s] 60%|██████    | 206935/343741 [00:09<00:05, 26285.52it/s] 61%|██████    | 209621/343741 [00:09<00:05, 26446.46it/s] 62%|██████▏   | 212306/343741 [00:09<00:05, 26103.73it/s] 63%|██████▎   | 214987/343741 [00:09<00:04, 26308.45it/s] 63%|██████▎   | 217659/343741 [00:10<00:04, 26428.75it/s] 64%|██████▍   | 220380/343741 [00:10<00:04, 26658.17it/s] 65%|██████▍   | 223057/343741 [00:10<00:04, 26611.11it/s] 66%|██████▌   | 225726/343741 [00:10<00:04, 26520.79it/s] 66%|██████▋   | 228402/343741 [00:10<00:04, 26588.43it/s] 67%|██████▋   | 231105/343741 [00:10<00:04, 26628.04it/s] 68%|██████▊   | 233771/343741 [00:10<00:04, 26594.75it/s] 69%|██████▉   | 236451/343741 [00:10<00:04, 26653.10it/s] 70%|██████▉   | 239123/343741 [00:10<00:03, 26671.35it/s] 70%|███████   | 241792/343741 [00:10<00:03, 26109.97it/s] 71%|███████   | 244407/343741 [00:11<00:03, 26107.92it/s] 72%|███████▏  | 247082/343741 [00:11<00:03, 26296.68it/s] 73%|███████▎  | 249735/343741 [00:11<00:03, 26364.58it/s] 73%|███████▎  | 252373/343741 [00:11<00:03, 26352.47it/s] 74%|███████▍  | 255010/343741 [00:12<00:11, 7969.54it/s]  75%|███████▍  | 257690/343741 [00:12<00:08, 10120.31it/s] 76%|███████▌  | 260383/343741 [00:12<00:06, 12477.96it/s] 77%|███████▋  | 263020/343741 [00:12<00:05, 14797.07it/s] 77%|███████▋  | 265731/343741 [00:12<00:04, 17165.99it/s] 78%|███████▊  | 268437/343741 [00:12<00:03, 19300.02it/s] 79%|███████▉  | 271107/343741 [00:12<00:03, 21042.22it/s] 80%|███████▉  | 273754/343741 [00:12<00:03, 22406.63it/s] 80%|████████  | 276455/343741 [00:13<00:02, 23623.20it/s] 81%|████████  | 279152/343741 [00:13<00:02, 24539.65it/s] 82%|████████▏ | 281808/343741 [00:13<00:02, 24769.43it/s] 83%|████████▎ | 284495/343741 [00:13<00:02, 25364.53it/s] 84%|████████▎ | 287206/343741 [00:13<00:02, 25865.50it/s] 84%|████████▍ | 289918/343741 [00:13<00:02, 26230.99it/s] 85%|████████▌ | 292594/343741 [00:13<00:01, 26372.32it/s] 86%|████████▌ | 295312/343741 [00:13<00:01, 26609.14it/s] 87%|████████▋ | 298008/343741 [00:13<00:01, 26712.74it/s] 87%|████████▋ | 300698/343741 [00:13<00:01, 26608.95it/s] 88%|████████▊ | 303379/343741 [00:14<00:01, 26658.98it/s] 89%|████████▉ | 306055/343741 [00:14<00:01, 26656.57it/s] 90%|████████▉ | 308762/343741 [00:14<00:01, 26777.88it/s] 91%|█████████ | 311445/343741 [00:14<00:01, 26320.31it/s] 91%|█████████▏| 314135/343741 [00:14<00:01, 26489.91it/s] 92%|█████████▏| 316843/343741 [00:14<00:01, 26662.40it/s] 93%|█████████▎| 319512/343741 [00:14<00:00, 26656.41it/s] 94%|█████████▎| 322197/343741 [00:14<00:00, 26710.84it/s] 95%|█████████▍| 324914/343741 [00:14<00:00, 26844.92it/s] 95%|█████████▌| 327625/343741 [00:14<00:00, 26921.05it/s] 96%|█████████▌| 330318/343741 [00:15<00:00, 26833.88it/s] 97%|█████████▋| 333002/343741 [00:15<00:00, 26834.24it/s] 98%|█████████▊| 335697/343741 [00:15<00:00, 26865.93it/s] 98%|█████████▊| 338384/343741 [00:15<00:00, 26834.69it/s] 99%|█████████▉| 341110/343741 [00:15<00:00, 26960.02it/s]100%|██████████| 343741/343741 [00:15<00:00, 22075.66it/s]
  0%|          | 0/56357 [00:00<?, ?it/s]  6%|▌         | 3339/56357 [00:00<00:01, 33385.73it/s] 12%|█▏        | 6678/56357 [00:00<00:01, 32731.99it/s] 18%|█▊        | 9953/56357 [00:00<00:01, 32035.93it/s] 24%|██▍       | 13432/56357 [00:00<00:01, 33098.26it/s] 30%|███       | 16925/56357 [00:00<00:01, 33747.94it/s] 36%|███▋      | 20467/56357 [00:00<00:01, 34299.66it/s] 43%|████▎     | 24003/56357 [00:00<00:00, 34642.11it/s] 49%|████▉     | 27677/56357 [00:00<00:00, 35304.12it/s] 55%|█████▌    | 31211/56357 [00:00<00:00, 35314.24it/s] 62%|██████▏   | 34821/56357 [00:01<00:00, 35553.33it/s] 68%|██████▊   | 38378/56357 [00:01<00:00, 34391.74it/s] 74%|███████▍  | 41826/56357 [00:01<00:00, 33829.20it/s] 80%|████████  | 45216/56357 [00:01<00:00, 33584.67it/s] 86%|████████▌ | 48579/56357 [00:01<00:00, 33298.78it/s] 92%|█████████▏| 52022/56357 [00:01<00:00, 33628.32it/s] 99%|█████████▊| 55572/56357 [00:01<00:00, 34179.76it/s]100%|██████████| 56357/56357 [00:01<00:00, 34087.23it/s]
  0%|          | 0/23248 [00:00<?, ?it/s] 16%|█▌        | 3638/23248 [00:00<00:00, 36372.23it/s] 31%|███▏      | 7276/23248 [00:00<00:00, 34602.25it/s] 46%|████▌     | 10743/23248 [00:00<00:00, 34565.58it/s] 62%|██████▏   | 14394/23248 [00:00<00:00, 35317.92it/s] 77%|███████▋  | 17930/23248 [00:00<00:00, 35132.88it/s] 92%|█████████▏| 21446/23248 [00:00<00:00, 35089.53it/s]100%|██████████| 23248/23248 [00:00<00:00, 35113.98it/s]
dataset loaded from path: 
data/ud/ud-treebanks-v2.1/UD_Spanish/inter-layer-13/UD_Spanish-train-bloom-1b1-intermediate-global_step10000.pkl
data/ud/ud-treebanks-v2.1/UD_Spanish/inter-layer-13/UD_Spanish-dev-bloom-1b1-intermediate-global_step10000.pkl
data/ud/ud-treebanks-v2.1/UD_Spanish/inter-layer-13/UD_Spanish-test-bloom-1b1-intermediate-global_step10000.pkl
Embedding dimensionality: 1536
Pre-training probe (if possible)...
Traceback (most recent call last):
  File "run.py", line 102, in <module>
    args.func(args)
  File "/home/s2308470/multilingual-typology-probing/commands.py", line 166, in greedy
    trainer.train()
  File "/home/s2308470/multilingual-typology-probing/probekit/trainers/trainer.py", line 21, in train
    self._train()
  File "/home/s2308470/multilingual-typology-probing/probekit/trainers/neural_probe_trainer.py", line 30, in _train
    self._train_for_dimensions()
  File "/home/s2308470/multilingual-typology-probing/trainers/flexible_neural_probe_trainer.py", line 72, in _train_for_dimensions
    inputs_tensor_shuffled = inputs_tensor[shuffled_indices]
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 1.63 GiB (GPU 0; 5.94 GiB total capacity; 4.18 GiB already allocated; 1.51 GiB free; 4.21 GiB reserved in total by PyTorch) If reserved memory is >> allocated memory try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF
