python run.py --language UD_Spanish --experiment-name inter-layer-13 --attribute POS --trainer poisson --gpu --embedding bloom-1b1-intermediate-global_step200000 greedy --selection-size 50 --selection-criterion mi
Setting up datasets (['UD_Spanish'], POS) and probes...
  0%|          | 0/343741 [00:00<?, ?it/s]  1%|          | 2304/343741 [00:00<00:14, 23036.01it/s]  2%|▏         | 5357/343741 [00:00<00:12, 27437.94it/s]  2%|▏         | 8365/343741 [00:00<00:11, 28642.25it/s]  3%|▎         | 11434/343741 [00:00<00:11, 29447.06it/s]  4%|▍         | 14439/343741 [00:00<00:11, 29663.75it/s]  5%|▌         | 17517/343741 [00:00<00:10, 30040.85it/s]  6%|▌         | 20534/343741 [00:00<00:10, 30082.16it/s]  7%|▋         | 23543/343741 [00:01<00:23, 13717.67it/s]  8%|▊         | 26640/343741 [00:01<00:19, 16679.79it/s]  9%|▊         | 29651/343741 [00:01<00:16, 19324.30it/s] 10%|▉         | 32742/343741 [00:01<00:14, 21867.26it/s] 10%|█         | 35733/343741 [00:01<00:12, 23787.28it/s] 11%|█▏        | 38838/343741 [00:01<00:11, 25633.04it/s] 12%|█▏        | 41852/343741 [00:01<00:11, 26833.61it/s] 13%|█▎        | 44809/343741 [00:01<00:10, 27496.54it/s] 14%|█▍        | 47849/343741 [00:01<00:10, 28314.17it/s] 15%|█▍        | 50886/343741 [00:02<00:10, 28903.43it/s] 16%|█▌        | 53922/343741 [00:02<00:09, 29326.27it/s] 17%|█▋        | 56963/343741 [00:02<00:09, 29642.60it/s] 17%|█▋        | 60032/343741 [00:02<00:09, 29950.06it/s] 18%|█▊        | 63064/343741 [00:02<00:21, 12912.03it/s] 19%|█▉        | 65695/343741 [00:03<00:18, 14975.30it/s] 20%|█▉        | 68489/343741 [00:03<00:15, 17313.44it/s] 21%|██        | 71200/343741 [00:03<00:14, 19319.36it/s] 22%|██▏       | 74249/343741 [00:03<00:12, 21848.02it/s] 22%|██▏       | 77317/343741 [00:03<00:11, 24004.00it/s] 23%|██▎       | 80275/343741 [00:03<00:10, 25445.84it/s] 24%|██▍       | 83345/343741 [00:03<00:09, 26862.51it/s] 25%|██▌       | 86389/343741 [00:03<00:09, 27855.85it/s] 26%|██▌       | 89447/343741 [00:03<00:08, 28630.17it/s] 27%|██▋       | 92475/343741 [00:03<00:08, 29103.96it/s] 28%|██▊       | 95563/343741 [00:04<00:08, 29620.13it/s] 29%|██▊       | 98590/343741 [00:04<00:08, 28874.94it/s] 30%|██▉       | 101527/343741 [00:04<00:08, 28589.86it/s] 30%|███       | 104421/343741 [00:04<00:08, 28453.34it/s] 31%|███       | 107291/343741 [00:04<00:08, 28091.79it/s] 32%|███▏      | 110118/343741 [00:04<00:08, 28075.11it/s] 33%|███▎      | 112938/343741 [00:05<00:20, 11268.67it/s] 34%|███▎      | 115559/343741 [00:05<00:17, 13413.03it/s] 34%|███▍      | 118319/343741 [00:05<00:14, 15826.89it/s] 35%|███▌      | 121140/343741 [00:05<00:12, 18247.38it/s] 36%|███▌      | 123875/343741 [00:05<00:10, 20233.33it/s] 37%|███▋      | 126673/343741 [00:05<00:09, 22074.76it/s] 38%|███▊      | 129409/343741 [00:05<00:09, 23412.85it/s] 38%|███▊      | 132198/343741 [00:05<00:08, 24601.60it/s] 39%|███▉      | 134911/343741 [00:05<00:08, 25295.59it/s] 40%|████      | 137753/343741 [00:06<00:07, 26175.80it/s] 41%|████      | 140522/343741 [00:06<00:07, 26608.09it/s] 42%|████▏     | 143304/343741 [00:06<00:07, 26959.89it/s] 42%|████▏     | 146068/343741 [00:06<00:07, 26780.25it/s] 43%|████▎     | 148883/343741 [00:06<00:07, 27180.30it/s] 44%|████▍     | 151636/343741 [00:06<00:07, 27199.79it/s] 45%|████▍     | 154463/343741 [00:06<00:06, 27515.04it/s] 46%|████▌     | 157232/343741 [00:06<00:06, 27546.04it/s] 47%|████▋     | 160016/343741 [00:06<00:06, 27630.67it/s] 47%|████▋     | 162794/343741 [00:06<00:06, 27672.13it/s] 48%|████▊     | 165595/343741 [00:07<00:06, 27770.59it/s] 49%|████▉     | 168377/343741 [00:07<00:06, 27665.38it/s] 50%|████▉     | 171182/343741 [00:07<00:06, 27778.66it/s] 51%|█████     | 173981/343741 [00:07<00:06, 27838.89it/s] 51%|█████▏    | 176767/343741 [00:08<00:16, 9882.91it/s]  52%|█████▏    | 179578/343741 [00:08<00:13, 12283.86it/s] 53%|█████▎    | 182322/343741 [00:08<00:10, 14683.58it/s] 54%|█████▍    | 185090/343741 [00:08<00:09, 17080.46it/s] 55%|█████▍    | 187891/343741 [00:08<00:08, 19358.73it/s] 55%|█████▌    | 190671/343741 [00:08<00:07, 21294.81it/s] 56%|█████▌    | 193332/343741 [00:08<00:06, 22489.22it/s] 57%|█████▋    | 196132/343741 [00:08<00:06, 23919.73it/s] 58%|█████▊    | 198940/343741 [00:08<00:05, 25045.18it/s] 59%|█████▊    | 201705/343741 [00:08<00:05, 25736.07it/s] 59%|█████▉    | 204506/343741 [00:09<00:05, 26382.71it/s] 60%|██████    | 207292/343741 [00:09<00:05, 26807.39it/s] 61%|██████    | 210083/343741 [00:09<00:04, 27128.77it/s] 62%|██████▏   | 212855/343741 [00:09<00:04, 27153.88it/s] 63%|██████▎   | 215641/343741 [00:09<00:04, 27360.07it/s] 64%|██████▎   | 218407/343741 [00:09<00:04, 27357.51it/s] 64%|██████▍   | 221167/343741 [00:09<00:04, 27427.52it/s] 65%|██████▌   | 223925/343741 [00:09<00:04, 27194.26it/s] 66%|██████▌   | 226696/343741 [00:09<00:04, 27343.87it/s] 67%|██████▋   | 229438/343741 [00:09<00:04, 27296.42it/s] 68%|██████▊   | 232231/343741 [00:10<00:04, 27482.71it/s] 68%|██████▊   | 235003/343741 [00:10<00:03, 27551.53it/s] 69%|██████▉   | 237761/343741 [00:10<00:03, 27525.96it/s] 70%|██████▉   | 240520/343741 [00:10<00:03, 27543.97it/s] 71%|███████   | 243333/343741 [00:10<00:03, 27718.56it/s] 72%|███████▏  | 246106/343741 [00:10<00:03, 27476.73it/s] 72%|███████▏  | 248889/343741 [00:10<00:03, 27580.65it/s] 73%|███████▎  | 251664/343741 [00:10<00:03, 27628.78it/s] 74%|███████▍  | 254428/343741 [00:11<00:10, 8323.91it/s]  75%|███████▍  | 257173/343741 [00:11<00:08, 10503.27it/s] 76%|███████▌  | 259935/343741 [00:11<00:06, 12899.29it/s] 76%|███████▋  | 262733/343741 [00:11<00:05, 15412.09it/s] 77%|███████▋  | 265318/343741 [00:12<00:04, 17418.39it/s] 78%|███████▊  | 268145/343741 [00:12<00:03, 19755.47it/s] 79%|███████▉  | 270912/343741 [00:12<00:03, 21616.47it/s] 80%|███████▉  | 273621/343741 [00:12<00:03, 22992.74it/s] 80%|████████  | 276374/343741 [00:12<00:02, 24191.30it/s] 81%|████████  | 279163/343741 [00:12<00:02, 25204.83it/s] 82%|████████▏ | 281897/343741 [00:12<00:02, 25803.03it/s] 83%|████████▎ | 284703/343741 [00:12<00:02, 26449.45it/s] 84%|████████▎ | 287477/343741 [00:12<00:02, 26822.15it/s] 84%|████████▍ | 290236/343741 [00:12<00:01, 27010.08it/s] 85%|████████▌ | 293015/343741 [00:13<00:01, 27238.47it/s] 86%|████████▌ | 295829/343741 [00:13<00:01, 27503.42it/s] 87%|████████▋ | 298607/343741 [00:13<00:01, 26994.83it/s] 88%|████████▊ | 301426/343741 [00:13<00:01, 27343.11it/s] 88%|████████▊ | 304176/343741 [00:13<00:01, 27349.27it/s] 89%|████████▉ | 306944/343741 [00:13<00:01, 27446.88it/s] 90%|█████████ | 309739/343741 [00:13<00:01, 27593.93it/s] 91%|█████████ | 312562/343741 [00:13<00:01, 27780.81it/s] 92%|█████████▏| 315345/343741 [00:13<00:01, 27739.75it/s] 93%|█████████▎| 318140/343741 [00:13<00:00, 27801.42it/s] 93%|█████████▎| 320923/343741 [00:14<00:00, 27773.99it/s] 94%|█████████▍| 323702/343741 [00:14<00:00, 27639.65it/s] 95%|█████████▍| 326489/343741 [00:14<00:00, 27706.94it/s] 96%|█████████▌| 329261/343741 [00:14<00:00, 27318.78it/s] 97%|█████████▋| 332032/343741 [00:14<00:00, 27431.49it/s] 97%|█████████▋| 334777/343741 [00:14<00:00, 27414.90it/s] 98%|█████████▊| 337581/343741 [00:14<00:00, 27597.85it/s] 99%|█████████▉| 340364/343741 [00:14<00:00, 27664.96it/s]100%|█████████▉| 343132/343741 [00:14<00:00, 27583.27it/s]100%|██████████| 343741/343741 [00:14<00:00, 23062.07it/s]
  0%|          | 0/56357 [00:00<?, ?it/s]  6%|▌         | 3483/56357 [00:00<00:01, 34827.46it/s] 12%|█▏        | 6966/56357 [00:00<00:01, 34439.21it/s] 18%|█▊        | 10421/56357 [00:00<00:01, 34487.34it/s] 25%|██▍       | 14037/56357 [00:00<00:01, 35143.93it/s] 32%|███▏      | 17848/56357 [00:00<00:01, 36203.70it/s] 39%|███▊      | 21744/56357 [00:00<00:00, 37136.71it/s] 45%|████▌     | 25459/56357 [00:00<00:00, 36936.44it/s] 52%|█████▏    | 29154/56357 [00:00<00:00, 36894.28it/s] 59%|█████▊    | 33039/56357 [00:00<00:00, 37500.35it/s] 65%|██████▌   | 36790/56357 [00:01<00:00, 36911.28it/s] 72%|███████▏  | 40484/56357 [00:01<00:00, 36417.63it/s] 78%|███████▊  | 44129/56357 [00:01<00:00, 35711.98it/s] 85%|████████▍ | 47704/56357 [00:01<00:00, 34872.91it/s] 91%|█████████ | 51199/56357 [00:01<00:00, 34892.26it/s] 98%|█████████▊| 54982/56357 [00:01<00:00, 35754.77it/s]100%|██████████| 56357/56357 [00:01<00:00, 35928.93it/s]
  0%|          | 0/23248 [00:00<?, ?it/s] 16%|█▋        | 3820/23248 [00:00<00:00, 38190.57it/s] 33%|███▎      | 7640/23248 [00:00<00:00, 37965.40it/s] 49%|████▉     | 11437/23248 [00:00<00:00, 37862.38it/s] 65%|██████▌   | 15224/23248 [00:00<00:00, 37783.30it/s] 82%|████████▏ | 19062/23248 [00:00<00:00, 37994.19it/s] 98%|█████████▊| 22886/23248 [00:00<00:00, 38075.57it/s]100%|██████████| 23248/23248 [00:00<00:00, 37869.95it/s]
dataset loaded from path: 
data/ud/ud-treebanks-v2.1/UD_Spanish/inter-layer-13/UD_Spanish-train-bloom-1b1-intermediate-global_step200000.pkl
data/ud/ud-treebanks-v2.1/UD_Spanish/inter-layer-13/UD_Spanish-dev-bloom-1b1-intermediate-global_step200000.pkl
data/ud/ud-treebanks-v2.1/UD_Spanish/inter-layer-13/UD_Spanish-test-bloom-1b1-intermediate-global_step200000.pkl
Embedding dimensionality: 1536
Pre-training probe (if possible)...
Traceback (most recent call last):
  File "run.py", line 102, in <module>
    args.func(args)
  File "/home/s2308470/multilingual-typology-probing/commands.py", line 166, in greedy
    trainer.train()
  File "/home/s2308470/multilingual-typology-probing/probekit/trainers/trainer.py", line 21, in train
    self._train()
  File "/home/s2308470/multilingual-typology-probing/probekit/trainers/neural_probe_trainer.py", line 30, in _train
    self._train_for_dimensions()
  File "/home/s2308470/multilingual-typology-probing/trainers/flexible_neural_probe_trainer.py", line 72, in _train_for_dimensions
    inputs_tensor_shuffled = inputs_tensor[shuffled_indices]
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 1.63 GiB (GPU 0; 5.94 GiB total capacity; 4.18 GiB already allocated; 1.51 GiB free; 4.21 GiB reserved in total by PyTorch) If reserved memory is >> allocated memory try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF
