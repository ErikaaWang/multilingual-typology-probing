python run.py --language UD_Spanish --experiment-name inter-layer-13 --attribute POS --trainer poisson --gpu --embedding bloom-1b1-intermediate-global_step1000 greedy --selection-size 50 --selection-criterion mi
Setting up datasets (['UD_Spanish'], POS) and probes...
  0%|          | 0/343741 [00:00<?, ?it/s]  1%|          | 2302/343741 [00:00<00:14, 23012.67it/s]  2%|▏         | 5197/343741 [00:00<00:12, 26501.09it/s]  2%|▏         | 8031/343741 [00:00<00:12, 27337.78it/s]  3%|▎         | 10907/343741 [00:00<00:11, 27895.95it/s]  4%|▍         | 13770/343741 [00:00<00:11, 28158.85it/s]  5%|▍         | 16597/343741 [00:00<00:11, 28194.57it/s]  6%|▌         | 19468/343741 [00:00<00:11, 28360.63it/s]  6%|▋         | 22305/343741 [00:01<00:24, 12930.14it/s]  7%|▋         | 25109/343741 [00:01<00:20, 15523.71it/s]  8%|▊         | 27932/343741 [00:01<00:17, 18025.47it/s]  9%|▉         | 30804/343741 [00:01<00:15, 20372.61it/s] 10%|▉         | 33585/343741 [00:01<00:14, 22147.16it/s] 11%|█         | 36504/343741 [00:01<00:12, 23936.83it/s] 11%|█▏        | 39383/343741 [00:01<00:12, 25228.21it/s] 12%|█▏        | 42195/343741 [00:01<00:11, 26023.38it/s] 13%|█▎        | 44984/343741 [00:01<00:11, 26212.01it/s] 14%|█▍        | 47804/343741 [00:02<00:11, 26776.08it/s] 15%|█▍        | 50577/343741 [00:02<00:10, 26945.83it/s] 16%|█▌        | 53418/343741 [00:02<00:10, 27370.86it/s] 16%|█▋        | 56204/343741 [00:02<00:10, 27470.29it/s] 17%|█▋        | 58985/343741 [00:02<00:10, 27460.29it/s] 18%|█▊        | 61755/343741 [00:03<00:26, 10728.40it/s] 19%|█▉        | 64546/343741 [00:03<00:21, 13158.81it/s] 20%|█▉        | 67387/343741 [00:03<00:17, 15722.28it/s] 20%|██        | 70243/343741 [00:03<00:15, 18208.01it/s] 21%|██▏       | 73135/343741 [00:03<00:13, 20527.63it/s] 22%|██▏       | 75921/343741 [00:03<00:12, 22259.45it/s] 23%|██▎       | 78772/343741 [00:03<00:11, 23836.33it/s] 24%|██▎       | 81591/343741 [00:03<00:10, 24989.61it/s] 25%|██▍       | 84361/343741 [00:03<00:10, 25720.28it/s] 25%|██▌       | 87188/343741 [00:04<00:09, 26437.54it/s] 26%|██▌       | 90036/343741 [00:04<00:09, 27020.96it/s] 27%|██▋       | 92840/343741 [00:04<00:09, 27207.76it/s] 28%|██▊       | 95656/343741 [00:04<00:09, 27483.69it/s] 29%|██▊       | 98456/343741 [00:04<00:09, 27099.08it/s] 29%|██▉       | 101315/343741 [00:04<00:08, 27533.61it/s] 30%|███       | 104107/343741 [00:04<00:08, 27644.48it/s] 31%|███       | 106891/343741 [00:04<00:08, 27362.72it/s] 32%|███▏      | 109726/343741 [00:04<00:08, 27652.30it/s] 33%|███▎      | 112502/343741 [00:05<00:21, 10650.80it/s] 34%|███▎      | 115313/343741 [00:05<00:17, 13094.97it/s] 34%|███▍      | 118080/343741 [00:05<00:14, 15524.03it/s] 35%|███▌      | 120906/343741 [00:05<00:12, 17972.26it/s] 36%|███▌      | 123602/343741 [00:05<00:11, 19907.83it/s] 37%|███▋      | 126217/343741 [00:05<00:10, 21376.29it/s] 38%|███▊      | 128980/343741 [00:06<00:09, 22948.36it/s] 38%|███▊      | 131679/343741 [00:06<00:08, 24016.65it/s] 39%|███▉      | 134410/343741 [00:06<00:08, 24919.12it/s] 40%|███▉      | 137147/343741 [00:06<00:08, 25607.98it/s] 41%|████      | 139963/343741 [00:06<00:07, 26338.52it/s] 42%|████▏     | 142730/343741 [00:06<00:07, 26709.51it/s] 42%|████▏     | 145565/343741 [00:06<00:07, 27188.83it/s] 43%|████▎     | 148364/343741 [00:06<00:07, 27421.90it/s] 44%|████▍     | 151143/343741 [00:06<00:07, 27486.62it/s] 45%|████▍     | 153952/343741 [00:06<00:06, 27663.02it/s] 46%|████▌     | 156818/343741 [00:07<00:06, 27957.41it/s] 46%|████▋     | 159642/343741 [00:07<00:06, 28039.85it/s] 47%|████▋     | 162455/343741 [00:07<00:06, 27694.97it/s] 48%|████▊     | 165252/343741 [00:07<00:06, 27774.17it/s] 49%|████▉     | 168035/343741 [00:07<00:06, 27675.90it/s] 50%|████▉     | 170807/343741 [00:07<00:06, 27667.54it/s] 50%|█████     | 173588/343741 [00:07<00:06, 27708.82it/s] 51%|█████▏    | 176361/343741 [00:08<00:17, 9840.08it/s]  52%|█████▏    | 179046/343741 [00:08<00:13, 12077.01it/s] 53%|█████▎    | 181811/343741 [00:08<00:11, 14539.82it/s] 54%|█████▎    | 184581/343741 [00:08<00:09, 16965.20it/s] 54%|█████▍    | 187149/343741 [00:08<00:08, 18780.97it/s] 55%|█████▌    | 189944/343741 [00:08<00:07, 20884.11it/s] 56%|█████▌    | 192731/343741 [00:08<00:06, 22606.41it/s] 57%|█████▋    | 195454/343741 [00:09<00:06, 23810.58it/s] 58%|█████▊    | 198229/343741 [00:09<00:05, 24878.20it/s] 58%|█████▊    | 200973/343741 [00:09<00:05, 25592.26it/s] 59%|█████▉    | 203703/343741 [00:09<00:05, 26076.49it/s] 60%|██████    | 206466/343741 [00:09<00:05, 26523.84it/s] 61%|██████    | 209215/343741 [00:09<00:05, 26803.91it/s] 62%|██████▏   | 211983/343741 [00:09<00:04, 27059.15it/s] 62%|██████▏   | 214730/343741 [00:09<00:04, 27056.88it/s] 63%|██████▎   | 217465/343741 [00:09<00:04, 27098.83it/s] 64%|██████▍   | 220238/343741 [00:09<00:04, 27285.30it/s] 65%|██████▍   | 222981/343741 [00:10<00:04, 27313.58it/s] 66%|██████▌   | 225723/343741 [00:10<00:04, 27297.00it/s] 66%|██████▋   | 228462/343741 [00:10<00:04, 27322.77it/s] 67%|██████▋   | 231200/343741 [00:10<00:04, 27227.34it/s] 68%|██████▊   | 233961/343741 [00:10<00:04, 27340.86it/s] 69%|██████▉   | 236746/343741 [00:10<00:03, 27492.00it/s] 70%|██████▉   | 239502/343741 [00:10<00:03, 27490.57it/s] 70%|███████   | 242253/343741 [00:10<00:03, 27469.25it/s] 71%|███████▏  | 245068/343741 [00:10<00:03, 27670.59it/s] 72%|███████▏  | 247836/343741 [00:10<00:03, 27587.59it/s] 73%|███████▎  | 250596/343741 [00:11<00:03, 27433.36it/s] 74%|███████▎  | 253340/343741 [00:11<00:03, 27415.08it/s] 74%|███████▍  | 256082/343741 [00:12<00:10, 8680.37it/s]  75%|███████▌  | 258819/343741 [00:12<00:07, 10903.41it/s] 76%|███████▌  | 261562/343741 [00:12<00:06, 13303.25it/s] 77%|███████▋  | 264322/343741 [00:12<00:05, 15759.56it/s] 78%|███████▊  | 267025/343741 [00:12<00:04, 17980.16it/s] 78%|███████▊  | 269803/343741 [00:12<00:03, 20132.14it/s] 79%|███████▉  | 272577/343741 [00:12<00:03, 21949.09it/s] 80%|████████  | 275357/343741 [00:12<00:02, 23435.89it/s] 81%|████████  | 278060/343741 [00:12<00:02, 23999.95it/s] 82%|████████▏ | 280716/343741 [00:12<00:02, 24622.89it/s] 82%|████████▏ | 283483/343741 [00:13<00:02, 25472.17it/s] 83%|████████▎ | 286237/343741 [00:13<00:02, 26060.17it/s] 84%|████████▍ | 289038/343741 [00:13<00:02, 26623.85it/s] 85%|████████▍ | 291862/343741 [00:13<00:01, 27094.35it/s] 86%|████████▌ | 294624/343741 [00:13<00:01, 27247.21it/s] 87%|████████▋ | 297407/343741 [00:13<00:01, 27418.38it/s] 87%|████████▋ | 300174/343741 [00:13<00:01, 27176.81it/s] 88%|████████▊ | 302910/343741 [00:13<00:01, 26890.31it/s] 89%|████████▉ | 305613/343741 [00:13<00:01, 26742.63it/s] 90%|████████▉ | 308352/343741 [00:13<00:01, 26931.21it/s] 90%|█████████ | 311076/343741 [00:14<00:01, 27001.60it/s] 91%|█████████▏| 313833/343741 [00:14<00:01, 27168.70it/s] 92%|█████████▏| 316554/343741 [00:14<00:01, 26944.81it/s] 93%|█████████▎| 319301/343741 [00:14<00:00, 27098.28it/s] 94%|█████████▎| 322013/343741 [00:14<00:00, 26991.68it/s] 94%|█████████▍| 324773/343741 [00:14<00:00, 27169.65it/s] 95%|█████████▌| 327516/343741 [00:14<00:00, 27246.70it/s] 96%|█████████▌| 330242/343741 [00:14<00:00, 27189.66it/s] 97%|█████████▋| 332962/343741 [00:14<00:00, 27191.59it/s] 98%|█████████▊| 335739/343741 [00:14<00:00, 27363.83it/s] 98%|█████████▊| 338476/343741 [00:15<00:00, 27235.79it/s] 99%|█████████▉| 341243/343741 [00:15<00:00, 27362.77it/s]100%|██████████| 343741/343741 [00:15<00:00, 22571.47it/s]
  0%|          | 0/56357 [00:00<?, ?it/s]  6%|▌         | 3235/56357 [00:00<00:01, 32339.39it/s] 11%|█▏        | 6469/56357 [00:00<00:01, 32148.26it/s] 17%|█▋        | 9684/56357 [00:00<00:01, 31398.64it/s] 23%|██▎       | 12964/56357 [00:00<00:01, 31939.33it/s] 29%|██▊       | 16160/56357 [00:00<00:01, 31912.75it/s] 34%|███▍      | 19432/56357 [00:00<00:01, 32181.99it/s] 40%|████      | 22655/56357 [00:00<00:01, 32195.97it/s] 46%|████▌     | 25903/56357 [00:00<00:00, 32285.34it/s] 52%|█████▏    | 29133/56357 [00:00<00:00, 32039.43it/s] 57%|█████▋    | 32368/56357 [00:01<00:00, 32120.46it/s] 63%|██████▎   | 35581/56357 [00:01<00:00, 31912.46it/s] 69%|██████▉   | 38773/56357 [00:01<00:00, 31745.67it/s] 75%|███████▍  | 42033/56357 [00:01<00:00, 32000.67it/s] 80%|████████  | 45244/56357 [00:01<00:00, 32030.80it/s] 86%|████████▌ | 48521/56357 [00:01<00:00, 32249.95it/s] 92%|█████████▏| 51747/56357 [00:01<00:00, 32109.51it/s] 98%|█████████▊| 55006/56357 [00:01<00:00, 32250.64it/s]100%|██████████| 56357/56357 [00:01<00:00, 32066.99it/s]
  0%|          | 0/23248 [00:00<?, ?it/s] 15%|█▌        | 3501/23248 [00:00<00:00, 35005.61it/s] 30%|███       | 7002/23248 [00:00<00:00, 34268.60it/s] 45%|████▌     | 10494/23248 [00:00<00:00, 34460.74it/s] 60%|█████▉    | 13941/23248 [00:00<00:00, 33779.98it/s] 75%|███████▍  | 17379/23248 [00:00<00:00, 33990.80it/s] 90%|████████▉ | 20875/23248 [00:00<00:00, 34315.53it/s]100%|██████████| 23248/23248 [00:00<00:00, 34218.79it/s]
dataset loaded from path: 
data/ud/ud-treebanks-v2.1/UD_Spanish/inter-layer-13/UD_Spanish-train-bloom-1b1-intermediate-global_step1000.pkl
data/ud/ud-treebanks-v2.1/UD_Spanish/inter-layer-13/UD_Spanish-dev-bloom-1b1-intermediate-global_step1000.pkl
data/ud/ud-treebanks-v2.1/UD_Spanish/inter-layer-13/UD_Spanish-test-bloom-1b1-intermediate-global_step1000.pkl
Embedding dimensionality: 1536
Pre-training probe (if possible)...
Traceback (most recent call last):
  File "run.py", line 102, in <module>
    args.func(args)
  File "/home/s2308470/multilingual-typology-probing/commands.py", line 166, in greedy
    trainer.train()
  File "/home/s2308470/multilingual-typology-probing/probekit/trainers/trainer.py", line 21, in train
    self._train()
  File "/home/s2308470/multilingual-typology-probing/probekit/trainers/neural_probe_trainer.py", line 30, in _train
    self._train_for_dimensions()
  File "/home/s2308470/multilingual-typology-probing/trainers/flexible_neural_probe_trainer.py", line 72, in _train_for_dimensions
    inputs_tensor_shuffled = inputs_tensor[shuffled_indices]
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 1.63 GiB (GPU 0; 5.94 GiB total capacity; 4.18 GiB already allocated; 1.51 GiB free; 4.21 GiB reserved in total by PyTorch) If reserved memory is >> allocated memory try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF
