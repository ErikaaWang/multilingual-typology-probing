python run.py --language UD_Spanish --experiment-name inter-layer-17 --attribute POS --trainer poisson --gpu --embedding bloom-1b1-intermediate-global_step1000 greedy --selection-size 50 --selection-criterion mi
Setting up datasets (['UD_Spanish'], POS) and probes...
  0%|          | 0/343741 [00:00<?, ?it/s]  1%|          | 1724/343741 [00:00<00:19, 17233.40it/s]  1%|          | 3975/343741 [00:00<00:16, 20334.75it/s]  2%|▏         | 6244/343741 [00:00<00:15, 21407.22it/s]  2%|▏         | 8513/343741 [00:00<00:15, 21912.01it/s]  3%|▎         | 10807/343741 [00:00<00:14, 22279.81it/s]  4%|▍         | 13080/343741 [00:00<00:14, 22429.82it/s]  4%|▍         | 15372/343741 [00:00<00:14, 22587.52it/s]  5%|▌         | 17650/343741 [00:00<00:14, 22647.69it/s]  6%|▌         | 19938/343741 [00:00<00:14, 22719.65it/s]  6%|▋         | 22210/343741 [00:01<00:29, 10873.41it/s]  7%|▋         | 24335/343741 [00:01<00:25, 12680.43it/s]  8%|▊         | 26460/343741 [00:01<00:22, 14387.44it/s]  8%|▊         | 28564/343741 [00:01<00:19, 15861.05it/s]  9%|▉         | 30833/343741 [00:01<00:17, 17502.85it/s] 10%|▉         | 33106/343741 [00:01<00:16, 18838.28it/s] 10%|█         | 35355/343741 [00:01<00:15, 19814.59it/s] 11%|█         | 37652/343741 [00:02<00:14, 20684.58it/s] 12%|█▏        | 39934/343741 [00:02<00:14, 21286.19it/s] 12%|█▏        | 42231/343741 [00:02<00:13, 21770.45it/s] 13%|█▎        | 44494/343741 [00:02<00:13, 22019.80it/s] 14%|█▎        | 46780/343741 [00:02<00:13, 22264.86it/s] 14%|█▍        | 49058/343741 [00:02<00:13, 22414.22it/s] 15%|█▍        | 51325/343741 [00:02<00:13, 21842.73it/s] 16%|█▌        | 53531/343741 [00:02<00:13, 21672.09it/s] 16%|█▌        | 55713/343741 [00:02<00:13, 21561.71it/s] 17%|█▋        | 57880/343741 [00:02<00:13, 21465.25it/s] 17%|█▋        | 60034/343741 [00:03<00:13, 21439.03it/s] 18%|█▊        | 62183/343741 [00:03<00:29, 9467.47it/s]  19%|█▊        | 64290/343741 [00:03<00:24, 11287.19it/s] 19%|█▉        | 66309/343741 [00:03<00:21, 12915.82it/s] 20%|█▉        | 68401/343741 [00:03<00:18, 14573.71it/s] 21%|██        | 70500/343741 [00:04<00:17, 16038.06it/s] 21%|██        | 72624/343741 [00:04<00:15, 17316.04it/s] 22%|██▏       | 74745/343741 [00:04<00:14, 18328.07it/s] 22%|██▏       | 76879/343741 [00:04<00:13, 19141.41it/s] 23%|██▎       | 78999/343741 [00:04<00:13, 19715.03it/s] 24%|██▎       | 81127/343741 [00:04<00:13, 20159.56it/s] 24%|██▍       | 83239/343741 [00:04<00:12, 20436.51it/s] 25%|██▍       | 85343/343741 [00:04<00:12, 20609.81it/s] 25%|██▌       | 87470/343741 [00:04<00:12, 20801.37it/s] 26%|██▌       | 89580/343741 [00:04<00:12, 20642.26it/s] 27%|██▋       | 91708/343741 [00:05<00:12, 20829.65it/s] 27%|██▋       | 93829/343741 [00:05<00:11, 20939.55it/s] 28%|██▊       | 95967/343741 [00:05<00:11, 21067.50it/s] 29%|██▊       | 98085/343741 [00:05<00:11, 21100.15it/s] 29%|██▉       | 100206/343741 [00:05<00:11, 21131.10it/s] 30%|██▉       | 102324/343741 [00:05<00:11, 21144.19it/s] 30%|███       | 104443/343741 [00:05<00:11, 21157.31it/s] 31%|███       | 106571/343741 [00:05<00:11, 21193.53it/s] 32%|███▏      | 108701/343741 [00:05<00:11, 21222.32it/s] 32%|███▏      | 110825/343741 [00:05<00:10, 21221.59it/s] 33%|███▎      | 112948/343741 [00:06<00:26, 8629.76it/s]  33%|███▎      | 115060/343741 [00:06<00:21, 10481.43it/s] 34%|███▍      | 117123/343741 [00:06<00:18, 12254.65it/s] 35%|███▍      | 119237/343741 [00:06<00:16, 14029.09it/s] 35%|███▌      | 121355/343741 [00:06<00:14, 15615.45it/s] 36%|███▌      | 123473/343741 [00:06<00:12, 16954.00it/s] 37%|███▋      | 125595/343741 [00:07<00:12, 18045.22it/s] 37%|███▋      | 127648/343741 [00:07<00:11, 18656.73it/s] 38%|███▊      | 129780/343741 [00:07<00:11, 19391.25it/s] 38%|███▊      | 131887/343741 [00:07<00:10, 19865.44it/s] 39%|███▉      | 134006/343741 [00:07<00:10, 20246.12it/s] 40%|███▉      | 136109/343741 [00:07<00:10, 20473.68it/s] 40%|████      | 138206/343741 [00:07<00:09, 20617.99it/s] 41%|████      | 140327/343741 [00:07<00:09, 20791.20it/s] 41%|████▏     | 142443/343741 [00:07<00:09, 20900.10it/s] 42%|████▏     | 144578/343741 [00:07<00:09, 21032.03it/s] 43%|████▎     | 146694/343741 [00:08<00:09, 21022.64it/s] 43%|████▎     | 148811/343741 [00:08<00:09, 21063.76it/s] 44%|████▍     | 150924/343741 [00:08<00:09, 20812.46it/s] 45%|████▍     | 153030/343741 [00:08<00:09, 20884.76it/s] 45%|████▌     | 155155/343741 [00:08<00:08, 20990.56it/s] 46%|████▌     | 157270/343741 [00:08<00:08, 21036.44it/s] 46%|████▋     | 159400/343741 [00:08<00:08, 21112.50it/s] 47%|████▋     | 161521/343741 [00:08<00:08, 21140.05it/s] 48%|████▊     | 163641/343741 [00:08<00:08, 21157.08it/s] 48%|████▊     | 165758/343741 [00:09<00:08, 21137.80it/s] 49%|████▉     | 167873/343741 [00:09<00:08, 21134.97it/s] 49%|████▉     | 170002/343741 [00:09<00:08, 21180.22it/s] 50%|█████     | 172126/343741 [00:09<00:08, 21197.32it/s] 51%|█████     | 174246/343741 [00:09<00:08, 21117.79it/s] 51%|█████▏    | 176358/343741 [00:10<00:21, 7763.27it/s]  52%|█████▏    | 178468/343741 [00:10<00:17, 9573.14it/s] 53%|█████▎    | 180582/343741 [00:10<00:14, 11451.49it/s] 53%|█████▎    | 182697/343741 [00:10<00:12, 13276.50it/s] 54%|█████▍    | 184804/343741 [00:10<00:10, 14928.34it/s] 54%|█████▍    | 186839/343741 [00:10<00:09, 16186.91it/s] 55%|█████▍    | 188962/343741 [00:10<00:08, 17442.46it/s] 56%|█████▌    | 191072/343741 [00:10<00:08, 18401.63it/s] 56%|█████▌    | 193199/343741 [00:10<00:07, 19183.55it/s] 57%|█████▋    | 195312/343741 [00:10<00:07, 19728.00it/s] 57%|█████▋    | 197447/343741 [00:11<00:07, 20190.11it/s] 58%|█████▊    | 199550/343741 [00:11<00:07, 20431.99it/s] 59%|█████▊    | 201670/343741 [00:11<00:06, 20654.06it/s] 59%|█████▉    | 203798/343741 [00:11<00:06, 20835.61it/s] 60%|█████▉    | 205912/343741 [00:11<00:06, 20857.18it/s] 61%|██████    | 208046/343741 [00:11<00:06, 20999.35it/s] 61%|██████    | 210163/343741 [00:11<00:06, 21047.66it/s] 62%|██████▏   | 212279/343741 [00:11<00:06, 20877.40it/s] 62%|██████▏   | 214395/343741 [00:11<00:06, 20959.52it/s] 63%|██████▎   | 216498/343741 [00:11<00:06, 20977.92it/s] 64%|██████▎   | 218607/343741 [00:12<00:05, 21009.95it/s] 64%|██████▍   | 220724/343741 [00:12<00:05, 21056.85it/s] 65%|██████▍   | 222839/343741 [00:12<00:05, 21084.14it/s] 65%|██████▌   | 224949/343741 [00:12<00:05, 21074.99it/s] 66%|██████▌   | 227069/343741 [00:12<00:05, 21109.70it/s] 67%|██████▋   | 229181/343741 [00:12<00:05, 21101.04it/s] 67%|██████▋   | 231292/343741 [00:12<00:05, 21039.68it/s] 68%|██████▊   | 233397/343741 [00:12<00:05, 20872.96it/s] 69%|██████▊   | 235502/343741 [00:12<00:05, 20924.83it/s] 69%|██████▉   | 237627/343741 [00:12<00:05, 21018.83it/s] 70%|██████▉   | 239740/343741 [00:13<00:04, 21049.60it/s] 70%|███████   | 241861/343741 [00:13<00:04, 21095.68it/s] 71%|███████   | 243972/343741 [00:13<00:04, 21097.12it/s] 72%|███████▏  | 246082/343741 [00:13<00:04, 21061.28it/s] 72%|███████▏  | 248194/343741 [00:13<00:04, 21075.46it/s] 73%|███████▎  | 250315/343741 [00:13<00:04, 21114.02it/s] 73%|███████▎  | 252429/343741 [00:13<00:04, 21119.14it/s] 74%|███████▍  | 254541/343741 [00:14<00:16, 5537.18it/s]  75%|███████▍  | 256560/343741 [00:14<00:12, 7015.89it/s] 75%|███████▌  | 258653/343741 [00:14<00:09, 8768.98it/s] 76%|███████▌  | 260764/343741 [00:15<00:07, 10650.86it/s] 76%|███████▋  | 262880/343741 [00:15<00:06, 12530.96it/s] 77%|███████▋  | 265000/343741 [00:15<00:05, 14294.54it/s] 78%|███████▊  | 267104/343741 [00:15<00:04, 15813.74it/s] 78%|███████▊  | 269222/343741 [00:15<00:04, 17119.98it/s] 79%|███████▉  | 271325/343741 [00:15<00:03, 18128.03it/s] 80%|███████▉  | 273436/343741 [00:15<00:03, 18928.73it/s] 80%|████████  | 275544/343741 [00:15<00:03, 19525.99it/s] 81%|████████  | 277636/343741 [00:15<00:03, 19781.12it/s] 81%|████████▏ | 279749/343741 [00:15<00:03, 20167.27it/s] 82%|████████▏ | 281868/343741 [00:16<00:03, 20462.57it/s] 83%|████████▎ | 283986/343741 [00:16<00:02, 20671.98it/s] 83%|████████▎ | 286096/343741 [00:16<00:02, 20795.86it/s] 84%|████████▍ | 288201/343741 [00:16<00:02, 20866.89it/s] 84%|████████▍ | 290311/343741 [00:16<00:02, 20934.08it/s] 85%|████████▌ | 292429/343741 [00:16<00:02, 21006.14it/s] 86%|████████▌ | 294542/343741 [00:16<00:02, 21040.45it/s] 86%|████████▋ | 296661/343741 [00:16<00:02, 21084.13it/s] 87%|████████▋ | 298774/343741 [00:16<00:02, 20864.18it/s] 88%|████████▊ | 300904/343741 [00:16<00:02, 20992.78it/s] 88%|████████▊ | 303006/343741 [00:17<00:01, 20988.86it/s] 89%|████████▉ | 305108/343741 [00:17<00:01, 20997.04it/s] 89%|████████▉ | 307224/343741 [00:17<00:01, 21043.29it/s] 90%|████████▉ | 309340/343741 [00:17<00:01, 21076.67it/s] 91%|█████████ | 311456/343741 [00:17<00:01, 21098.23it/s] 91%|█████████ | 313567/343741 [00:17<00:01, 21094.00it/s] 92%|█████████▏| 315691/343741 [00:17<00:01, 21136.08it/s] 92%|█████████▏| 317805/343741 [00:17<00:01, 21108.39it/s] 93%|█████████▎| 319917/343741 [00:17<00:01, 20905.70it/s] 94%|█████████▎| 322033/343741 [00:17<00:01, 20979.14it/s] 94%|█████████▍| 324147/343741 [00:18<00:00, 21026.47it/s] 95%|█████████▍| 326276/343741 [00:18<00:00, 21103.21it/s] 96%|█████████▌| 328387/343741 [00:18<00:00, 21095.99it/s] 96%|█████████▌| 330505/343741 [00:18<00:00, 21114.54it/s] 97%|█████████▋| 332617/343741 [00:18<00:00, 21094.00it/s] 97%|█████████▋| 334727/343741 [00:18<00:00, 21095.21it/s] 98%|█████████▊| 336848/343741 [00:18<00:00, 21126.86it/s] 99%|█████████▊| 338966/343741 [00:18<00:00, 21140.90it/s] 99%|█████████▉| 341081/343741 [00:18<00:00, 20956.47it/s]100%|█████████▉| 343196/343741 [00:18<00:00, 21012.23it/s]100%|██████████| 343741/343741 [00:18<00:00, 18123.30it/s]
  0%|          | 0/56357 [00:00<?, ?it/s]  4%|▍         | 2534/56357 [00:00<00:02, 25330.72it/s]  9%|▉         | 5068/56357 [00:00<00:02, 24686.88it/s] 13%|█▎        | 7538/56357 [00:00<00:01, 24540.51it/s] 18%|█▊        | 9993/56357 [00:00<00:01, 24462.96it/s] 22%|██▏       | 12515/56357 [00:00<00:01, 24732.53it/s] 27%|██▋       | 15153/56357 [00:00<00:01, 25288.19it/s] 32%|███▏      | 17754/56357 [00:00<00:01, 25521.80it/s] 36%|███▌      | 20307/56357 [00:00<00:01, 25402.23it/s] 41%|████      | 22935/56357 [00:00<00:01, 25673.13it/s] 45%|████▌     | 25549/56357 [00:01<00:01, 25813.86it/s] 50%|████▉     | 28164/56357 [00:01<00:01, 25913.14it/s] 55%|█████▍    | 30756/56357 [00:01<00:00, 25863.88it/s] 59%|█████▉    | 33390/56357 [00:01<00:00, 26005.25it/s] 64%|██████▍   | 35991/56357 [00:01<00:00, 25927.14it/s] 68%|██████▊   | 38584/56357 [00:01<00:00, 25649.80it/s] 73%|███████▎  | 41150/56357 [00:01<00:00, 25638.80it/s] 78%|███████▊  | 43803/56357 [00:01<00:00, 25902.14it/s] 82%|████████▏ | 46394/56357 [00:01<00:00, 25879.93it/s] 87%|████████▋ | 49067/56357 [00:01<00:00, 26130.77it/s] 92%|█████████▏| 51681/56357 [00:02<00:00, 26108.44it/s] 96%|█████████▋| 54293/56357 [00:02<00:00, 25814.73it/s]100%|██████████| 56357/56357 [00:02<00:00, 25652.84it/s]
  0%|          | 0/23248 [00:00<?, ?it/s] 11%|█         | 2505/23248 [00:00<00:00, 25047.58it/s] 22%|██▏       | 5188/23248 [00:00<00:00, 26094.86it/s] 34%|███▍      | 7861/23248 [00:00<00:00, 26383.87it/s] 45%|████▌     | 10500/23248 [00:00<00:00, 26385.41it/s] 57%|█████▋    | 13179/23248 [00:00<00:00, 26528.64it/s] 68%|██████▊   | 15842/23248 [00:00<00:00, 26560.72it/s] 80%|███████▉  | 18509/23248 [00:00<00:00, 26594.58it/s] 91%|█████████ | 21169/23248 [00:00<00:00, 26321.95it/s]100%|██████████| 23248/23248 [00:00<00:00, 26062.87it/s]
dataset loaded from path: 
data/ud/ud-treebanks-v2.1/UD_Spanish/inter-layer-17/UD_Spanish-train-bloom-1b1-intermediate-global_step1000.pkl
data/ud/ud-treebanks-v2.1/UD_Spanish/inter-layer-17/UD_Spanish-dev-bloom-1b1-intermediate-global_step1000.pkl
data/ud/ud-treebanks-v2.1/UD_Spanish/inter-layer-17/UD_Spanish-test-bloom-1b1-intermediate-global_step1000.pkl
Embedding dimensionality: 1536
Pre-training probe (if possible)...
Traceback (most recent call last):
  File "run.py", line 102, in <module>
    args.func(args)
  File "/home/s2308470/multilingual-typology-probing/commands.py", line 166, in greedy
    trainer.train()
  File "/home/s2308470/multilingual-typology-probing/probekit/trainers/trainer.py", line 21, in train
    self._train()
  File "/home/s2308470/multilingual-typology-probing/probekit/trainers/neural_probe_trainer.py", line 30, in _train
    self._train_for_dimensions()
  File "/home/s2308470/multilingual-typology-probing/trainers/flexible_neural_probe_trainer.py", line 72, in _train_for_dimensions
    inputs_tensor_shuffled = inputs_tensor[shuffled_indices]
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 1.63 GiB (GPU 0; 5.94 GiB total capacity; 4.18 GiB already allocated; 1.51 GiB free; 4.21 GiB reserved in total by PyTorch) If reserved memory is >> allocated memory try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF
