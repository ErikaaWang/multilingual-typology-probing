python run.py --language UD_Catalan --experiment-name inter-layer-17 --attribute POS --trainer poisson --gpu --embedding bloom-1b1-intermediate-global_step400000 greedy --selection-size 50 --selection-criterion mi
Setting up datasets (['UD_Catalan'], POS) and probes...
  0%|          | 0/441656 [00:00<?, ?it/s]  0%|          | 2197/441656 [00:00<00:20, 21966.35it/s]  1%|          | 5093/441656 [00:00<00:16, 26076.45it/s]  2%|▏         | 7926/441656 [00:00<00:16, 27101.62it/s]  2%|▏         | 10736/441656 [00:00<00:15, 27492.62it/s]  3%|▎         | 13642/441656 [00:00<00:15, 28056.78it/s]  4%|▍         | 16566/441656 [00:00<00:14, 28456.03it/s]  4%|▍         | 19450/441656 [00:00<00:14, 28579.10it/s]  5%|▌         | 22466/441656 [00:00<00:14, 29079.72it/s]  6%|▌         | 25374/441656 [00:00<00:14, 28926.60it/s]  6%|▋         | 28283/441656 [00:01<00:14, 28975.84it/s]  7%|▋         | 31259/441656 [00:01<00:14, 29212.53it/s]  8%|▊         | 34181/441656 [00:01<00:14, 29084.12it/s]  8%|▊         | 37090/441656 [00:01<00:37, 10862.87it/s]  9%|▉         | 40007/441656 [00:01<00:30, 13386.51it/s] 10%|▉         | 42988/441656 [00:02<00:24, 16097.73it/s] 10%|█         | 45886/441656 [00:02<00:21, 18555.68it/s] 11%|█         | 48722/441656 [00:02<00:19, 20655.38it/s] 12%|█▏        | 51675/441656 [00:02<00:17, 22734.54it/s] 12%|█▏        | 54581/441656 [00:02<00:15, 24319.22it/s] 13%|█▎        | 57421/441656 [00:02<00:15, 25394.56it/s] 14%|█▎        | 60381/441656 [00:02<00:14, 26543.18it/s] 14%|█▍        | 63346/441656 [00:02<00:13, 27415.44it/s] 15%|█▍        | 66243/441656 [00:02<00:13, 27652.58it/s] 16%|█▌        | 69164/441656 [00:02<00:13, 28101.53it/s] 16%|█▋        | 72097/441656 [00:03<00:12, 28458.82it/s] 17%|█▋        | 75052/441656 [00:03<00:12, 28777.87it/s] 18%|█▊        | 77970/441656 [00:03<00:12, 28797.59it/s] 18%|█▊        | 80948/441656 [00:03<00:12, 29085.89it/s] 19%|█▉        | 83884/441656 [00:03<00:12, 29166.59it/s] 20%|█▉        | 86815/441656 [00:04<00:35, 9919.55it/s]  20%|██        | 89725/441656 [00:04<00:28, 12343.79it/s] 21%|██        | 92666/441656 [00:04<00:23, 14953.92it/s] 22%|██▏       | 95569/441656 [00:04<00:19, 17477.14it/s] 22%|██▏       | 98456/441656 [00:04<00:17, 19796.72it/s] 23%|██▎       | 101304/441656 [00:04<00:15, 21754.03it/s] 24%|██▎       | 104306/441656 [00:04<00:14, 23766.22it/s] 24%|██▍       | 107277/441656 [00:04<00:13, 25299.73it/s] 25%|██▍       | 110182/441656 [00:05<00:12, 26309.53it/s] 26%|██▌       | 113067/441656 [00:05<00:12, 26366.96it/s] 26%|██▋       | 115956/441656 [00:05<00:12, 27069.81it/s] 27%|██▋       | 118958/441656 [00:05<00:11, 27908.90it/s] 28%|██▊       | 121953/441656 [00:05<00:11, 28496.69it/s] 28%|██▊       | 124872/441656 [00:05<00:11, 28577.55it/s] 29%|██▉       | 127778/441656 [00:05<00:10, 28694.60it/s] 30%|██▉       | 130682/441656 [00:05<00:10, 28704.96it/s] 30%|███       | 133588/441656 [00:05<00:10, 28807.04it/s] 31%|███       | 136600/441656 [00:05<00:10, 29195.44it/s] 32%|███▏      | 139532/441656 [00:06<00:10, 29082.67it/s] 32%|███▏      | 142477/441656 [00:06<00:10, 29189.50it/s] 33%|███▎      | 145402/441656 [00:06<00:10, 28872.01it/s] 34%|███▎      | 148295/441656 [00:06<00:10, 28596.31it/s] 34%|███▍      | 151159/441656 [00:07<00:38, 7577.14it/s]  35%|███▍      | 153851/441656 [00:07<00:30, 9521.15it/s] 36%|███▌      | 156820/441656 [00:07<00:23, 12053.30it/s] 36%|███▌      | 159758/441656 [00:07<00:19, 14687.86it/s] 37%|███▋      | 162605/441656 [00:07<00:16, 17147.38it/s] 37%|███▋      | 165560/441656 [00:07<00:14, 19666.63it/s] 38%|███▊      | 168455/441656 [00:07<00:12, 21712.88it/s] 39%|███▉      | 171430/441656 [00:08<00:11, 23664.10it/s] 39%|███▉      | 174335/441656 [00:08<00:10, 25048.74it/s] 40%|████      | 177202/441656 [00:08<00:10, 25851.33it/s] 41%|████      | 180180/441656 [00:08<00:09, 26922.82it/s] 41%|████▏     | 183107/441656 [00:08<00:09, 27584.73it/s] 42%|████▏     | 186004/441656 [00:08<00:09, 27602.22it/s] 43%|████▎     | 188977/441656 [00:08<00:08, 28215.06it/s] 43%|████▎     | 191895/441656 [00:08<00:08, 28495.81it/s] 44%|████▍     | 194878/441656 [00:08<00:08, 28885.67it/s] 45%|████▍     | 197803/441656 [00:08<00:08, 28920.12it/s] 45%|████▌     | 200721/441656 [00:09<00:08, 28926.49it/s] 46%|████▌     | 203632/441656 [00:09<00:08, 28905.20it/s] 47%|████▋     | 206535/441656 [00:09<00:08, 28528.42it/s] 47%|████▋     | 209477/441656 [00:09<00:08, 28790.48it/s] 48%|████▊     | 212392/441656 [00:09<00:07, 28895.73it/s] 49%|████▊     | 215287/441656 [00:09<00:07, 28757.20it/s] 49%|████▉     | 218167/441656 [00:09<00:07, 28364.05it/s] 50%|█████     | 221043/441656 [00:09<00:07, 28478.97it/s] 51%|█████     | 223981/441656 [00:09<00:07, 28745.25it/s] 51%|█████▏    | 226977/441656 [00:10<00:07, 29103.98it/s] 52%|█████▏    | 229890/441656 [00:11<00:33, 6306.60it/s]  53%|█████▎    | 232820/441656 [00:11<00:25, 8249.41it/s] 53%|█████▎    | 235808/441656 [00:11<00:19, 10579.09it/s] 54%|█████▍    | 238687/441656 [00:11<00:15, 13007.08it/s] 55%|█████▍    | 241582/441656 [00:11<00:12, 15557.79it/s] 55%|█████▌    | 244355/441656 [00:11<00:11, 17821.63it/s] 56%|█████▌    | 247281/441656 [00:11<00:09, 20222.41it/s] 57%|█████▋    | 250073/441656 [00:12<00:08, 21949.71it/s] 57%|█████▋    | 252899/441656 [00:12<00:08, 23509.79it/s] 58%|█████▊    | 255845/441656 [00:12<00:07, 25063.46it/s] 59%|█████▊    | 258708/441656 [00:12<00:07, 26030.62it/s] 59%|█████▉    | 261556/441656 [00:12<00:06, 26631.98it/s] 60%|█████▉    | 264395/441656 [00:12<00:06, 27110.86it/s] 61%|██████    | 267263/441656 [00:12<00:06, 27563.37it/s] 61%|██████    | 270127/441656 [00:12<00:06, 27864.57it/s] 62%|██████▏   | 272991/441656 [00:12<00:06, 28089.59it/s] 62%|██████▏   | 275845/441656 [00:12<00:05, 27841.43it/s] 63%|██████▎   | 278743/441656 [00:13<00:05, 28173.67it/s] 64%|██████▍   | 281584/441656 [00:13<00:05, 27763.40it/s] 64%|██████▍   | 284417/441656 [00:13<00:05, 27927.07it/s] 65%|██████▌   | 287232/441656 [00:13<00:05, 27992.08it/s] 66%|██████▌   | 290111/441656 [00:13<00:05, 28227.00it/s] 66%|██████▋   | 292941/441656 [00:13<00:05, 28036.55it/s] 67%|██████▋   | 295837/441656 [00:13<00:05, 28308.22it/s] 68%|██████▊   | 298675/441656 [00:13<00:05, 28327.25it/s] 68%|██████▊   | 301511/441656 [00:13<00:04, 28095.66it/s] 69%|██████▉   | 304383/441656 [00:13<00:04, 28278.07it/s] 70%|██████▉   | 307213/441656 [00:14<00:04, 28224.01it/s] 70%|███████   | 310037/441656 [00:14<00:04, 28197.32it/s] 71%|███████   | 312908/441656 [00:14<00:04, 28347.14it/s] 71%|███████▏  | 315744/441656 [00:14<00:04, 28254.67it/s] 72%|███████▏  | 318662/441656 [00:14<00:04, 28528.70it/s] 73%|███████▎  | 321542/441656 [00:14<00:04, 28606.69it/s] 73%|███████▎  | 324404/441656 [00:14<00:04, 28575.05it/s] 74%|███████▍  | 327328/441656 [00:14<00:03, 28772.20it/s] 75%|███████▍  | 330206/441656 [00:16<00:18, 5964.23it/s]  75%|███████▌  | 332781/441656 [00:16<00:14, 7575.57it/s] 76%|███████▌  | 335402/441656 [00:16<00:11, 9517.32it/s] 77%|███████▋  | 338077/441656 [00:16<00:08, 11750.12it/s] 77%|███████▋  | 340688/441656 [00:16<00:07, 13992.28it/s] 78%|███████▊  | 343274/441656 [00:16<00:06, 16156.51it/s] 78%|███████▊  | 345937/441656 [00:16<00:05, 18320.19it/s] 79%|███████▉  | 348586/441656 [00:16<00:04, 20181.65it/s] 80%|███████▉  | 351229/441656 [00:16<00:04, 21715.41it/s] 80%|████████  | 353834/441656 [00:17<00:03, 22473.83it/s] 81%|████████  | 356403/441656 [00:17<00:03, 23333.12it/s] 81%|████████▏ | 359084/441656 [00:17<00:03, 24293.51it/s] 82%|████████▏ | 361798/441656 [00:17<00:03, 25096.72it/s] 83%|████████▎ | 364431/441656 [00:17<00:03, 25283.08it/s] 83%|████████▎ | 367072/441656 [00:17<00:02, 25609.29it/s] 84%|████████▎ | 369695/441656 [00:17<00:02, 25716.11it/s] 84%|████████▍ | 372356/441656 [00:17<00:02, 25976.50it/s] 85%|████████▍ | 374985/441656 [00:17<00:02, 26016.42it/s] 86%|████████▌ | 377681/441656 [00:17<00:02, 26293.54it/s] 86%|████████▌ | 380376/441656 [00:18<00:02, 26488.36it/s] 87%|████████▋ | 383036/441656 [00:18<00:02, 26207.72it/s] 87%|████████▋ | 385666/441656 [00:18<00:02, 26206.58it/s] 88%|████████▊ | 388355/441656 [00:18<00:02, 26407.28it/s] 89%|████████▊ | 391000/441656 [00:18<00:01, 25941.55it/s] 89%|████████▉ | 393612/441656 [00:18<00:01, 25991.15it/s] 90%|████████▉ | 396261/441656 [00:18<00:01, 26137.17it/s] 90%|█████████ | 398940/441656 [00:18<00:01, 26330.03it/s] 91%|█████████ | 401579/441656 [00:18<00:01, 26346.32it/s] 92%|█████████▏| 404247/441656 [00:18<00:01, 26445.32it/s] 92%|█████████▏| 406928/441656 [00:19<00:01, 26551.69it/s] 93%|█████████▎| 409608/441656 [00:19<00:01, 26622.51it/s] 93%|█████████▎| 412271/441656 [00:19<00:01, 26520.42it/s] 94%|█████████▍| 414924/441656 [00:19<00:01, 26344.41it/s] 95%|█████████▍| 417598/441656 [00:19<00:00, 26460.16it/s] 95%|█████████▌| 420260/441656 [00:19<00:00, 26506.00it/s] 96%|█████████▌| 422911/441656 [00:19<00:00, 26011.30it/s] 96%|█████████▋| 425586/441656 [00:19<00:00, 26226.49it/s] 97%|█████████▋| 428281/441656 [00:19<00:00, 26438.86it/s] 98%|█████████▊| 430927/441656 [00:19<00:00, 25794.87it/s] 98%|█████████▊| 433574/441656 [00:20<00:00, 25990.92it/s] 99%|█████████▉| 436228/441656 [00:20<00:00, 26151.26it/s] 99%|█████████▉| 438891/441656 [00:20<00:00, 26290.61it/s]100%|█████████▉| 441565/441656 [00:20<00:00, 26421.14it/s]100%|██████████| 441656/441656 [00:20<00:00, 21696.60it/s]
  0%|          | 0/53198 [00:00<?, ?it/s]  6%|▋         | 3415/53198 [00:00<00:01, 34144.33it/s] 13%|█▎        | 6830/53198 [00:00<00:01, 31975.52it/s] 19%|█▉        | 10040/53198 [00:00<00:01, 32026.65it/s] 25%|██▌       | 13416/53198 [00:00<00:01, 32692.40it/s] 32%|███▏      | 16884/53198 [00:00<00:01, 33396.31it/s] 38%|███▊      | 20228/53198 [00:00<00:00, 33062.05it/s] 44%|████▍     | 23610/53198 [00:00<00:00, 33304.65it/s] 51%|█████     | 26943/53198 [00:00<00:00, 33127.86it/s] 57%|█████▋    | 30258/53198 [00:00<00:00, 32796.63it/s] 63%|██████▎   | 33575/53198 [00:01<00:00, 32909.40it/s] 69%|██████▉   | 36880/53198 [00:01<00:00, 32949.16it/s] 76%|███████▌  | 40242/53198 [00:01<00:00, 33139.92it/s] 82%|████████▏ | 43557/53198 [00:01<00:00, 32401.00it/s] 88%|████████▊ | 46832/53198 [00:01<00:00, 32501.34it/s] 94%|█████████▍| 50205/53198 [00:01<00:00, 32865.06it/s]100%|██████████| 53198/53198 [00:01<00:00, 32772.14it/s]
  0%|          | 0/35912 [00:00<?, ?it/s] 10%|▉         | 3537/35912 [00:00<00:00, 35362.61it/s] 20%|█▉        | 7074/35912 [00:00<00:00, 34617.63it/s] 30%|██▉       | 10656/35912 [00:00<00:00, 35155.53it/s] 39%|███▉      | 14181/35912 [00:00<00:00, 35191.32it/s] 49%|████▉     | 17701/35912 [00:00<00:00, 33567.80it/s] 59%|█████▊    | 21070/35912 [00:00<00:00, 33334.49it/s] 68%|██████▊   | 24412/35912 [00:00<00:00, 32919.08it/s] 77%|███████▋  | 27761/35912 [00:00<00:00, 33092.76it/s] 87%|████████▋ | 31075/35912 [00:00<00:00, 33027.91it/s] 96%|█████████▌| 34381/35912 [00:01<00:00, 32984.02it/s]100%|██████████| 35912/35912 [00:01<00:00, 33535.77it/s]
dataset loaded from path: 
data/ud/ud-treebanks-v2.1/UD_Catalan/inter-layer-17/UD_Catalan-train-bloom-1b1-intermediate-global_step400000.pkl
data/ud/ud-treebanks-v2.1/UD_Catalan/inter-layer-17/UD_Catalan-dev-bloom-1b1-intermediate-global_step400000.pkl
data/ud/ud-treebanks-v2.1/UD_Catalan/inter-layer-17/UD_Catalan-test-bloom-1b1-intermediate-global_step400000.pkl
Embedding dimensionality: 1536
Pre-training probe (if possible)...
Traceback (most recent call last):
  File "run.py", line 102, in <module>
    args.func(args)
  File "/home/s2308470/multilingual-typology-probing/commands.py", line 166, in greedy
    trainer.train()
  File "/home/s2308470/multilingual-typology-probing/probekit/trainers/trainer.py", line 21, in train
    self._train()
  File "/home/s2308470/multilingual-typology-probing/probekit/trainers/neural_probe_trainer.py", line 30, in _train
    self._train_for_dimensions()
  File "/home/s2308470/multilingual-typology-probing/trainers/flexible_neural_probe_trainer.py", line 72, in _train_for_dimensions
    inputs_tensor_shuffled = inputs_tensor[shuffled_indices]
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 2.21 GiB (GPU 0; 5.94 GiB total capacity; 5.41 GiB already allocated; 285.31 MiB free; 5.44 GiB reserved in total by PyTorch) If reserved memory is >> allocated memory try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF
