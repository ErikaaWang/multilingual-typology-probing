now processing task id: 9
CORPUS: UD_Portuguese
python preprocess_treebank.py UD_Portuguese --experiment-name inter-layer-17 --treebanks-root /home/s2308470/multilingual-typology-probing/data/ud/ud-treebanks-v2.1 --bloom bloom-1b7 --checkpoint 1000 --inter-layer 17 --use-gpu
Embeddings root: embeddings
Using GPU
0it [00:00, ?it/s]18it [00:00, 177.91it/s]49it [00:00, 246.09it/s]75it [00:00, 251.00it/s]107it [00:00, 277.32it/s]152it [00:00, 336.30it/s]198it [00:00, 376.07it/s]246it [00:00, 408.82it/s]289it [00:00, 415.35it/s]333it [00:00, 419.33it/s]375it [00:01, 400.62it/s]416it [00:01, 392.74it/s]460it [00:01, 404.26it/s]477it [00:01, 364.56it/s]
0it [00:00, ?it/s]18it [00:00, 175.62it/s]45it [00:00, 229.20it/s]76it [00:00, 265.57it/s]105it [00:00, 271.17it/s]137it [00:00, 285.06it/s]166it [00:00, 284.65it/s]208it [00:00, 327.99it/s]241it [00:00, 321.94it/s]274it [00:00, 309.71it/s]310it [00:01, 323.76it/s]343it [00:01, 288.85it/s]373it [00:01, 275.25it/s]402it [00:01, 278.31it/s]431it [00:01, 185.68it/s]466it [00:01, 219.05it/s]498it [00:01, 241.25it/s]531it [00:01, 262.14it/s]563it [00:02, 274.62it/s]601it [00:02, 301.44it/s]634it [00:02, 296.49it/s]669it [00:02, 306.56it/s]701it [00:02, 305.62it/s]733it [00:02, 306.86it/s]765it [00:02, 288.33it/s]799it [00:02, 301.97it/s]838it [00:02, 324.76it/s]871it [00:03, 299.32it/s]903it [00:03, 303.64it/s]935it [00:03, 306.98it/s]971it [00:03, 321.43it/s]1004it [00:03, 297.46it/s]1042it [00:03, 314.65it/s]1074it [00:03, 288.51it/s]1106it [00:03, 296.41it/s]1144it [00:03, 317.84it/s]1177it [00:04, 315.03it/s]1209it [00:04, 294.36it/s]1239it [00:04, 284.43it/s]1268it [00:04, 284.89it/s]1297it [00:04, 272.24it/s]1327it [00:04, 276.94it/s]1358it [00:04, 284.74it/s]1387it [00:04, 271.11it/s]1420it [00:04, 281.58it/s]1449it [00:05, 282.82it/s]1478it [00:05, 280.06it/s]1507it [00:05, 263.51it/s]1534it [00:05, 256.07it/s]1563it [00:05, 265.11it/s]1590it [00:05, 256.96it/s]1618it [00:05, 261.59it/s]1645it [00:05, 254.47it/s]1677it [00:05, 270.60it/s]1706it [00:06, 272.71it/s]1742it [00:06, 297.23it/s]1772it [00:06, 281.68it/s]1804it [00:06, 290.21it/s]1836it [00:06, 298.68it/s]1876it [00:06, 325.68it/s]1909it [00:06, 284.56it/s]1939it [00:06, 266.49it/s]1967it [00:06, 254.35it/s]2002it [00:07, 279.00it/s]2040it [00:07, 304.24it/s]2072it [00:07, 283.16it/s]2102it [00:07, 262.83it/s]2136it [00:07, 281.18it/s]2166it [00:07, 285.20it/s]2202it [00:07, 301.72it/s]2233it [00:07, 289.81it/s]2279it [00:07, 333.85it/s]2313it [00:08, 333.84it/s]2347it [00:08, 324.93it/s]2385it [00:08, 340.47it/s]2420it [00:08, 320.70it/s]2453it [00:08, 321.75it/s]2491it [00:08, 337.55it/s]2526it [00:08, 325.44it/s]2559it [00:08, 322.94it/s]2592it [00:08, 292.71it/s]2624it [00:09, 295.67it/s]2659it [00:09, 310.05it/s]2691it [00:09, 306.12it/s]2722it [00:09, 178.42it/s]2751it [00:09, 198.20it/s]2780it [00:09, 217.61it/s]2807it [00:09, 220.72it/s]2835it [00:10, 234.28it/s]2865it [00:10, 248.55it/s]2898it [00:10, 269.63it/s]2931it [00:10, 284.94it/s]2961it [00:10, 258.88it/s]2991it [00:10, 263.88it/s]3024it [00:10, 280.51it/s]3058it [00:10, 293.57it/s]3091it [00:10, 303.77it/s]3123it [00:11, 307.84it/s]3159it [00:11, 320.70it/s]3196it [00:11, 328.83it/s]3230it [00:11, 311.53it/s]3268it [00:11, 329.42it/s]3309it [00:11, 350.80it/s]3345it [00:11, 334.84it/s]3379it [00:11, 326.89it/s]3412it [00:11, 315.33it/s]3444it [00:12, 315.29it/s]3476it [00:12, 298.05it/s]3510it [00:12, 308.16it/s]3542it [00:12, 309.71it/s]3574it [00:12, 303.33it/s]3605it [00:12, 296.07it/s]3635it [00:12, 288.03it/s]3668it [00:12, 299.26it/s]3699it [00:12, 298.52it/s]3729it [00:12, 293.22it/s]3762it [00:13, 300.05it/s]3793it [00:13, 300.63it/s]3826it [00:13, 308.26it/s]3857it [00:13, 291.48it/s]3889it [00:13, 296.00it/s]3919it [00:13, 292.56it/s]3949it [00:13, 281.40it/s]3978it [00:13, 278.92it/s]4006it [00:13, 274.38it/s]4038it [00:14, 285.27it/s]4069it [00:14, 291.43it/s]4101it [00:14, 296.54it/s]4131it [00:14, 279.57it/s]4170it [00:14, 304.88it/s]4206it [00:14, 319.97it/s]4240it [00:14, 325.28it/s]4273it [00:14, 323.64it/s]4313it [00:14, 345.58it/s]4348it [00:15, 316.44it/s]4389it [00:15, 342.13it/s]4424it [00:15, 338.40it/s]4459it [00:15, 305.43it/s]4491it [00:15, 304.23it/s]4523it [00:15, 306.57it/s]4560it [00:15, 320.17it/s]4593it [00:15, 316.21it/s]4625it [00:15, 306.84it/s]4656it [00:16, 291.25it/s]4686it [00:16, 286.03it/s]4720it [00:16, 293.88it/s]4750it [00:16, 281.14it/s]4779it [00:16, 273.13it/s]4814it [00:16, 294.02it/s]4845it [00:16, 297.23it/s]4875it [00:16, 292.24it/s]4905it [00:16, 276.72it/s]4937it [00:17, 287.73it/s]4967it [00:17, 281.42it/s]4996it [00:17, 272.96it/s]5031it [00:17, 293.02it/s]5068it [00:17, 314.85it/s]5106it [00:17, 331.01it/s]5149it [00:17, 356.04it/s]5196it [00:17, 385.86it/s]5235it [00:17, 381.34it/s]5274it [00:17, 366.73it/s]5315it [00:18, 377.12it/s]5353it [00:18, 377.41it/s]5396it [00:18, 389.50it/s]5436it [00:18, 382.34it/s]5475it [00:18, 377.27it/s]5517it [00:18, 385.46it/s]5557it [00:18, 388.67it/s]5596it [00:18, 387.36it/s]5652it [00:18, 437.79it/s]5696it [00:19, 242.89it/s]5731it [00:19, 252.93it/s]5775it [00:19, 290.93it/s]5815it [00:19, 312.24it/s]5854it [00:19, 329.06it/s]5900it [00:19, 361.01it/s]5944it [00:19, 381.13it/s]5985it [00:20, 380.93it/s]6027it [00:20, 389.46it/s]6068it [00:20, 375.53it/s]6107it [00:20, 372.90it/s]6145it [00:20, 363.39it/s]6182it [00:20, 363.00it/s]6223it [00:20, 374.29it/s]6263it [00:20, 380.47it/s]6302it [00:20, 378.17it/s]6340it [00:20, 369.40it/s]6390it [00:21, 404.87it/s]6431it [00:21, 394.93it/s]6475it [00:21, 403.68it/s]6516it [00:21, 387.84it/s]6559it [00:21, 397.61it/s]6606it [00:21, 415.14it/s]6648it [00:21, 404.79it/s]6689it [00:21, 400.80it/s]6730it [00:21, 389.81it/s]6772it [00:22, 397.49it/s]6812it [00:22, 383.13it/s]6856it [00:22, 396.12it/s]6898it [00:22, 400.43it/s]6955it [00:22, 445.17it/s]7000it [00:22, 444.61it/s]7049it [00:22, 457.52it/s]7095it [00:22, 406.43it/s]7137it [00:22, 398.96it/s]7178it [00:23, 394.28it/s]7218it [00:23, 385.62it/s]7267it [00:23, 414.23it/s]7309it [00:23, 396.36it/s]7350it [00:23, 392.41it/s]7390it [00:23, 375.13it/s]7428it [00:23, 372.87it/s]7471it [00:23, 387.07it/s]7510it [00:23, 376.76it/s]7552it [00:23, 386.73it/s]7599it [00:24, 410.29it/s]7641it [00:24, 405.86it/s]7682it [00:24, 402.13it/s]7725it [00:24, 405.91it/s]7766it [00:24, 384.30it/s]7807it [00:24, 390.72it/s]7847it [00:24, 386.22it/s]7886it [00:24, 373.04it/s]7924it [00:24, 370.10it/s]7968it [00:25, 387.44it/s]8007it [00:25, 377.42it/s]8055it [00:25, 401.02it/s]8096it [00:25, 383.21it/s]8135it [00:25, 367.47it/s]8172it [00:25, 362.66it/s]8209it [00:25, 364.47it/s]8254it [00:25, 388.39it/s]8296it [00:25, 394.02it/s]8331it [00:25, 320.45it/s]
0it [00:00, ?it/s]28it [00:00, 279.68it/s]71it [00:00, 360.43it/s]115it [00:00, 394.81it/s]159it [00:00, 411.90it/s]201it [00:00, 405.26it/s]242it [00:00, 406.30it/s]283it [00:00, 404.45it/s]326it [00:00, 410.30it/s]371it [00:00, 421.17it/s]414it [00:01, 408.23it/s]455it [00:01, 398.91it/s]495it [00:01, 383.78it/s]536it [00:01, 388.11it/s]560it [00:01, 398.89it/s]
Skipped:
{'total_sents': 9368}

Total: 0
Using model bloom-1b7-intermediate-global_step1000...
Processing UD_Portuguese...
Traceback (most recent call last):
  File "preprocess_treebank.py", line 374, in <module>
    model = BloomModel.from_pretrained(bloom_model, 
  File "/home/s2308470/miniconda3/envs/multilingual-typology-probing/lib/python3.8/site-packages/transformers/modeling_utils.py", line 1878, in to
    return super().to(*args, **kwargs)
  File "/home/s2308470/miniconda3/envs/multilingual-typology-probing/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1145, in to
    return self._apply(convert)
  File "/home/s2308470/miniconda3/envs/multilingual-typology-probing/lib/python3.8/site-packages/torch/nn/modules/module.py", line 797, in _apply
    module._apply(fn)
  File "/home/s2308470/miniconda3/envs/multilingual-typology-probing/lib/python3.8/site-packages/torch/nn/modules/module.py", line 797, in _apply
    module._apply(fn)
  File "/home/s2308470/miniconda3/envs/multilingual-typology-probing/lib/python3.8/site-packages/torch/nn/modules/module.py", line 797, in _apply
    module._apply(fn)
  [Previous line repeated 1 more time]
  File "/home/s2308470/miniconda3/envs/multilingual-typology-probing/lib/python3.8/site-packages/torch/nn/modules/module.py", line 820, in _apply
    param_applied = fn(param)
  File "/home/s2308470/miniconda3/envs/multilingual-typology-probing/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1143, in convert
    return t.to(device, dtype if t.is_floating_point() or t.is_complex() else None, non_blocking)
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 64.00 MiB (GPU 0; 5.94 GiB total capacity; 5.79 GiB already allocated; 35.31 MiB free; 5.79 GiB reserved in total by PyTorch) If reserved memory is >> allocated memory try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF
