python run.py --language UD_Spanish --experiment-name inter-layer-17 --attribute POS --trainer poisson --gpu --embedding bloom-1b1-intermediate-global_step300000 greedy --selection-size 50 --selection-criterion mi
Setting up datasets (['UD_Spanish'], POS) and probes...
  0%|          | 0/343741 [00:00<?, ?it/s]  0%|          | 1598/343741 [00:00<00:21, 15974.87it/s]  1%|          | 3695/343741 [00:00<00:17, 18908.46it/s]  2%|▏         | 5792/343741 [00:00<00:17, 19847.44it/s]  2%|▏         | 7906/343741 [00:00<00:16, 20355.50it/s]  3%|▎         | 9999/343741 [00:00<00:16, 20560.52it/s]  4%|▎         | 12114/343741 [00:00<00:15, 20760.40it/s]  4%|▍         | 14208/343741 [00:00<00:15, 20818.05it/s]  5%|▍         | 16297/343741 [00:00<00:15, 20840.35it/s]  5%|▌         | 18406/343741 [00:00<00:15, 20916.01it/s]  6%|▌         | 20517/343741 [00:01<00:15, 20974.97it/s]  7%|▋         | 22615/343741 [00:01<00:31, 10123.02it/s]  7%|▋         | 24707/343741 [00:01<00:26, 12003.23it/s]  8%|▊         | 26807/343741 [00:01<00:22, 13794.91it/s]  8%|▊         | 28906/343741 [00:01<00:20, 15388.75it/s]  9%|▉         | 31011/343741 [00:01<00:18, 16747.83it/s] 10%|▉         | 32993/343741 [00:01<00:17, 17514.77it/s] 10%|█         | 35102/343741 [00:02<00:16, 18468.92it/s] 11%|█         | 37207/343741 [00:02<00:15, 19179.96it/s] 11%|█▏        | 39309/343741 [00:02<00:15, 19692.64it/s] 12%|█▏        | 41420/343741 [00:02<00:15, 20099.26it/s] 13%|█▎        | 43524/343741 [00:02<00:14, 20372.91it/s] 13%|█▎        | 45633/343741 [00:02<00:14, 20581.61it/s] 14%|█▍        | 47749/343741 [00:02<00:14, 20750.10it/s] 15%|█▍        | 49848/343741 [00:02<00:14, 20820.91it/s] 15%|█▌        | 51969/343741 [00:02<00:13, 20934.20it/s] 16%|█▌        | 54075/343741 [00:02<00:13, 20952.83it/s] 16%|█▋        | 56191/343741 [00:03<00:13, 21012.63it/s] 17%|█▋        | 58298/343741 [00:03<00:14, 20356.80it/s] 18%|█▊        | 60343/343741 [00:03<00:14, 20161.97it/s] 18%|█▊        | 62366/343741 [00:03<00:31, 8980.97it/s]  19%|█▊        | 64314/343741 [00:03<00:26, 10619.44it/s] 19%|█▉        | 66276/343741 [00:03<00:22, 12265.04it/s] 20%|█▉        | 68234/343741 [00:04<00:19, 13780.07it/s] 20%|██        | 70203/343741 [00:04<00:18, 15127.97it/s] 21%|██        | 72060/343741 [00:04<00:17, 15961.57it/s] 22%|██▏       | 74030/343741 [00:04<00:15, 16932.08it/s] 22%|██▏       | 75984/343741 [00:04<00:15, 17637.02it/s] 23%|██▎       | 77951/343741 [00:04<00:14, 18202.10it/s] 23%|██▎       | 79912/343741 [00:04<00:14, 18602.39it/s] 24%|██▍       | 81875/343741 [00:04<00:13, 18896.97it/s] 24%|██▍       | 83838/343741 [00:04<00:13, 19108.39it/s] 25%|██▍       | 85844/343741 [00:04<00:13, 19388.35it/s] 26%|██▌       | 87811/343741 [00:05<00:13, 19434.64it/s] 26%|██▌       | 89789/343741 [00:05<00:12, 19536.81it/s] 27%|██▋       | 91757/343741 [00:05<00:12, 19552.67it/s] 27%|██▋       | 93722/343741 [00:05<00:12, 19329.83it/s] 28%|██▊       | 95681/343741 [00:05<00:12, 19405.26it/s] 28%|██▊       | 97642/343741 [00:05<00:12, 19463.16it/s] 29%|██▉       | 99609/343741 [00:05<00:12, 19523.82it/s] 30%|██▉       | 101585/343741 [00:05<00:12, 19592.15it/s] 30%|███       | 103547/343741 [00:05<00:12, 19572.50it/s] 31%|███       | 105527/343741 [00:06<00:12, 19639.18it/s] 31%|███▏      | 107492/343741 [00:06<00:12, 19631.16it/s] 32%|███▏      | 109457/343741 [00:06<00:11, 19634.85it/s] 32%|███▏      | 111421/343741 [00:06<00:28, 8026.66it/s]  33%|███▎      | 113371/343741 [00:06<00:23, 9734.21it/s] 34%|███▎      | 115361/343741 [00:06<00:19, 11516.28it/s] 34%|███▍      | 117319/343741 [00:07<00:17, 13130.29it/s] 35%|███▍      | 119278/343741 [00:07<00:15, 14566.06it/s] 35%|███▌      | 121239/343741 [00:07<00:14, 15780.62it/s] 36%|███▌      | 123208/343741 [00:07<00:13, 16780.03it/s] 36%|███▋      | 125168/343741 [00:07<00:12, 17534.56it/s] 37%|███▋      | 127135/343741 [00:07<00:11, 18124.20it/s] 38%|███▊      | 129071/343741 [00:07<00:11, 18297.39it/s] 38%|███▊      | 131027/343741 [00:07<00:11, 18657.07it/s] 39%|███▊      | 132992/343741 [00:07<00:11, 18941.63it/s] 39%|███▉      | 134955/343741 [00:07<00:10, 19141.34it/s] 40%|███▉      | 136928/343741 [00:08<00:10, 19313.82it/s] 40%|████      | 138883/343741 [00:08<00:10, 19377.28it/s] 41%|████      | 140853/343741 [00:08<00:10, 19470.43it/s] 42%|████▏     | 142813/343741 [00:08<00:10, 19508.74it/s] 42%|████▏     | 144803/343741 [00:08<00:10, 19623.25it/s] 43%|████▎     | 146771/343741 [00:08<00:10, 19555.17it/s] 43%|████▎     | 148747/343741 [00:08<00:09, 19615.09it/s] 44%|████▍     | 150712/343741 [00:08<00:09, 19373.50it/s] 44%|████▍     | 152691/343741 [00:08<00:09, 19494.68it/s] 45%|████▍     | 154648/343741 [00:08<00:09, 19513.90it/s] 46%|████▌     | 156626/343741 [00:09<00:09, 19592.41it/s] 46%|████▌     | 158587/343741 [00:09<00:09, 19570.42it/s] 47%|████▋     | 160547/343741 [00:09<00:09, 19577.27it/s] 47%|████▋     | 162514/343741 [00:09<00:09, 19604.31it/s] 48%|████▊     | 164483/343741 [00:09<00:09, 19628.68it/s] 48%|████▊     | 166454/343741 [00:09<00:09, 19652.68it/s] 49%|████▉     | 168431/343741 [00:09<00:08, 19687.13it/s] 50%|████▉     | 170400/343741 [00:09<00:08, 19647.20it/s] 50%|█████     | 172379/343741 [00:09<00:08, 19689.39it/s] 51%|█████     | 174349/343741 [00:10<00:08, 19392.17it/s] 51%|█████▏    | 176290/343741 [00:10<00:23, 7246.54it/s]  52%|█████▏    | 178243/343741 [00:10<00:18, 8924.11it/s] 52%|█████▏    | 180204/343741 [00:10<00:15, 10668.20it/s] 53%|█████▎    | 182168/343741 [00:10<00:13, 12364.75it/s] 54%|█████▎    | 184058/343741 [00:11<00:11, 13753.37it/s] 54%|█████▍    | 186017/343741 [00:11<00:10, 15112.46it/s] 55%|█████▍    | 187982/343741 [00:11<00:09, 16245.18it/s] 55%|█████▌    | 189938/343741 [00:11<00:08, 17114.89it/s] 56%|█████▌    | 191911/343741 [00:11<00:08, 17826.79it/s] 56%|█████▋    | 193869/343741 [00:11<00:08, 18317.56it/s] 57%|█████▋    | 195826/343741 [00:11<00:07, 18674.89it/s] 58%|█████▊    | 197794/343741 [00:11<00:07, 18965.98it/s] 58%|█████▊    | 199760/343741 [00:11<00:07, 19168.93it/s] 59%|█████▊    | 201734/343741 [00:11<00:07, 19335.67it/s] 59%|█████▉    | 203727/343741 [00:12<00:07, 19509.90it/s] 60%|█████▉    | 205698/343741 [00:12<00:07, 19564.93it/s] 60%|██████    | 207668/343741 [00:12<00:07, 19340.32it/s] 61%|██████    | 209643/343741 [00:12<00:06, 19458.61it/s] 62%|██████▏   | 211614/343741 [00:12<00:06, 19531.29it/s] 62%|██████▏   | 213585/343741 [00:12<00:06, 19584.01it/s] 63%|██████▎   | 215547/343741 [00:12<00:06, 19579.77it/s] 63%|██████▎   | 217517/343741 [00:12<00:06, 19612.56it/s] 64%|██████▍   | 219481/343741 [00:12<00:06, 19579.16it/s] 64%|██████▍   | 221455/343741 [00:12<00:06, 19625.28it/s] 65%|██████▍   | 223419/343741 [00:13<00:06, 19588.93it/s] 66%|██████▌   | 225384/343741 [00:13<00:06, 19604.80it/s] 66%|██████▌   | 227345/343741 [00:13<00:05, 19602.46it/s] 67%|██████▋   | 229306/343741 [00:13<00:05, 19379.45it/s] 67%|██████▋   | 231270/343741 [00:13<00:05, 19454.05it/s] 68%|██████▊   | 233242/343741 [00:13<00:05, 19531.98it/s] 68%|██████▊   | 235226/343741 [00:13<00:05, 19621.22it/s] 69%|██████▉   | 237189/343741 [00:13<00:05, 19620.17it/s] 70%|██████▉   | 239152/343741 [00:13<00:05, 19593.73it/s] 70%|███████   | 241112/343741 [00:13<00:05, 19524.27it/s] 71%|███████   | 243067/343741 [00:14<00:05, 19531.17it/s] 71%|███████▏  | 245029/343741 [00:14<00:05, 19554.77it/s] 72%|███████▏  | 246994/343741 [00:14<00:04, 19582.40it/s] 72%|███████▏  | 248953/343741 [00:14<00:04, 19568.07it/s] 73%|███████▎  | 250910/343741 [00:14<00:04, 19370.01it/s] 74%|███████▎  | 252862/343741 [00:14<00:04, 19411.81it/s] 74%|███████▍  | 254804/343741 [00:15<00:17, 5104.52it/s]  75%|███████▍  | 256761/343741 [00:15<00:13, 6561.35it/s] 75%|███████▌  | 258722/343741 [00:15<00:10, 8202.19it/s] 76%|███████▌  | 260679/343741 [00:15<00:08, 9927.81it/s] 76%|███████▋  | 262677/343741 [00:16<00:06, 11722.28it/s] 77%|███████▋  | 264631/343741 [00:16<00:05, 13311.07it/s] 78%|███████▊  | 266588/343741 [00:16<00:05, 14718.97it/s] 78%|███████▊  | 268545/343741 [00:16<00:04, 15896.99it/s] 79%|███████▊  | 270509/343741 [00:16<00:04, 16860.27it/s] 79%|███████▉  | 272439/343741 [00:16<00:04, 17423.03it/s] 80%|███████▉  | 274408/343741 [00:16<00:03, 18049.42it/s] 80%|████████  | 276364/343741 [00:16<00:03, 18474.92it/s] 81%|████████  | 278335/343741 [00:16<00:03, 18829.92it/s] 82%|████████▏ | 280285/343741 [00:16<00:03, 19011.28it/s] 82%|████████▏ | 282242/343741 [00:17<00:03, 19172.85it/s] 83%|████████▎ | 284198/343741 [00:17<00:03, 19284.38it/s] 83%|████████▎ | 286162/343741 [00:17<00:02, 19386.61it/s] 84%|████████▍ | 288119/343741 [00:17<00:02, 19438.28it/s] 84%|████████▍ | 290081/343741 [00:17<00:02, 19489.59it/s] 85%|████████▍ | 292039/343741 [00:17<00:02, 19396.91it/s] 86%|████████▌ | 294010/343741 [00:17<00:02, 19487.54it/s] 86%|████████▌ | 295963/343741 [00:17<00:02, 19462.37it/s] 87%|████████▋ | 297916/343741 [00:17<00:02, 19482.04it/s] 87%|████████▋ | 299874/343741 [00:17<00:02, 19508.68it/s] 88%|████████▊ | 301832/343741 [00:18<00:02, 19528.99it/s] 88%|████████▊ | 303797/343741 [00:18<00:02, 19564.23it/s] 89%|████████▉ | 305755/343741 [00:18<00:01, 19557.30it/s] 90%|████████▉ | 307726/343741 [00:18<00:01, 19600.85it/s] 90%|█████████ | 309687/343741 [00:18<00:01, 19547.21it/s] 91%|█████████ | 311642/343741 [00:18<00:01, 19367.38it/s] 91%|█████████ | 313603/343741 [00:18<00:01, 19436.86it/s] 92%|█████████▏| 315559/343741 [00:18<00:01, 19471.73it/s] 92%|█████████▏| 317530/343741 [00:18<00:01, 19540.98it/s] 93%|█████████▎| 319487/343741 [00:18<00:01, 19547.50it/s] 94%|█████████▎| 321488/343741 [00:19<00:01, 19684.63it/s] 94%|█████████▍| 323457/343741 [00:19<00:01, 19628.05it/s] 95%|█████████▍| 325420/343741 [00:19<00:00, 19612.68it/s] 95%|█████████▌| 327384/343741 [00:19<00:00, 19619.87it/s] 96%|█████████▌| 329347/343741 [00:19<00:00, 19604.74it/s] 96%|█████████▋| 331308/343741 [00:19<00:00, 19435.52it/s] 97%|█████████▋| 333265/343741 [00:19<00:00, 19474.43it/s] 98%|█████████▊| 335222/343741 [00:19<00:00, 19500.97it/s] 98%|█████████▊| 337176/343741 [00:19<00:00, 19511.51it/s] 99%|█████████▊| 339128/343741 [00:19<00:00, 19508.74it/s] 99%|█████████▉| 341087/343741 [00:20<00:00, 19530.30it/s]100%|█████████▉| 343048/343741 [00:20<00:00, 19553.51it/s]100%|██████████| 343741/343741 [00:20<00:00, 17039.20it/s]
  0%|          | 0/56357 [00:00<?, ?it/s]  4%|▍         | 2381/56357 [00:00<00:02, 23802.87it/s]  8%|▊         | 4762/56357 [00:00<00:02, 22793.25it/s] 13%|█▎        | 7045/56357 [00:00<00:02, 22533.89it/s] 17%|█▋        | 9300/56357 [00:00<00:02, 22472.44it/s] 21%|██        | 11604/56357 [00:00<00:01, 22670.44it/s] 25%|██▍       | 14048/56357 [00:00<00:01, 23264.61it/s] 29%|██▉       | 16523/56357 [00:00<00:01, 23743.44it/s] 34%|███▎      | 18998/56357 [00:00<00:01, 24061.20it/s] 38%|███▊      | 21452/56357 [00:00<00:01, 24209.90it/s] 42%|████▏     | 23926/56357 [00:01<00:01, 24371.40it/s] 47%|████▋     | 26364/56357 [00:01<00:01, 24367.77it/s] 51%|█████     | 28867/56357 [00:01<00:01, 24561.68it/s] 56%|█████▌    | 31360/56357 [00:01<00:01, 24672.55it/s] 60%|██████    | 33865/56357 [00:01<00:00, 24784.33it/s] 64%|██████▍   | 36344/56357 [00:01<00:00, 24096.66it/s] 69%|██████▉   | 38758/56357 [00:01<00:00, 23073.82it/s] 73%|███████▎  | 41076/56357 [00:01<00:00, 22725.91it/s] 77%|███████▋  | 43356/56357 [00:01<00:00, 22316.79it/s] 81%|████████  | 45593/56357 [00:01<00:00, 22067.01it/s] 85%|████████▍ | 47803/56357 [00:02<00:00, 21993.51it/s] 89%|████████▊ | 50005/56357 [00:02<00:00, 21994.57it/s] 93%|█████████▎| 52206/56357 [00:02<00:00, 21922.21it/s] 97%|█████████▋| 54517/56357 [00:02<00:00, 22270.06it/s]100%|██████████| 56357/56357 [00:02<00:00, 23184.61it/s]
  0%|          | 0/23248 [00:00<?, ?it/s] 10%|█         | 2371/23248 [00:00<00:00, 23704.31it/s] 20%|██        | 4742/23248 [00:00<00:00, 21735.09it/s] 30%|██▉       | 6948/23248 [00:00<00:00, 21872.12it/s] 39%|███▉      | 9142/23248 [00:00<00:00, 21613.40it/s] 50%|████▉     | 11587/23248 [00:00<00:00, 22605.14it/s] 61%|██████    | 14075/23248 [00:00<00:00, 23362.99it/s] 71%|███████▏  | 16569/23248 [00:00<00:00, 23869.26it/s] 82%|████████▏ | 18986/23248 [00:00<00:00, 23963.31it/s] 92%|█████████▏| 21416/23248 [00:00<00:00, 24066.20it/s]100%|██████████| 23248/23248 [00:00<00:00, 23273.47it/s]
dataset loaded from path: 
data/ud/ud-treebanks-v2.1/UD_Spanish/inter-layer-17/UD_Spanish-train-bloom-1b1-intermediate-global_step300000.pkl
data/ud/ud-treebanks-v2.1/UD_Spanish/inter-layer-17/UD_Spanish-dev-bloom-1b1-intermediate-global_step300000.pkl
data/ud/ud-treebanks-v2.1/UD_Spanish/inter-layer-17/UD_Spanish-test-bloom-1b1-intermediate-global_step300000.pkl
Embedding dimensionality: 1536
Pre-training probe (if possible)...
Traceback (most recent call last):
  File "run.py", line 102, in <module>
    args.func(args)
  File "/home/s2308470/multilingual-typology-probing/commands.py", line 166, in greedy
    trainer.train()
  File "/home/s2308470/multilingual-typology-probing/probekit/trainers/trainer.py", line 21, in train
    self._train()
  File "/home/s2308470/multilingual-typology-probing/probekit/trainers/neural_probe_trainer.py", line 30, in _train
    self._train_for_dimensions()
  File "/home/s2308470/multilingual-typology-probing/trainers/flexible_neural_probe_trainer.py", line 72, in _train_for_dimensions
    inputs_tensor_shuffled = inputs_tensor[shuffled_indices]
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 1.63 GiB (GPU 0; 5.94 GiB total capacity; 4.18 GiB already allocated; 1.51 GiB free; 4.21 GiB reserved in total by PyTorch) If reserved memory is >> allocated memory try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF
