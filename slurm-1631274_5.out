now processing task id: 5
CORPUS: UD_English
python preprocess_treebank.py UD_English --experiment-name inter-layer-17 --treebanks-root /home/s2308470/multilingual-typology-probing/data/ud/ud-treebanks-v2.1 --bloom bloom-1b7 --checkpoint 10000 --inter-layer 17 --use-gpu
Embeddings root: embeddings
Using GPU
0it [00:00, ?it/s]42it [00:00, 407.10it/s]83it [00:00, 354.29it/s]119it [00:00, 338.53it/s]170it [00:00, 399.51it/s]211it [00:00, 395.97it/s]306it [00:00, 573.90it/s]377it [00:00, 616.14it/s]454it [00:00, 663.42it/s]536it [00:00, 708.44it/s]608it [00:01, 662.13it/s]678it [00:01, 670.04it/s]757it [00:01, 506.22it/s]837it [00:01, 568.57it/s]901it [00:01, 563.75it/s]964it [00:01, 577.99it/s]1026it [00:01, 544.03it/s]1114it [00:01, 630.47it/s]1195it [00:02, 676.89it/s]1271it [00:02, 698.29it/s]1343it [00:02, 704.14it/s]1415it [00:02, 665.93it/s]1483it [00:02, 624.73it/s]1547it [00:02, 596.11it/s]1655it [00:02, 725.00it/s]1737it [00:02, 750.73it/s]1818it [00:02, 764.20it/s]1896it [00:03, 740.35it/s]1972it [00:03, 728.07it/s]2046it [00:03, 720.10it/s]2077it [00:03, 625.92it/s]
0it [00:00, ?it/s]37it [00:00, 362.72it/s]74it [00:00, 306.57it/s]134it [00:00, 421.16it/s]178it [00:00, 398.01it/s]219it [00:00, 370.72it/s]257it [00:00, 365.05it/s]294it [00:00, 334.84it/s]329it [00:00, 306.37it/s]381it [00:01, 362.05it/s]419it [00:01, 361.84it/s]457it [00:01, 344.21it/s]501it [00:01, 368.00it/s]552it [00:01, 405.64it/s]594it [00:01, 242.24it/s]632it [00:01, 268.84it/s]667it [00:02, 285.60it/s]702it [00:02, 295.09it/s]740it [00:02, 315.78it/s]782it [00:02, 339.46it/s]824it [00:02, 358.76it/s]862it [00:02, 360.65it/s]912it [00:02, 399.45it/s]961it [00:02, 424.95it/s]1010it [00:02, 441.03it/s]1070it [00:02, 484.20it/s]1119it [00:03, 450.02it/s]1165it [00:03, 422.12it/s]1210it [00:03, 429.33it/s]1254it [00:03, 398.67it/s]1295it [00:03, 390.17it/s]1335it [00:03, 390.11it/s]1375it [00:03, 362.60it/s]1412it [00:03, 354.59it/s]1448it [00:04, 341.21it/s]1488it [00:04, 356.34it/s]1524it [00:04, 341.51it/s]1563it [00:04, 352.63it/s]1619it [00:04, 408.27it/s]1688it [00:04, 485.77it/s]1757it [00:04, 544.11it/s]1829it [00:04, 589.77it/s]1915it [00:04, 668.29it/s]1983it [00:04, 643.57it/s]2063it [00:05, 686.52it/s]2133it [00:05, 645.58it/s]2200it [00:05, 651.75it/s]2276it [00:05, 680.47it/s]2345it [00:05, 643.67it/s]2438it [00:05, 722.47it/s]2513it [00:05, 724.06it/s]2587it [00:05, 679.02it/s]2674it [00:05, 730.85it/s]2749it [00:06, 686.87it/s]2823it [00:06, 698.47it/s]2894it [00:06, 429.18it/s]2971it [00:06, 494.89it/s]3039it [00:06, 535.18it/s]3103it [00:06, 541.78it/s]3165it [00:06, 548.90it/s]3237it [00:07, 590.44it/s]3308it [00:07, 622.16it/s]3374it [00:07, 622.97it/s]3439it [00:07, 598.92it/s]3513it [00:07, 636.96it/s]3579it [00:07, 640.67it/s]3645it [00:07, 622.34it/s]3709it [00:07, 599.42it/s]3770it [00:07, 530.71it/s]3825it [00:08, 506.10it/s]3898it [00:08, 563.93it/s]3961it [00:08, 579.70it/s]4021it [00:08, 562.11it/s]4096it [00:08, 613.58it/s]4171it [00:08, 649.18it/s]4239it [00:08, 656.38it/s]4332it [00:08, 735.03it/s]4415it [00:08, 761.58it/s]4504it [00:08, 787.85it/s]4584it [00:09, 756.49it/s]4661it [00:09, 666.69it/s]4730it [00:09, 668.22it/s]4810it [00:09, 700.01it/s]4882it [00:09, 647.21it/s]4959it [00:09, 673.54it/s]5028it [00:09, 665.62it/s]5096it [00:09, 656.74it/s]5163it [00:10, 555.20it/s]5225it [00:10, 570.78it/s]5307it [00:10, 630.96it/s]5373it [00:10, 609.14it/s]5436it [00:10, 558.60it/s]5498it [00:10, 573.48it/s]5557it [00:10, 564.44it/s]5615it [00:10, 563.16it/s]5672it [00:10, 561.62it/s]5729it [00:11, 538.59it/s]5784it [00:11, 502.92it/s]5848it [00:11, 537.22it/s]5903it [00:11, 523.07it/s]5956it [00:11, 474.39it/s]6011it [00:11, 493.83it/s]6062it [00:11, 459.16it/s]6109it [00:12, 239.51it/s]6152it [00:12, 269.41it/s]6190it [00:12, 289.34it/s]6245it [00:12, 343.87it/s]6297it [00:12, 383.66it/s]6343it [00:12, 399.10it/s]6390it [00:12, 417.23it/s]6436it [00:12, 395.86it/s]6485it [00:13, 420.54it/s]6530it [00:13, 423.87it/s]6575it [00:13, 425.64it/s]6624it [00:13, 441.59it/s]6684it [00:13, 485.83it/s]6734it [00:13, 458.81it/s]6781it [00:13, 388.46it/s]6823it [00:13, 331.29it/s]6860it [00:14, 339.53it/s]6900it [00:14, 352.13it/s]6937it [00:14, 354.03it/s]6977it [00:14, 365.59it/s]7017it [00:14, 373.62it/s]7058it [00:14, 383.34it/s]7105it [00:14, 405.73it/s]7153it [00:14, 427.19it/s]7197it [00:14, 428.27it/s]7249it [00:14, 453.05it/s]7303it [00:15, 475.39it/s]7361it [00:15, 503.28it/s]7434it [00:15, 569.87it/s]7492it [00:15, 535.85it/s]7547it [00:15, 518.41it/s]7601it [00:15, 521.23it/s]7654it [00:15, 520.14it/s]7722it [00:15, 563.91it/s]7783it [00:15, 570.97it/s]7841it [00:16, 559.79it/s]7900it [00:16, 566.50it/s]7957it [00:16, 544.29it/s]8012it [00:16, 542.05it/s]8067it [00:16, 529.58it/s]8131it [00:16, 560.20it/s]8188it [00:16, 559.84it/s]8245it [00:16, 523.24it/s]8301it [00:16, 531.12it/s]8355it [00:16, 527.32it/s]8409it [00:17, 497.03it/s]8460it [00:17, 493.41it/s]8510it [00:17, 468.17it/s]8558it [00:17, 453.18it/s]8604it [00:17, 437.40it/s]8652it [00:17, 440.01it/s]8702it [00:17, 453.40it/s]8758it [00:17, 483.25it/s]8815it [00:17, 505.95it/s]8870it [00:18, 517.32it/s]8930it [00:18, 540.16it/s]8985it [00:18, 526.57it/s]9044it [00:18, 542.40it/s]9099it [00:18, 512.34it/s]9151it [00:18, 508.72it/s]9207it [00:18, 522.90it/s]9260it [00:19, 246.15it/s]9309it [00:19, 284.68it/s]9353it [00:19, 313.43it/s]9396it [00:19, 330.84it/s]9453it [00:19, 385.31it/s]9500it [00:19, 393.52it/s]9545it [00:19, 406.11it/s]9595it [00:19, 429.19it/s]9643it [00:20, 442.26it/s]9690it [00:20, 448.48it/s]9737it [00:20, 428.82it/s]9788it [00:20, 450.95it/s]9844it [00:20, 480.68it/s]9908it [00:20, 525.94it/s]9974it [00:20, 562.45it/s]10034it [00:20, 571.26it/s]10099it [00:20, 593.89it/s]10164it [00:20, 609.39it/s]10226it [00:21, 611.62it/s]10288it [00:21, 609.41it/s]10350it [00:21, 605.19it/s]10411it [00:21, 591.89it/s]10471it [00:21, 572.38it/s]10532it [00:21, 582.04it/s]10591it [00:21, 573.78it/s]10649it [00:21, 555.12it/s]10705it [00:21, 555.39it/s]10767it [00:22, 569.62it/s]10825it [00:22, 561.29it/s]10882it [00:22, 556.43it/s]10938it [00:22, 554.31it/s]10994it [00:22, 542.73it/s]11049it [00:22, 536.05it/s]11103it [00:22, 512.33it/s]11160it [00:22, 528.05it/s]11214it [00:22, 521.73it/s]11267it [00:22, 517.07it/s]11319it [00:23, 499.63it/s]11370it [00:23, 490.46it/s]11420it [00:23, 479.72it/s]11469it [00:23, 482.14it/s]11518it [00:23, 475.49it/s]11572it [00:23, 493.30it/s]11624it [00:23, 496.39it/s]11679it [00:23, 507.14it/s]11730it [00:23, 477.05it/s]11779it [00:24, 455.57it/s]11827it [00:24, 460.09it/s]11874it [00:24, 446.57it/s]11919it [00:24, 439.15it/s]11972it [00:24, 462.99it/s]12025it [00:24, 481.31it/s]12074it [00:24, 455.32it/s]12120it [00:24, 452.11it/s]12166it [00:24, 441.01it/s]12211it [00:25, 433.90it/s]12258it [00:25, 442.96it/s]12310it [00:25, 462.07it/s]12357it [00:25, 455.09it/s]12403it [00:25, 430.93it/s]12448it [00:25, 435.43it/s]12494it [00:25, 440.55it/s]12539it [00:25, 411.08it/s]12543it [00:25, 486.33it/s]
0it [00:00, ?it/s]35it [00:00, 347.23it/s]70it [00:00, 333.48it/s]110it [00:00, 356.79it/s]164it [00:00, 426.42it/s]207it [00:00, 424.39it/s]251it [00:00, 428.39it/s]316it [00:00, 498.13it/s]390it [00:00, 573.77it/s]479it [00:00, 668.38it/s]546it [00:01, 653.92it/s]641it [00:01, 738.57it/s]717it [00:01, 742.88it/s]792it [00:01, 738.34it/s]866it [00:01, 722.41it/s]939it [00:01, 669.59it/s]1007it [00:01, 538.67it/s]1066it [00:02, 255.62it/s]1142it [00:02, 325.09it/s]1222it [00:02, 401.44it/s]1283it [00:02, 434.93it/s]1343it [00:02, 462.29it/s]1402it [00:02, 488.91it/s]1470it [00:02, 535.44it/s]1573it [00:03, 662.25it/s]1662it [00:03, 723.35it/s]1745it [00:03, 749.95it/s]1825it [00:03, 746.58it/s]1903it [00:03, 745.16it/s]1980it [00:03, 704.50it/s]2002it [00:03, 551.11it/s]
Skipped:
{'total_sents': 16622}

Total: 0
Using model bloom-1b7-intermediate-global_step10000...
Processing UD_English...
Traceback (most recent call last):
  File "preprocess_treebank.py", line 374, in <module>
    model = BloomModel.from_pretrained(bloom_model, 
  File "/home/s2308470/miniconda3/envs/multilingual-typology-probing/lib/python3.8/site-packages/transformers/modeling_utils.py", line 1878, in to
    return super().to(*args, **kwargs)
  File "/home/s2308470/miniconda3/envs/multilingual-typology-probing/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1145, in to
    return self._apply(convert)
  File "/home/s2308470/miniconda3/envs/multilingual-typology-probing/lib/python3.8/site-packages/torch/nn/modules/module.py", line 797, in _apply
    module._apply(fn)
  File "/home/s2308470/miniconda3/envs/multilingual-typology-probing/lib/python3.8/site-packages/torch/nn/modules/module.py", line 797, in _apply
    module._apply(fn)
  File "/home/s2308470/miniconda3/envs/multilingual-typology-probing/lib/python3.8/site-packages/torch/nn/modules/module.py", line 797, in _apply
    module._apply(fn)
  [Previous line repeated 1 more time]
  File "/home/s2308470/miniconda3/envs/multilingual-typology-probing/lib/python3.8/site-packages/torch/nn/modules/module.py", line 820, in _apply
    param_applied = fn(param)
  File "/home/s2308470/miniconda3/envs/multilingual-typology-probing/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1143, in convert
    return t.to(device, dtype if t.is_floating_point() or t.is_complex() else None, non_blocking)
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 64.00 MiB (GPU 0; 5.94 GiB total capacity; 5.79 GiB already allocated; 35.31 MiB free; 5.79 GiB reserved in total by PyTorch) If reserved memory is >> allocated memory try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF
