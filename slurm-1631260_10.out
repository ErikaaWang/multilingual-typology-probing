now processing task id: 10
CORPUS: UD_Spanish
python preprocess_treebank.py UD_Spanish --experiment-name inter-layer-17 --treebanks-root /home/s2308470/multilingual-typology-probing/data/ud/ud-treebanks-v2.1 --bloom bloom-1b7 --checkpoint 1000 --inter-layer 17 --use-gpu
Embeddings root: embeddings
Using GPU
0it [00:00, ?it/s]19it [00:00, 186.04it/s]48it [00:00, 243.19it/s]83it [00:00, 286.37it/s]116it [00:00, 303.17it/s]150it [00:00, 309.62it/s]181it [00:00, 308.91it/s]215it [00:00, 318.55it/s]247it [00:00, 301.88it/s]283it [00:00, 317.43it/s]315it [00:01, 312.59it/s]353it [00:01, 331.37it/s]387it [00:01, 289.87it/s]423it [00:01, 306.27it/s]455it [00:01, 300.00it/s]487it [00:01, 304.99it/s]522it [00:01, 315.93it/s]561it [00:01, 336.47it/s]598it [00:01, 344.94it/s]633it [00:02, 338.77it/s]670it [00:02, 345.05it/s]707it [00:02, 351.86it/s]743it [00:02, 329.27it/s]777it [00:02, 328.32it/s]811it [00:02, 323.64it/s]844it [00:02, 218.94it/s]882it [00:02, 253.11it/s]913it [00:03, 266.38it/s]946it [00:03, 281.52it/s]979it [00:03, 293.46it/s]1011it [00:03, 300.45it/s]1050it [00:03, 325.27it/s]1084it [00:03, 329.26it/s]1120it [00:03, 336.02it/s]1157it [00:03, 344.78it/s]1197it [00:03, 360.77it/s]1234it [00:03, 354.83it/s]1270it [00:04, 352.04it/s]1306it [00:04, 351.95it/s]1342it [00:04, 344.33it/s]1378it [00:04, 348.22it/s]1417it [00:04, 357.15it/s]1458it [00:04, 368.12it/s]1495it [00:04, 363.76it/s]1532it [00:04, 355.25it/s]1571it [00:04, 363.92it/s]1608it [00:04, 359.26it/s]1644it [00:05, 348.09it/s]1682it [00:05, 354.58it/s]1718it [00:05, 343.92it/s]1757it [00:05, 356.31it/s]1793it [00:05, 348.44it/s]1832it [00:05, 358.40it/s]1868it [00:05, 346.83it/s]1904it [00:05, 349.79it/s]1940it [00:05, 344.84it/s]1975it [00:06, 335.30it/s]2009it [00:06, 320.57it/s]2044it [00:06, 326.46it/s]2079it [00:06, 333.07it/s]2115it [00:06, 337.91it/s]2149it [00:06, 323.50it/s]2182it [00:06, 319.29it/s]2215it [00:06, 320.52it/s]2248it [00:06, 317.40it/s]2280it [00:07, 318.14it/s]2314it [00:07, 322.99it/s]2347it [00:07, 315.56it/s]2382it [00:07, 321.67it/s]2415it [00:07, 316.20it/s]2456it [00:07, 342.58it/s]2493it [00:07, 348.69it/s]2528it [00:07, 341.43it/s]2569it [00:07, 359.59it/s]2606it [00:07, 341.38it/s]2642it [00:08, 346.49it/s]2677it [00:08, 346.96it/s]2712it [00:08, 333.68it/s]2746it [00:08, 335.33it/s]2783it [00:08, 343.63it/s]2818it [00:08, 344.86it/s]2853it [00:08, 338.19it/s]2887it [00:08, 327.01it/s]2921it [00:08, 329.02it/s]2961it [00:09, 344.75it/s]2996it [00:09, 340.38it/s]3031it [00:09, 339.54it/s]3065it [00:09, 204.34it/s]3099it [00:09, 230.61it/s]3130it [00:09, 245.13it/s]3169it [00:09, 278.63it/s]3201it [00:09, 288.88it/s]3237it [00:10, 307.27it/s]3272it [00:10, 317.92it/s]3309it [00:10, 331.71it/s]3345it [00:10, 335.35it/s]3380it [00:10, 336.66it/s]3415it [00:10, 337.91it/s]3456it [00:10, 355.58it/s]3492it [00:10, 350.02it/s]3528it [00:10, 345.14it/s]3566it [00:11, 354.81it/s]3604it [00:11, 360.50it/s]3641it [00:11, 355.57it/s]3681it [00:11, 366.35it/s]3718it [00:11, 361.81it/s]3758it [00:11, 369.14it/s]3795it [00:11, 362.35it/s]3837it [00:11, 377.74it/s]3875it [00:11, 356.70it/s]3914it [00:11, 365.80it/s]3951it [00:12, 361.90it/s]3988it [00:12, 354.96it/s]4024it [00:12, 346.24it/s]4064it [00:12, 357.39it/s]4102it [00:12, 362.04it/s]4139it [00:12, 337.66it/s]4174it [00:12, 332.89it/s]4210it [00:12, 340.20it/s]4246it [00:12, 343.17it/s]4281it [00:13, 335.47it/s]4321it [00:13, 352.04it/s]4357it [00:13, 350.02it/s]4400it [00:13, 372.64it/s]4438it [00:13, 371.66it/s]4476it [00:13, 351.29it/s]4512it [00:13, 346.43it/s]4547it [00:13, 345.59it/s]4582it [00:13, 342.34it/s]4617it [00:13, 340.50it/s]4654it [00:14, 348.23it/s]4689it [00:14, 341.20it/s]4724it [00:14, 339.61it/s]4759it [00:14, 312.05it/s]4791it [00:14, 308.20it/s]4828it [00:14, 324.78it/s]4863it [00:14, 331.74it/s]4904it [00:14, 353.20it/s]4940it [00:14, 353.42it/s]4976it [00:15, 347.23it/s]5014it [00:15, 354.68it/s]5050it [00:15, 344.36it/s]5085it [00:15, 335.78it/s]5119it [00:15, 332.06it/s]5159it [00:15, 345.69it/s]5197it [00:15, 351.28it/s]5233it [00:15, 343.10it/s]5271it [00:15, 352.68it/s]5307it [00:15, 352.17it/s]5343it [00:16, 334.29it/s]5377it [00:16, 332.78it/s]5411it [00:16, 329.77it/s]5445it [00:16, 331.29it/s]5481it [00:16, 335.34it/s]5515it [00:16, 335.24it/s]5550it [00:16, 337.21it/s]5586it [00:16, 342.82it/s]5621it [00:16, 336.52it/s]5656it [00:17, 337.75it/s]5692it [00:17, 342.77it/s]5727it [00:17, 344.12it/s]5763it [00:17, 348.05it/s]5800it [00:17, 352.03it/s]5836it [00:17, 328.11it/s]5870it [00:17, 183.85it/s]5903it [00:18, 209.12it/s]5934it [00:18, 227.78it/s]5968it [00:18, 251.44it/s]6003it [00:18, 274.71it/s]6038it [00:18, 293.41it/s]6077it [00:18, 317.12it/s]6113it [00:18, 327.69it/s]6148it [00:18, 329.66it/s]6185it [00:18, 341.01it/s]6220it [00:19, 331.12it/s]6255it [00:19, 334.40it/s]6289it [00:19, 335.97it/s]6323it [00:19, 331.22it/s]6357it [00:19, 327.40it/s]6390it [00:19, 326.97it/s]6424it [00:19, 329.22it/s]6458it [00:19, 326.96it/s]6491it [00:19, 327.79it/s]6524it [00:19, 327.45it/s]6558it [00:20, 327.24it/s]6594it [00:20, 336.22it/s]6628it [00:20, 335.74it/s]6662it [00:20, 332.31it/s]6696it [00:20, 317.42it/s]6732it [00:20, 329.26it/s]6771it [00:20, 344.67it/s]6807it [00:20, 345.31it/s]6842it [00:20, 343.00it/s]6877it [00:20, 330.42it/s]6914it [00:21, 340.09it/s]6949it [00:21, 336.20it/s]6984it [00:21, 338.78it/s]7020it [00:21, 343.06it/s]7057it [00:21, 348.51it/s]7092it [00:21, 337.40it/s]7129it [00:21, 344.17it/s]7167it [00:21, 354.36it/s]7203it [00:21, 355.80it/s]7239it [00:22, 348.83it/s]7274it [00:22, 344.66it/s]7309it [00:22, 344.06it/s]7344it [00:22, 334.01it/s]7383it [00:22, 350.05it/s]7419it [00:22, 352.89it/s]7458it [00:22, 360.12it/s]7495it [00:22, 349.66it/s]7531it [00:22, 350.53it/s]7568it [00:22, 354.16it/s]7607it [00:23, 361.37it/s]7644it [00:23, 340.53it/s]7679it [00:23, 342.85it/s]7714it [00:23, 336.96it/s]7748it [00:23, 328.65it/s]7782it [00:23, 331.08it/s]7819it [00:23, 340.48it/s]7854it [00:23, 341.61it/s]7889it [00:23, 341.30it/s]7925it [00:24, 344.93it/s]7962it [00:24, 350.96it/s]7998it [00:24, 336.79it/s]8034it [00:24, 342.01it/s]8075it [00:24, 358.96it/s]8112it [00:24, 334.31it/s]8146it [00:24, 332.67it/s]8181it [00:24, 336.66it/s]8217it [00:24, 342.86it/s]8252it [00:24, 333.78it/s]8286it [00:25, 332.58it/s]8320it [00:25, 334.39it/s]8354it [00:25, 330.01it/s]8393it [00:25, 346.56it/s]8428it [00:25, 339.58it/s]8464it [00:25, 341.15it/s]8499it [00:25, 319.79it/s]8536it [00:25, 332.29it/s]8570it [00:25, 333.73it/s]8605it [00:26, 335.67it/s]8639it [00:26, 327.72it/s]8672it [00:26, 323.70it/s]8710it [00:26, 337.12it/s]8744it [00:26, 336.05it/s]8780it [00:26, 340.96it/s]8815it [00:26, 343.34it/s]8850it [00:26, 337.47it/s]8886it [00:26, 341.25it/s]8921it [00:26, 336.70it/s]8955it [00:27, 318.17it/s]8989it [00:27, 323.29it/s]9022it [00:27, 309.63it/s]9057it [00:27, 318.85it/s]9090it [00:27, 312.13it/s]9122it [00:27, 310.17it/s]9158it [00:27, 322.36it/s]9194it [00:27, 331.29it/s]9229it [00:27, 334.69it/s]9265it [00:28, 336.44it/s]9300it [00:28, 340.35it/s]9335it [00:28, 144.68it/s]9371it [00:28, 176.81it/s]9402it [00:28, 198.74it/s]9432it [00:29, 216.76it/s]9463it [00:29, 237.19it/s]9498it [00:29, 263.63it/s]9531it [00:29, 279.22it/s]9566it [00:29, 296.61it/s]9603it [00:29, 315.98it/s]9637it [00:29, 311.51it/s]9671it [00:29, 315.65it/s]9707it [00:29, 327.36it/s]9741it [00:29, 323.67it/s]9774it [00:30, 324.80it/s]9808it [00:30, 327.77it/s]9847it [00:30, 342.17it/s]9882it [00:30, 336.20it/s]9921it [00:30, 348.23it/s]9957it [00:30, 350.50it/s]9993it [00:30, 348.95it/s]10028it [00:30, 338.35it/s]10062it [00:30, 321.48it/s]10097it [00:31, 329.41it/s]10131it [00:31, 316.96it/s]10164it [00:31, 319.03it/s]10198it [00:31, 323.23it/s]10231it [00:31, 323.11it/s]10267it [00:31, 333.15it/s]10304it [00:31, 343.55it/s]10339it [00:31, 344.43it/s]10374it [00:31, 335.82it/s]10413it [00:31, 350.01it/s]10449it [00:32, 334.40it/s]10483it [00:32, 330.94it/s]10519it [00:32, 337.00it/s]10556it [00:32, 344.66it/s]10591it [00:32, 338.47it/s]10625it [00:32, 334.11it/s]10659it [00:32, 326.71it/s]10692it [00:32, 323.61it/s]10728it [00:32, 330.05it/s]10763it [00:33, 334.12it/s]10797it [00:33, 330.24it/s]10834it [00:33, 340.94it/s]10869it [00:33, 331.75it/s]10903it [00:33, 323.01it/s]10939it [00:33, 329.91it/s]10973it [00:33, 318.38it/s]11006it [00:33, 320.78it/s]11040it [00:33, 321.16it/s]11080it [00:33, 342.73it/s]11119it [00:34, 355.03it/s]11155it [00:34, 349.88it/s]11191it [00:34, 341.06it/s]11226it [00:34, 327.74it/s]11259it [00:34, 314.94it/s]11291it [00:34, 306.82it/s]11326it [00:34, 317.56it/s]11359it [00:34, 318.84it/s]11391it [00:34, 316.48it/s]11423it [00:35, 308.83it/s]11462it [00:35, 328.32it/s]11500it [00:35, 341.37it/s]11535it [00:35, 336.43it/s]11569it [00:35, 317.73it/s]11603it [00:35, 323.56it/s]11639it [00:35, 332.64it/s]11673it [00:35, 330.45it/s]11707it [00:35, 330.11it/s]11743it [00:35, 336.29it/s]11778it [00:36, 339.42it/s]11812it [00:36, 326.06it/s]11849it [00:36, 337.92it/s]11883it [00:36, 332.84it/s]11918it [00:36, 337.12it/s]11957it [00:36, 351.81it/s]11993it [00:36, 342.39it/s]12028it [00:36, 343.84it/s]12063it [00:36, 333.70it/s]12098it [00:37, 338.09it/s]12132it [00:37, 337.38it/s]12171it [00:37, 352.33it/s]12207it [00:37, 346.96it/s]12242it [00:37, 334.69it/s]12276it [00:37, 319.27it/s]12311it [00:37, 327.42it/s]12347it [00:37, 334.81it/s]12383it [00:37, 341.45it/s]12423it [00:37, 355.10it/s]12459it [00:38, 348.25it/s]12494it [00:38, 347.84it/s]12532it [00:38, 355.20it/s]12570it [00:38, 359.86it/s]12607it [00:38, 335.62it/s]12644it [00:38, 343.02it/s]12683it [00:38, 356.24it/s]12720it [00:38, 358.40it/s]12757it [00:38, 344.18it/s]12792it [00:39, 341.12it/s]12827it [00:39, 343.63it/s]12862it [00:39, 338.41it/s]12902it [00:39, 352.12it/s]12938it [00:39, 340.10it/s]12977it [00:39, 353.86it/s]13013it [00:39, 346.62it/s]13048it [00:39, 342.72it/s]13083it [00:39, 329.48it/s]13118it [00:40, 334.65it/s]13152it [00:40, 320.12it/s]13188it [00:40, 331.09it/s]13222it [00:40, 333.18it/s]13256it [00:40, 328.30it/s]13295it [00:40, 343.42it/s]13332it [00:40, 349.94it/s]13370it [00:40, 356.36it/s]13410it [00:40, 368.22it/s]13447it [00:40, 364.16it/s]13487it [00:41, 370.10it/s]13525it [00:41, 150.98it/s]13553it [00:41, 168.01it/s]13590it [00:41, 201.42it/s]13623it [00:41, 225.95it/s]13658it [00:42, 252.33it/s]13693it [00:42, 274.02it/s]13729it [00:42, 293.39it/s]13763it [00:42, 298.42it/s]13797it [00:42, 308.26it/s]13832it [00:42, 318.29it/s]13866it [00:42, 310.70it/s]13899it [00:42, 313.37it/s]13932it [00:42, 316.63it/s]13967it [00:43, 325.92it/s]14001it [00:43, 324.30it/s]14035it [00:43, 328.53it/s]14072it [00:43, 339.87it/s]14107it [00:43, 330.30it/s]14149it [00:43, 351.84it/s]14185it [00:43, 329.88it/s]14187it [00:43, 324.92it/s]
0it [00:00, ?it/s]34it [00:00, 331.26it/s]68it [00:00, 335.01it/s]103it [00:00, 341.31it/s]138it [00:00, 341.89it/s]173it [00:00, 333.36it/s]207it [00:00, 333.83it/s]243it [00:00, 339.40it/s]278it [00:00, 342.62it/s]314it [00:00, 347.10it/s]349it [00:01, 344.25it/s]384it [00:01, 343.59it/s]419it [00:01, 335.89it/s]453it [00:01, 332.62it/s]488it [00:01, 334.69it/s]523it [00:01, 338.45it/s]557it [00:01, 338.22it/s]593it [00:01, 343.14it/s]633it [00:01, 359.48it/s]669it [00:01, 356.69it/s]705it [00:02, 347.01it/s]740it [00:02, 339.95it/s]775it [00:02, 326.26it/s]808it [00:02, 317.52it/s]843it [00:02, 324.54it/s]876it [00:02, 321.82it/s]909it [00:02, 315.95it/s]945it [00:02, 328.24it/s]980it [00:02, 331.39it/s]1019it [00:03, 345.31it/s]1058it [00:03, 354.92it/s]1095it [00:03, 357.66it/s]1134it [00:03, 363.14it/s]1171it [00:03, 357.40it/s]1207it [00:03, 352.94it/s]1243it [00:03, 353.38it/s]1279it [00:03, 345.77it/s]1314it [00:03, 342.43it/s]1349it [00:03, 326.17it/s]1385it [00:04, 334.37it/s]1400it [00:04, 339.71it/s]
0it [00:00, ?it/s]28it [00:00, 276.74it/s]64it [00:00, 318.01it/s]97it [00:00, 319.53it/s]129it [00:00, 318.85it/s]164it [00:00, 324.12it/s]197it [00:00, 315.80it/s]232it [00:00, 322.59it/s]265it [00:00, 289.48it/s]295it [00:00, 280.79it/s]324it [00:01, 266.86it/s]352it [00:01, 262.88it/s]409it [00:01, 343.74it/s]426it [00:01, 314.26it/s]
Skipped:
{'total_sents': 16013}

Total: 0
Using model bloom-1b7-intermediate-global_step1000...
Processing UD_Spanish...
Traceback (most recent call last):
  File "preprocess_treebank.py", line 374, in <module>
    model = BloomModel.from_pretrained(bloom_model, 
  File "/home/s2308470/miniconda3/envs/multilingual-typology-probing/lib/python3.8/site-packages/transformers/modeling_utils.py", line 1878, in to
    return super().to(*args, **kwargs)
  File "/home/s2308470/miniconda3/envs/multilingual-typology-probing/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1145, in to
    return self._apply(convert)
  File "/home/s2308470/miniconda3/envs/multilingual-typology-probing/lib/python3.8/site-packages/torch/nn/modules/module.py", line 797, in _apply
    module._apply(fn)
  File "/home/s2308470/miniconda3/envs/multilingual-typology-probing/lib/python3.8/site-packages/torch/nn/modules/module.py", line 797, in _apply
    module._apply(fn)
  File "/home/s2308470/miniconda3/envs/multilingual-typology-probing/lib/python3.8/site-packages/torch/nn/modules/module.py", line 797, in _apply
    module._apply(fn)
  [Previous line repeated 1 more time]
  File "/home/s2308470/miniconda3/envs/multilingual-typology-probing/lib/python3.8/site-packages/torch/nn/modules/module.py", line 820, in _apply
    param_applied = fn(param)
  File "/home/s2308470/miniconda3/envs/multilingual-typology-probing/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1143, in convert
    return t.to(device, dtype if t.is_floating_point() or t.is_complex() else None, non_blocking)
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 64.00 MiB (GPU 0; 5.94 GiB total capacity; 5.79 GiB already allocated; 35.31 MiB free; 5.79 GiB reserved in total by PyTorch) If reserved memory is >> allocated memory try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF
