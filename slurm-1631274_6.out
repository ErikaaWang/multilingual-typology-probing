now processing task id: 6
CORPUS: UD_French
python preprocess_treebank.py UD_French --experiment-name inter-layer-17 --treebanks-root /home/s2308470/multilingual-typology-probing/data/ud/ud-treebanks-v2.1 --bloom bloom-1b7 --checkpoint 10000 --inter-layer 17 --use-gpu
Embeddings root: embeddings
Using GPU
0it [00:00, ?it/s]30it [00:00, 296.71it/s]66it [00:00, 330.14it/s]100it [00:00, 321.89it/s]133it [00:00, 312.03it/s]165it [00:00, 312.27it/s]197it [00:00, 303.41it/s]232it [00:00, 315.46it/s]264it [00:00, 304.62it/s]299it [00:00, 316.97it/s]331it [00:01, 316.51it/s]368it [00:01, 330.31it/s]402it [00:01, 323.11it/s]435it [00:01, 324.13it/s]468it [00:01, 323.62it/s]501it [00:01, 325.31it/s]536it [00:01, 329.28it/s]572it [00:01, 336.51it/s]606it [00:01, 323.42it/s]640it [00:01, 323.89it/s]678it [00:02, 339.87it/s]717it [00:02, 352.01it/s]753it [00:02, 337.23it/s]787it [00:02, 329.73it/s]825it [00:02, 341.61it/s]860it [00:02, 340.89it/s]895it [00:02, 340.77it/s]930it [00:03, 227.50it/s]961it [00:03, 245.09it/s]992it [00:03, 258.78it/s]1029it [00:03, 285.81it/s]1066it [00:03, 305.33it/s]1099it [00:03, 291.40it/s]1133it [00:03, 304.03it/s]1169it [00:03, 318.78it/s]1202it [00:03, 319.56it/s]1240it [00:03, 332.14it/s]1274it [00:04, 330.90it/s]1313it [00:04, 347.44it/s]1349it [00:04, 348.76it/s]1385it [00:04, 333.87it/s]1423it [00:04, 345.02it/s]1458it [00:04, 344.55it/s]1493it [00:04, 345.07it/s]1528it [00:04, 332.13it/s]1563it [00:04, 337.22it/s]1597it [00:05, 320.81it/s]1632it [00:05, 327.72it/s]1666it [00:05, 329.74it/s]1700it [00:05, 325.79it/s]1737it [00:05, 337.93it/s]1772it [00:05, 338.76it/s]1807it [00:05, 337.76it/s]1841it [00:05, 334.04it/s]1878it [00:05, 340.86it/s]1913it [00:05, 343.31it/s]1949it [00:06, 346.55it/s]1989it [00:06, 360.47it/s]2026it [00:06, 334.31it/s]2060it [00:06, 331.03it/s]2100it [00:06, 349.97it/s]2136it [00:06, 347.67it/s]2171it [00:06, 344.57it/s]2206it [00:06, 335.26it/s]2240it [00:06, 330.28it/s]2276it [00:07, 338.44it/s]2310it [00:07, 331.29it/s]2344it [00:07, 329.43it/s]2378it [00:07, 330.84it/s]2412it [00:07, 327.78it/s]2446it [00:07, 327.76it/s]2481it [00:07, 333.83it/s]2518it [00:07, 343.18it/s]2553it [00:07, 320.48it/s]2588it [00:07, 326.49it/s]2627it [00:08, 339.48it/s]2664it [00:08, 345.39it/s]2699it [00:08, 340.95it/s]2734it [00:08, 335.24it/s]2776it [00:08, 357.18it/s]2812it [00:08, 338.15it/s]2847it [00:08, 334.48it/s]2881it [00:08, 330.71it/s]2915it [00:08, 319.16it/s]2948it [00:09, 312.67it/s]2981it [00:09, 316.01it/s]3018it [00:09, 329.66it/s]3054it [00:09, 336.37it/s]3093it [00:09, 350.34it/s]3129it [00:09, 347.57it/s]3168it [00:09, 358.68it/s]3204it [00:09, 354.31it/s]3241it [00:09, 358.42it/s]3277it [00:09, 343.53it/s]3312it [00:10, 209.11it/s]3343it [00:10, 228.58it/s]3384it [00:10, 268.12it/s]3417it [00:10, 276.14it/s]3457it [00:10, 303.58it/s]3496it [00:10, 325.82it/s]3533it [00:10, 337.72it/s]3569it [00:11, 341.42it/s]3605it [00:11, 326.08it/s]3640it [00:11, 332.09it/s]3675it [00:11, 334.87it/s]3711it [00:11, 338.36it/s]3746it [00:11, 339.89it/s]3784it [00:11, 350.06it/s]3820it [00:11, 341.44it/s]3862it [00:11, 360.09it/s]3899it [00:11, 349.19it/s]3935it [00:12, 346.65it/s]3974it [00:12, 354.79it/s]4014it [00:12, 366.73it/s]4054it [00:12, 374.16it/s]4092it [00:12, 368.61it/s]4129it [00:12, 368.91it/s]4166it [00:12, 367.89it/s]4203it [00:12, 344.34it/s]4238it [00:12, 326.12it/s]4274it [00:13, 334.76it/s]4309it [00:13, 337.78it/s]4345it [00:13, 340.73it/s]4381it [00:13, 343.07it/s]4417it [00:13, 347.26it/s]4452it [00:13, 346.56it/s]4488it [00:13, 349.37it/s]4523it [00:13, 338.42it/s]4558it [00:13, 340.76it/s]4593it [00:13, 341.95it/s]4628it [00:14, 337.69it/s]4662it [00:14, 330.07it/s]4700it [00:14, 342.49it/s]4735it [00:14, 340.48it/s]4770it [00:14, 336.62it/s]4804it [00:14, 321.04it/s]4839it [00:14, 328.65it/s]4879it [00:14, 347.80it/s]4914it [00:14, 340.87it/s]4951it [00:15, 346.99it/s]4986it [00:15, 336.54it/s]5025it [00:15, 351.79it/s]5061it [00:15, 340.91it/s]5096it [00:15, 327.96it/s]5134it [00:15, 341.45it/s]5171it [00:15, 344.86it/s]5206it [00:15, 336.14it/s]5240it [00:15, 326.78it/s]5273it [00:16, 327.51it/s]5307it [00:16, 329.97it/s]5341it [00:16, 319.60it/s]5374it [00:16, 314.20it/s]5411it [00:16, 329.49it/s]5447it [00:16, 337.94it/s]5481it [00:16, 296.02it/s]5513it [00:16, 301.46it/s]5545it [00:16, 305.32it/s]5581it [00:16, 320.21it/s]5614it [00:17, 314.99it/s]5648it [00:17, 318.87it/s]5682it [00:17, 320.70it/s]5720it [00:17, 334.60it/s]5754it [00:17, 332.04it/s]5789it [00:17, 333.25it/s]5824it [00:17, 336.82it/s]5858it [00:17, 318.08it/s]5891it [00:17, 304.42it/s]5927it [00:18, 319.38it/s]5963it [00:18, 330.41it/s]5999it [00:18, 338.77it/s]6034it [00:18, 340.42it/s]6070it [00:18, 345.56it/s]6105it [00:18, 338.55it/s]6139it [00:18, 331.71it/s]6173it [00:18, 329.32it/s]6207it [00:18, 331.58it/s]6241it [00:18, 330.37it/s]6275it [00:19, 330.63it/s]6317it [00:19, 353.53it/s]6353it [00:19, 185.35it/s]6386it [00:19, 210.71it/s]6416it [00:19, 227.10it/s]6451it [00:19, 253.15it/s]6482it [00:20, 245.93it/s]6517it [00:20, 268.75it/s]6550it [00:20, 281.56it/s]6584it [00:20, 296.74it/s]6624it [00:20, 322.22it/s]6663it [00:20, 341.13it/s]6699it [00:20, 333.95it/s]6735it [00:20, 338.18it/s]6770it [00:20, 340.33it/s]6807it [00:20, 346.43it/s]6842it [00:21, 337.25it/s]6876it [00:21, 323.99it/s]6911it [00:21, 331.18it/s]6948it [00:21, 342.08it/s]6983it [00:21, 334.02it/s]7017it [00:21, 318.03it/s]7053it [00:21, 328.21it/s]7092it [00:21, 345.41it/s]7127it [00:21, 346.21it/s]7163it [00:22, 347.06it/s]7198it [00:22, 339.05it/s]7233it [00:22, 327.39it/s]7275it [00:22, 352.54it/s]7311it [00:22, 350.51it/s]7347it [00:22, 352.74it/s]7384it [00:22, 356.72it/s]7420it [00:22, 345.79it/s]7455it [00:22, 346.44it/s]7490it [00:22, 333.69it/s]7525it [00:23, 336.91it/s]7562it [00:23, 338.74it/s]7599it [00:23, 345.33it/s]7634it [00:23, 335.33it/s]7668it [00:23, 330.58it/s]7702it [00:23, 331.63it/s]7736it [00:23, 324.31it/s]7774it [00:23, 339.12it/s]7812it [00:23, 349.75it/s]7848it [00:24, 333.91it/s]7882it [00:24, 333.49it/s]7916it [00:24, 334.14it/s]7950it [00:24, 333.91it/s]7984it [00:24, 329.79it/s]8019it [00:24, 333.92it/s]8056it [00:24, 343.14it/s]8091it [00:24, 337.57it/s]8125it [00:24, 328.72it/s]8158it [00:24, 326.12it/s]8193it [00:25, 332.25it/s]8227it [00:25, 326.69it/s]8261it [00:25, 330.01it/s]8297it [00:25, 337.01it/s]8331it [00:25, 328.36it/s]8374it [00:25, 351.89it/s]8412it [00:25, 357.59it/s]8448it [00:25, 342.24it/s]8483it [00:25, 330.60it/s]8519it [00:26, 335.98it/s]8556it [00:26, 344.20it/s]8591it [00:26, 340.36it/s]8626it [00:26, 339.59it/s]8661it [00:26, 334.41it/s]8695it [00:26, 333.96it/s]8729it [00:26, 331.39it/s]8763it [00:26, 314.63it/s]8797it [00:26, 321.07it/s]8834it [00:27, 333.75it/s]8868it [00:27, 334.74it/s]8902it [00:27, 332.64it/s]8937it [00:27, 337.45it/s]8974it [00:27, 346.74it/s]9009it [00:27, 347.67it/s]9044it [00:27, 346.25it/s]9081it [00:27, 352.56it/s]9117it [00:27, 344.28it/s]9152it [00:27, 336.36it/s]9186it [00:28, 335.40it/s]9221it [00:28, 338.02it/s]9257it [00:28, 342.15it/s]9292it [00:28, 325.20it/s]9327it [00:28, 331.17it/s]9362it [00:28, 334.24it/s]9401it [00:28, 348.44it/s]9436it [00:28, 342.60it/s]9471it [00:28, 343.38it/s]9509it [00:28, 350.01it/s]9546it [00:29, 354.75it/s]9582it [00:29, 349.31it/s]9617it [00:29, 344.10it/s]9652it [00:29, 339.11it/s]9690it [00:29, 348.92it/s]9725it [00:29, 332.13it/s]9759it [00:29, 311.32it/s]9791it [00:29, 300.79it/s]9826it [00:29, 313.92it/s]9858it [00:30, 304.29it/s]9892it [00:30, 313.95it/s]9927it [00:30, 323.08it/s]9963it [00:30, 331.02it/s]9997it [00:30, 329.27it/s]10031it [00:31, 148.57it/s]10063it [00:31, 174.78it/s]10097it [00:31, 204.78it/s]10136it [00:31, 240.92it/s]10175it [00:31, 274.00it/s]10211it [00:31, 293.60it/s]10246it [00:31, 305.56it/s]10289it [00:31, 336.27it/s]10326it [00:31, 334.69it/s]10362it [00:31, 332.92it/s]10402it [00:32, 350.77it/s]10439it [00:32, 336.47it/s]10474it [00:32, 327.54it/s]10509it [00:32, 332.11it/s]10544it [00:32, 334.74it/s]10579it [00:32, 337.35it/s]10613it [00:32, 337.41it/s]10652it [00:32, 349.08it/s]10688it [00:32, 341.94it/s]10723it [00:33, 322.91it/s]10756it [00:33, 305.93it/s]10790it [00:33, 314.69it/s]10826it [00:33, 326.77it/s]10859it [00:33, 319.90it/s]10892it [00:33, 315.71it/s]10933it [00:33, 341.57it/s]10968it [00:33, 337.87it/s]11003it [00:33, 339.80it/s]11038it [00:33, 337.51it/s]11075it [00:34, 346.68it/s]11113it [00:34, 351.61it/s]11149it [00:34, 347.82it/s]11184it [00:34, 333.89it/s]11218it [00:34, 329.90it/s]11256it [00:34, 342.28it/s]11291it [00:34, 338.52it/s]11325it [00:34, 328.73it/s]11358it [00:34, 318.02it/s]11390it [00:35, 310.80it/s]11424it [00:35, 318.10it/s]11458it [00:35, 322.20it/s]11491it [00:35, 312.66it/s]11528it [00:35, 326.15it/s]11561it [00:35, 314.56it/s]11593it [00:35, 274.50it/s]11622it [00:35, 212.53it/s]11658it [00:36, 243.87it/s]11686it [00:36, 211.73it/s]11722it [00:36, 243.32it/s]11756it [00:36, 264.92it/s]11793it [00:36, 290.73it/s]11826it [00:36, 300.21it/s]11858it [00:36, 295.37it/s]11893it [00:36, 310.03it/s]11934it [00:36, 337.98it/s]11969it [00:37, 340.51it/s]12009it [00:37, 354.68it/s]12047it [00:37, 359.67it/s]12085it [00:37, 363.74it/s]12122it [00:37, 333.54it/s]12159it [00:37, 341.83it/s]12194it [00:37, 339.56it/s]12230it [00:37, 344.95it/s]12265it [00:37, 330.64it/s]12299it [00:38, 282.97it/s]12335it [00:38, 300.66it/s]12367it [00:38, 302.76it/s]12399it [00:38, 304.07it/s]12431it [00:38, 302.37it/s]12468it [00:38, 318.06it/s]12501it [00:38, 273.78it/s]12533it [00:38, 285.39it/s]12563it [00:38, 287.67it/s]12594it [00:39, 291.71it/s]12624it [00:39, 293.23it/s]12656it [00:39, 298.72it/s]12693it [00:39, 319.26it/s]12726it [00:39, 316.65it/s]12763it [00:39, 331.81it/s]12799it [00:39, 336.75it/s]12834it [00:39, 333.77it/s]12868it [00:39, 308.74it/s]12907it [00:40, 330.88it/s]12941it [00:40, 331.37it/s]12975it [00:40, 322.14it/s]13008it [00:40, 323.71it/s]13041it [00:40, 296.00it/s]13075it [00:40, 304.18it/s]13112it [00:40, 322.27it/s]13147it [00:40, 326.25it/s]13180it [00:40, 324.70it/s]13213it [00:40, 324.60it/s]13246it [00:41, 322.14it/s]13280it [00:41, 327.12it/s]13314it [00:41, 330.71it/s]13351it [00:41, 340.20it/s]13386it [00:41, 335.42it/s]13420it [00:41, 330.22it/s]13454it [00:41, 324.42it/s]13488it [00:41, 327.19it/s]13522it [00:41, 327.68it/s]13555it [00:42, 326.50it/s]13590it [00:42, 331.92it/s]13625it [00:42, 334.59it/s]13659it [00:42, 325.87it/s]13693it [00:42, 323.77it/s]13729it [00:42, 330.53it/s]13763it [00:42, 333.26it/s]13799it [00:42, 339.08it/s]13834it [00:42, 339.42it/s]13871it [00:42, 347.67it/s]13906it [00:43, 346.58it/s]13942it [00:43, 349.69it/s]13977it [00:43, 349.63it/s]14012it [00:43, 344.27it/s]14047it [00:43, 343.90it/s]14082it [00:43, 342.99it/s]14117it [00:43, 341.28it/s]14154it [00:43, 347.48it/s]14190it [00:43, 348.56it/s]14225it [00:43, 347.55it/s]14262it [00:44, 347.28it/s]14298it [00:44, 350.37it/s]14334it [00:44, 348.42it/s]14369it [00:44, 338.76it/s]14405it [00:44, 343.20it/s]14440it [00:44, 333.41it/s]14474it [00:44, 334.10it/s]14508it [00:44, 325.37it/s]14549it [00:44, 346.82it/s]14554it [00:44, 323.68it/s]
0it [00:00, ?it/s]25it [00:00, 43.19it/s]61it [00:00, 105.55it/s]95it [00:00, 156.76it/s]126it [00:00, 192.97it/s]163it [00:00, 236.98it/s]195it [00:01, 255.46it/s]228it [00:01, 270.22it/s]260it [00:01, 279.19it/s]291it [00:01, 286.64it/s]329it [00:01, 311.83it/s]363it [00:01, 318.69it/s]399it [00:01, 329.88it/s]433it [00:01, 330.98it/s]467it [00:01, 328.31it/s]501it [00:02, 325.62it/s]534it [00:02, 321.01it/s]567it [00:02, 315.77it/s]603it [00:02, 328.19it/s]639it [00:02, 334.16it/s]674it [00:02, 337.94it/s]710it [00:02, 342.30it/s]748it [00:02, 352.93it/s]786it [00:02, 358.96it/s]822it [00:02, 338.54it/s]857it [00:03, 335.63it/s]892it [00:03, 337.88it/s]926it [00:03, 333.02it/s]965it [00:03, 348.23it/s]1000it [00:03, 334.38it/s]1034it [00:03, 317.99it/s]1072it [00:03, 333.88it/s]1107it [00:03, 335.51it/s]1141it [00:03, 332.44it/s]1179it [00:04, 345.62it/s]1214it [00:04, 346.03it/s]1249it [00:04, 321.88it/s]1284it [00:04, 328.95it/s]1323it [00:04, 343.48it/s]1358it [00:04, 331.62it/s]1392it [00:04, 327.30it/s]1425it [00:04, 326.64it/s]1458it [00:04, 317.04it/s]1478it [00:04, 298.04it/s]
0it [00:00, ?it/s]32it [00:00, 308.00it/s]65it [00:00, 320.41it/s]98it [00:00, 301.66it/s]129it [00:00, 291.67it/s]162it [00:00, 278.14it/s]193it [00:00, 285.88it/s]239it [00:00, 337.61it/s]281it [00:00, 361.01it/s]320it [00:00, 368.12it/s]358it [00:01, 355.23it/s]394it [00:01, 339.10it/s]416it [00:01, 327.85it/s]
Skipped:
{'total_sents': 16448}

Total: 0
Using model bloom-1b7-intermediate-global_step10000...
Processing UD_French...
Traceback (most recent call last):
  File "preprocess_treebank.py", line 374, in <module>
    model = BloomModel.from_pretrained(bloom_model, 
  File "/home/s2308470/miniconda3/envs/multilingual-typology-probing/lib/python3.8/site-packages/transformers/modeling_utils.py", line 1878, in to
    return super().to(*args, **kwargs)
  File "/home/s2308470/miniconda3/envs/multilingual-typology-probing/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1145, in to
    return self._apply(convert)
  File "/home/s2308470/miniconda3/envs/multilingual-typology-probing/lib/python3.8/site-packages/torch/nn/modules/module.py", line 797, in _apply
    module._apply(fn)
  File "/home/s2308470/miniconda3/envs/multilingual-typology-probing/lib/python3.8/site-packages/torch/nn/modules/module.py", line 797, in _apply
    module._apply(fn)
  File "/home/s2308470/miniconda3/envs/multilingual-typology-probing/lib/python3.8/site-packages/torch/nn/modules/module.py", line 797, in _apply
    module._apply(fn)
  [Previous line repeated 1 more time]
  File "/home/s2308470/miniconda3/envs/multilingual-typology-probing/lib/python3.8/site-packages/torch/nn/modules/module.py", line 820, in _apply
    param_applied = fn(param)
  File "/home/s2308470/miniconda3/envs/multilingual-typology-probing/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1143, in convert
    return t.to(device, dtype if t.is_floating_point() or t.is_complex() else None, non_blocking)
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 64.00 MiB (GPU 0; 5.94 GiB total capacity; 5.79 GiB already allocated; 35.31 MiB free; 5.79 GiB reserved in total by PyTorch) If reserved memory is >> allocated memory try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF
