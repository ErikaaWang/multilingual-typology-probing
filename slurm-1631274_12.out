now processing task id: 12
CORPUS: UD_Urdu
python preprocess_treebank.py UD_Urdu --experiment-name inter-layer-17 --treebanks-root /home/s2308470/multilingual-typology-probing/data/ud/ud-treebanks-v2.1 --bloom bloom-1b7 --checkpoint 10000 --inter-layer 17 --use-gpu
Embeddings root: embeddings
Using GPU
0it [00:00, ?it/s]23it [00:00, 229.58it/s]50it [00:00, 238.79it/s]76it [00:00, 246.57it/s]107it [00:00, 269.97it/s]141it [00:00, 291.28it/s]171it [00:00, 281.53it/s]201it [00:00, 285.43it/s]230it [00:00, 281.12it/s]260it [00:00, 285.64it/s]289it [00:01, 277.38it/s]323it [00:01, 293.58it/s]353it [00:01, 292.02it/s]392it [00:01, 320.02it/s]425it [00:01, 295.32it/s]455it [00:01, 268.75it/s]486it [00:01, 278.29it/s]515it [00:01, 278.04it/s]535it [00:01, 281.51it/s]
0it [00:00, ?it/s]31it [00:00, 296.48it/s]65it [00:00, 312.71it/s]97it [00:00, 307.53it/s]128it [00:00, 287.23it/s]160it [00:00, 295.99it/s]190it [00:00, 273.34it/s]219it [00:00, 271.13it/s]247it [00:01, 185.18it/s]279it [00:01, 213.97it/s]314it [00:01, 245.40it/s]342it [00:01, 246.94it/s]374it [00:01, 265.27it/s]417it [00:01, 307.17it/s]452it [00:01, 315.66it/s]485it [00:01, 315.08it/s]523it [00:01, 332.31it/s]557it [00:02, 296.54it/s]590it [00:02, 305.40it/s]622it [00:02, 303.10it/s]653it [00:02, 299.76it/s]684it [00:02, 293.25it/s]719it [00:02, 308.09it/s]751it [00:02, 304.25it/s]782it [00:02, 291.58it/s]812it [00:02, 269.98it/s]840it [00:02, 270.27it/s]868it [00:03, 267.62it/s]898it [00:03, 276.10it/s]931it [00:03, 287.37it/s]960it [00:03, 271.56it/s]989it [00:03, 275.86it/s]1022it [00:03, 289.94it/s]1052it [00:03, 284.08it/s]1083it [00:03, 291.43it/s]1113it [00:03, 292.68it/s]1143it [00:04, 283.54it/s]1177it [00:04, 296.62it/s]1209it [00:04, 302.73it/s]1240it [00:04, 295.35it/s]1270it [00:04, 295.57it/s]1300it [00:04, 284.96it/s]1330it [00:04, 288.62it/s]1366it [00:04, 307.78it/s]1400it [00:04, 315.92it/s]1432it [00:05, 311.66it/s]1464it [00:05, 305.57it/s]1497it [00:05, 312.01it/s]1529it [00:05, 300.47it/s]1560it [00:05, 301.99it/s]1591it [00:05, 293.22it/s]1622it [00:05, 296.39it/s]1655it [00:05, 303.91it/s]1686it [00:05, 288.68it/s]1716it [00:05, 281.41it/s]1747it [00:06, 287.62it/s]1776it [00:06, 286.09it/s]1807it [00:06, 292.63it/s]1837it [00:06, 288.92it/s]1866it [00:06, 283.48it/s]1895it [00:06, 278.85it/s]1927it [00:06, 289.49it/s]1958it [00:06, 294.37it/s]1990it [00:06, 298.35it/s]2022it [00:07, 303.27it/s]2053it [00:07, 285.32it/s]2082it [00:07, 281.92it/s]2112it [00:07, 285.60it/s]2145it [00:07, 297.50it/s]2175it [00:07, 287.54it/s]2209it [00:07, 301.60it/s]2240it [00:07, 292.82it/s]2274it [00:07, 304.04it/s]2305it [00:08, 176.12it/s]2336it [00:08, 201.48it/s]2364it [00:08, 216.81it/s]2396it [00:08, 240.19it/s]2430it [00:08, 264.38it/s]2460it [00:08, 261.47it/s]2489it [00:08, 264.22it/s]2521it [00:08, 279.01it/s]2551it [00:09, 281.41it/s]2585it [00:09, 296.85it/s]2618it [00:09, 303.92it/s]2650it [00:09, 307.70it/s]2682it [00:09, 284.22it/s]2714it [00:09, 292.49it/s]2749it [00:09, 306.90it/s]2781it [00:09, 301.62it/s]2816it [00:09, 311.40it/s]2850it [00:10, 314.53it/s]2882it [00:10, 296.42it/s]2917it [00:10, 310.90it/s]2949it [00:10, 292.40it/s]2984it [00:10, 306.60it/s]3017it [00:10, 312.17it/s]3049it [00:10, 289.46it/s]3079it [00:10, 292.32it/s]3114it [00:10, 307.60it/s]3146it [00:11, 307.58it/s]3184it [00:11, 328.28it/s]3218it [00:11, 307.97it/s]3250it [00:11, 277.01it/s]3279it [00:11, 273.23it/s]3318it [00:11, 301.85it/s]3353it [00:11, 313.41it/s]3389it [00:11, 325.78it/s]3423it [00:11, 311.58it/s]3455it [00:12, 284.17it/s]3491it [00:12, 302.70it/s]3522it [00:12, 300.34it/s]3554it [00:12, 305.29it/s]3585it [00:12, 290.91it/s]3615it [00:12, 289.69it/s]3645it [00:12, 277.12it/s]3677it [00:12, 288.65it/s]3708it [00:12, 290.76it/s]3738it [00:13, 280.09it/s]3767it [00:13, 274.34it/s]3796it [00:13, 277.13it/s]3824it [00:13, 265.34it/s]3853it [00:13, 271.03it/s]3888it [00:13, 292.49it/s]3921it [00:13, 300.66it/s]3956it [00:13, 312.46it/s]3988it [00:13, 303.10it/s]4019it [00:13, 296.91it/s]4043it [00:14, 287.09it/s]
0it [00:00, ?it/s]25it [00:00, 248.30it/s]63it [00:00, 322.34it/s]97it [00:00, 325.67it/s]132it [00:00, 332.86it/s]166it [00:00, 333.39it/s]200it [00:00, 307.24it/s]232it [00:00, 286.99it/s]263it [00:00, 291.60it/s]293it [00:00, 282.98it/s]322it [00:01, 283.85it/s]354it [00:01, 292.73it/s]384it [00:01, 277.41it/s]420it [00:01, 296.83it/s]450it [00:01, 295.98it/s]480it [00:01, 295.02it/s]512it [00:01, 300.94it/s]543it [00:01, 295.88it/s]552it [00:01, 298.98it/s]
Skipped:
{'total_sents': 5130}

Total: 0
Using model bloom-1b7-intermediate-global_step10000...
Processing UD_Urdu...
Traceback (most recent call last):
  File "preprocess_treebank.py", line 374, in <module>
    model = BloomModel.from_pretrained(bloom_model, 
  File "/home/s2308470/miniconda3/envs/multilingual-typology-probing/lib/python3.8/site-packages/transformers/modeling_utils.py", line 1878, in to
    return super().to(*args, **kwargs)
  File "/home/s2308470/miniconda3/envs/multilingual-typology-probing/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1145, in to
    return self._apply(convert)
  File "/home/s2308470/miniconda3/envs/multilingual-typology-probing/lib/python3.8/site-packages/torch/nn/modules/module.py", line 797, in _apply
    module._apply(fn)
  File "/home/s2308470/miniconda3/envs/multilingual-typology-probing/lib/python3.8/site-packages/torch/nn/modules/module.py", line 797, in _apply
    module._apply(fn)
  File "/home/s2308470/miniconda3/envs/multilingual-typology-probing/lib/python3.8/site-packages/torch/nn/modules/module.py", line 797, in _apply
    module._apply(fn)
  [Previous line repeated 1 more time]
  File "/home/s2308470/miniconda3/envs/multilingual-typology-probing/lib/python3.8/site-packages/torch/nn/modules/module.py", line 820, in _apply
    param_applied = fn(param)
  File "/home/s2308470/miniconda3/envs/multilingual-typology-probing/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1143, in convert
    return t.to(device, dtype if t.is_floating_point() or t.is_complex() else None, non_blocking)
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 64.00 MiB (GPU 0; 5.94 GiB total capacity; 5.79 GiB already allocated; 35.31 MiB free; 5.79 GiB reserved in total by PyTorch) If reserved memory is >> allocated memory try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF
