now processing task id: 7
CORPUS: UD_Hindi
python preprocess_treebank.py UD_Hindi --experiment-name inter-layer-17 --treebanks-root /home/s2308470/multilingual-typology-probing/data/ud/ud-treebanks-v2.1 --bloom bloom-1b7 --checkpoint 10000 --inter-layer 17 --use-gpu
Embeddings root: embeddings
Using GPU
0it [00:00, ?it/s]32it [00:00, 314.02it/s]77it [00:00, 392.04it/s]121it [00:00, 411.48it/s]168it [00:00, 432.39it/s]212it [00:00, 431.13it/s]263it [00:00, 456.93it/s]311it [00:00, 463.99it/s]358it [00:00, 461.18it/s]405it [00:00, 455.43it/s]452it [00:01, 458.41it/s]498it [00:01, 457.74it/s]545it [00:01, 460.21it/s]592it [00:01, 439.37it/s]637it [00:01, 432.17it/s]681it [00:01, 407.91it/s]723it [00:01, 369.18it/s]761it [00:01, 353.61it/s]801it [00:01, 364.43it/s]838it [00:02, 351.67it/s]876it [00:02, 352.62it/s]912it [00:02, 327.23it/s]952it [00:02, 345.86it/s]988it [00:02, 332.26it/s]1025it [00:02, 341.73it/s]1060it [00:02, 217.51it/s]1095it [00:03, 243.95it/s]1133it [00:03, 273.94it/s]1169it [00:03, 293.26it/s]1203it [00:03, 295.38it/s]1247it [00:03, 331.99it/s]1285it [00:03, 342.27it/s]1321it [00:03, 343.86it/s]1357it [00:03, 347.79it/s]1393it [00:03, 343.78it/s]1429it [00:03, 345.39it/s]1466it [00:04, 350.30it/s]1502it [00:04, 343.35it/s]1537it [00:04, 327.34it/s]1571it [00:04, 324.79it/s]1608it [00:04, 335.51it/s]1642it [00:04, 335.15it/s]1676it [00:04, 334.53it/s]1712it [00:04, 340.73it/s]1747it [00:04, 338.55it/s]1781it [00:04, 338.02it/s]1816it [00:05, 339.00it/s]1852it [00:05, 342.58it/s]1887it [00:05, 327.58it/s]1923it [00:05, 334.20it/s]1957it [00:05, 329.16it/s]1995it [00:05, 341.89it/s]2035it [00:05, 356.94it/s]2071it [00:05, 350.83it/s]2107it [00:05, 341.56it/s]2143it [00:06, 345.65it/s]2178it [00:06, 345.75it/s]2213it [00:06, 336.86it/s]2248it [00:06, 339.33it/s]2282it [00:06, 331.72it/s]2316it [00:06, 331.01it/s]2351it [00:06, 333.37it/s]2392it [00:06, 354.56it/s]2428it [00:06, 340.13it/s]2463it [00:07, 326.13it/s]2496it [00:07, 323.68it/s]2532it [00:07, 333.81it/s]2566it [00:07, 331.77it/s]2600it [00:07, 330.71it/s]2638it [00:07, 343.32it/s]2673it [00:07, 326.13it/s]2706it [00:07, 320.22it/s]2739it [00:07, 320.10it/s]2774it [00:07, 327.96it/s]2807it [00:08, 328.08it/s]2841it [00:08, 329.48it/s]2875it [00:08, 330.95it/s]2909it [00:08, 318.24it/s]2962it [00:08, 378.02it/s]3001it [00:08, 368.95it/s]3039it [00:08, 365.57it/s]3076it [00:08, 358.19it/s]3114it [00:08, 362.80it/s]3151it [00:09, 364.52it/s]3188it [00:09, 339.61it/s]3223it [00:09, 340.62it/s]3258it [00:09, 327.84it/s]3292it [00:09, 325.61it/s]3325it [00:09, 315.93it/s]3367it [00:09, 342.04it/s]3403it [00:09, 345.34it/s]3440it [00:09, 352.19it/s]3476it [00:10, 332.90it/s]3513it [00:10, 342.10it/s]3552it [00:10, 355.72it/s]3588it [00:10, 351.41it/s]3625it [00:10, 352.92it/s]3661it [00:10, 332.27it/s]3696it [00:10, 335.02it/s]3730it [00:11, 186.76it/s]3765it [00:11, 215.93it/s]3794it [00:11, 222.08it/s]3822it [00:11, 211.32it/s]3861it [00:11, 250.61it/s]3892it [00:11, 263.79it/s]3922it [00:11, 266.43it/s]3957it [00:11, 287.14it/s]3993it [00:11, 305.38it/s]4030it [00:12, 322.66it/s]4068it [00:12, 335.27it/s]4103it [00:12, 320.20it/s]4136it [00:12, 321.16it/s]4169it [00:12, 323.08it/s]4212it [00:12, 352.98it/s]4248it [00:12, 288.84it/s]4289it [00:12, 316.94it/s]4323it [00:12, 315.83it/s]4358it [00:13, 323.91it/s]4398it [00:13, 343.92it/s]4434it [00:13, 330.86it/s]4468it [00:13, 323.88it/s]4510it [00:13, 350.36it/s]4546it [00:13, 351.91it/s]4582it [00:13, 335.22it/s]4616it [00:13, 321.14it/s]4649it [00:13, 315.80it/s]4683it [00:14, 318.76it/s]4719it [00:14, 328.29it/s]4755it [00:14, 336.26it/s]4791it [00:14, 342.14it/s]4826it [00:14, 318.68it/s]4861it [00:14, 327.06it/s]4895it [00:14, 313.06it/s]4927it [00:14, 305.08it/s]4962it [00:14, 317.39it/s]5001it [00:14, 336.14it/s]5035it [00:15, 324.16it/s]5076it [00:15, 346.95it/s]5114it [00:15, 353.77it/s]5150it [00:15, 328.15it/s]5184it [00:15, 327.76it/s]5218it [00:15, 330.35it/s]5254it [00:15, 336.21it/s]5288it [00:15, 336.45it/s]5329it [00:15, 356.46it/s]5365it [00:16, 343.21it/s]5400it [00:16, 324.69it/s]5433it [00:16, 316.06it/s]5467it [00:16, 322.09it/s]5502it [00:16, 328.52it/s]5539it [00:16, 339.30it/s]5577it [00:16, 350.07it/s]5613it [00:16, 352.94it/s]5654it [00:16, 367.39it/s]5693it [00:16, 373.36it/s]5731it [00:17, 368.52it/s]5768it [00:17, 341.81it/s]5805it [00:17, 348.88it/s]5841it [00:17, 349.92it/s]5877it [00:17, 347.70it/s]5913it [00:17, 350.35it/s]5949it [00:17, 339.28it/s]5985it [00:17, 344.44it/s]6021it [00:17, 348.59it/s]6056it [00:18, 325.87it/s]6092it [00:18, 335.30it/s]6132it [00:18, 352.85it/s]6172it [00:18, 364.88it/s]6210it [00:18, 368.62it/s]6248it [00:18, 349.05it/s]6284it [00:18, 336.86it/s]6318it [00:18, 334.07it/s]6353it [00:18, 337.50it/s]6387it [00:19, 329.91it/s]6421it [00:19, 323.07it/s]6463it [00:19, 348.96it/s]6500it [00:19, 353.99it/s]6538it [00:19, 360.27it/s]6575it [00:19, 346.67it/s]6613it [00:19, 355.04it/s]6651it [00:19, 361.55it/s]6688it [00:19, 336.34it/s]6725it [00:19, 345.44it/s]6760it [00:20, 333.48it/s]6794it [00:20, 330.09it/s]6830it [00:20, 338.49it/s]6865it [00:20, 326.44it/s]6898it [00:20, 158.77it/s]6932it [00:21, 188.23it/s]6965it [00:21, 213.43it/s]7001it [00:21, 244.02it/s]7032it [00:21, 256.69it/s]7070it [00:21, 287.08it/s]7111it [00:21, 317.43it/s]7149it [00:21, 331.35it/s]7191it [00:21, 354.39it/s]7229it [00:21, 350.42it/s]7266it [00:21, 346.64it/s]7302it [00:22, 345.95it/s]7339it [00:22, 349.57it/s]7375it [00:22, 348.29it/s]7413it [00:22, 357.15it/s]7449it [00:22, 344.44it/s]7484it [00:22, 345.34it/s]7522it [00:22, 352.25it/s]7558it [00:22, 338.84it/s]7593it [00:22, 332.56it/s]7630it [00:22, 342.14it/s]7675it [00:23, 372.12it/s]7713it [00:23, 358.37it/s]7750it [00:23, 347.98it/s]7786it [00:23, 337.75it/s]7824it [00:23, 348.19it/s]7860it [00:23, 345.39it/s]7897it [00:23, 351.37it/s]7933it [00:23, 352.86it/s]7969it [00:23, 351.76it/s]8005it [00:24, 338.82it/s]8040it [00:24, 323.95it/s]8073it [00:24, 318.79it/s]8108it [00:24, 324.70it/s]8143it [00:24, 330.83it/s]8179it [00:24, 337.08it/s]8213it [00:24, 335.31it/s]8247it [00:24, 330.88it/s]8287it [00:24, 350.47it/s]8323it [00:25, 342.69it/s]8358it [00:25, 338.39it/s]8396it [00:25, 349.78it/s]8432it [00:25, 329.60it/s]8467it [00:25, 335.20it/s]8501it [00:25, 333.55it/s]8537it [00:25, 340.90it/s]8574it [00:25, 345.77it/s]8609it [00:25, 332.19it/s]8646it [00:25, 339.91it/s]8687it [00:26, 358.88it/s]8724it [00:26, 354.82it/s]8761it [00:26, 357.07it/s]8797it [00:26, 335.35it/s]8833it [00:26, 341.29it/s]8868it [00:26, 339.29it/s]8907it [00:26, 353.08it/s]8943it [00:26, 349.58it/s]8980it [00:26, 353.62it/s]9017it [00:27, 357.86it/s]9057it [00:27, 368.57it/s]9094it [00:27, 360.72it/s]9131it [00:27, 357.72it/s]9167it [00:27, 350.57it/s]9203it [00:27, 345.02it/s]9238it [00:27, 334.02it/s]9280it [00:27, 356.60it/s]9316it [00:27, 354.43it/s]9357it [00:27, 368.00it/s]9396it [00:28, 371.50it/s]9434it [00:28, 372.43it/s]9472it [00:28, 344.99it/s]9507it [00:28, 332.23it/s]9541it [00:28, 329.66it/s]9575it [00:28, 317.23it/s]9608it [00:28, 317.82it/s]9646it [00:28, 333.87it/s]9683it [00:28, 343.08it/s]9718it [00:29, 340.68it/s]9753it [00:29, 331.42it/s]9793it [00:29, 350.91it/s]9830it [00:29, 355.13it/s]9875it [00:29, 380.91it/s]9914it [00:29, 346.55it/s]9951it [00:29, 351.27it/s]9987it [00:29, 353.59it/s]10023it [00:29, 352.57it/s]10059it [00:30, 336.80it/s]10096it [00:30, 341.74it/s]10131it [00:30, 334.41it/s]10165it [00:30, 327.62it/s]10199it [00:30, 328.11it/s]10232it [00:30, 325.89it/s]10265it [00:30, 319.55it/s]10299it [00:30, 325.08it/s]10332it [00:30, 313.41it/s]10364it [00:30, 311.64it/s]10398it [00:31, 316.91it/s]10430it [00:31, 315.53it/s]10464it [00:31, 321.30it/s]10500it [00:31, 331.27it/s]10534it [00:31, 317.23it/s]10568it [00:31, 322.60it/s]10601it [00:31, 319.93it/s]10635it [00:31, 325.53it/s]10669it [00:31, 328.51it/s]10703it [00:32, 329.96it/s]10737it [00:32, 317.84it/s]10769it [00:32, 317.51it/s]10807it [00:32, 334.79it/s]10841it [00:32, 328.77it/s]10874it [00:32, 314.59it/s]10908it [00:33, 133.06it/s]10947it [00:33, 169.58it/s]10979it [00:33, 194.54it/s]11018it [00:33, 231.74it/s]11050it [00:33, 246.18it/s]11084it [00:33, 266.68it/s]11120it [00:33, 289.29it/s]11153it [00:33, 284.06it/s]11185it [00:34, 292.34it/s]11217it [00:34, 298.50it/s]11249it [00:34, 295.15it/s]11280it [00:34, 298.46it/s]11315it [00:34, 312.16it/s]11348it [00:34, 316.35it/s]11381it [00:34, 313.21it/s]11413it [00:34, 313.20it/s]11450it [00:34, 328.90it/s]11485it [00:34, 331.19it/s]11520it [00:35, 333.25it/s]11555it [00:35, 335.71it/s]11589it [00:35, 336.96it/s]11625it [00:35, 342.14it/s]11661it [00:35, 346.86it/s]11696it [00:35, 345.45it/s]11735it [00:35, 358.30it/s]11771it [00:35, 351.51it/s]11807it [00:35, 347.92it/s]11845it [00:35, 354.71it/s]11881it [00:36, 344.57it/s]11916it [00:36, 338.79it/s]11950it [00:36, 319.94it/s]11984it [00:36, 324.28it/s]12021it [00:36, 336.44it/s]12055it [00:36, 329.54it/s]12089it [00:36, 318.08it/s]12128it [00:36, 337.14it/s]12162it [00:36, 336.13it/s]12196it [00:37, 330.69it/s]12230it [00:37, 315.56it/s]12263it [00:37, 317.62it/s]12309it [00:37, 357.34it/s]12346it [00:37, 356.98it/s]12383it [00:37, 359.35it/s]12420it [00:37, 361.91it/s]12457it [00:37, 346.50it/s]12492it [00:37, 331.17it/s]12526it [00:38, 332.32it/s]12561it [00:38, 335.93it/s]12595it [00:38, 337.04it/s]12629it [00:38, 323.19it/s]12662it [00:38, 322.56it/s]12698it [00:38, 330.07it/s]12735it [00:38, 341.42it/s]12777it [00:38, 362.98it/s]12814it [00:38, 363.84it/s]12851it [00:38, 355.09it/s]12887it [00:39, 352.28it/s]12923it [00:39, 347.12it/s]12960it [00:39, 350.15it/s]12997it [00:39, 353.97it/s]13033it [00:39, 353.45it/s]13069it [00:39, 342.63it/s]13104it [00:39, 336.29it/s]13138it [00:39, 313.53it/s]13171it [00:39, 316.59it/s]13203it [00:40, 307.15it/s]13234it [00:40, 289.89it/s]13264it [00:40, 289.72it/s]13298it [00:40, 303.73it/s]13304it [00:40, 329.57it/s]
0it [00:00, ?it/s]35it [00:00, 343.69it/s]86it [00:00, 437.08it/s]130it [00:00, 421.24it/s]173it [00:00, 383.73it/s]212it [00:00, 359.34it/s]249it [00:00, 351.31it/s]287it [00:00, 358.60it/s]324it [00:00, 343.93it/s]359it [00:00, 343.92it/s]394it [00:01, 331.13it/s]428it [00:01, 327.48it/s]464it [00:01, 336.71it/s]498it [00:01, 333.02it/s]532it [00:01, 323.90it/s]566it [00:01, 324.24it/s]601it [00:01, 329.38it/s]634it [00:01, 328.53it/s]669it [00:01, 332.76it/s]703it [00:02, 320.14it/s]736it [00:02, 319.53it/s]769it [00:02, 321.56it/s]802it [00:02, 318.25it/s]836it [00:02, 322.00it/s]869it [00:02, 322.26it/s]902it [00:02, 324.33it/s]942it [00:02, 345.67it/s]985it [00:02, 368.47it/s]1022it [00:02, 348.43it/s]1058it [00:03, 335.49it/s]1094it [00:03, 342.13it/s]1130it [00:03, 344.49it/s]1165it [00:03, 330.69it/s]1199it [00:03, 332.16it/s]1233it [00:03, 312.84it/s]1275it [00:03, 340.42it/s]1312it [00:03, 344.89it/s]1347it [00:03, 335.27it/s]1381it [00:04, 334.04it/s]1417it [00:04, 340.98it/s]1456it [00:04, 353.94it/s]1492it [00:04, 348.10it/s]1527it [00:04, 333.49it/s]1566it [00:04, 348.09it/s]1601it [00:04, 340.74it/s]1636it [00:04, 329.20it/s]1659it [00:04, 338.74it/s]
0it [00:00, ?it/s]36it [00:00, 353.69it/s]83it [00:00, 416.00it/s]125it [00:00, 365.66it/s]163it [00:00, 364.32it/s]200it [00:00, 364.94it/s]237it [00:00, 340.77it/s]272it [00:00, 342.28it/s]307it [00:00, 331.99it/s]341it [00:00, 330.10it/s]375it [00:01, 319.48it/s]408it [00:01, 312.74it/s]445it [00:01, 328.06it/s]479it [00:01, 328.11it/s]513it [00:01, 329.62it/s]547it [00:01, 331.44it/s]584it [00:01, 339.75it/s]622it [00:01, 351.52it/s]659it [00:01, 355.35it/s]696it [00:02, 357.60it/s]732it [00:02, 343.95it/s]767it [00:02, 341.74it/s]802it [00:02, 322.98it/s]835it [00:02, 315.49it/s]872it [00:02, 330.28it/s]906it [00:03, 108.31it/s]943it [00:03, 138.37it/s]973it [00:03, 160.46it/s]1006it [00:03, 188.94it/s]1043it [00:03, 223.11it/s]1080it [00:03, 254.80it/s]1118it [00:04, 283.49it/s]1153it [00:04, 295.23it/s]1187it [00:04, 287.85it/s]1219it [00:04, 287.98it/s]1256it [00:04, 307.77it/s]1289it [00:04, 309.52it/s]1322it [00:04, 310.15it/s]1356it [00:04, 316.18it/s]1391it [00:04, 325.11it/s]1429it [00:04, 337.63it/s]1465it [00:05, 342.17it/s]1500it [00:05, 340.41it/s]1539it [00:05, 353.73it/s]1578it [00:05, 362.48it/s]1620it [00:05, 377.06it/s]1658it [00:05, 372.11it/s]1684it [00:05, 297.84it/s]
Skipped:
{'total_sents': 16647}

Total: 0
Using model bloom-1b7-intermediate-global_step10000...
Processing UD_Hindi...
Traceback (most recent call last):
  File "preprocess_treebank.py", line 374, in <module>
    model = BloomModel.from_pretrained(bloom_model, 
  File "/home/s2308470/miniconda3/envs/multilingual-typology-probing/lib/python3.8/site-packages/transformers/modeling_utils.py", line 1878, in to
    return super().to(*args, **kwargs)
  File "/home/s2308470/miniconda3/envs/multilingual-typology-probing/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1145, in to
    return self._apply(convert)
  File "/home/s2308470/miniconda3/envs/multilingual-typology-probing/lib/python3.8/site-packages/torch/nn/modules/module.py", line 797, in _apply
    module._apply(fn)
  File "/home/s2308470/miniconda3/envs/multilingual-typology-probing/lib/python3.8/site-packages/torch/nn/modules/module.py", line 797, in _apply
    module._apply(fn)
  File "/home/s2308470/miniconda3/envs/multilingual-typology-probing/lib/python3.8/site-packages/torch/nn/modules/module.py", line 797, in _apply
    module._apply(fn)
  [Previous line repeated 1 more time]
  File "/home/s2308470/miniconda3/envs/multilingual-typology-probing/lib/python3.8/site-packages/torch/nn/modules/module.py", line 820, in _apply
    param_applied = fn(param)
  File "/home/s2308470/miniconda3/envs/multilingual-typology-probing/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1143, in convert
    return t.to(device, dtype if t.is_floating_point() or t.is_complex() else None, non_blocking)
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 64.00 MiB (GPU 0; 5.94 GiB total capacity; 5.79 GiB already allocated; 35.31 MiB free; 5.79 GiB reserved in total by PyTorch) If reserved memory is >> allocated memory try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF
