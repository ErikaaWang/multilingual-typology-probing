now processing task id: 3
CORPUS: UD_Chinese
python preprocess_treebank.py UD_Chinese --experiment-name inter-layer-17 --treebanks-root /home/s2308470/multilingual-typology-probing/data/ud/ud-treebanks-v2.1 --bloom bloom-1b7 --checkpoint 1000 --inter-layer 17 --use-gpu
Embeddings root: embeddings
Using GPU
0it [00:00, ?it/s]25it [00:00, 244.76it/s]53it [00:00, 263.06it/s]82it [00:00, 271.96it/s]116it [00:00, 293.11it/s]150it [00:00, 303.87it/s]188it [00:00, 328.24it/s]225it [00:00, 337.97it/s]259it [00:00, 328.82it/s]294it [00:00, 332.83it/s]328it [00:01, 334.43it/s]362it [00:01, 335.94it/s]396it [00:01, 334.50it/s]430it [00:01, 333.16it/s]468it [00:01, 346.39it/s]500it [00:01, 324.37it/s]
0it [00:00, ?it/s]18it [00:00, 178.57it/s]53it [00:00, 276.21it/s]89it [00:00, 306.26it/s]129it [00:00, 340.70it/s]169it [00:00, 359.82it/s]205it [00:00, 323.39it/s]238it [00:00, 324.14it/s]282it [00:00, 357.01it/s]328it [00:00, 387.77it/s]368it [00:01, 251.81it/s]411it [00:01, 286.38it/s]446it [00:01, 297.97it/s]480it [00:01, 306.66it/s]514it [00:01, 304.45it/s]552it [00:01, 322.30it/s]586it [00:01, 326.93it/s]622it [00:01, 336.03it/s]657it [00:02, 338.50it/s]692it [00:02, 321.96it/s]725it [00:02, 320.77it/s]758it [00:02, 316.96it/s]793it [00:02, 323.27it/s]831it [00:02, 336.32it/s]865it [00:02, 333.84it/s]899it [00:02, 334.24it/s]933it [00:02, 324.90it/s]970it [00:03, 336.98it/s]1007it [00:03, 343.84it/s]1043it [00:03, 347.00it/s]1078it [00:03, 342.02it/s]1115it [00:03, 349.54it/s]1151it [00:03, 340.75it/s]1186it [00:03, 337.06it/s]1222it [00:03, 340.98it/s]1257it [00:03, 336.07it/s]1291it [00:03, 336.97it/s]1325it [00:04, 335.79it/s]1362it [00:04, 344.75it/s]1397it [00:04, 344.21it/s]1432it [00:04, 331.26it/s]1466it [00:04, 326.47it/s]1499it [00:04, 309.18it/s]1531it [00:04, 307.97it/s]1568it [00:04, 324.70it/s]1604it [00:04, 334.45it/s]1638it [00:05, 325.03it/s]1674it [00:05, 332.31it/s]1710it [00:05, 338.22it/s]1744it [00:05, 324.30it/s]1777it [00:05, 314.72it/s]1809it [00:05, 315.41it/s]1841it [00:05, 310.82it/s]1881it [00:05, 334.84it/s]1917it [00:05, 341.45it/s]1956it [00:05, 353.96it/s]1994it [00:06, 361.45it/s]2032it [00:06, 366.64it/s]2069it [00:06, 344.67it/s]2104it [00:06, 337.27it/s]2138it [00:06, 330.08it/s]2172it [00:06, 328.80it/s]2208it [00:06, 335.81it/s]2242it [00:06, 327.12it/s]2275it [00:06, 317.50it/s]2307it [00:07, 317.46it/s]2343it [00:07, 326.95it/s]2376it [00:07, 324.63it/s]2410it [00:07, 326.56it/s]2447it [00:07, 339.11it/s]2487it [00:07, 354.34it/s]2523it [00:07, 345.82it/s]2558it [00:07, 345.55it/s]2593it [00:08, 209.75it/s]2629it [00:08, 239.58it/s]2663it [00:08, 261.77it/s]2696it [00:08, 276.42it/s]2728it [00:08, 283.93it/s]2765it [00:08, 303.28it/s]2799it [00:08, 310.25it/s]2836it [00:08, 326.65it/s]2872it [00:08, 334.82it/s]2909it [00:09, 343.01it/s]2950it [00:09, 358.91it/s]2987it [00:09, 353.62it/s]3025it [00:09, 358.47it/s]3062it [00:09, 356.57it/s]3098it [00:09, 345.54it/s]3133it [00:09, 342.23it/s]3170it [00:09, 348.43it/s]3207it [00:09, 351.35it/s]3243it [00:09, 352.98it/s]3279it [00:10, 333.00it/s]3316it [00:10, 342.82it/s]3351it [00:10, 344.53it/s]3388it [00:10, 350.78it/s]3424it [00:10, 351.24it/s]3460it [00:10, 353.79it/s]3497it [00:10, 353.27it/s]3533it [00:10, 336.79it/s]3567it [00:10, 321.19it/s]3600it [00:11, 322.86it/s]3633it [00:11, 320.88it/s]3666it [00:11, 321.43it/s]3702it [00:11, 331.41it/s]3736it [00:11, 328.99it/s]3769it [00:11, 326.28it/s]3804it [00:11, 332.33it/s]3839it [00:11, 335.51it/s]3874it [00:11, 337.57it/s]3908it [00:11, 331.55it/s]3947it [00:12, 346.01it/s]3987it [00:12, 361.27it/s]3997it [00:12, 327.93it/s]
0it [00:00, ?it/s]27it [00:00, 267.97it/s]64it [00:00, 319.64it/s]101it [00:00, 341.97it/s]139it [00:00, 354.01it/s]175it [00:00, 345.73it/s]211it [00:00, 349.48it/s]250it [00:00, 361.03it/s]287it [00:00, 345.43it/s]324it [00:00, 352.49it/s]360it [00:01, 340.28it/s]395it [00:01, 336.50it/s]431it [00:01, 342.65it/s]469it [00:01, 352.59it/s]500it [00:01, 344.28it/s]
Skipped:
{'total_sents': 4997}

Total: 0
Using model bloom-1b7-intermediate-global_step1000...
Processing UD_Chinese...
Traceback (most recent call last):
  File "preprocess_treebank.py", line 374, in <module>
    model = BloomModel.from_pretrained(bloom_model, 
  File "/home/s2308470/miniconda3/envs/multilingual-typology-probing/lib/python3.8/site-packages/transformers/modeling_utils.py", line 1878, in to
    return super().to(*args, **kwargs)
  File "/home/s2308470/miniconda3/envs/multilingual-typology-probing/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1145, in to
    return self._apply(convert)
  File "/home/s2308470/miniconda3/envs/multilingual-typology-probing/lib/python3.8/site-packages/torch/nn/modules/module.py", line 797, in _apply
    module._apply(fn)
  File "/home/s2308470/miniconda3/envs/multilingual-typology-probing/lib/python3.8/site-packages/torch/nn/modules/module.py", line 797, in _apply
    module._apply(fn)
  File "/home/s2308470/miniconda3/envs/multilingual-typology-probing/lib/python3.8/site-packages/torch/nn/modules/module.py", line 797, in _apply
    module._apply(fn)
  [Previous line repeated 1 more time]
  File "/home/s2308470/miniconda3/envs/multilingual-typology-probing/lib/python3.8/site-packages/torch/nn/modules/module.py", line 820, in _apply
    param_applied = fn(param)
  File "/home/s2308470/miniconda3/envs/multilingual-typology-probing/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1143, in convert
    return t.to(device, dtype if t.is_floating_point() or t.is_complex() else None, non_blocking)
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 64.00 MiB (GPU 0; 5.94 GiB total capacity; 5.79 GiB already allocated; 35.31 MiB free; 5.79 GiB reserved in total by PyTorch) If reserved memory is >> allocated memory try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF
