python run.py --language UD_Catalan --experiment-name inter-layer-17 --attribute POS --trainer poisson --gpu --embedding bloom-1b1-intermediate-global_step500000 greedy --selection-size 50 --selection-criterion mi
Setting up datasets (['UD_Catalan'], POS) and probes...
  0%|          | 0/441656 [00:00<?, ?it/s]  0%|          | 1919/441656 [00:00<00:22, 19183.98it/s]  1%|          | 4856/441656 [00:00<00:17, 25169.70it/s]  2%|▏         | 7807/441656 [00:00<00:15, 27148.12it/s]  2%|▏         | 10678/441656 [00:00<00:15, 27760.97it/s]  3%|▎         | 13650/441656 [00:00<00:15, 28463.83it/s]  4%|▍         | 16604/441656 [00:00<00:14, 28828.68it/s]  4%|▍         | 19512/441656 [00:00<00:14, 28909.78it/s]  5%|▌         | 22448/441656 [00:00<00:14, 29051.75it/s]  6%|▌         | 25403/441656 [00:00<00:14, 29206.04it/s]  6%|▋         | 28359/441656 [00:01<00:14, 29313.24it/s]  7%|▋         | 31344/441656 [00:01<00:13, 29476.82it/s]  8%|▊         | 34292/441656 [00:01<00:13, 29435.04it/s]  8%|▊         | 37236/441656 [00:01<00:34, 11817.71it/s]  9%|▉         | 40131/441656 [00:01<00:27, 14345.61it/s] 10%|▉         | 42958/441656 [00:01<00:23, 16772.96it/s] 10%|█         | 45930/441656 [00:02<00:20, 19354.31it/s] 11%|█         | 48808/441656 [00:02<00:18, 21443.21it/s] 12%|█▏        | 51760/441656 [00:02<00:16, 23384.48it/s] 12%|█▏        | 54708/441656 [00:02<00:15, 24838.97it/s] 13%|█▎        | 57699/441656 [00:02<00:14, 26190.58it/s] 14%|█▎        | 60695/441656 [00:02<00:13, 27229.71it/s] 14%|█▍        | 63608/441656 [00:02<00:13, 27740.87it/s] 15%|█▌        | 66602/441656 [00:02<00:13, 28372.33it/s] 16%|█▌        | 69537/441656 [00:02<00:13, 28534.21it/s] 16%|█▋        | 72509/441656 [00:02<00:12, 28880.71it/s] 17%|█▋        | 75446/441656 [00:03<00:12, 28601.35it/s] 18%|█▊        | 78341/441656 [00:03<00:12, 28578.41it/s] 18%|█▊        | 81304/441656 [00:03<00:12, 28886.20it/s] 19%|█▉        | 84245/441656 [00:03<00:12, 29038.64it/s] 20%|█▉        | 87162/441656 [00:04<00:32, 10794.69it/s] 20%|██        | 90103/441656 [00:04<00:26, 13329.18it/s] 21%|██        | 92869/441656 [00:04<00:22, 15661.90it/s] 22%|██▏       | 95838/441656 [00:04<00:18, 18309.03it/s] 22%|██▏       | 98816/441656 [00:04<00:16, 20744.11it/s] 23%|██▎       | 101726/441656 [00:04<00:14, 22688.48it/s] 24%|██▎       | 104706/441656 [00:04<00:13, 24462.18it/s] 24%|██▍       | 107650/441656 [00:04<00:12, 25769.11it/s] 25%|██▌       | 110600/441656 [00:04<00:12, 26784.86it/s] 26%|██▌       | 113608/441656 [00:04<00:11, 27707.50it/s] 26%|██▋       | 116588/441656 [00:05<00:11, 28304.70it/s] 27%|██▋       | 119559/441656 [00:05<00:11, 28710.80it/s] 28%|██▊       | 122513/441656 [00:05<00:11, 28913.66it/s] 28%|██▊       | 125463/441656 [00:05<00:11, 28727.86it/s] 29%|██▉       | 128383/441656 [00:05<00:10, 28840.20it/s] 30%|██▉       | 131368/441656 [00:05<00:10, 29136.57it/s] 30%|███       | 134313/441656 [00:05<00:10, 29227.42it/s] 31%|███       | 137251/441656 [00:05<00:10, 29221.50it/s] 32%|███▏      | 140224/441656 [00:05<00:10, 29370.11it/s] 32%|███▏      | 143169/441656 [00:05<00:10, 29120.10it/s] 33%|███▎      | 146125/441656 [00:06<00:10, 29248.01it/s] 34%|███▍      | 149112/441656 [00:06<00:09, 29432.81it/s] 34%|███▍      | 152059/441656 [00:07<00:34, 8302.90it/s]  35%|███▌      | 154977/441656 [00:07<00:27, 10543.97it/s] 36%|███▌      | 157939/441656 [00:07<00:21, 13079.88it/s] 36%|███▋      | 160818/441656 [00:07<00:18, 15587.04it/s] 37%|███▋      | 163777/441656 [00:07<00:15, 18186.92it/s] 38%|███▊      | 166649/441656 [00:07<00:13, 20167.51it/s] 38%|███▊      | 169590/441656 [00:07<00:12, 22278.45it/s] 39%|███▉      | 172572/441656 [00:07<00:11, 24132.44it/s] 40%|███▉      | 175469/441656 [00:07<00:10, 25388.73it/s] 40%|████      | 178442/441656 [00:08<00:09, 26562.92it/s] 41%|████      | 181378/441656 [00:08<00:09, 27342.38it/s] 42%|████▏     | 184331/441656 [00:08<00:09, 27965.25it/s] 42%|████▏     | 187293/441656 [00:08<00:08, 28442.50it/s] 43%|████▎     | 190228/441656 [00:08<00:08, 28640.21it/s] 44%|████▎     | 193213/441656 [00:08<00:08, 28993.28it/s] 44%|████▍     | 196158/441656 [00:08<00:08, 28962.79it/s] 45%|████▌     | 199091/441656 [00:08<00:08, 29069.18it/s] 46%|████▌     | 202021/441656 [00:08<00:08, 28867.72it/s] 46%|████▋     | 204981/441656 [00:08<00:08, 29082.55it/s] 47%|████▋     | 207925/441656 [00:09<00:08, 29185.46it/s] 48%|████▊     | 210852/441656 [00:09<00:07, 29130.92it/s] 48%|████▊     | 213771/441656 [00:09<00:07, 29111.20it/s] 49%|████▉     | 216710/441656 [00:09<00:07, 29191.50it/s] 50%|████▉     | 219632/441656 [00:09<00:07, 29175.21it/s] 50%|█████     | 222624/441656 [00:09<00:07, 29397.02it/s] 51%|█████     | 225566/441656 [00:09<00:07, 29401.43it/s] 52%|█████▏    | 228523/441656 [00:09<00:07, 29448.67it/s] 52%|█████▏    | 231469/441656 [00:10<00:29, 7219.55it/s]  53%|█████▎    | 234393/441656 [00:10<00:22, 9310.43it/s] 54%|█████▎    | 237108/441656 [00:11<00:17, 11441.14it/s] 54%|█████▍    | 240030/441656 [00:11<00:14, 13987.42it/s] 55%|█████▌    | 243024/441656 [00:11<00:11, 16728.74it/s] 56%|█████▌    | 245953/441656 [00:11<00:10, 19203.62it/s] 56%|█████▋    | 248845/441656 [00:11<00:09, 21337.29it/s] 57%|█████▋    | 251802/441656 [00:11<00:08, 23302.64it/s] 58%|█████▊    | 254749/441656 [00:11<00:07, 24869.96it/s] 58%|█████▊    | 257731/441656 [00:11<00:07, 26188.60it/s] 59%|█████▉    | 260705/441656 [00:11<00:06, 27167.38it/s] 60%|█████▉    | 263636/441656 [00:11<00:06, 27675.22it/s] 60%|██████    | 266625/441656 [00:12<00:06, 28307.87it/s] 61%|██████    | 269566/441656 [00:12<00:06, 28454.91it/s] 62%|██████▏   | 272489/441656 [00:12<00:05, 28207.33it/s] 62%|██████▏   | 275381/441656 [00:12<00:05, 28409.04it/s] 63%|██████▎   | 278261/441656 [00:12<00:05, 28364.14it/s] 64%|██████▎   | 281183/441656 [00:12<00:05, 28613.43it/s] 64%|██████▍   | 284089/441656 [00:12<00:05, 28743.37it/s] 65%|██████▍   | 286978/441656 [00:12<00:05, 28616.72it/s] 66%|██████▌   | 289856/441656 [00:12<00:05, 28661.88it/s] 66%|██████▋   | 292729/441656 [00:12<00:05, 28644.74it/s] 67%|██████▋   | 295634/441656 [00:13<00:05, 28764.27it/s] 68%|██████▊   | 298539/441656 [00:13<00:04, 28849.00it/s] 68%|██████▊   | 301427/441656 [00:13<00:04, 28551.69it/s] 69%|██████▉   | 304285/441656 [00:13<00:04, 28164.39it/s] 70%|██████▉   | 307175/441656 [00:13<00:04, 28380.95it/s] 70%|███████   | 310016/441656 [00:13<00:04, 28319.72it/s] 71%|███████   | 312904/441656 [00:13<00:04, 28483.19it/s] 71%|███████▏  | 315754/441656 [00:13<00:04, 28446.76it/s] 72%|███████▏  | 318621/441656 [00:13<00:04, 28512.35it/s] 73%|███████▎  | 321491/441656 [00:14<00:04, 28566.75it/s] 73%|███████▎  | 324349/441656 [00:14<00:04, 28463.53it/s] 74%|███████▍  | 327196/441656 [00:14<00:04, 28342.15it/s] 75%|███████▍  | 330031/441656 [00:15<00:18, 6012.61it/s]  75%|███████▌  | 332624/441656 [00:15<00:14, 7662.71it/s] 76%|███████▌  | 335282/441656 [00:15<00:11, 9664.50it/s] 76%|███████▋  | 337829/441656 [00:15<00:08, 11739.85it/s] 77%|███████▋  | 340505/441656 [00:15<00:07, 14112.29it/s] 78%|███████▊  | 343140/441656 [00:16<00:06, 16364.63it/s] 78%|███████▊  | 345845/441656 [00:16<00:05, 18588.51it/s] 79%|███████▉  | 348517/441656 [00:16<00:04, 20450.95it/s] 80%|███████▉  | 351212/441656 [00:16<00:04, 22052.60it/s] 80%|████████  | 353870/441656 [00:16<00:03, 23231.46it/s] 81%|████████  | 356562/441656 [00:16<00:03, 24229.65it/s] 81%|████████▏ | 359219/441656 [00:16<00:03, 24776.69it/s] 82%|████████▏ | 361874/441656 [00:16<00:03, 25279.32it/s] 83%|████████▎ | 364530/441656 [00:16<00:03, 25647.72it/s] 83%|████████▎ | 367222/441656 [00:16<00:02, 26018.14it/s] 84%|████████▍ | 369892/441656 [00:17<00:02, 26217.29it/s] 84%|████████▍ | 372563/441656 [00:17<00:02, 26362.47it/s] 85%|████████▍ | 375230/441656 [00:17<00:02, 26112.60it/s] 86%|████████▌ | 377887/441656 [00:17<00:02, 26244.62it/s] 86%|████████▌ | 380585/441656 [00:17<00:02, 26461.39it/s] 87%|████████▋ | 383243/441656 [00:17<00:02, 26385.49it/s] 87%|████████▋ | 385932/441656 [00:17<00:02, 26534.27it/s] 88%|████████▊ | 388620/441656 [00:17<00:01, 26635.79it/s] 89%|████████▊ | 391328/441656 [00:17<00:01, 26767.17it/s] 89%|████████▉ | 394008/441656 [00:17<00:01, 26708.64it/s] 90%|████████▉ | 396694/441656 [00:18<00:01, 26752.28it/s] 90%|█████████ | 399386/441656 [00:18<00:01, 26801.76it/s] 91%|█████████ | 402068/441656 [00:18<00:01, 26767.10it/s] 92%|█████████▏| 404748/441656 [00:18<00:01, 26775.42it/s] 92%|█████████▏| 407434/441656 [00:18<00:01, 26798.83it/s] 93%|█████████▎| 410144/441656 [00:18<00:01, 26887.11it/s] 93%|█████████▎| 412833/441656 [00:18<00:01, 26613.81it/s] 94%|█████████▍| 415496/441656 [00:18<00:00, 26248.50it/s] 95%|█████████▍| 418197/441656 [00:18<00:00, 26471.58it/s] 95%|█████████▌| 420854/441656 [00:18<00:00, 26498.30it/s] 96%|█████████▌| 423547/441656 [00:19<00:00, 26623.64it/s] 97%|█████████▋| 426217/441656 [00:19<00:00, 26643.42it/s] 97%|█████████▋| 428917/441656 [00:19<00:00, 26748.52it/s] 98%|█████████▊| 431593/441656 [00:19<00:00, 26644.90it/s] 98%|█████████▊| 434273/441656 [00:19<00:00, 26689.58it/s] 99%|█████████▉| 436974/441656 [00:19<00:00, 26784.55it/s]100%|█████████▉| 439653/441656 [00:19<00:00, 26739.20it/s]100%|██████████| 441656/441656 [00:19<00:00, 22364.19it/s]
  0%|          | 0/53198 [00:00<?, ?it/s]  6%|▌         | 3245/53198 [00:00<00:01, 32438.51it/s] 12%|█▏        | 6489/53198 [00:00<00:01, 31687.92it/s] 18%|█▊        | 9659/53198 [00:00<00:01, 30881.31it/s] 24%|██▍       | 12881/53198 [00:00<00:01, 31394.82it/s] 30%|███       | 16023/53198 [00:00<00:01, 31213.72it/s] 36%|███▌      | 19242/53198 [00:00<00:01, 31537.28it/s] 42%|████▏     | 22531/53198 [00:00<00:00, 31974.65it/s] 49%|████▉     | 25977/53198 [00:00<00:00, 32759.63it/s] 55%|█████▌    | 29464/53198 [00:00<00:00, 33415.79it/s] 62%|██████▏   | 32849/53198 [00:01<00:00, 33548.59it/s] 68%|██████▊   | 36205/53198 [00:01<00:00, 33369.33it/s] 74%|███████▍  | 39543/53198 [00:01<00:00, 33314.55it/s] 81%|████████  | 42928/53198 [00:01<00:00, 33474.02it/s] 87%|████████▋ | 46402/53198 [00:01<00:00, 33853.04it/s] 94%|█████████▎| 49812/53198 [00:01<00:00, 33925.19it/s]100%|██████████| 53198/53198 [00:01<00:00, 32961.17it/s]
  0%|          | 0/35912 [00:00<?, ?it/s] 10%|▉         | 3580/35912 [00:00<00:00, 35792.95it/s] 20%|██        | 7185/35912 [00:00<00:00, 35939.98it/s] 30%|███       | 10779/35912 [00:00<00:00, 35745.64it/s] 40%|███▉      | 14354/35912 [00:00<00:00, 35715.48it/s] 50%|████▉     | 17926/35912 [00:00<00:00, 35112.40it/s] 60%|█████▉    | 21439/35912 [00:00<00:00, 34944.64it/s] 69%|██████▉   | 24935/35912 [00:00<00:00, 34232.54it/s] 79%|███████▉  | 28362/35912 [00:00<00:00, 34035.74it/s] 89%|████████▊ | 31797/35912 [00:00<00:00, 34130.37it/s] 98%|█████████▊| 35212/35912 [00:01<00:00, 33958.68it/s]100%|██████████| 35912/35912 [00:01<00:00, 34585.61it/s]
dataset loaded from path: 
data/ud/ud-treebanks-v2.1/UD_Catalan/inter-layer-17/UD_Catalan-train-bloom-1b1-intermediate-global_step500000.pkl
data/ud/ud-treebanks-v2.1/UD_Catalan/inter-layer-17/UD_Catalan-dev-bloom-1b1-intermediate-global_step500000.pkl
data/ud/ud-treebanks-v2.1/UD_Catalan/inter-layer-17/UD_Catalan-test-bloom-1b1-intermediate-global_step500000.pkl
Embedding dimensionality: 1536
Pre-training probe (if possible)...
Traceback (most recent call last):
  File "run.py", line 102, in <module>
    args.func(args)
  File "/home/s2308470/multilingual-typology-probing/commands.py", line 166, in greedy
    trainer.train()
  File "/home/s2308470/multilingual-typology-probing/probekit/trainers/trainer.py", line 21, in train
    self._train()
  File "/home/s2308470/multilingual-typology-probing/probekit/trainers/neural_probe_trainer.py", line 30, in _train
    self._train_for_dimensions()
  File "/home/s2308470/multilingual-typology-probing/trainers/flexible_neural_probe_trainer.py", line 72, in _train_for_dimensions
    inputs_tensor_shuffled = inputs_tensor[shuffled_indices]
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 2.21 GiB (GPU 0; 5.94 GiB total capacity; 5.41 GiB already allocated; 285.31 MiB free; 5.44 GiB reserved in total by PyTorch) If reserved memory is >> allocated memory try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF
