now processing task id: 9
CORPUS: UD_Portuguese
python preprocess_treebank.py UD_Portuguese --experiment-name inter-layer-17 --treebanks-root /home/s2308470/multilingual-typology-probing/data/ud/ud-treebanks-v2.1 --bloom bloom-1b7 --checkpoint 10000 --inter-layer 17 --use-gpu
Embeddings root: embeddings
Using GPU
0it [00:00, ?it/s]18it [00:00, 179.11it/s]49it [00:00, 249.42it/s]75it [00:00, 253.35it/s]106it [00:00, 274.60it/s]149it [00:00, 328.46it/s]193it [00:00, 364.35it/s]237it [00:00, 384.36it/s]281it [00:00, 400.87it/s]322it [00:00, 403.22it/s]363it [00:01, 391.34it/s]403it [00:01, 380.07it/s]443it [00:01, 385.29it/s]477it [00:01, 355.00it/s]
0it [00:00, ?it/s]25it [00:00, 248.91it/s]50it [00:00, 245.47it/s]81it [00:00, 273.29it/s]109it [00:00, 271.91it/s]140it [00:00, 280.82it/s]169it [00:00, 280.62it/s]211it [00:00, 322.32it/s]244it [00:00, 317.40it/s]276it [00:00, 305.91it/s]310it [00:01, 312.74it/s]342it [00:01, 287.25it/s]372it [00:01, 281.74it/s]401it [00:01, 279.89it/s]430it [00:01, 177.30it/s]463it [00:01, 207.93it/s]496it [00:01, 233.53it/s]525it [00:02, 245.85it/s]553it [00:02, 254.06it/s]588it [00:02, 278.66it/s]619it [00:02, 284.39it/s]657it [00:02, 308.44it/s]689it [00:02, 280.78it/s]719it [00:02, 274.41it/s]748it [00:02, 277.76it/s]777it [00:02, 269.70it/s]817it [00:02, 305.23it/s]849it [00:03, 307.34it/s]881it [00:03, 293.30it/s]911it [00:03, 290.38it/s]948it [00:03, 312.70it/s]983it [00:03, 321.53it/s]1016it [00:03, 309.04it/s]1048it [00:03, 310.85it/s]1080it [00:03, 296.21it/s]1117it [00:03, 315.07it/s]1152it [00:04, 323.86it/s]1186it [00:04, 326.97it/s]1219it [00:04, 302.46it/s]1250it [00:04, 296.88it/s]1280it [00:04, 285.88it/s]1311it [00:04, 290.44it/s]1346it [00:04, 303.47it/s]1377it [00:04, 294.24it/s]1407it [00:04, 295.28it/s]1437it [00:05, 284.13it/s]1470it [00:05, 295.47it/s]1500it [00:05, 279.16it/s]1529it [00:05, 277.24it/s]1560it [00:05, 286.37it/s]1589it [00:05, 276.84it/s]1617it [00:05, 277.39it/s]1645it [00:05, 266.63it/s]1680it [00:05, 290.00it/s]1710it [00:06, 291.82it/s]1746it [00:06, 303.86it/s]1779it [00:06, 310.83it/s]1813it [00:06, 319.03it/s]1849it [00:06, 326.74it/s]1885it [00:06, 334.31it/s]1919it [00:06, 305.33it/s]1951it [00:06, 279.60it/s]1980it [00:06, 269.24it/s]2019it [00:07, 300.27it/s]2050it [00:07, 300.40it/s]2081it [00:07, 282.46it/s]2110it [00:07, 268.82it/s]2145it [00:07, 287.24it/s]2176it [00:07, 293.39it/s]2209it [00:07, 300.18it/s]2240it [00:07, 285.51it/s]2284it [00:07, 326.14it/s]2319it [00:08, 328.92it/s]2356it [00:08, 338.25it/s]2392it [00:08, 344.28it/s]2427it [00:08, 254.06it/s]2464it [00:08, 279.70it/s]2505it [00:08, 310.65it/s]2539it [00:08, 304.39it/s]2572it [00:08, 299.30it/s]2604it [00:08, 298.40it/s]2638it [00:09, 308.89it/s]2674it [00:09, 320.63it/s]2707it [00:09, 140.28it/s]2739it [00:09, 166.78it/s]2768it [00:09, 186.75it/s]2799it [00:10, 211.15it/s]2828it [00:10, 225.31it/s]2860it [00:10, 246.85it/s]2897it [00:10, 276.14it/s]2934it [00:10, 299.22it/s]2967it [00:10, 277.51it/s]3003it [00:10, 295.46it/s]3044it [00:10, 324.91it/s]3079it [00:10, 327.16it/s]3114it [00:11, 325.07it/s]3156it [00:11, 350.20it/s]3194it [00:11, 357.23it/s]3231it [00:11, 336.60it/s]3272it [00:11, 353.44it/s]3315it [00:11, 371.21it/s]3353it [00:11, 365.77it/s]3390it [00:11, 345.42it/s]3425it [00:11, 322.36it/s]3458it [00:12, 311.69it/s]3490it [00:12, 308.92it/s]3523it [00:12, 313.79it/s]3556it [00:12, 316.34it/s]3592it [00:12, 328.35it/s]3625it [00:12, 308.27it/s]3660it [00:12, 319.69it/s]3695it [00:12, 327.92it/s]3729it [00:12, 324.84it/s]3763it [00:12, 329.10it/s]3797it [00:13, 332.16it/s]3832it [00:13, 331.47it/s]3868it [00:13, 335.08it/s]3902it [00:13, 327.30it/s]3935it [00:13, 323.11it/s]3968it [00:13, 322.69it/s]4001it [00:13, 318.95it/s]4033it [00:13, 318.11it/s]4067it [00:13, 322.28it/s]4101it [00:14, 324.67it/s]4134it [00:14, 314.13it/s]4176it [00:14, 343.30it/s]4212it [00:14, 343.87it/s]4251it [00:14, 354.56it/s]4297it [00:14, 381.57it/s]4336it [00:14, 361.51it/s]4374it [00:14, 365.53it/s]4418it [00:14, 384.50it/s]4457it [00:15, 345.84it/s]4493it [00:15, 345.05it/s]4529it [00:15, 342.19it/s]4569it [00:15, 355.38it/s]4607it [00:15, 361.17it/s]4644it [00:15, 340.71it/s]4679it [00:15, 317.32it/s]4719it [00:15, 336.93it/s]4754it [00:15, 314.54it/s]4787it [00:16, 307.50it/s]4829it [00:16, 337.22it/s]4864it [00:16, 318.49it/s]4897it [00:16, 317.42it/s]4931it [00:16, 319.04it/s]4965it [00:16, 323.05it/s]4998it [00:16, 309.27it/s]5035it [00:16, 322.73it/s]5077it [00:16, 349.27it/s]5122it [00:16, 376.76it/s]5166it [00:17, 394.67it/s]5213it [00:17, 414.94it/s]5255it [00:17, 412.29it/s]5297it [00:17, 413.72it/s]5339it [00:17, 414.05it/s]5383it [00:17, 421.55it/s]5428it [00:17, 429.46it/s]5471it [00:17, 411.35it/s]5517it [00:17, 424.27it/s]5562it [00:18, 430.74it/s]5606it [00:18, 426.01it/s]5678it [00:18, 268.98it/s]5718it [00:18, 291.40it/s]5764it [00:18, 324.87it/s]5811it [00:18, 356.81it/s]5853it [00:18, 367.80it/s]5902it [00:19, 398.57it/s]5952it [00:19, 424.93it/s]5998it [00:19, 419.00it/s]6042it [00:19, 422.29it/s]6086it [00:19, 419.05it/s]6129it [00:19, 416.79it/s]6172it [00:19, 412.01it/s]6214it [00:19, 411.40it/s]6260it [00:19, 422.40it/s]6303it [00:19, 420.78it/s]6346it [00:20, 423.31it/s]6396it [00:20, 441.87it/s]6441it [00:20, 436.76it/s]6488it [00:20, 444.21it/s]6533it [00:20, 437.97it/s]6585it [00:20, 459.22it/s]6631it [00:20, 449.23it/s]6676it [00:20, 438.34it/s]6720it [00:20, 434.85it/s]6767it [00:21, 443.20it/s]6812it [00:21, 425.63it/s]6859it [00:21, 437.60it/s]6905it [00:21, 442.49it/s]6967it [00:21, 488.65it/s]7028it [00:21, 522.37it/s]7081it [00:21, 464.82it/s]7129it [00:21, 444.08it/s]7175it [00:21, 440.66it/s]7220it [00:22, 429.25it/s]7272it [00:22, 452.63it/s]7318it [00:22, 440.11it/s]7363it [00:22, 428.63it/s]7407it [00:22, 405.57it/s]7456it [00:22, 427.51it/s]7502it [00:22, 435.25it/s]7546it [00:22, 433.54it/s]7598it [00:22, 457.12it/s]7644it [00:22, 449.32it/s]7690it [00:23, 452.16it/s]7738it [00:23, 458.95it/s]7785it [00:23, 425.78it/s]7830it [00:23, 431.16it/s]7874it [00:23, 423.49it/s]7917it [00:23, 410.96it/s]7965it [00:23, 429.72it/s]8009it [00:23, 423.30it/s]8058it [00:23, 441.61it/s]8103it [00:24, 424.10it/s]8146it [00:24, 412.82it/s]8188it [00:24, 405.70it/s]8235it [00:24, 420.73it/s]8282it [00:24, 432.35it/s]8326it [00:24, 431.53it/s]8331it [00:24, 338.70it/s]
0it [00:00, ?it/s]44it [00:00, 433.65it/s]92it [00:00, 456.34it/s]142it [00:00, 472.04it/s]190it [00:00, 453.77it/s]236it [00:00, 448.89it/s]281it [00:00, 438.51it/s]325it [00:00, 437.41it/s]378it [00:00, 462.20it/s]425it [00:00, 436.21it/s]469it [00:01, 422.45it/s]514it [00:01, 428.94it/s]560it [00:01, 436.40it/s]560it [00:01, 441.26it/s]
Skipped:
{'total_sents': 9368}

Total: 0
Using model bloom-1b7-intermediate-global_step10000...
Processing UD_Portuguese...
Traceback (most recent call last):
  File "preprocess_treebank.py", line 374, in <module>
    model = BloomModel.from_pretrained(bloom_model, 
  File "/home/s2308470/miniconda3/envs/multilingual-typology-probing/lib/python3.8/site-packages/transformers/modeling_utils.py", line 1878, in to
    return super().to(*args, **kwargs)
  File "/home/s2308470/miniconda3/envs/multilingual-typology-probing/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1145, in to
    return self._apply(convert)
  File "/home/s2308470/miniconda3/envs/multilingual-typology-probing/lib/python3.8/site-packages/torch/nn/modules/module.py", line 797, in _apply
    module._apply(fn)
  File "/home/s2308470/miniconda3/envs/multilingual-typology-probing/lib/python3.8/site-packages/torch/nn/modules/module.py", line 797, in _apply
    module._apply(fn)
  File "/home/s2308470/miniconda3/envs/multilingual-typology-probing/lib/python3.8/site-packages/torch/nn/modules/module.py", line 797, in _apply
    module._apply(fn)
  [Previous line repeated 1 more time]
  File "/home/s2308470/miniconda3/envs/multilingual-typology-probing/lib/python3.8/site-packages/torch/nn/modules/module.py", line 820, in _apply
    param_applied = fn(param)
  File "/home/s2308470/miniconda3/envs/multilingual-typology-probing/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1143, in convert
    return t.to(device, dtype if t.is_floating_point() or t.is_complex() else None, non_blocking)
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 64.00 MiB (GPU 0; 5.94 GiB total capacity; 5.79 GiB already allocated; 35.31 MiB free; 5.79 GiB reserved in total by PyTorch) If reserved memory is >> allocated memory try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF
