now processing task id: 12
CORPUS: UD_Urdu
python preprocess_treebank.py UD_Urdu --experiment-name inter-layer-17 --treebanks-root /home/s2308470/multilingual-typology-probing/data/ud/ud-treebanks-v2.1 --bloom bloom-1b7 --checkpoint 1000 --inter-layer 17 --use-gpu
Embeddings root: embeddings
Using GPU
0it [00:00, ?it/s]17it [00:00, 164.53it/s]47it [00:00, 240.70it/s]72it [00:00, 226.57it/s]100it [00:00, 245.54it/s]137it [00:00, 287.10it/s]166it [00:00, 273.02it/s]195it [00:00, 276.60it/s]223it [00:00, 271.63it/s]251it [00:00, 272.93it/s]279it [00:01, 271.63it/s]307it [00:01, 272.79it/s]340it [00:01, 288.88it/s]374it [00:01, 302.47it/s]405it [00:01, 293.94it/s]435it [00:01, 271.65it/s]463it [00:01, 253.96it/s]493it [00:01, 266.18it/s]521it [00:01, 267.91it/s]535it [00:01, 269.79it/s]
0it [00:00, ?it/s]26it [00:00, 254.25it/s]57it [00:00, 280.70it/s]86it [00:00, 279.04it/s]115it [00:00, 283.00it/s]144it [00:00, 270.81it/s]173it [00:00, 274.41it/s]201it [00:00, 257.86it/s]230it [00:01, 173.82it/s]259it [00:01, 196.95it/s]292it [00:01, 227.37it/s]320it [00:01, 238.85it/s]349it [00:01, 251.98it/s]383it [00:01, 275.57it/s]420it [00:01, 297.69it/s]453it [00:01, 304.70it/s]485it [00:01, 307.92it/s]519it [00:01, 316.09it/s]552it [00:02, 297.26it/s]583it [00:02, 289.47it/s]613it [00:02, 289.34it/s]643it [00:02, 286.36it/s]672it [00:02, 281.86it/s]706it [00:02, 298.18it/s]737it [00:02, 292.15it/s]767it [00:02, 288.08it/s]796it [00:02, 267.30it/s]824it [00:03, 262.08it/s]851it [00:03, 256.51it/s]877it [00:03, 253.98it/s]907it [00:03, 265.81it/s]938it [00:03, 276.99it/s]966it [00:03, 259.89it/s]993it [00:03, 258.37it/s]1024it [00:03, 270.54it/s]1055it [00:03, 280.70it/s]1088it [00:04, 293.41it/s]1118it [00:04, 286.22it/s]1147it [00:04, 273.13it/s]1181it [00:04, 289.63it/s]1211it [00:04, 291.98it/s]1241it [00:04, 283.45it/s]1270it [00:04, 283.65it/s]1299it [00:04, 272.85it/s]1328it [00:04, 275.71it/s]1363it [00:04, 295.66it/s]1395it [00:05, 300.51it/s]1426it [00:05, 295.29it/s]1456it [00:05, 287.64it/s]1487it [00:05, 292.56it/s]1517it [00:05, 278.93it/s]1550it [00:05, 292.18it/s]1581it [00:05, 292.64it/s]1611it [00:05, 290.10it/s]1641it [00:05, 292.88it/s]1671it [00:06, 288.35it/s]1700it [00:06, 270.48it/s]1728it [00:06, 270.46it/s]1756it [00:06, 271.82it/s]1784it [00:06, 269.05it/s]1813it [00:06, 274.79it/s]1841it [00:06, 270.55it/s]1869it [00:06, 262.15it/s]1897it [00:06, 264.40it/s]1929it [00:07, 277.35it/s]1959it [00:07, 283.58it/s]1990it [00:07, 287.54it/s]2021it [00:07, 293.26it/s]2051it [00:07, 274.75it/s]2079it [00:07, 276.01it/s]2108it [00:07, 279.74it/s]2137it [00:07, 278.62it/s]2167it [00:07, 283.30it/s]2197it [00:07, 286.26it/s]2226it [00:08, 283.45it/s]2255it [00:08, 280.71it/s]2288it [00:08, 293.54it/s]2318it [00:08, 168.29it/s]2347it [00:08, 190.21it/s]2376it [00:08, 211.31it/s]2408it [00:08, 236.35it/s]2437it [00:09, 248.11it/s]2465it [00:09, 247.23it/s]2493it [00:09, 255.33it/s]2522it [00:09, 263.10it/s]2552it [00:09, 269.37it/s]2587it [00:09, 290.83it/s]2618it [00:09, 294.13it/s]2648it [00:09, 292.62it/s]2678it [00:09, 266.05it/s]2711it [00:10, 279.80it/s]2744it [00:10, 292.65it/s]2776it [00:10, 300.04it/s]2810it [00:10, 309.26it/s]2842it [00:10, 304.52it/s]2873it [00:10, 289.18it/s]2906it [00:10, 300.36it/s]2937it [00:10, 286.82it/s]2966it [00:10, 282.91it/s]3002it [00:10, 303.14it/s]3033it [00:11, 287.70it/s]3063it [00:11, 284.10it/s]3098it [00:11, 301.98it/s]3129it [00:11, 286.98it/s]3169it [00:11, 317.74it/s]3202it [00:11, 303.89it/s]3233it [00:11, 288.83it/s]3263it [00:11, 273.63it/s]3291it [00:12, 268.99it/s]3326it [00:12, 287.84it/s]3361it [00:12, 303.13it/s]3399it [00:12, 323.58it/s]3432it [00:12, 292.95it/s]3463it [00:12, 280.37it/s]3497it [00:12, 294.59it/s]3527it [00:12, 291.52it/s]3558it [00:12, 295.49it/s]3588it [00:13, 278.07it/s]3619it [00:13, 285.34it/s]3648it [00:13, 267.19it/s]3683it [00:13, 289.61it/s]3713it [00:13, 276.62it/s]3742it [00:13, 269.45it/s]3770it [00:13, 259.60it/s]3799it [00:13, 265.81it/s]3826it [00:13, 254.17it/s]3855it [00:14, 262.71it/s]3889it [00:14, 283.60it/s]3920it [00:14, 289.35it/s]3954it [00:14, 299.34it/s]3985it [00:14, 292.49it/s]4015it [00:14, 286.34it/s]4043it [00:14, 276.17it/s]
0it [00:00, ?it/s]21it [00:00, 203.56it/s]56it [00:00, 287.45it/s]88it [00:00, 299.79it/s]124it [00:00, 322.07it/s]157it [00:00, 315.25it/s]189it [00:00, 308.31it/s]220it [00:00, 277.26it/s]249it [00:00, 269.60it/s]281it [00:00, 282.63it/s]310it [00:01, 276.85it/s]338it [00:01, 276.79it/s]367it [00:01, 278.61it/s]395it [00:01, 270.33it/s]430it [00:01, 289.00it/s]460it [00:01, 270.64it/s]492it [00:01, 281.62it/s]524it [00:01, 290.79it/s]552it [00:01, 285.59it/s]
Skipped:
{'total_sents': 5130}

Total: 0
Using model bloom-1b7-intermediate-global_step1000...
Processing UD_Urdu...
Traceback (most recent call last):
  File "preprocess_treebank.py", line 374, in <module>
    model = BloomModel.from_pretrained(bloom_model, 
  File "/home/s2308470/miniconda3/envs/multilingual-typology-probing/lib/python3.8/site-packages/transformers/modeling_utils.py", line 1878, in to
    return super().to(*args, **kwargs)
  File "/home/s2308470/miniconda3/envs/multilingual-typology-probing/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1145, in to
    return self._apply(convert)
  File "/home/s2308470/miniconda3/envs/multilingual-typology-probing/lib/python3.8/site-packages/torch/nn/modules/module.py", line 797, in _apply
    module._apply(fn)
  File "/home/s2308470/miniconda3/envs/multilingual-typology-probing/lib/python3.8/site-packages/torch/nn/modules/module.py", line 797, in _apply
    module._apply(fn)
  File "/home/s2308470/miniconda3/envs/multilingual-typology-probing/lib/python3.8/site-packages/torch/nn/modules/module.py", line 797, in _apply
    module._apply(fn)
  [Previous line repeated 1 more time]
  File "/home/s2308470/miniconda3/envs/multilingual-typology-probing/lib/python3.8/site-packages/torch/nn/modules/module.py", line 820, in _apply
    param_applied = fn(param)
  File "/home/s2308470/miniconda3/envs/multilingual-typology-probing/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1143, in convert
    return t.to(device, dtype if t.is_floating_point() or t.is_complex() else None, non_blocking)
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 64.00 MiB (GPU 0; 5.94 GiB total capacity; 5.79 GiB already allocated; 35.31 MiB free; 5.79 GiB reserved in total by PyTorch) If reserved memory is >> allocated memory try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF
