python run.py --language UD_Spanish --experiment-name inter-layer-13 --attribute POS --trainer poisson --gpu --embedding bloom-1b1-intermediate-global_step400000 greedy --selection-size 50 --selection-criterion mi
Setting up datasets (['UD_Spanish'], POS) and probes...
  0%|          | 0/343741 [00:00<?, ?it/s]  1%|          | 2441/343741 [00:00<00:13, 24401.53it/s]  2%|▏         | 5493/343741 [00:00<00:12, 27995.97it/s]  2%|▏         | 8467/343741 [00:00<00:11, 28787.14it/s]  3%|▎         | 11469/343741 [00:00<00:11, 29271.93it/s]  4%|▍         | 14451/343741 [00:00<00:11, 29468.96it/s]  5%|▌         | 17507/343741 [00:00<00:10, 29839.22it/s]  6%|▌         | 20491/343741 [00:00<00:10, 29731.76it/s]  7%|▋         | 23465/343741 [00:01<00:23, 13504.11it/s]  8%|▊         | 26527/343741 [00:01<00:19, 16427.78it/s]  9%|▊         | 29534/343741 [00:01<00:16, 19103.64it/s]  9%|▉         | 32589/343741 [00:01<00:14, 21608.76it/s] 10%|█         | 35614/343741 [00:01<00:13, 23666.13it/s] 11%|█▏        | 38687/343741 [00:01<00:11, 25457.90it/s] 12%|█▏        | 41604/343741 [00:01<00:11, 26135.54it/s] 13%|█▎        | 44570/343741 [00:01<00:11, 27097.18it/s] 14%|█▍        | 47560/343741 [00:01<00:10, 27882.39it/s] 15%|█▍        | 50491/343741 [00:02<00:10, 28259.62it/s] 16%|█▌        | 53431/343741 [00:02<00:10, 28587.04it/s] 16%|█▋        | 56362/343741 [00:02<00:10, 28653.33it/s] 17%|█▋        | 59332/343741 [00:02<00:09, 28957.82it/s] 18%|█▊        | 62264/343741 [00:03<00:24, 11334.05it/s] 19%|█▉        | 65227/343741 [00:03<00:20, 13921.11it/s] 20%|█▉        | 68167/343741 [00:03<00:16, 16522.51it/s] 21%|██        | 71046/343741 [00:03<00:14, 18896.81it/s] 21%|██▏       | 73900/343741 [00:03<00:12, 20984.80it/s] 22%|██▏       | 76857/343741 [00:03<00:11, 23012.49it/s] 23%|██▎       | 79807/343741 [00:03<00:10, 24648.83it/s] 24%|██▍       | 82865/343741 [00:03<00:09, 26219.72it/s] 25%|██▍       | 85857/343741 [00:03<00:09, 27215.58it/s] 26%|██▌       | 88913/343741 [00:03<00:09, 28155.59it/s] 27%|██▋       | 91917/343741 [00:04<00:08, 28694.23it/s] 28%|██▊       | 94895/343741 [00:04<00:08, 28971.91it/s] 28%|██▊       | 97876/343741 [00:04<00:08, 29216.23it/s] 29%|██▉       | 100852/343741 [00:04<00:08, 28833.05it/s] 30%|███       | 103835/343741 [00:04<00:08, 29122.76it/s] 31%|███       | 106857/343741 [00:04<00:08, 29307.88it/s] 32%|███▏      | 109848/343741 [00:04<00:07, 29485.25it/s] 33%|███▎      | 112811/343741 [00:05<00:20, 11341.11it/s] 34%|███▎      | 115757/343741 [00:05<00:16, 13877.89it/s] 35%|███▍      | 118743/343741 [00:05<00:13, 16541.51it/s] 35%|███▌      | 121731/343741 [00:05<00:11, 19088.23it/s] 36%|███▌      | 124547/343741 [00:05<00:10, 21041.36it/s] 37%|███▋      | 127542/343741 [00:05<00:09, 23136.59it/s] 38%|███▊      | 130438/343741 [00:05<00:08, 24575.38it/s] 39%|███▉      | 133468/343741 [00:05<00:08, 26086.86it/s] 40%|███▉      | 136431/343741 [00:06<00:07, 27003.27it/s] 41%|████      | 139484/343741 [00:06<00:07, 27993.22it/s] 41%|████▏     | 142479/343741 [00:06<00:07, 28550.62it/s] 42%|████▏     | 145444/343741 [00:06<00:06, 28711.14it/s] 43%|████▎     | 148507/343741 [00:06<00:06, 29267.48it/s] 44%|████▍     | 151490/343741 [00:06<00:06, 29296.24it/s] 45%|████▍     | 154459/343741 [00:06<00:06, 29293.01it/s] 46%|████▌     | 157431/343741 [00:06<00:06, 29335.95it/s] 47%|████▋     | 160384/343741 [00:06<00:06, 29323.72it/s] 48%|████▊     | 163367/343741 [00:06<00:06, 29473.44it/s] 48%|████▊     | 166389/343741 [00:07<00:05, 29693.47it/s] 49%|████▉     | 169366/343741 [00:07<00:05, 29472.43it/s] 50%|█████     | 172379/343741 [00:07<00:05, 29664.23it/s] 51%|█████     | 175350/343741 [00:07<00:15, 10526.52it/s] 52%|█████▏    | 178308/343741 [00:08<00:12, 13025.74it/s] 53%|█████▎    | 181304/343741 [00:08<00:10, 15698.21it/s] 54%|█████▎    | 184294/343741 [00:08<00:08, 18310.91it/s] 54%|█████▍    | 187271/343741 [00:08<00:07, 20695.36it/s] 55%|█████▌    | 190287/343741 [00:08<00:06, 22863.53it/s] 56%|█████▌    | 193165/343741 [00:08<00:06, 24322.31it/s] 57%|█████▋    | 196117/343741 [00:08<00:05, 25675.19it/s] 58%|█████▊    | 199171/343741 [00:08<00:05, 26992.79it/s] 59%|█████▉    | 202112/343741 [00:08<00:05, 27614.99it/s] 60%|█████▉    | 205122/343741 [00:08<00:04, 28320.52it/s] 61%|██████    | 208083/343741 [00:09<00:04, 28692.43it/s] 61%|██████▏   | 211094/343741 [00:09<00:04, 29105.70it/s] 62%|██████▏   | 214096/343741 [00:09<00:04, 29373.41it/s] 63%|██████▎   | 217079/343741 [00:09<00:04, 29441.39it/s] 64%|██████▍   | 220094/343741 [00:09<00:04, 29649.14it/s] 65%|██████▍   | 223082/343741 [00:09<00:04, 29526.60it/s] 66%|██████▌   | 226089/343741 [00:09<00:03, 29685.05it/s] 67%|██████▋   | 229069/343741 [00:09<00:03, 29611.17it/s] 68%|██████▊   | 232081/343741 [00:09<00:03, 29759.91it/s] 68%|██████▊   | 235063/343741 [00:09<00:03, 29432.92it/s] 69%|██████▉   | 238011/343741 [00:10<00:03, 29384.89it/s] 70%|███████   | 241032/343741 [00:10<00:03, 29627.44it/s] 71%|███████   | 244026/343741 [00:10<00:03, 29719.70it/s] 72%|███████▏  | 247036/343741 [00:10<00:03, 29831.88it/s] 73%|███████▎  | 250050/343741 [00:10<00:03, 29922.09it/s] 74%|███████▎  | 253104/343741 [00:10<00:03, 30106.48it/s] 75%|███████▍  | 256116/343741 [00:11<00:09, 9450.48it/s]  75%|███████▌  | 259129/343741 [00:11<00:07, 11898.29it/s] 76%|███████▋  | 262165/343741 [00:11<00:05, 14568.37it/s] 77%|███████▋  | 265161/343741 [00:11<00:04, 17203.94it/s] 78%|███████▊  | 268236/343741 [00:11<00:03, 19865.54it/s] 79%|███████▉  | 271277/343741 [00:11<00:03, 22176.26it/s] 80%|███████▉  | 274251/343741 [00:12<00:02, 23978.25it/s] 81%|████████  | 277247/343741 [00:12<00:02, 25496.68it/s] 82%|████████▏ | 280229/343741 [00:12<00:02, 26647.57it/s] 82%|████████▏ | 283325/343741 [00:12<00:02, 27835.43it/s] 83%|████████▎ | 286323/343741 [00:12<00:02, 28417.63it/s] 84%|████████▍ | 289400/343741 [00:12<00:01, 29091.12it/s] 85%|████████▌ | 292455/343741 [00:12<00:01, 29514.88it/s] 86%|████████▌ | 295529/343741 [00:12<00:01, 29871.71it/s] 87%|████████▋ | 298572/343741 [00:12<00:01, 29462.53it/s] 88%|████████▊ | 301653/343741 [00:12<00:01, 29854.71it/s] 89%|████████▊ | 304687/343741 [00:13<00:01, 29996.81it/s] 90%|████████▉ | 307711/343741 [00:13<00:01, 30066.55it/s] 90%|█████████ | 310751/343741 [00:13<00:01, 30162.95it/s] 91%|█████████▏| 313778/343741 [00:13<00:00, 30097.45it/s] 92%|█████████▏| 316856/343741 [00:13<00:00, 30298.41it/s] 93%|█████████▎| 319913/343741 [00:13<00:00, 30377.12it/s] 94%|█████████▍| 322961/343741 [00:13<00:00, 30405.75it/s] 95%|█████████▍| 326016/343741 [00:13<00:00, 30446.78it/s] 96%|█████████▌| 329101/343741 [00:13<00:00, 30561.96it/s] 97%|█████████▋| 332159/343741 [00:13<00:00, 30487.89it/s] 98%|█████████▊| 335216/343741 [00:14<00:00, 30511.68it/s] 98%|█████████▊| 338292/343741 [00:14<00:00, 30584.73it/s] 99%|█████████▉| 341351/343741 [00:14<00:00, 29864.62it/s]100%|██████████| 343741/343741 [00:14<00:00, 23998.71it/s]
  0%|          | 0/56357 [00:00<?, ?it/s]  6%|▌         | 3498/56357 [00:00<00:01, 34974.53it/s] 12%|█▏        | 6996/56357 [00:00<00:01, 34487.59it/s] 19%|█▊        | 10446/56357 [00:00<00:01, 33952.37it/s] 25%|██▍       | 13843/56357 [00:00<00:01, 33483.46it/s] 31%|███       | 17387/56357 [00:00<00:01, 34171.54it/s] 37%|███▋      | 20806/56357 [00:00<00:01, 34092.60it/s] 43%|████▎     | 24246/56357 [00:00<00:00, 34191.03it/s] 49%|████▉     | 27782/56357 [00:00<00:00, 34558.12it/s] 55%|█████▌    | 31239/56357 [00:00<00:00, 34546.14it/s] 62%|██████▏   | 34727/56357 [00:01<00:00, 34647.15it/s] 68%|██████▊   | 38215/56357 [00:01<00:00, 34717.29it/s] 74%|███████▍  | 41688/56357 [00:01<00:00, 34581.07it/s] 80%|████████  | 45147/56357 [00:01<00:00, 34293.75it/s] 86%|████████▌ | 48578/56357 [00:01<00:00, 34288.15it/s] 92%|█████████▏| 52012/56357 [00:01<00:00, 34300.97it/s] 98%|█████████▊| 55468/56357 [00:01<00:00, 34349.62it/s]100%|██████████| 56357/56357 [00:01<00:00, 34353.69it/s]
  0%|          | 0/23248 [00:00<?, ?it/s] 16%|█▌        | 3700/23248 [00:00<00:00, 36990.60it/s] 32%|███▏      | 7430/23248 [00:00<00:00, 37167.08it/s] 48%|████▊     | 11147/23248 [00:00<00:00, 36907.69it/s] 64%|██████▍   | 14905/23248 [00:00<00:00, 37167.83it/s] 80%|████████  | 18623/23248 [00:00<00:00, 37011.63it/s] 96%|█████████▌| 22325/23248 [00:00<00:00, 36848.47it/s]100%|██████████| 23248/23248 [00:00<00:00, 36875.61it/s]
dataset loaded from path: 
data/ud/ud-treebanks-v2.1/UD_Spanish/inter-layer-13/UD_Spanish-train-bloom-1b1-intermediate-global_step400000.pkl
data/ud/ud-treebanks-v2.1/UD_Spanish/inter-layer-13/UD_Spanish-dev-bloom-1b1-intermediate-global_step400000.pkl
data/ud/ud-treebanks-v2.1/UD_Spanish/inter-layer-13/UD_Spanish-test-bloom-1b1-intermediate-global_step400000.pkl
Embedding dimensionality: 1536
Pre-training probe (if possible)...
Traceback (most recent call last):
  File "run.py", line 102, in <module>
    args.func(args)
  File "/home/s2308470/multilingual-typology-probing/commands.py", line 166, in greedy
    trainer.train()
  File "/home/s2308470/multilingual-typology-probing/probekit/trainers/trainer.py", line 21, in train
    self._train()
  File "/home/s2308470/multilingual-typology-probing/probekit/trainers/neural_probe_trainer.py", line 30, in _train
    self._train_for_dimensions()
  File "/home/s2308470/multilingual-typology-probing/trainers/flexible_neural_probe_trainer.py", line 72, in _train_for_dimensions
    inputs_tensor_shuffled = inputs_tensor[shuffled_indices]
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 1.63 GiB (GPU 0; 5.94 GiB total capacity; 4.18 GiB already allocated; 1.51 GiB free; 4.21 GiB reserved in total by PyTorch) If reserved memory is >> allocated memory try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF
