now processing task id: 5
CORPUS: UD_English
python preprocess_treebank.py UD_English --experiment-name inter-layer-17 --treebanks-root /home/s2308470/multilingual-typology-probing/data/ud/ud-treebanks-v2.1 --bloom bloom-1b7 --checkpoint 1000 --inter-layer 17 --use-gpu
Embeddings root: embeddings
Using GPU
0it [00:00, ?it/s]42it [00:00, 405.66it/s]83it [00:00, 352.54it/s]119it [00:00, 337.26it/s]169it [00:00, 395.45it/s]210it [00:00, 385.02it/s]301it [00:00, 551.05it/s]373it [00:00, 601.93it/s]451it [00:00, 654.85it/s]535it [00:00, 705.54it/s]607it [00:01, 656.12it/s]694it [00:01, 711.84it/s]767it [00:01, 564.70it/s]844it [00:01, 613.53it/s]911it [00:01, 594.55it/s]974it [00:01, 583.08it/s]1035it [00:01, 536.04it/s]1144it [00:01, 675.60it/s]1219it [00:02, 694.39it/s]1292it [00:02, 699.41it/s]1365it [00:02, 693.20it/s]1436it [00:02, 647.19it/s]1503it [00:02, 618.31it/s]1569it [00:02, 629.34it/s]1670it [00:02, 733.71it/s]1745it [00:02, 735.85it/s]1827it [00:02, 755.65it/s]1904it [00:03, 730.68it/s]1978it [00:03, 721.87it/s]2051it [00:03, 715.55it/s]2077it [00:03, 631.02it/s]
0it [00:00, ?it/s]34it [00:00, 334.40it/s]68it [00:00, 296.90it/s]126it [00:00, 413.77it/s]169it [00:00, 381.54it/s]209it [00:00, 372.49it/s]247it [00:00, 358.74it/s]284it [00:00, 333.48it/s]318it [00:00, 305.61it/s]359it [00:01, 332.92it/s]399it [00:01, 349.82it/s]435it [00:01, 349.49it/s]471it [00:01, 348.87it/s]507it [00:01, 349.22it/s]559it [00:01, 397.98it/s]600it [00:01, 229.96it/s]637it [00:02, 256.88it/s]671it [00:02, 271.33it/s]704it [00:02, 284.37it/s]744it [00:02, 312.85it/s]786it [00:02, 340.86it/s]825it [00:02, 354.17it/s]863it [00:02, 358.78it/s]909it [00:02, 385.60it/s]956it [00:02, 408.56it/s]1004it [00:02, 429.28it/s]1056it [00:03, 454.66it/s]1102it [00:03, 444.02it/s]1147it [00:03, 397.82it/s]1192it [00:03, 410.50it/s]1234it [00:03, 402.15it/s]1275it [00:03, 391.70it/s]1315it [00:03, 381.69it/s]1354it [00:03, 373.68it/s]1392it [00:03, 344.29it/s]1427it [00:04, 333.33it/s]1464it [00:04, 341.57it/s]1501it [00:04, 349.07it/s]1537it [00:04, 346.35it/s]1572it [00:04, 342.95it/s]1631it [00:04, 412.38it/s]1691it [00:04, 466.14it/s]1760it [00:04, 530.86it/s]1832it [00:04, 584.94it/s]1916it [00:04, 655.68it/s]1982it [00:05, 633.56it/s]2060it [00:05, 675.78it/s]2128it [00:05, 634.39it/s]2193it [00:05, 638.40it/s]2266it [00:05, 663.59it/s]2333it [00:05, 648.51it/s]2404it [00:05, 664.31it/s]2488it [00:05, 712.63it/s]2560it [00:05, 689.85it/s]2638it [00:06, 715.54it/s]2710it [00:06, 703.78it/s]2781it [00:06, 683.25it/s]2854it [00:06, 394.93it/s]2935it [00:06, 472.03it/s]3006it [00:06, 519.54it/s]3072it [00:06, 551.66it/s]3137it [00:07, 539.75it/s]3198it [00:07, 553.23it/s]3269it [00:07, 591.03it/s]3343it [00:07, 631.31it/s]3410it [00:07, 594.03it/s]3474it [00:07, 604.02it/s]3538it [00:07, 612.42it/s]3602it [00:07, 615.60it/s]3677it [00:07, 646.97it/s]3743it [00:08, 538.59it/s]3801it [00:08, 517.04it/s]3856it [00:08, 509.70it/s]3920it [00:08, 542.76it/s]3979it [00:08, 554.36it/s]4045it [00:08, 579.95it/s]4121it [00:08, 629.83it/s]4189it [00:08, 643.04it/s]4259it [00:08, 659.44it/s]4347it [00:09, 721.72it/s]4422it [00:09, 729.25it/s]4505it [00:09, 754.56it/s]4582it [00:09, 752.90it/s]4658it [00:09, 651.94it/s]4726it [00:09, 646.96it/s]4804it [00:09, 680.44it/s]4874it [00:09, 625.43it/s]4955it [00:09, 674.08it/s]5025it [00:10, 646.27it/s]5092it [00:10, 633.05it/s]5157it [00:10, 546.63it/s]5215it [00:10, 553.10it/s]5294it [00:10, 609.29it/s]5357it [00:10, 606.60it/s]5419it [00:10, 536.01it/s]5486it [00:10, 568.01it/s]5545it [00:10, 571.36it/s]5604it [00:11, 555.32it/s]5661it [00:11, 551.37it/s]5717it [00:11, 542.56it/s]5772it [00:11, 500.54it/s]5829it [00:11, 516.81it/s]5882it [00:11, 509.67it/s]5934it [00:11, 497.24it/s]5985it [00:11, 469.08it/s]6033it [00:11, 460.52it/s]6080it [00:12, 236.56it/s]6118it [00:12, 259.81it/s]6156it [00:12, 280.93it/s]6194it [00:12, 301.07it/s]6251it [00:12, 362.98it/s]6299it [00:12, 390.13it/s]6344it [00:13, 404.26it/s]6390it [00:13, 417.54it/s]6435it [00:13, 392.89it/s]6484it [00:13, 416.19it/s]6528it [00:13, 417.22it/s]6571it [00:13, 420.72it/s]6619it [00:13, 436.94it/s]6677it [00:13, 476.49it/s]6726it [00:13, 473.80it/s]6774it [00:14, 414.15it/s]6817it [00:14, 327.89it/s]6854it [00:14, 333.32it/s]6891it [00:14, 341.90it/s]6929it [00:14, 351.28it/s]6967it [00:14, 357.65it/s]7004it [00:14, 355.10it/s]7043it [00:14, 362.17it/s]7089it [00:14, 388.39it/s]7137it [00:15, 412.88it/s]7179it [00:15, 413.01it/s]7224it [00:15, 420.96it/s]7279it [00:15, 457.95it/s]7332it [00:15, 477.59it/s]7396it [00:15, 523.42it/s]7458it [00:15, 550.16it/s]7514it [00:15, 519.04it/s]7569it [00:15, 524.63it/s]7622it [00:16, 501.63it/s]7686it [00:16, 539.71it/s]7747it [00:16, 556.39it/s]7804it [00:16, 552.26it/s]7863it [00:16, 561.13it/s]7920it [00:16, 552.11it/s]7976it [00:16, 526.18it/s]8029it [00:16, 525.64it/s]8082it [00:16, 525.70it/s]8149it [00:16, 567.37it/s]8206it [00:17, 544.25it/s]8261it [00:17, 517.63it/s]8314it [00:17, 516.05it/s]8367it [00:17, 519.61it/s]8420it [00:17, 495.44it/s]8470it [00:17, 477.83it/s]8519it [00:17, 462.27it/s]8566it [00:17, 435.98it/s]8610it [00:17, 426.81it/s]8655it [00:18, 432.43it/s]8707it [00:18, 452.46it/s]8762it [00:18, 479.00it/s]8816it [00:18, 496.14it/s]8870it [00:18, 507.66it/s]8929it [00:18, 527.87it/s]8982it [00:18, 520.02it/s]9040it [00:18, 535.28it/s]9094it [00:18, 504.15it/s]9145it [00:19, 499.42it/s]9198it [00:19, 505.87it/s]9249it [00:19, 240.84it/s]9299it [00:19, 282.62it/s]9343it [00:19, 312.23it/s]9386it [00:19, 324.08it/s]9447it [00:20, 386.31it/s]9494it [00:20, 390.19it/s]9539it [00:20, 403.06it/s]9587it [00:20, 422.97it/s]9636it [00:20, 436.76it/s]9682it [00:20, 438.16it/s]9728it [00:20, 425.53it/s]9779it [00:20, 446.13it/s]9825it [00:20, 449.90it/s]9893it [00:20, 515.36it/s]9955it [00:21, 544.51it/s]10013it [00:21, 554.16it/s]10080it [00:21, 586.57it/s]10140it [00:21, 589.97it/s]10201it [00:21, 593.55it/s]10261it [00:21, 585.16it/s]10320it [00:21, 560.29it/s]10385it [00:21, 580.33it/s]10444it [00:21, 549.82it/s]10500it [00:22, 544.39it/s]10556it [00:22, 547.28it/s]10613it [00:22, 551.52it/s]10669it [00:22, 543.87it/s]10726it [00:22, 550.69it/s]10782it [00:22, 543.52it/s]10837it [00:22, 519.01it/s]10896it [00:22, 538.17it/s]10951it [00:22, 529.63it/s]11005it [00:22, 526.16it/s]11058it [00:23, 509.96it/s]11110it [00:23, 484.40it/s]11165it [00:23, 500.84it/s]11216it [00:23, 501.78it/s]11267it [00:23, 495.18it/s]11317it [00:23, 478.86it/s]11366it [00:23, 480.19it/s]11415it [00:23, 467.80it/s]11462it [00:23, 461.38it/s]11509it [00:24, 462.43it/s]11556it [00:24, 463.75it/s]11611it [00:24, 487.74it/s]11662it [00:24, 492.03it/s]11712it [00:24, 467.65it/s]11760it [00:24, 430.20it/s]11812it [00:24, 451.29it/s]11858it [00:24, 436.47it/s]11903it [00:24, 417.31it/s]11957it [00:25, 450.57it/s]12006it [00:25, 461.45it/s]12053it [00:25, 450.36it/s]12099it [00:25, 433.47it/s]12143it [00:25, 431.38it/s]12187it [00:25, 417.01it/s]12232it [00:25, 424.53it/s]12278it [00:25, 434.60it/s]12323it [00:25, 438.94it/s]12369it [00:25, 443.90it/s]12414it [00:26, 420.67it/s]12457it [00:26, 421.73it/s]12500it [00:26, 418.80it/s]12543it [00:26, 391.89it/s]12543it [00:26, 474.41it/s]
0it [00:00, ?it/s]32it [00:00, 310.02it/s]68it [00:00, 333.12it/s]107it [00:00, 354.12it/s]159it [00:00, 414.63it/s]202it [00:00, 419.06it/s]244it [00:00, 408.77it/s]303it [00:00, 465.09it/s]380it [00:00, 558.66it/s]461it [00:00, 634.52it/s]525it [00:01, 629.06it/s]612it [00:01, 700.11it/s]696it [00:01, 739.93it/s]771it [00:01, 725.45it/s]844it [00:01, 710.86it/s]916it [00:01, 669.24it/s]984it [00:01, 538.98it/s]1043it [00:01, 524.60it/s]1099it [00:02, 236.39it/s]1174it [00:02, 305.38it/s]1245it [00:02, 370.45it/s]1302it [00:02, 397.48it/s]1357it [00:02, 425.79it/s]1414it [00:03, 457.34it/s]1494it [00:03, 540.51it/s]1592it [00:03, 653.52it/s]1673it [00:03, 695.26it/s]1749it [00:03, 713.13it/s]1825it [00:03, 710.06it/s]1899it [00:03, 710.70it/s]1973it [00:03, 670.58it/s]2002it [00:03, 527.73it/s]
Skipped:
{'total_sents': 16622}

Total: 0
Using model bloom-1b7-intermediate-global_step1000...
Processing UD_English...
Traceback (most recent call last):
  File "preprocess_treebank.py", line 374, in <module>
    model = BloomModel.from_pretrained(bloom_model, 
  File "/home/s2308470/miniconda3/envs/multilingual-typology-probing/lib/python3.8/site-packages/transformers/modeling_utils.py", line 1878, in to
    return super().to(*args, **kwargs)
  File "/home/s2308470/miniconda3/envs/multilingual-typology-probing/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1145, in to
    return self._apply(convert)
  File "/home/s2308470/miniconda3/envs/multilingual-typology-probing/lib/python3.8/site-packages/torch/nn/modules/module.py", line 797, in _apply
    module._apply(fn)
  File "/home/s2308470/miniconda3/envs/multilingual-typology-probing/lib/python3.8/site-packages/torch/nn/modules/module.py", line 797, in _apply
    module._apply(fn)
  File "/home/s2308470/miniconda3/envs/multilingual-typology-probing/lib/python3.8/site-packages/torch/nn/modules/module.py", line 797, in _apply
    module._apply(fn)
  [Previous line repeated 1 more time]
  File "/home/s2308470/miniconda3/envs/multilingual-typology-probing/lib/python3.8/site-packages/torch/nn/modules/module.py", line 820, in _apply
    param_applied = fn(param)
  File "/home/s2308470/miniconda3/envs/multilingual-typology-probing/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1143, in convert
    return t.to(device, dtype if t.is_floating_point() or t.is_complex() else None, non_blocking)
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 64.00 MiB (GPU 0; 5.94 GiB total capacity; 5.79 GiB already allocated; 35.31 MiB free; 5.79 GiB reserved in total by PyTorch) If reserved memory is >> allocated memory try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF
