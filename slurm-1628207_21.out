python run.py --language UD_Catalan --experiment-name inter-layer-13 --attribute POS --trainer poisson --gpu --embedding bloom-1b1-intermediate-global_step10000 greedy --selection-size 50 --selection-criterion mi
Setting up datasets (['UD_Catalan'], POS) and probes...
  0%|          | 0/441656 [00:00<?, ?it/s]  1%|          | 2287/441656 [00:00<00:19, 22867.57it/s]  1%|          | 5254/441656 [00:00<00:16, 26865.07it/s]  2%|▏         | 8195/441656 [00:00<00:15, 28025.11it/s]  3%|▎         | 11139/441656 [00:00<00:15, 28580.13it/s]  3%|▎         | 14134/441656 [00:00<00:14, 29073.23it/s]  4%|▍         | 17080/441656 [00:00<00:14, 29201.39it/s]  5%|▍         | 20075/441656 [00:00<00:14, 29442.89it/s]  5%|▌         | 23033/441656 [00:00<00:14, 29393.23it/s]  6%|▌         | 26026/441656 [00:00<00:14, 29558.37it/s]  7%|▋         | 29007/441656 [00:01<00:13, 29634.98it/s]  7%|▋         | 31971/441656 [00:01<00:13, 29520.81it/s]  8%|▊         | 34959/441656 [00:01<00:13, 29626.96it/s]  9%|▊         | 37922/441656 [00:01<00:34, 11682.84it/s]  9%|▉         | 40861/441656 [00:01<00:28, 14258.29it/s] 10%|▉         | 43869/441656 [00:02<00:23, 16979.40it/s] 11%|█         | 46787/441656 [00:02<00:20, 19385.24it/s] 11%|█▏        | 49797/441656 [00:02<00:18, 21740.64it/s] 12%|█▏        | 52669/441656 [00:02<00:16, 23407.65it/s] 13%|█▎        | 55657/441656 [00:02<00:15, 25053.60it/s] 13%|█▎        | 58525/441656 [00:02<00:14, 25769.44it/s] 14%|█▍        | 61363/441656 [00:02<00:14, 26037.12it/s] 15%|█▍        | 64151/441656 [00:02<00:14, 26289.82it/s] 15%|█▌        | 66910/441656 [00:02<00:14, 26574.85it/s] 16%|█▌        | 69660/441656 [00:02<00:14, 26520.14it/s] 16%|█▋        | 72486/441656 [00:03<00:13, 27018.55it/s] 17%|█▋        | 75445/441656 [00:03<00:13, 27765.49it/s] 18%|█▊        | 78399/441656 [00:03<00:12, 28286.03it/s] 18%|█▊        | 81335/441656 [00:03<00:12, 28600.33it/s] 19%|█▉        | 84288/441656 [00:03<00:12, 28873.64it/s] 20%|█▉        | 87189/441656 [00:04<00:32, 10848.68it/s] 20%|██        | 89881/441656 [00:04<00:26, 13060.10it/s] 21%|██        | 92612/441656 [00:04<00:22, 15401.67it/s] 22%|██▏       | 95240/441656 [00:04<00:19, 17469.05it/s] 22%|██▏       | 97950/441656 [00:04<00:17, 19525.35it/s] 23%|██▎       | 100683/441656 [00:04<00:15, 21348.91it/s] 23%|██▎       | 103341/441656 [00:04<00:14, 22657.13it/s] 24%|██▍       | 105968/441656 [00:04<00:14, 23527.23it/s] 25%|██▍       | 108639/441656 [00:04<00:13, 24394.26it/s] 25%|██▌       | 111377/441656 [00:04<00:13, 25230.79it/s] 26%|██▌       | 114042/441656 [00:05<00:12, 25557.79it/s] 26%|██▋       | 116760/441656 [00:05<00:12, 26026.64it/s] 27%|██▋       | 119451/441656 [00:05<00:12, 26282.39it/s] 28%|██▊       | 122131/441656 [00:05<00:12, 26374.80it/s] 28%|██▊       | 124815/441656 [00:05<00:11, 26511.53it/s] 29%|██▉       | 127531/441656 [00:05<00:11, 26703.25it/s] 29%|██▉       | 130252/441656 [00:05<00:11, 26851.10it/s] 30%|███       | 132950/441656 [00:05<00:11, 26778.13it/s] 31%|███       | 135673/441656 [00:05<00:11, 26912.18it/s] 31%|███▏      | 138371/441656 [00:05<00:11, 26518.38it/s] 32%|███▏      | 141061/441656 [00:06<00:11, 26630.28it/s] 33%|███▎      | 143780/441656 [00:06<00:11, 26794.39it/s] 33%|███▎      | 146505/441656 [00:06<00:10, 26927.93it/s] 34%|███▍      | 149207/441656 [00:06<00:10, 26950.19it/s] 34%|███▍      | 151904/441656 [00:07<00:32, 9011.14it/s]  35%|███▌      | 154629/441656 [00:07<00:25, 11289.10it/s] 36%|███▌      | 157305/441656 [00:07<00:20, 13631.69it/s] 36%|███▌      | 160032/441656 [00:07<00:17, 16056.45it/s] 37%|███▋      | 162710/441656 [00:07<00:15, 18228.46it/s] 37%|███▋      | 165419/441656 [00:07<00:13, 20216.91it/s] 38%|███▊      | 168122/441656 [00:07<00:12, 21870.16it/s] 39%|███▊      | 170768/441656 [00:07<00:11, 23051.07it/s] 39%|███▉      | 173453/441656 [00:07<00:11, 24071.88it/s] 40%|███▉      | 176199/441656 [00:08<00:10, 25010.68it/s] 41%|████      | 178874/441656 [00:08<00:10, 25469.55it/s] 41%|████      | 181545/441656 [00:08<00:10, 25519.45it/s] 42%|████▏     | 184236/441656 [00:08<00:09, 25920.72it/s] 42%|████▏     | 186963/441656 [00:08<00:09, 26314.33it/s] 43%|████▎     | 189639/441656 [00:08<00:09, 26374.39it/s] 44%|████▎     | 192367/441656 [00:08<00:09, 26639.69it/s] 44%|████▍     | 195087/441656 [00:08<00:09, 26804.32it/s] 45%|████▍     | 197835/441656 [00:08<00:09, 27003.91it/s] 45%|████▌     | 200547/441656 [00:08<00:08, 26841.25it/s] 46%|████▌     | 203252/441656 [00:09<00:08, 26900.15it/s] 47%|████▋     | 205954/441656 [00:09<00:08, 26935.35it/s] 47%|████▋     | 208652/441656 [00:09<00:08, 26876.04it/s] 48%|████▊     | 211343/441656 [00:09<00:08, 26511.06it/s] 48%|████▊     | 214044/441656 [00:09<00:08, 26656.92it/s] 49%|████▉     | 216756/441656 [00:09<00:08, 26682.23it/s] 50%|████▉     | 219490/441656 [00:09<00:08, 26874.73it/s] 50%|█████     | 222184/441656 [00:09<00:08, 26891.61it/s] 51%|█████     | 224897/441656 [00:09<00:08, 26959.87it/s] 52%|█████▏    | 227594/441656 [00:09<00:07, 26844.46it/s] 52%|█████▏    | 230279/441656 [00:10<00:26, 8027.20it/s]  53%|█████▎    | 232982/441656 [00:10<00:20, 10175.07it/s] 53%|█████▎    | 235688/441656 [00:11<00:16, 12522.18it/s] 54%|█████▍    | 238338/441656 [00:11<00:13, 14837.84it/s] 55%|█████▍    | 241012/441656 [00:11<00:11, 17114.65it/s] 55%|█████▌    | 243737/441656 [00:11<00:10, 19290.04it/s] 56%|█████▌    | 246410/441656 [00:11<00:09, 21035.60it/s] 56%|█████▋    | 249129/441656 [00:11<00:08, 22579.67it/s] 57%|█████▋    | 251767/441656 [00:11<00:08, 23339.64it/s] 58%|█████▊    | 254482/441656 [00:11<00:07, 24374.10it/s] 58%|█████▊    | 257122/441656 [00:11<00:07, 24922.74it/s] 59%|█████▉    | 259843/441656 [00:11<00:07, 25574.25it/s] 59%|█████▉    | 262559/441656 [00:12<00:06, 26032.15it/s] 60%|██████    | 265238/441656 [00:12<00:06, 26249.48it/s] 61%|██████    | 267951/441656 [00:12<00:06, 26506.51it/s] 61%|██████▏   | 270681/441656 [00:12<00:06, 26738.83it/s] 62%|██████▏   | 273384/441656 [00:12<00:06, 26823.81it/s] 63%|██████▎   | 276086/441656 [00:12<00:06, 26741.95it/s] 63%|██████▎   | 278774/441656 [00:12<00:06, 26770.63it/s] 64%|██████▎   | 281461/441656 [00:12<00:06, 26499.06it/s] 64%|██████▍   | 284128/441656 [00:12<00:05, 26477.21it/s] 65%|██████▍   | 286807/441656 [00:12<00:05, 26568.47it/s] 66%|██████▌   | 289514/441656 [00:13<00:05, 26717.08it/s] 66%|██████▌   | 292199/441656 [00:13<00:05, 26754.68it/s] 67%|██████▋   | 294881/441656 [00:13<00:05, 26771.39it/s] 67%|██████▋   | 297582/441656 [00:13<00:05, 26841.87it/s] 68%|██████▊   | 300307/441656 [00:13<00:05, 26961.59it/s] 69%|██████▊   | 303022/441656 [00:13<00:05, 27015.01it/s] 69%|██████▉   | 305724/441656 [00:13<00:05, 26894.39it/s] 70%|██████▉   | 308445/441656 [00:13<00:04, 26986.87it/s] 70%|███████   | 311145/441656 [00:13<00:04, 26436.19it/s] 71%|███████   | 313792/441656 [00:13<00:04, 26317.94it/s] 72%|███████▏  | 316509/441656 [00:14<00:04, 26568.91it/s] 72%|███████▏  | 319230/441656 [00:14<00:04, 26754.66it/s] 73%|███████▎  | 321928/441656 [00:14<00:04, 26733.19it/s] 73%|███████▎  | 324617/441656 [00:14<00:04, 26776.79it/s] 74%|███████▍  | 327323/441656 [00:14<00:04, 26857.96it/s] 75%|███████▍  | 330010/441656 [00:15<00:17, 6247.21it/s]  75%|███████▌  | 332639/441656 [00:15<00:13, 8057.41it/s] 76%|███████▌  | 335336/441656 [00:15<00:10, 10218.41it/s] 77%|███████▋  | 338047/441656 [00:15<00:08, 12588.57it/s] 77%|███████▋  | 340749/441656 [00:16<00:06, 14997.80it/s] 78%|███████▊  | 343274/441656 [00:16<00:05, 16971.05it/s] 78%|███████▊  | 345964/441656 [00:16<00:05, 19112.99it/s] 79%|███████▉  | 348656/441656 [00:16<00:04, 20950.08it/s] 80%|███████▉  | 351332/441656 [00:16<00:04, 22410.89it/s] 80%|████████  | 353984/441656 [00:16<00:03, 23496.72it/s] 81%|████████  | 356673/441656 [00:16<00:03, 24425.20it/s] 81%|████████▏ | 359382/441656 [00:16<00:03, 25172.67it/s] 82%|████████▏ | 362050/441656 [00:16<00:03, 25486.67it/s] 83%|████████▎ | 364758/441656 [00:16<00:02, 25947.69it/s] 83%|████████▎ | 367453/441656 [00:17<00:02, 26240.34it/s] 84%|████████▍ | 370131/441656 [00:17<00:02, 26174.00it/s] 84%|████████▍ | 372788/441656 [00:17<00:02, 26290.03it/s] 85%|████████▌ | 375519/441656 [00:17<00:02, 26590.13it/s] 86%|████████▌ | 378198/441656 [00:17<00:02, 26625.85it/s] 86%|████████▌ | 380902/441656 [00:17<00:02, 26627.95it/s] 87%|████████▋ | 383595/441656 [00:17<00:02, 26716.40it/s] 87%|████████▋ | 386320/441656 [00:17<00:02, 26873.14it/s] 88%|████████▊ | 389013/441656 [00:17<00:01, 26883.78it/s] 89%|████████▊ | 391705/441656 [00:18<00:01, 26732.77it/s] 89%|████████▉ | 394393/441656 [00:18<00:01, 26775.37it/s] 90%|████████▉ | 397107/441656 [00:18<00:01, 26883.55it/s] 91%|█████████ | 399797/441656 [00:18<00:01, 26571.33it/s] 91%|█████████ | 402475/441656 [00:18<00:01, 26632.13it/s] 92%|█████████▏| 405140/441656 [00:18<00:01, 26524.00it/s] 92%|█████████▏| 407874/441656 [00:18<00:01, 26764.23it/s] 93%|█████████▎| 410552/441656 [00:18<00:01, 26681.44it/s] 94%|█████████▎| 413278/441656 [00:18<00:01, 26844.47it/s] 94%|█████████▍| 415977/441656 [00:18<00:00, 26885.94it/s] 95%|█████████▍| 418703/441656 [00:19<00:00, 26862.08it/s] 95%|█████████▌| 421390/441656 [00:19<00:00, 26839.05it/s] 96%|█████████▌| 424117/441656 [00:19<00:00, 26966.06it/s] 97%|█████████▋| 426814/441656 [00:19<00:00, 26686.65it/s] 97%|█████████▋| 429484/441656 [00:19<00:00, 26671.39it/s] 98%|█████████▊| 432175/441656 [00:19<00:00, 26739.82it/s] 98%|█████████▊| 434905/441656 [00:19<00:00, 26906.36it/s] 99%|█████████▉| 437596/441656 [00:19<00:00, 26855.65it/s]100%|█████████▉| 440284/441656 [00:19<00:00, 26860.52it/s]100%|██████████| 441656/441656 [00:19<00:00, 22229.91it/s]
  0%|          | 0/53198 [00:00<?, ?it/s]  7%|▋         | 3682/53198 [00:00<00:01, 36809.59it/s] 14%|█▍        | 7363/53198 [00:00<00:01, 36169.36it/s] 21%|██        | 10981/53198 [00:00<00:01, 35650.41it/s] 28%|██▊       | 14659/53198 [00:00<00:01, 36085.97it/s] 34%|███▍      | 18340/53198 [00:00<00:00, 36342.62it/s] 41%|████▏     | 21976/53198 [00:00<00:00, 36158.40it/s] 48%|████▊     | 25593/53198 [00:00<00:00, 35587.19it/s] 55%|█████▍    | 29154/53198 [00:00<00:00, 35090.66it/s] 62%|██████▏   | 32778/53198 [00:00<00:00, 35441.57it/s] 68%|██████▊   | 36425/53198 [00:01<00:00, 35753.32it/s] 75%|███████▌  | 40117/53198 [00:01<00:00, 36103.48it/s] 82%|████████▏ | 43742/53198 [00:01<00:00, 36146.60it/s] 89%|████████▉ | 47407/53198 [00:01<00:00, 36297.32it/s] 96%|█████████▌| 51038/53198 [00:01<00:00, 35615.79it/s]100%|██████████| 53198/53198 [00:01<00:00, 35772.33it/s]
  0%|          | 0/35912 [00:00<?, ?it/s] 10%|▉         | 3566/35912 [00:00<00:00, 35653.15it/s] 20%|█▉        | 7132/35912 [00:00<00:00, 35442.88it/s] 30%|███       | 10844/35912 [00:00<00:00, 36178.37it/s] 40%|████      | 14509/35912 [00:00<00:00, 36362.92it/s] 51%|█████     | 18146/35912 [00:00<00:00, 34732.96it/s] 60%|██████    | 21632/35912 [00:00<00:00, 34614.56it/s] 70%|██████▉   | 25102/35912 [00:00<00:00, 34184.09it/s] 79%|███████▉  | 28526/35912 [00:00<00:00, 34061.58it/s] 89%|████████▉ | 32085/35912 [00:00<00:00, 34527.90it/s] 99%|█████████▉| 35683/35912 [00:01<00:00, 34967.27it/s]100%|██████████| 35912/35912 [00:01<00:00, 34940.03it/s]
dataset loaded from path: 
data/ud/ud-treebanks-v2.1/UD_Catalan/inter-layer-13/UD_Catalan-train-bloom-1b1-intermediate-global_step10000.pkl
data/ud/ud-treebanks-v2.1/UD_Catalan/inter-layer-13/UD_Catalan-dev-bloom-1b1-intermediate-global_step10000.pkl
data/ud/ud-treebanks-v2.1/UD_Catalan/inter-layer-13/UD_Catalan-test-bloom-1b1-intermediate-global_step10000.pkl
Embedding dimensionality: 1536
Pre-training probe (if possible)...
Traceback (most recent call last):
  File "run.py", line 102, in <module>
    args.func(args)
  File "/home/s2308470/multilingual-typology-probing/commands.py", line 166, in greedy
    trainer.train()
  File "/home/s2308470/multilingual-typology-probing/probekit/trainers/trainer.py", line 21, in train
    self._train()
  File "/home/s2308470/multilingual-typology-probing/probekit/trainers/neural_probe_trainer.py", line 30, in _train
    self._train_for_dimensions()
  File "/home/s2308470/multilingual-typology-probing/trainers/flexible_neural_probe_trainer.py", line 72, in _train_for_dimensions
    inputs_tensor_shuffled = inputs_tensor[shuffled_indices]
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 2.21 GiB (GPU 0; 5.94 GiB total capacity; 5.41 GiB already allocated; 285.31 MiB free; 5.44 GiB reserved in total by PyTorch) If reserved memory is >> allocated memory try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF
