now processing task id: 7
CORPUS: UD_Hindi
python preprocess_treebank.py UD_Hindi --experiment-name inter-layer-17 --treebanks-root /home/s2308470/multilingual-typology-probing/data/ud/ud-treebanks-v2.1 --bloom bloom-1b7 --checkpoint 1000 --inter-layer 17 --use-gpu
Embeddings root: embeddings
Using GPU
0it [00:00, ?it/s]30it [00:00, 297.02it/s]76it [00:00, 387.42it/s]121it [00:00, 411.63it/s]167it [00:00, 428.99it/s]211it [00:00, 431.98it/s]263it [00:00, 461.47it/s]313it [00:00, 471.18it/s]361it [00:00, 470.72it/s]409it [00:00, 467.49it/s]456it [00:01, 467.99it/s]504it [00:01, 469.88it/s]551it [00:01, 468.89it/s]598it [00:01, 445.67it/s]643it [00:01, 424.85it/s]686it [00:01, 397.74it/s]727it [00:01, 380.22it/s]766it [00:01, 368.24it/s]806it [00:01, 376.28it/s]844it [00:02, 370.52it/s]882it [00:02, 353.80it/s]918it [00:02, 345.62it/s]956it [00:02, 354.30it/s]992it [00:02, 342.05it/s]1031it [00:02, 352.71it/s]1067it [00:02, 223.01it/s]1108it [00:02, 259.90it/s]1145it [00:03, 283.29it/s]1180it [00:03, 298.20it/s]1215it [00:03, 308.64it/s]1265it [00:03, 358.13it/s]1304it [00:03, 351.78it/s]1341it [00:03, 351.31it/s]1378it [00:03, 353.55it/s]1415it [00:03, 350.61it/s]1453it [00:03, 358.13it/s]1490it [00:04, 358.34it/s]1527it [00:04, 348.79it/s]1563it [00:04, 333.97it/s]1603it [00:04, 350.95it/s]1639it [00:04, 351.14it/s]1676it [00:04, 350.47it/s]1714it [00:04, 356.89it/s]1751it [00:04, 356.85it/s]1787it [00:04, 353.33it/s]1827it [00:04, 364.64it/s]1864it [00:05, 352.33it/s]1900it [00:05, 344.61it/s]1938it [00:05, 353.43it/s]1974it [00:05, 339.49it/s]2019it [00:05, 367.81it/s]2057it [00:05, 368.64it/s]2095it [00:05, 359.94it/s]2135it [00:05, 369.89it/s]2173it [00:05, 359.31it/s]2210it [00:06, 352.45it/s]2248it [00:06, 357.69it/s]2284it [00:06, 354.11it/s]2320it [00:06, 353.21it/s]2359it [00:06, 361.32it/s]2399it [00:06, 371.76it/s]2437it [00:06, 365.28it/s]2474it [00:06, 348.06it/s]2513it [00:06, 355.40it/s]2549it [00:07, 347.60it/s]2586it [00:07, 350.88it/s]2623it [00:07, 355.90it/s]2659it [00:07, 351.93it/s]2695it [00:07, 337.66it/s]2729it [00:07, 336.04it/s]2765it [00:07, 341.61it/s]2800it [00:07, 338.31it/s]2837it [00:07, 345.43it/s]2872it [00:07, 340.87it/s]2907it [00:08, 328.21it/s]2962it [00:08, 390.84it/s]3002it [00:08, 382.67it/s]3041it [00:08, 381.48it/s]3080it [00:08, 373.53it/s]3119it [00:08, 376.69it/s]3157it [00:08, 370.49it/s]3195it [00:08, 349.90it/s]3231it [00:08, 351.70it/s]3267it [00:09, 342.45it/s]3302it [00:09, 332.39it/s]3337it [00:09, 337.03it/s]3377it [00:09, 353.41it/s]3416it [00:09, 361.67it/s]3453it [00:09, 355.19it/s]3489it [00:09, 345.68it/s]3524it [00:09, 344.22it/s]3567it [00:09, 368.02it/s]3604it [00:09, 351.46it/s]3640it [00:10, 349.33it/s]3676it [00:10, 349.51it/s]3712it [00:10, 191.59it/s]3749it [00:10, 223.78it/s]3786it [00:10, 253.09it/s]3828it [00:10, 290.79it/s]3867it [00:11, 312.87it/s]3903it [00:11, 310.21it/s]3942it [00:11, 328.89it/s]3978it [00:11, 329.27it/s]4017it [00:11, 345.43it/s]4056it [00:11, 356.67it/s]4093it [00:11, 337.68it/s]4128it [00:11, 335.32it/s]4163it [00:11, 335.39it/s]4209it [00:11, 369.37it/s]4247it [00:12, 364.52it/s]4289it [00:12, 377.86it/s]4328it [00:12, 358.88it/s]4366it [00:12, 362.73it/s]4407it [00:12, 375.35it/s]4445it [00:12, 345.08it/s]4483it [00:12, 354.30it/s]4527it [00:12, 375.24it/s]4565it [00:12, 355.88it/s]4602it [00:13, 329.46it/s]4636it [00:13, 328.68it/s]4670it [00:13, 324.29it/s]4705it [00:13, 328.24it/s]4740it [00:13, 333.77it/s]4782it [00:13, 357.25it/s]4818it [00:13, 333.84it/s]4852it [00:13, 334.00it/s]4886it [00:13, 332.48it/s]4920it [00:14, 312.88it/s]4957it [00:14, 327.15it/s]4994it [00:14, 337.61it/s]5029it [00:14, 332.78it/s]5068it [00:14, 348.84it/s]5109it [00:14, 364.67it/s]5146it [00:14, 331.93it/s]5182it [00:14, 336.63it/s]5217it [00:14, 339.09it/s]5254it [00:15, 345.11it/s]5289it [00:15, 342.79it/s]5328it [00:15, 355.92it/s]5364it [00:15, 345.09it/s]5399it [00:15, 329.20it/s]5433it [00:15, 318.84it/s]5468it [00:15, 326.22it/s]5504it [00:15, 333.30it/s]5543it [00:15, 346.93it/s]5582it [00:15, 359.17it/s]5619it [00:16, 358.50it/s]5659it [00:16, 368.12it/s]5701it [00:16, 381.40it/s]5740it [00:16, 368.18it/s]5777it [00:16, 346.49it/s]5817it [00:16, 359.82it/s]5854it [00:16, 347.54it/s]5894it [00:16, 361.61it/s]5931it [00:16, 348.13it/s]5967it [00:17, 345.48it/s]6004it [00:17, 350.81it/s]6040it [00:17, 330.30it/s]6076it [00:17, 338.29it/s]6114it [00:17, 348.47it/s]6158it [00:17, 373.20it/s]6198it [00:17, 379.14it/s]6237it [00:17, 368.03it/s]6275it [00:17, 353.50it/s]6311it [00:18, 336.95it/s]6346it [00:18, 338.34it/s]6381it [00:18, 328.12it/s]6415it [00:18, 329.86it/s]6454it [00:18, 340.81it/s]6493it [00:18, 352.33it/s]6532it [00:18, 361.12it/s]6569it [00:18, 350.06it/s]6607it [00:18, 358.42it/s]6643it [00:18, 357.89it/s]6679it [00:19, 347.60it/s]6715it [00:19, 350.32it/s]6751it [00:19, 343.12it/s]6786it [00:19, 337.10it/s]6822it [00:19, 342.72it/s]6857it [00:19, 334.15it/s]6891it [00:20, 160.05it/s]6925it [00:20, 188.77it/s]6958it [00:20, 214.69it/s]6996it [00:20, 246.36it/s]7029it [00:20, 265.48it/s]7070it [00:20, 300.17it/s]7112it [00:20, 330.80it/s]7149it [00:20, 341.33it/s]7192it [00:20, 363.64it/s]7231it [00:21, 353.94it/s]7268it [00:21, 350.74it/s]7305it [00:21, 346.42it/s]7342it [00:21, 349.52it/s]7379it [00:21, 354.18it/s]7416it [00:21, 356.87it/s]7452it [00:21, 352.00it/s]7488it [00:21, 350.53it/s]7526it [00:21, 354.46it/s]7562it [00:21, 344.71it/s]7597it [00:22, 339.78it/s]7636it [00:22, 350.96it/s]7682it [00:22, 380.49it/s]7721it [00:22, 366.31it/s]7758it [00:22, 338.74it/s]7798it [00:22, 354.82it/s]7834it [00:22, 352.36it/s]7870it [00:22, 353.78it/s]7907it [00:22, 357.05it/s]7943it [00:23, 357.43it/s]7979it [00:23, 350.18it/s]8015it [00:23, 341.97it/s]8050it [00:23, 330.94it/s]8084it [00:23, 323.24it/s]8117it [00:23, 324.24it/s]8156it [00:23, 339.47it/s]8191it [00:23, 338.84it/s]8227it [00:23, 342.19it/s]8262it [00:24, 339.61it/s]8302it [00:24, 356.89it/s]8338it [00:24, 345.96it/s]8375it [00:24, 351.12it/s]8412it [00:24, 352.72it/s]8448it [00:24, 344.09it/s]8483it [00:24, 338.74it/s]8518it [00:24, 340.26it/s]8557it [00:24, 352.71it/s]8593it [00:24, 339.48it/s]8628it [00:25, 340.15it/s]8668it [00:25, 357.36it/s]8706it [00:25, 363.94it/s]8744it [00:25, 368.26it/s]8781it [00:25, 344.11it/s]8817it [00:25, 348.13it/s]8853it [00:25, 347.56it/s]8893it [00:25, 361.66it/s]8930it [00:25, 357.03it/s]8967it [00:26, 359.33it/s]9004it [00:26, 357.69it/s]9047it [00:26, 377.18it/s]9085it [00:26, 369.14it/s]9122it [00:26, 367.71it/s]9159it [00:26, 357.83it/s]9195it [00:26, 354.38it/s]9231it [00:26, 339.09it/s]9271it [00:26, 354.46it/s]9311it [00:26, 367.45it/s]9354it [00:27, 385.42it/s]9394it [00:27, 388.91it/s]9434it [00:27, 384.73it/s]9473it [00:27, 356.98it/s]9510it [00:27, 337.99it/s]9546it [00:27, 343.75it/s]9581it [00:27, 329.55it/s]9615it [00:27, 319.69it/s]9654it [00:27, 338.15it/s]9691it [00:28, 347.00it/s]9726it [00:28, 344.01it/s]9761it [00:28, 335.98it/s]9802it [00:28, 353.30it/s]9848it [00:28, 381.39it/s]9887it [00:28, 368.91it/s]9925it [00:28, 355.36it/s]9962it [00:28, 359.27it/s]10000it [00:28, 363.38it/s]10037it [00:29, 340.27it/s]10072it [00:29, 339.60it/s]10107it [00:29, 334.89it/s]10143it [00:29, 340.10it/s]10178it [00:29, 340.19it/s]10213it [00:29, 337.92it/s]10247it [00:29, 324.01it/s]10285it [00:29, 339.45it/s]10320it [00:29, 319.47it/s]10355it [00:30, 323.77it/s]10388it [00:30, 319.57it/s]10422it [00:30, 323.69it/s]10456it [00:30, 328.17it/s]10492it [00:30, 335.79it/s]10526it [00:30, 322.22it/s]10565it [00:30, 340.20it/s]10600it [00:30, 326.72it/s]10636it [00:30, 331.76it/s]10672it [00:30, 338.06it/s]10707it [00:31, 341.39it/s]10742it [00:31, 321.90it/s]10777it [00:31, 328.89it/s]10814it [00:31, 340.15it/s]10849it [00:31, 337.60it/s]10883it [00:31, 327.62it/s]10916it [00:32, 136.42it/s]10954it [00:32, 171.42it/s]10991it [00:32, 205.27it/s]11031it [00:32, 242.76it/s]11065it [00:32, 251.78it/s]11104it [00:32, 283.29it/s]11138it [00:32, 289.06it/s]11171it [00:32, 295.81it/s]11204it [00:33, 300.95it/s]11238it [00:33, 310.69it/s]11271it [00:33, 311.40it/s]11308it [00:33, 326.26it/s]11343it [00:33, 330.28it/s]11377it [00:33, 329.08it/s]11411it [00:33, 329.11it/s]11449it [00:33, 343.33it/s]11485it [00:33, 347.36it/s]11521it [00:33, 350.81it/s]11557it [00:34, 353.21it/s]11594it [00:34, 356.37it/s]11630it [00:34, 355.76it/s]11670it [00:34, 365.57it/s]11710it [00:34, 374.40it/s]11748it [00:34, 372.15it/s]11786it [00:34, 361.70it/s]11824it [00:34, 364.65it/s]11863it [00:34, 367.85it/s]11900it [00:34, 356.52it/s]11936it [00:35, 349.60it/s]11972it [00:35, 324.07it/s]12010it [00:35, 338.69it/s]12045it [00:35, 337.11it/s]12079it [00:35, 332.91it/s]12113it [00:35, 334.19it/s]12151it [00:35, 347.26it/s]12186it [00:35, 337.06it/s]12220it [00:35, 329.51it/s]12254it [00:36, 318.88it/s]12300it [00:36, 356.97it/s]12338it [00:36, 362.44it/s]12375it [00:36, 364.05it/s]12415it [00:36, 371.81it/s]12453it [00:36, 357.26it/s]12489it [00:36, 337.32it/s]12524it [00:36, 339.23it/s]12560it [00:36, 343.94it/s]12596it [00:37, 345.18it/s]12631it [00:37, 334.67it/s]12665it [00:37, 331.61it/s]12701it [00:37, 334.89it/s]12741it [00:37, 351.93it/s]12781it [00:37, 365.78it/s]12819it [00:37, 368.14it/s]12856it [00:37, 355.93it/s]12895it [00:37, 363.74it/s]12932it [00:37, 355.04it/s]12969it [00:38, 357.64it/s]13007it [00:38, 357.07it/s]13045it [00:38, 359.09it/s]13081it [00:38, 344.85it/s]13116it [00:38, 341.48it/s]13151it [00:38, 314.85it/s]13188it [00:38, 329.51it/s]13222it [00:38, 310.18it/s]13257it [00:38, 320.20it/s]13290it [00:39, 317.82it/s]13304it [00:39, 340.13it/s]
0it [00:00, ?it/s]35it [00:00, 345.51it/s]86it [00:00, 436.54it/s]130it [00:00, 422.56it/s]173it [00:00, 386.12it/s]213it [00:00, 361.41it/s]250it [00:00, 356.10it/s]288it [00:00, 360.56it/s]325it [00:00, 346.20it/s]362it [00:00, 350.77it/s]398it [00:01, 334.75it/s]432it [00:01, 334.32it/s]469it [00:01, 342.91it/s]504it [00:01, 337.45it/s]538it [00:01, 327.30it/s]573it [00:01, 328.13it/s]608it [00:01, 333.89it/s]642it [00:01, 332.67it/s]678it [00:01, 340.26it/s]713it [00:02, 317.28it/s]747it [00:02, 323.47it/s]780it [00:02, 324.99it/s]813it [00:02, 325.26it/s]846it [00:02, 323.47it/s]879it [00:02, 321.45it/s]914it [00:02, 326.74it/s]958it [00:02, 359.68it/s]998it [00:02, 369.11it/s]1035it [00:03, 347.89it/s]1071it [00:03, 334.69it/s]1107it [00:03, 340.86it/s]1142it [00:03, 336.83it/s]1176it [00:03, 327.84it/s]1209it [00:03, 322.84it/s]1242it [00:03, 320.05it/s]1285it [00:03, 351.12it/s]1321it [00:03, 352.14it/s]1357it [00:03, 342.92it/s]1392it [00:04, 338.86it/s]1431it [00:04, 352.82it/s]1468it [00:04, 357.10it/s]1504it [00:04, 338.54it/s]1539it [00:04, 336.52it/s]1577it [00:04, 346.54it/s]1612it [00:04, 325.58it/s]1645it [00:04, 325.64it/s]1659it [00:04, 340.68it/s]
0it [00:00, ?it/s]31it [00:00, 309.91it/s]75it [00:00, 380.70it/s]113it [00:00, 377.55it/s]151it [00:00, 351.56it/s]190it [00:00, 363.18it/s]227it [00:00, 343.23it/s]262it [00:00, 333.39it/s]296it [00:00, 328.79it/s]329it [00:00, 328.89it/s]362it [00:01, 314.98it/s]394it [00:01, 307.80it/s]425it [00:01, 306.87it/s]462it [00:01, 324.51it/s]496it [00:01, 325.32it/s]534it [00:01, 339.81it/s]569it [00:01, 335.58it/s]610it [00:01, 356.69it/s]646it [00:01, 350.23it/s]684it [00:02, 358.07it/s]720it [00:02, 356.00it/s]756it [00:02, 349.65it/s]792it [00:02, 326.26it/s]825it [00:02, 314.52it/s]862it [00:02, 328.06it/s]896it [00:03, 126.54it/s]931it [00:03, 156.27it/s]963it [00:03, 182.37it/s]996it [00:03, 209.42it/s]1032it [00:03, 240.52it/s]1067it [00:03, 265.43it/s]1108it [00:03, 297.69it/s]1143it [00:03, 307.62it/s]1178it [00:04, 300.01it/s]1211it [00:04, 297.40it/s]1245it [00:04, 308.65it/s]1278it [00:04, 314.17it/s]1311it [00:04, 317.45it/s]1344it [00:04, 320.09it/s]1380it [00:04, 330.92it/s]1417it [00:04, 341.19it/s]1455it [00:04, 352.12it/s]1491it [00:05, 344.77it/s]1529it [00:05, 354.77it/s]1568it [00:05, 365.04it/s]1609it [00:05, 377.88it/s]1647it [00:05, 370.54it/s]1684it [00:05, 306.31it/s]
Skipped:
{'total_sents': 16647}

Total: 0
Using model bloom-1b7-intermediate-global_step1000...
Processing UD_Hindi...
Traceback (most recent call last):
  File "preprocess_treebank.py", line 374, in <module>
    model = BloomModel.from_pretrained(bloom_model, 
  File "/home/s2308470/miniconda3/envs/multilingual-typology-probing/lib/python3.8/site-packages/transformers/modeling_utils.py", line 1878, in to
    return super().to(*args, **kwargs)
  File "/home/s2308470/miniconda3/envs/multilingual-typology-probing/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1145, in to
    return self._apply(convert)
  File "/home/s2308470/miniconda3/envs/multilingual-typology-probing/lib/python3.8/site-packages/torch/nn/modules/module.py", line 797, in _apply
    module._apply(fn)
  File "/home/s2308470/miniconda3/envs/multilingual-typology-probing/lib/python3.8/site-packages/torch/nn/modules/module.py", line 797, in _apply
    module._apply(fn)
  File "/home/s2308470/miniconda3/envs/multilingual-typology-probing/lib/python3.8/site-packages/torch/nn/modules/module.py", line 797, in _apply
    module._apply(fn)
  [Previous line repeated 1 more time]
  File "/home/s2308470/miniconda3/envs/multilingual-typology-probing/lib/python3.8/site-packages/torch/nn/modules/module.py", line 820, in _apply
    param_applied = fn(param)
  File "/home/s2308470/miniconda3/envs/multilingual-typology-probing/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1143, in convert
    return t.to(device, dtype if t.is_floating_point() or t.is_complex() else None, non_blocking)
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 64.00 MiB (GPU 0; 5.94 GiB total capacity; 5.79 GiB already allocated; 35.31 MiB free; 5.79 GiB reserved in total by PyTorch) If reserved memory is >> allocated memory try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF
